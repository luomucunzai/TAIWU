using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Threading;
using Config;
using Config.Common;
using Config.ConfigCells;
using GameData.ArchiveData;
using GameData.Combat.Math;
using GameData.Common;
using GameData.Common.SingleValueCollection;
using GameData.Dependencies;
using GameData.DLC;
using GameData.DomainEvents;
using GameData.Domains.Adventure;
using GameData.Domains.Building;
using GameData.Domains.Character;
using GameData.Domains.Character.Ai;
using GameData.Domains.Character.Ai.PrioritizedAction;
using GameData.Domains.Character.AvatarSystem;
using GameData.Domains.Character.Display;
using GameData.Domains.Character.Filters;
using GameData.Domains.Character.Relation;
using GameData.Domains.Character.SortFilter;
using GameData.Domains.Combat;
using GameData.Domains.CombatSkill;
using GameData.Domains.Extra;
using GameData.Domains.Global;
using GameData.Domains.Information;
using GameData.Domains.Information.Collection;
using GameData.Domains.Item;
using GameData.Domains.Item.Display;
using GameData.Domains.Item.Filters;
using GameData.Domains.LifeRecord;
using GameData.Domains.Map;
using GameData.Domains.Merchant;
using GameData.Domains.Organization;
using GameData.Domains.Organization.Display;
using GameData.Domains.Organization.TaiwuVillageStoragesRecord;
using GameData.Domains.Taiwu.Debate;
using GameData.Domains.Taiwu.DebateAI;
using GameData.Domains.Taiwu.Display;
using GameData.Domains.Taiwu.LifeSkillCombat;
using GameData.Domains.Taiwu.LifeSkillCombat.Operation;
using GameData.Domains.Taiwu.LifeSkillCombat.Snapshot;
using GameData.Domains.Taiwu.LifeSkillCombat.Status;
using GameData.Domains.Taiwu.Profession;
using GameData.Domains.Taiwu.Profession.SkillsData;
using GameData.Domains.Taiwu.VillagerRole;
using GameData.Domains.TaiwuEvent;
using GameData.Domains.TaiwuEvent.EventHelper;
using GameData.Domains.World;
using GameData.Domains.World.MonthlyEvent;
using GameData.Domains.World.Notification;
using GameData.GameDataBridge;
using GameData.Serializer;
using GameData.Utilities;
using NLog;
using Redzen.Random;

namespace GameData.Domains.Taiwu
{
	// Token: 0x02000042 RID: 66
	[GameDataDomain(5)]
	public class TaiwuDomain : BaseGameDataDomain
	{
		// Token: 0x06000F8F RID: 3983 RVA: 0x000FEA88 File Offset: 0x000FCC88
		private void OnInitializedDomainData()
		{
			for (int i = 0; i < 5; i++)
			{
				this._equipmentsPlans[i] = new EquipmentPlan();
			}
			for (int j = 0; j < this._combatGroupCharIds.Length; j++)
			{
				this._combatGroupCharIds[j] = -1;
			}
		}

		// Token: 0x06000F90 RID: 3984 RVA: 0x000FEAD3 File Offset: 0x000FCCD3
		private void InitializeOnInitializeGameDataModule()
		{
			TaiwuDomain.InitializeNormalLegacies();
			this.InitializeGradeRoles();
		}

		// Token: 0x06000F91 RID: 3985 RVA: 0x000FEAE4 File Offset: 0x000FCCE4
		private unsafe void InitializeOnEnterNewWorld()
		{
			this._taiwuCharId = -1;
			this._taiwuGenerationsCount = 1;
			this._legacyPoint = 0;
			this._cricketLuckPoint = 100;
			this._legacyPassingState = 0;
			this._taiwuVillageSettlementId = -1;
			this._taiwuChar = null;
			this._prosperousConstruction = false;
			this._currEquipmentPlanId = 0;
			this._curReadingBook = ItemKey.Invalid;
			for (int i = 0; i < this._referenceBooks.Length; i++)
			{
				this._referenceBooks[i] = ItemKey.Invalid;
			}
			this._referenceBookSlotUnlockStates = 1;
			this._referenceSkillSlotUnlockStates = 1;
			for (int j = 0; j < 9; j++)
			{
				this._combatSkillPlans[j] = new CombatSkillPlan();
			}
			this._currCombatSkillPlanId = 0;
			short[] array;
			short* pPlans;
			if ((array = this._combatSkillAttainmentPanelPlans) == null || array.Length == 0)
			{
				pPlans = null;
			}
			else
			{
				pPlans = &array[0];
			}
			CollectionUtils.SetMemoryToMinusOne((byte*)pPlans, this._combatSkillAttainmentPanelPlans.Length * 2);
			array = null;
			Events.RegisterHandler_AdvanceMonthBegin(new Events.OnAdvanceMonthBegin(this.OnAdvanceMonthBegin));
			this.RegisterUpdateMusicBonus();
		}

		// Token: 0x06000F92 RID: 3986 RVA: 0x000FEBE8 File Offset: 0x000FCDE8
		private void OnLoadedArchiveData()
		{
			this._taiwuChar = DomainManager.Character.GetElement_Objects(this._taiwuCharId);
			this.InitializeVillagerWorkLocations();
			Events.RegisterHandler_AdvanceMonthBegin(new Events.OnAdvanceMonthBegin(this.OnAdvanceMonthBegin));
			this.RegisterUpdateMusicBonus();
			this.ReCalcVillagerFeatureHolderSet();
		}

		// Token: 0x06000F93 RID: 3987 RVA: 0x000FEC28 File Offset: 0x000FCE28
		public override void FixAbnormalDomainArchiveData(DataContext context)
		{
			this.FixAbnormalTaiwuData(context);
			this.FixAbnormalGroupData(context);
			this.FixNotLearnedSkills(context);
			this.FixHiddenEquipSkills(context);
			this.FixInvalidSkills(context);
			this.FixBreakGridBonus(context);
			this.FixWarehouse(context);
			this.FixInventory(context);
			this.FixFiveLoongDlcClothing(context);
			this.FixItemsPoisonEffects(context);
			this.FixVillageWorkData(context);
			this.FixUnlockedWorkingVillagersData(context);
			this.FixVillageIdentityInfo(context);
			this.FixAbnormalEquipmentPlan(context);
			this.FixSkillBookReadingProgress(context);
			this.FixSkillBookReadingState(context);
			this.FixAvailableReadingStrategies(context);
			this.FixTaiwuReadingStrategyExpireTime(context);
			bool flag = DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 70, 0);
			if (flag)
			{
				this.RecordAllOwnedClothing(context);
			}
			bool flag2 = DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 74, 40);
			if (flag2)
			{
				this.FixTaiwuObsoleteBuildingCore(context);
			}
			bool flag3 = DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 74, 38);
			if (flag3)
			{
				this.FixTaiwuStockStorageGoodsShelf(context);
			}
			bool flag4 = DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 76, 22);
			if (flag4)
			{
				this.FixObsoletePoisonImmunities(context);
			}
			bool flag5 = DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 74, 0);
			if (flag5)
			{
				DomainManager.Organization.ForceUpdateTaiwuVillager(context);
			}
			bool flag6 = DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 79, 12);
			if (flag6)
			{
				this.UpdateConsummateLevelBrokenFeature(context);
			}
		}

		// Token: 0x06000F94 RID: 3988 RVA: 0x000FED74 File Offset: 0x000FCF74
		public void RecordAllOwnedClothing(DataContext context)
		{
			GameData.Domains.Character.Character taiwu = DomainManager.Taiwu.GetTaiwu();
			Inventory inventory = taiwu.GetInventory();
			foreach (ItemKey itemKey in inventory.Items.Keys)
			{
				bool flag = itemKey.ItemType == 3;
				if (flag)
				{
					DomainManager.Extra.RecordOwnedClothing(context, itemKey.TemplateId);
				}
			}
			ItemKey[] equipments = taiwu.GetEquipment();
			bool flag2 = equipments[4].IsValid();
			if (flag2)
			{
				DomainManager.Extra.RecordOwnedClothing(context, equipments[4].TemplateId);
			}
			foreach (ItemKey itemKey2 in this._warehouseItems.Keys)
			{
				bool flag3 = itemKey2.ItemType == 3;
				if (flag3)
				{
					DomainManager.Extra.RecordOwnedClothing(context, itemKey2.TemplateId);
				}
			}
		}

		// Token: 0x06000F95 RID: 3989 RVA: 0x000FEE98 File Offset: 0x000FD098
		private void RegisterUpdateMusicBonus()
		{
			DataUid musicUid = new DataUid(19, 125, ulong.MaxValue, uint.MaxValue);
			DataUid isEnabledUid = new DataUid(19, 126, ulong.MaxValue, uint.MaxValue);
			GameDataBridge.AddPostDataModificationHandler(musicUid, "UpdateMusicBonus", new Action<DataContext, DataUid>(this.UpdateMusicBonus));
			GameDataBridge.AddPostDataModificationHandler(isEnabledUid, "UpdateMusicBonus", new Action<DataContext, DataUid>(this.UpdateMusicBonus));
		}

		// Token: 0x06000F96 RID: 3990 RVA: 0x000FEEF4 File Offset: 0x000FD0F4
		private void UpdateMusicBonus(DataContext context, DataUid uid)
		{
			short musicId = DomainManager.Extra.GetSectXuannvPlayerMusicId();
			bool isEnabled = DomainManager.Extra.GetSectXuannvPlayerIsEnabled();
			bool flag = musicId < 0 || !isEnabled;
			if (flag)
			{
				HashSet<int> taiwuGroupCharIds = this._groupCharIds.GetCollection();
				foreach (int charId in taiwuGroupCharIds)
				{
					GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
					character.RemoveFeatureGroup(context, 416);
				}
				foreach (int charId2 in this._taiwuSpecialGroup)
				{
					GameData.Domains.Character.Character character2 = DomainManager.Character.GetElement_Objects(charId2);
					character2.RemoveFeatureGroup(context, 416);
				}
			}
			else
			{
				short featureId = Music.Instance[musicId].TemporaryFeature;
				HashSet<int> taiwuGroupCharIds2 = this._groupCharIds.GetCollection();
				foreach (int charId3 in taiwuGroupCharIds2)
				{
					GameData.Domains.Character.Character character3 = DomainManager.Character.GetElement_Objects(charId3);
					character3.AddFeature(context, featureId, true);
				}
				foreach (int charId4 in this._taiwuSpecialGroup)
				{
					GameData.Domains.Character.Character character4 = DomainManager.Character.GetElement_Objects(charId4);
					character4.AddFeature(context, featureId, true);
				}
			}
		}

		// Token: 0x06000F97 RID: 3991 RVA: 0x000FF0CC File Offset: 0x000FD2CC
		private void OnAdvanceMonthBegin(DataContext context)
		{
			this._prevMonthResourceCollection = new List<int>();
			for (sbyte type = 0; type < 6; type += 1)
			{
				int oriAmount = this._taiwuChar.GetResource(type);
				this._prevMonthResourceCollection.Add(oriAmount);
			}
			this._canTaiwuBeSneakyHarmfulActionTarget = !DomainManager.Extra.IsProfessionalSkillUnlockedAndEquipped(28);
		}

		// Token: 0x06000F98 RID: 3992 RVA: 0x000FF128 File Offset: 0x000FD328
		private void FixVillageIdentityInfo(DataContext context)
		{
			HashSet<int> chars = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId).GetMembers().GetMembers(0);
			List<int> wrongSettlementCharIds = new List<int>();
			foreach (int charId in chars)
			{
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
				OrganizationInfo orgInfo = character.GetOrganizationInfo();
				bool flag = orgInfo.Grade == 0 && !orgInfo.Principal;
				if (flag)
				{
					orgInfo.Principal = true;
					character.SetOrganizationInfo(orgInfo, context);
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(72, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Fixing character ");
					defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(character);
					defaultInterpolatedStringHandler.AppendLiteral("'s wrong principal value when join taiwu by stone house");
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool flag2 = orgInfo.OrgTemplateId == 20;
				if (flag2)
				{
					wrongSettlementCharIds.Add(charId);
				}
			}
			int i = 0;
			int max = wrongSettlementCharIds.Count;
			while (i < max)
			{
				int charId2 = wrongSettlementCharIds[i];
				GameData.Domains.Character.Character character2 = DomainManager.Character.GetElement_Objects(charId2);
				OrganizationInfo orgInfo2 = character2.GetOrganizationInfo();
				orgInfo2.OrgTemplateId = 16;
				orgInfo2.Grade = 0;
				orgInfo2.SettlementId = this._taiwuVillageSettlementId;
				character2.SetOrganizationInfo(orgInfo2, context);
				Events.RaiseXiangshuInfectionFeatureChanged(context, character2, 218);
				Logger logger2 = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(58, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Fixing character ");
				defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(character2);
				defaultInterpolatedStringHandler.AppendLiteral("'s wrong settlement id as taiwu villiager");
				logger2.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				i++;
			}
		}

		// Token: 0x06000F99 RID: 3993 RVA: 0x000FF2FC File Offset: 0x000FD4FC
		private unsafe void FixVillageWorkData(DataContext context)
		{
			Location location = this.GetTaiwuVillageLocation();
			foreach (KeyValuePair<int, VillagerWorkData> pair in this._villagerWork)
			{
				VillagerWorkData workData = pair.Value;
				bool flag = VillagerWorkType.IsWorkOnMap(workData.WorkType);
				if (flag)
				{
					Location workLocation = new Location(workData.AreaId, workData.BlockId);
					DomainManager.Extra.AddLocationMark(context, workLocation);
				}
				bool flag2 = pair.Value.WorkType >= 10;
				if (!flag2)
				{
					bool flag3 = pair.Value.AreaId != location.AreaId || pair.Value.BlockId != location.BlockId;
					if (!flag3)
					{
						BuildingBlockKey buildingBlockKey = new BuildingBlockKey(pair.Value.AreaId, pair.Value.BlockId, pair.Value.BuildingBlockIndex);
						BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(buildingBlockKey);
						bool flag4 = blockData.TemplateId == 0;
						if (flag4)
						{
							Logger logger = TaiwuDomain.Logger;
							DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(45, 1);
							defaultInterpolatedStringHandler.AppendLiteral("Fixing character ");
							defaultInterpolatedStringHandler.AppendFormatted<int>(pair.Key);
							defaultInterpolatedStringHandler.AppendLiteral("'s wrong  villager work data");
							logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
							this.RemoveVillagerWork(context, pair.Key, true);
						}
					}
				}
			}
			ExtraDomain extraDomain = DomainManager.Extra;
			CharacterDomain characterDomain = DomainManager.Character;
			VillagerRoleRecords records = extraDomain.GetVillagerRoleRecordsData();
			HashSet<int> idSetCurrentVillager = new HashSet<int>(extraDomain.GetVillagerRoleCharacters());
			using (HashSet<int>.Enumerator enumerator2 = idSetCurrentVillager.GetEnumerator())
			{
				while (enumerator2.MoveNext())
				{
					int charId = enumerator2.Current;
					VillagerRoleBase role = null;
					GameData.Domains.Character.Character character;
					bool flag5 = records.History.Any((VillagerRoleRecordElement r) => r.CharacterId == charId) || !characterDomain.TryGetElement_Objects(charId, out character) || (role = extraDomain.GetVillagerRole(charId)) == null;
					if (!flag5)
					{
						VillagerRoleRecordElement record = new VillagerRoleRecordElement
						{
							CharacterId = charId,
							CharacterTemplateId = character.GetTemplateId(),
							RoleTemplateId = role.RoleTemplateId,
							Personalities = character.GetPersonalities(),
							LifeSkillAttainments = *character.GetLifeSkillAttainments(),
							Avatar = character.GenerateAvatarRelatedData(),
							Date = DomainManager.World.GetCurrDate()
						};
						CharacterDomain.GetNameRelatedData(character, ref record.Name);
						records.History.Add(record);
					}
				}
			}
			extraDomain.SetVillagerRoleRecordsData(context, records);
		}

		// Token: 0x06000F9A RID: 3994 RVA: 0x000FF5FC File Offset: 0x000FD7FC
		private void FixUnlockedWorkingVillagersData(DataContext context)
		{
			List<int> villagers = DomainManager.Extra.GetUnlockedWorkingVillagers();
			for (int i = villagers.Count - 1; i >= 0; i--)
			{
				bool flag = !this._villagerWork.ContainsKey(villagers[i]);
				if (flag)
				{
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(57, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Fixing character ");
					defaultInterpolatedStringHandler.AppendFormatted<int>(villagers[i]);
					defaultInterpolatedStringHandler.AppendLiteral("'s wrong unlocked working villagers data");
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
					villagers.RemoveAt(i);
				}
			}
			DomainManager.Extra.SetUnlockedWorkingVillagers(villagers, context);
		}

		// Token: 0x06000F9B RID: 3995 RVA: 0x000FF6A8 File Offset: 0x000FD8A8
		private void FixAbnormalTaiwuData(DataContext context)
		{
			this.ClearExceedCombatSkills(context);
			this.RemoveTaiwuInvalidFeatures(context);
			this.TryRemoveReferenceSkillAtLockedSlot(context);
			this.RemoveTaiwuFromPrison(context);
		}

		// Token: 0x06000F9C RID: 3996 RVA: 0x000FF6CC File Offset: 0x000FD8CC
		private void RemoveTaiwuFromPrison(DataContext context)
		{
			sbyte prisonerSect = DomainManager.Organization.GetPrisonerSect(this._taiwuCharId);
			bool flag = prisonerSect >= 0;
			if (flag)
			{
				Settlement settlement = DomainManager.Organization.GetSettlementByOrgTemplateId(prisonerSect);
				Sect sect = settlement as Sect;
				bool flag2 = sect != null;
				if (flag2)
				{
					SettlementPrison prison = sect.Prison;
					prison.OfflineRemovePrisoner(this._taiwuCharId);
					DomainManager.Organization.UnregisterSectPrisoner(this._taiwuCharId);
					DomainManager.Extra.SetSettlementPrison(context, settlement.GetId(), prison);
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(39, 2);
					defaultInterpolatedStringHandler.AppendLiteral("Fixing taiwu in prison: ");
					defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(this._taiwuChar);
					defaultInterpolatedStringHandler.AppendLiteral(" removed from ");
					defaultInterpolatedStringHandler.AppendFormatted<Sect>(sect);
					defaultInterpolatedStringHandler.AppendLiteral(".");
					AdaptableLog.Warning(defaultInterpolatedStringHandler.ToStringAndClear(), false);
				}
			}
		}

		// Token: 0x06000F9D RID: 3997 RVA: 0x000FF7B0 File Offset: 0x000FD9B0
		private void FixAbnormalEquipmentPlan(DataContext context)
		{
			bool flag = !DomainManager.World.IsCurrWorldBeforeVersion(0, 0, 68, 0);
			if (!flag)
			{
				ItemKey defaultItemKey = default(ItemKey);
				bool isModified = false;
				for (int i = 0; i < this._equipmentsPlans.Length; i++)
				{
					EquipmentPlan equipmentPlan = this._equipmentsPlans[i];
					for (int j = 0; j < equipmentPlan.Slots.Length; j++)
					{
						bool flag2 = equipmentPlan.Slots[j].Equals(defaultItemKey);
						if (flag2)
						{
							equipmentPlan.Slots[j] = ItemKey.Invalid;
							isModified = true;
						}
					}
					bool flag3 = isModified;
					if (flag3)
					{
						this.SetElement_EquipmentsPlans(i, equipmentPlan, context);
						Logger logger = TaiwuDomain.Logger;
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(32, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Fixing abnormal equipment plan ");
						defaultInterpolatedStringHandler.AppendFormatted<int>(i);
						defaultInterpolatedStringHandler.AppendLiteral(".");
						logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
					}
				}
			}
		}

		// Token: 0x06000F9E RID: 3998 RVA: 0x000FF8B0 File Offset: 0x000FDAB0
		private void FixAbnormalGroupData(DataContext context)
		{
			OrganizationInfo taiwuOrgInfo = this._taiwuChar.GetOrganizationInfo();
			OrganizationInfo expectedGroupOrgInfo = new OrganizationInfo(taiwuOrgInfo.OrgTemplateId, 0, true, taiwuOrgInfo.SettlementId);
			OrganizationItem expectedOrgCfg = Organization.Instance[expectedGroupOrgInfo.OrgTemplateId];
			OrganizationMemberItem expectedOrgMemberCfg = OrganizationDomain.GetOrgMemberConfig(expectedGroupOrgInfo);
			foreach (int groupCharId in this._groupCharIds.GetCollection())
			{
				GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(groupCharId);
				bool flag = groupChar.IsActiveExternalRelationState(60);
				if (flag)
				{
					groupChar.DeactivateExternalRelationState(context, 60);
				}
				CrossAreaMoveInfo crossAreaMoveInfo;
				bool flag2 = DomainManager.Character.TryGetElement_CrossAreaMoveInfos(groupCharId, out crossAreaMoveInfo);
				if (flag2)
				{
					DomainManager.Character.RemoveCrossAreaTravelInfo(context, groupCharId);
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(51, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Removing unexpectedly traveling taiwu group member ");
					defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(groupChar);
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				OrganizationInfo orgInfo = groupChar.GetOrganizationInfo();
				bool flag3 = orgInfo.OrgTemplateId == taiwuOrgInfo.OrgTemplateId;
				if (!flag3)
				{
					ValueTuple<string, string> realName = CharacterDomain.GetRealName(groupChar);
					string surname = realName.Item1;
					string givenName = realName.Item2;
					OrganizationMemberItem orgMemberCfg = OrganizationDomain.GetOrgMemberConfig(orgInfo);
					OrganizationItem orgCfg = Organization.Instance[orgInfo.OrgTemplateId];
					SettlementCharacter settlementChar;
					bool flag4 = DomainManager.Organization.TryGetSettlementCharacter(groupCharId, out settlementChar) && settlementChar.GetSettlementId() != expectedGroupOrgInfo.SettlementId;
					if (flag4)
					{
						DomainManager.Organization.ChangeOrganization(context, groupChar, expectedGroupOrgInfo);
					}
					Logger logger2 = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(54, 7);
					defaultInterpolatedStringHandler.AppendLiteral("Fixing abnormal taiwu group char ");
					defaultInterpolatedStringHandler.AppendFormatted(surname);
					defaultInterpolatedStringHandler.AppendFormatted(givenName);
					defaultInterpolatedStringHandler.AppendLiteral("(");
					defaultInterpolatedStringHandler.AppendFormatted<int>(groupCharId);
					defaultInterpolatedStringHandler.AppendLiteral(") organization: ");
					defaultInterpolatedStringHandler.AppendFormatted(orgCfg.Name);
					defaultInterpolatedStringHandler.AppendFormatted(orgMemberCfg.GradeName);
					defaultInterpolatedStringHandler.AppendLiteral(" => ");
					defaultInterpolatedStringHandler.AppendFormatted(expectedOrgCfg.Name);
					defaultInterpolatedStringHandler.AppendFormatted(expectedOrgMemberCfg.GradeName);
					logger2.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
			}
		}

		// Token: 0x06000F9F RID: 3999 RVA: 0x000FFB0C File Offset: 0x000FDD0C
		private void RemoveTaiwuInvalidFeatures(DataContext context)
		{
			List<short> featureIds = this._taiwuChar.GetFeatureIds();
			for (sbyte combatSkillType = 0; combatSkillType < 14; combatSkillType += 1)
			{
				CombatSkillTypeItem combatSkillTypeCfg = Config.CombatSkillType.Instance[combatSkillType];
				bool flag = featureIds.Remove(combatSkillTypeCfg.LegendaryBookFeature);
				if (flag)
				{
					TaiwuDomain.Logger.Warn("Removing taiwu's invalid feature " + CharacterFeature.Instance[combatSkillTypeCfg.LegendaryBookFeature].Name);
				}
			}
			this._taiwuChar.SetFeatureIds(featureIds, context);
		}

		// Token: 0x06000FA0 RID: 4000 RVA: 0x000FFB90 File Offset: 0x000FDD90
		private void FixNotLearnedSkills(DataContext context)
		{
			HashSet<short> notLearnedLifeSkills = this._notLearnLifeSkillReadingProgress.Keys.ToHashSet<short>();
			HashSet<short> learnedLifeSkills = this._lifeSkills.Keys.ToHashSet<short>();
			notLearnedLifeSkills.IntersectWith(learnedLifeSkills);
			List<GameData.Domains.Character.LifeSkillItem> taiwuLifeSkills = this._taiwuChar.GetLearnedLifeSkills();
			bool flag = notLearnedLifeSkills.Count > 0;
			if (flag)
			{
				foreach (short templateId in notLearnedLifeSkills)
				{
					TaiwuDomain.Logger.Warn("Fixing life skill exists in both not learned and learned skills: " + LifeSkill.Instance[templateId].Name);
					TaiwuLifeSkill notLearnedLifeSkill = this.GetElement_NotLearnLifeSkillReadingProgress(templateId);
					TaiwuLifeSkill learnedLifeSkill = this.GetElement_LifeSkills(templateId);
					for (byte pageId = 0; pageId < 5; pageId += 1)
					{
						this.OfflineAddReadingProgress(learnedLifeSkill, pageId, (int)notLearnedLifeSkill.GetBookPageReadingProgress(pageId));
					}
					this.RemoveElement_NotLearnLifeSkillReadingProgress(templateId, context);
					this.SetElement_LifeSkills(templateId, learnedLifeSkill, context);
				}
			}
			for (int i = 0; i < taiwuLifeSkills.Count; i++)
			{
				GameData.Domains.Character.LifeSkillItem skillItem = taiwuLifeSkills[i];
				bool flag2 = !this._lifeSkills.ContainsKey(skillItem.SkillTemplateId);
				if (flag2)
				{
					this.RegisterLifeSkill(context, skillItem);
					TaiwuDomain.Logger.Warn("Fixing unregistered life skill " + LifeSkill.Instance[skillItem.SkillTemplateId].Name);
				}
			}
			bool lifeSkillChanged = false;
			foreach (KeyValuePair<short, TaiwuLifeSkill> keyValuePair in this._lifeSkills)
			{
				short num;
				TaiwuLifeSkill taiwuLifeSkill;
				keyValuePair.Deconstruct(out num, out taiwuLifeSkill);
				short templateId2 = num;
				TaiwuLifeSkill lifeSkill = taiwuLifeSkill;
				int index = this._taiwuChar.FindLearnedLifeSkillIndex(templateId2);
				bool flag3 = index >= 0;
				if (!flag3)
				{
					Config.LifeSkillItem lifeSkillCfg = LifeSkill.Instance[templateId2];
					LifeSkillTypeItem skillTypeCfg = Config.LifeSkillType.Instance[lifeSkillCfg.Type];
					GameData.Domains.Character.LifeSkillItem lifeSkillItem = new GameData.Domains.Character.LifeSkillItem(templateId2);
					for (byte pageId2 = 0; pageId2 < 5; pageId2 += 1)
					{
						bool flag4 = lifeSkill.GetBookPageReadingProgress(pageId2) >= 100;
						if (flag4)
						{
							lifeSkillItem.SetPageRead(pageId2);
						}
					}
					taiwuLifeSkills.Add(lifeSkillItem);
					lifeSkillChanged = true;
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(64, 2);
					defaultInterpolatedStringHandler.AppendLiteral("Fixing lifeSkill ");
					defaultInterpolatedStringHandler.AppendFormatted(lifeSkillCfg.Name);
					defaultInterpolatedStringHandler.AppendLiteral(" (");
					defaultInterpolatedStringHandler.AppendFormatted(skillTypeCfg.Name);
					defaultInterpolatedStringHandler.AppendLiteral(") exists only in taiwu data, not in char data");
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
			}
			bool flag5 = lifeSkillChanged;
			if (flag5)
			{
				this._taiwuChar.SetLearnedLifeSkills(taiwuLifeSkills, context);
			}
			HashSet<short> notLearnedCombatSkills = this._notLearnCombatSkillReadingProgress.Keys.ToHashSet<short>();
			HashSet<short> learnedCombatSkills = this._combatSkills.Keys.ToHashSet<short>();
			notLearnedCombatSkills.IntersectWith(learnedCombatSkills);
			bool flag6 = notLearnedCombatSkills.Count > 0;
			if (flag6)
			{
				foreach (short templateId3 in notLearnedCombatSkills)
				{
					TaiwuDomain.Logger.Warn("Fixing combat skill exists in both not learned and learned skills: " + Config.CombatSkill.Instance[templateId3].Name);
					TaiwuCombatSkill notLearnedCombatSkill = this.GetElement_NotLearnCombatSkillReadingProgress(templateId3);
					TaiwuCombatSkill learnedCombatSkill = this.GetElement_CombatSkills(templateId3);
					for (byte internalIndex = 0; internalIndex < 15; internalIndex += 1)
					{
						this.OfflineAddReadingProgress(learnedCombatSkill, internalIndex, (int)notLearnedCombatSkill.GetBookPageReadingProgress(internalIndex));
					}
					this.RemoveElement_NotLearnCombatSkillReadingProgress(templateId3, context);
					this.SetElement_CombatSkills(templateId3, learnedCombatSkill, context);
				}
			}
		}

		// Token: 0x06000FA1 RID: 4001 RVA: 0x000FFFB0 File Offset: 0x000FE1B0
		private void FixHiddenEquipSkills(DataContext context)
		{
			bool changed = false;
			short[] equipSkills = this._taiwuChar.GetEquippedCombatSkills();
			sbyte[] slotEndIndexes = GameData.Domains.Character.CombatSkillHelper.SlotEndIndexes;
			sbyte index = slotEndIndexes[slotEndIndexes.Length - 1];
			while ((int)index < equipSkills.Length)
			{
				bool flag = equipSkills[(int)index] < 0;
				if (!flag)
				{
					equipSkills[(int)index] = -1;
					changed = true;
				}
				index += 1;
			}
			bool flag2 = changed;
			if (flag2)
			{
				this._taiwuChar.SetEquippedCombatSkills(equipSkills, context);
				AdaptableLog.Warning("Hidden equip skills removed", false);
			}
		}

		// Token: 0x06000FA2 RID: 4002 RVA: 0x00100024 File Offset: 0x000FE224
		private void FixInvalidSkills(DataContext context)
		{
			short invalidSkillId = 880;
			List<short> learnedSkills = this._taiwuChar.GetLearnedCombatSkills();
			bool flag = learnedSkills.Contains(invalidSkillId);
			if (flag)
			{
				learnedSkills.Remove(invalidSkillId);
				this._taiwuChar.SetLearnedCombatSkills(learnedSkills, context);
				CombatSkillKey invalidSkillKey = new CombatSkillKey(this._taiwuCharId, invalidSkillId);
				GameData.Domains.CombatSkill.CombatSkill combatSkill;
				bool flag2 = DomainManager.CombatSkill.TryGetElement_CombatSkills(invalidSkillKey, out combatSkill);
				if (flag2)
				{
					DomainManager.CombatSkill.RemoveCombatSkill(this._taiwuCharId, invalidSkillId);
				}
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(22, 2);
				defaultInterpolatedStringHandler.AppendLiteral("Fixing invalid skill ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(invalidSkillId);
				defaultInterpolatedStringHandler.AppendLiteral(" ");
				defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(this._taiwuChar);
				AdaptableLog.Warning(defaultInterpolatedStringHandler.ToStringAndClear(), false);
			}
		}

		// Token: 0x06000FA3 RID: 4003 RVA: 0x001000E8 File Offset: 0x000FE2E8
		private void FixBreakGridBonus(DataContext context)
		{
			Dictionary<short, int> gridBonusDict = new Dictionary<short, int>();
			foreach (KeyValuePair<short, SkillBreakBonusCollection> bonusEntry in this._skillBreakBonusDict)
			{
				SkillBreakPlateObsolete plate = this._skillBreakPlateObsoleteDict[bonusEntry.Key];
				sbyte behaviorType = CombatSkillStateHelper.GetActiveOutlinePageType(plate.SelectedPages);
				gridBonusDict.Clear();
				List<BreakGrid> gridList = CombatSkillDomain.GetBonusBreakGrids(bonusEntry.Key, behaviorType);
				bool flag = gridList == null;
				if (!flag)
				{
					foreach (BreakGrid breakGridCfg in gridList)
					{
						bool flag2 = gridBonusDict.ContainsKey(breakGridCfg.BonusType);
						if (flag2)
						{
							Dictionary<short, int> dictionary = gridBonusDict;
							short bonusType = breakGridCfg.BonusType;
							dictionary[bonusType] += (int)breakGridCfg.GridCount;
						}
						else
						{
							gridBonusDict[breakGridCfg.BonusType] = (int)breakGridCfg.GridCount;
						}
					}
					SkillBreakBonusCollection bonusCollection = bonusEntry.Value;
					bonusCollection.Clear();
					for (byte i = 0; i < plate.Height; i += 1)
					{
						for (byte j = 0; j < plate.Width; j += 1)
						{
							SkillBreakPlateGridObsolete grid = plate.Grids[(int)i][(int)j];
							bool flag3 = grid.State != ESkillBreakGridState.Selected || grid.BonusType < 0;
							if (!flag3)
							{
								int count;
								bool flag4 = !gridBonusDict.TryGetValue(grid.BonusType, out count) || count <= 0;
								if (!flag4)
								{
									gridBonusDict[grid.BonusType] = count - 1;
									bonusCollection.AddBonusType(grid.BonusType);
								}
							}
						}
					}
					this.SetElement_SkillBreakBonusDict(bonusEntry.Key, bonusCollection, context);
				}
			}
		}

		// Token: 0x06000FA4 RID: 4004 RVA: 0x0010030C File Offset: 0x000FE50C
		private bool FixWarehouseModifiedItem(DataContext context, ItemKey key, out ItemKey baseKey)
		{
			baseKey = DomainManager.Item.GetBaseItem(key).GetItemKey();
			bool flag = !key.Equals(baseKey);
			bool result;
			if (flag)
			{
				int amount = DomainManager.Taiwu.GetWarehouseItemCount(key);
				DomainManager.Taiwu.WarehouseRemove(context, key, amount, false);
				DomainManager.Taiwu.WarehouseAdd(context, baseKey, amount);
				result = true;
			}
			else
			{
				result = false;
			}
			return result;
		}

		// Token: 0x06000FA5 RID: 4005 RVA: 0x0010037C File Offset: 0x000FE57C
		private void FixWarehouseNontransferableItems(DataContext context, ItemKey key)
		{
			ItemBase baseItem = DomainManager.Item.GetBaseItem(key);
			bool flag = !baseItem.GetTransferable();
			if (flag)
			{
				int amount = DomainManager.Taiwu.GetWarehouseItemCount(key);
				DomainManager.Taiwu.WarehouseRemove(context, key, amount, false);
				this._taiwuChar.AddInventoryItem(context, key, amount, false);
			}
		}

		// Token: 0x06000FA6 RID: 4006 RVA: 0x001003D0 File Offset: 0x000FE5D0
		private bool FixWarehouseExtraGoodsItems(DataContext context, ItemKey key, out ItemKey result)
		{
			result = ItemKey.Invalid;
			bool flag = ModificationStateHelper.IsActive(key.ModificationState, 8);
			bool result2;
			if (flag)
			{
				DomainManager.Taiwu.WarehouseRemove(context, key, 1, true);
				result = DomainManager.Item.CreateItem(context, key.ItemType, key.TemplateId);
				DomainManager.Taiwu.WarehouseAdd(context, result, 1);
				result2 = true;
			}
			else
			{
				result2 = false;
			}
			return result2;
		}

		// Token: 0x06000FA7 RID: 4007 RVA: 0x00100444 File Offset: 0x000FE644
		private bool FixWarehouseSectAccessoryItems(DataContext context, ItemKey key, out ItemKey result)
		{
			result = ItemKey.Invalid;
			ItemBase resultItem;
			bool removed = DomainManager.Item.RemoveRefinedEffectsAndReturnMaterial(context, key, null, out resultItem);
			bool flag = removed;
			if (flag)
			{
				result = resultItem.GetItemKey();
				DomainManager.Taiwu.WarehouseRemove(context, key, 1, false);
				DomainManager.Taiwu.WarehouseAdd(context, result, 1);
			}
			return removed;
		}

		// Token: 0x06000FA8 RID: 4008 RVA: 0x001004A8 File Offset: 0x000FE6A8
		private void FixItemsPoisonEffects(DataContext context)
		{
			TaiwuDomain.<>c__DisplayClass36_0 CS$<>8__locals1;
			CS$<>8__locals1.context = context;
			CS$<>8__locals1.<>4__this = this;
			Version gameVersion = DomainManager.World.GetCurrWorldGameVersion();
			bool flag = gameVersion != null && gameVersion.Build > 64;
			if (!flag)
			{
				List<ItemKey> keys = ObjectPool<List<ItemKey>>.Instance.Get();
				keys.Clear();
				keys.AddRange(this._taiwuChar.GetInventory().Items.Keys);
				foreach (ItemKey key in keys)
				{
					this.<FixItemsPoisonEffects>g__Fix|36_0(key, ItemSourceType.Inventory, -1, -1, ref CS$<>8__locals1);
				}
				keys.Clear();
				keys.AddRange(this._warehouseItems.Keys);
				foreach (ItemKey key2 in keys)
				{
					this.<FixItemsPoisonEffects>g__Fix|36_0(key2, ItemSourceType.Warehouse, -1, -1, ref CS$<>8__locals1);
				}
				keys.Clear();
				keys.AddRange(DomainManager.Extra.TreasuryItems.Keys);
				foreach (ItemKey key3 in keys)
				{
					this.<FixItemsPoisonEffects>g__Fix|36_0(key3, ItemSourceType.OldTreasury, -1, -1, ref CS$<>8__locals1);
				}
				keys.Clear();
				keys.AddRange(DomainManager.Extra.TroughItems.Keys);
				foreach (ItemKey key4 in keys)
				{
					this.<FixItemsPoisonEffects>g__Fix|36_0(key4, ItemSourceType.Trough, -1, -1, ref CS$<>8__locals1);
				}
				keys.Clear();
				keys.AddRange(this._taiwuChar.GetEquipment());
				for (int index = 0; index < keys.Count; index++)
				{
					ItemKey key5 = keys[index];
					this.<FixItemsPoisonEffects>g__Fix|36_0(key5, ItemSourceType.Equipment, index, -1, ref CS$<>8__locals1);
				}
				for (int planIndex = 0; planIndex < this._equipmentsPlans.Length; planIndex++)
				{
					bool flag2 = planIndex == this._currEquipmentPlanId;
					if (!flag2)
					{
						EquipmentPlan plan = this._equipmentsPlans[planIndex];
						keys.Clear();
						keys.AddRange(plan.Slots);
						for (int index2 = 0; index2 < keys.Count; index2++)
						{
							ItemKey key6 = keys[index2];
							this.<FixItemsPoisonEffects>g__Fix|36_0(key6, ItemSourceType.EquipmentPlan, index2, planIndex, ref CS$<>8__locals1);
						}
					}
				}
				ObjectPool<List<ItemKey>>.Instance.Return(keys);
			}
		}

		// Token: 0x06000FA9 RID: 4009 RVA: 0x00100778 File Offset: 0x000FE978
		private void FixWarehouse(DataContext context)
		{
			bool versionNeedRepairSectAccessory = DomainManager.Item.VersionNeedRepairSectAccessory;
			HashSet<ItemKey> currItems = ObjectPool<HashSet<ItemKey>>.Instance.Get();
			currItems.Clear();
			List<ItemKey> warehouseList = DomainManager.Taiwu.GetWarehouseAllItemKey();
			int i = 0;
			while (i < warehouseList.Count)
			{
				ItemKey key = warehouseList[i];
				bool flag = DomainManager.Item.ItemExists(key);
				if (flag)
				{
					ItemKey result;
					bool flag2 = this.FixWarehouseModifiedItem(context, key, out result);
					if (flag2)
					{
						key = result;
					}
					bool flag3 = this.FixWarehouseExtraGoodsItems(context, key, out result);
					if (flag3)
					{
						key = result;
					}
					bool flag4 = versionNeedRepairSectAccessory && this.FixWarehouseSectAccessoryItems(context, key, out result);
					if (flag4)
					{
						key = result;
					}
					this.FixWarehouseNontransferableItems(context, key);
					bool flag5 = ItemTemplateHelper.IsStackable(key.ItemType, key.TemplateId);
					if (!flag5)
					{
						int amount = DomainManager.Taiwu.GetWarehouseItemCount(key);
						bool flag6 = amount > 1;
						if (flag6)
						{
							currItems.Add(key);
						}
					}
				}
				else
				{
					this.RemoveElement_WarehouseItems(key, context);
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(38, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Removing non-existing warehouse item ");
					defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(key);
					defaultInterpolatedStringHandler.AppendLiteral(".");
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				IL_12C:
				i++;
				continue;
				goto IL_12C;
			}
			bool flag7 = currItems.Count > 0;
			if (flag7)
			{
				foreach (ItemKey currItem in currItems)
				{
					this._warehouseItems[currItem] = 1;
				}
				currItems.Clear();
			}
			ObjectPool<HashSet<ItemKey>>.Instance.Return(currItems);
		}

		// Token: 0x06000FAA RID: 4010 RVA: 0x00100938 File Offset: 0x000FEB38
		private void FixInventory(DataContext context)
		{
			List<ItemKey> inventoryList = this._taiwuChar.GetInventory().Items.Keys.ToList<ItemKey>();
			for (int i = 0; i < inventoryList.Count; i++)
			{
				ItemKey key = inventoryList[i];
				bool flag = DomainManager.Item.ItemExists(key);
				if (flag)
				{
					int amount = this._taiwuChar.GetInventory().Items[key];
					this.FixInventoryAnimalArmor(context, key, amount);
				}
			}
		}

		// Token: 0x06000FAB RID: 4011 RVA: 0x001009B8 File Offset: 0x000FEBB8
		private void FixInventoryAnimalArmor(DataContext context, ItemKey key, int amount)
		{
			ItemBase baseItem = DomainManager.Item.GetBaseItem(key);
			bool flag = baseItem.GetItemSubType() == 104;
			if (flag)
			{
				this._taiwuChar.RemoveInventoryItem(context, key, amount, true, false);
			}
		}

		// Token: 0x06000FAC RID: 4012 RVA: 0x001009F4 File Offset: 0x000FEBF4
		private void FixFiveLoongDlcClothing(DataContext context)
		{
			bool flag = !DlcManager.IsDlcInstalled(2764950UL);
			if (!flag)
			{
				bool[] alreadyHave = new bool[5];
				ItemKey[] equipment = this._taiwuChar.GetEquipment();
				for (int i = equipment.Length - 1; i >= 0; i--)
				{
					ItemKey key = equipment[i];
					bool flag2;
					if (key.ItemType == 3)
					{
						short templateId = key.TemplateId;
						flag2 = (templateId >= 75 && templateId <= 79);
					}
					else
					{
						flag2 = false;
					}
					bool flag3 = flag2;
					if (flag3)
					{
						int index = (int)(key.TemplateId - 75);
						bool flag4 = !alreadyHave[index];
						if (flag4)
						{
							alreadyHave[index] = true;
						}
					}
				}
				List<ItemKey> inventoryList = this._taiwuChar.GetInventory().Items.Keys.ToList<ItemKey>();
				for (int j = inventoryList.Count - 1; j >= 0; j--)
				{
					ItemKey key2 = inventoryList[j];
					bool flag5;
					if (key2.ItemType == 3)
					{
						short templateId = key2.TemplateId;
						flag5 = (templateId >= 75 && templateId <= 79);
					}
					else
					{
						flag5 = false;
					}
					bool flag6 = flag5;
					if (flag6)
					{
						int index2 = (int)(key2.TemplateId - 75);
						bool flag7 = !alreadyHave[index2];
						if (flag7)
						{
							alreadyHave[index2] = true;
						}
						else
						{
							this._taiwuChar.RemoveInventoryItem(context, key2, 1, true, false);
							Logger logger = TaiwuDomain.Logger;
							DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(50, 1);
							defaultInterpolatedStringHandler.AppendLiteral("Fixing taiwu repeated fiveLoongCloth, templateId: ");
							defaultInterpolatedStringHandler.AppendFormatted<short>(key2.TemplateId);
							logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
						}
					}
				}
			}
		}

		// Token: 0x06000FAD RID: 4013 RVA: 0x00100B90 File Offset: 0x000FED90
		private void FixSkillBookReadingProgress(DataContext context)
		{
			TaiwuDomain.<>c__DisplayClass41_0 CS$<>8__locals1;
			CS$<>8__locals1.context = context;
			CS$<>8__locals1.<>4__this = this;
			List<GameData.Domains.Character.LifeSkillItem> learnedLifeSkills = this._taiwuChar.GetLearnedLifeSkills();
			List<short> learnedCombatSkills = this._taiwuChar.GetLearnedCombatSkills();
			foreach (GameData.Domains.Character.LifeSkillItem lifeSkillItem in learnedLifeSkills)
			{
				TaiwuLifeSkill taiwuLifeSkill;
				bool flag = this.TryGetTaiwuLifeSkill(lifeSkillItem.SkillTemplateId, out taiwuLifeSkill);
				if (flag)
				{
					this.<FixSkillBookReadingProgress>g__FixLifeSkillBookReadingProgress|41_0(lifeSkillItem, taiwuLifeSkill, ref CS$<>8__locals1);
				}
			}
			foreach (short templateId in learnedCombatSkills)
			{
				TaiwuCombatSkill taiwuCombatSkill;
				bool flag2 = this.TryGetElement_CombatSkills(templateId, out taiwuCombatSkill);
				if (flag2)
				{
					this.<FixSkillBookReadingProgress>g__FixCombatSkillBookReadingProgress|41_1(templateId, taiwuCombatSkill, ref CS$<>8__locals1);
				}
			}
		}

		// Token: 0x06000FAE RID: 4014 RVA: 0x00100C84 File Offset: 0x000FEE84
		private void FixSkillBookReadingState(DataContext context)
		{
			List<GameData.Domains.Character.LifeSkillItem> learnedLifeSkills = this._taiwuChar.GetLearnedLifeSkills();
			List<TaiwuDomain.LifeSkillStateModify> lifeSkillModifyList = new List<TaiwuDomain.LifeSkillStateModify>();
			for (int i = 0; i < learnedLifeSkills.Count; i++)
			{
				GameData.Domains.Character.LifeSkillItem lifeSkillItem = learnedLifeSkills[i];
				TaiwuLifeSkill taiwuLifeSkill;
				bool flag = this.TryGetTaiwuLifeSkill(lifeSkillItem.SkillTemplateId, out taiwuLifeSkill);
				if (flag)
				{
					TaiwuDomain.<FixSkillBookReadingState>g__FixLifeSkillBookReadingState|43_0(lifeSkillItem, taiwuLifeSkill, i, lifeSkillModifyList);
				}
			}
			bool lifeSkillStateModified = lifeSkillModifyList.Count > 0;
			foreach (TaiwuDomain.LifeSkillStateModify modify in lifeSkillModifyList)
			{
				GameData.Domains.Character.LifeSkillItem lifeSkillItem2 = learnedLifeSkills[modify.Index];
				lifeSkillItem2.ReadingState = (byte)((int)lifeSkillItem2.ReadingState | 1 << modify.ReadPageIndex);
				learnedLifeSkills[modify.Index] = lifeSkillItem2;
			}
			bool flag2 = lifeSkillStateModified;
			if (flag2)
			{
				this._taiwuChar.SetLearnedLifeSkills(learnedLifeSkills, context);
			}
		}

		// Token: 0x06000FAF RID: 4015 RVA: 0x00100D84 File Offset: 0x000FEF84
		private void FixAvailableReadingStrategies(DataContext context)
		{
			ItemKey readingBook = this.GetCurReadingBook();
			bool flag = !readingBook.IsValid();
			if (!flag)
			{
				List<int> hasEventBookList = DomainManager.Extra.GetReadingEventBookIdList();
				bool flag2 = !hasEventBookList.Contains(readingBook.Id);
				if (!flag2)
				{
					SByteList availableReadingStrategyList;
					bool flag3 = DomainManager.Extra.TryGetElement_AvailableReadingStrategyMap(readingBook.Id, out availableReadingStrategyList);
					if (!flag3)
					{
						this.GenerateAvailableReadingStrategies(context);
					}
				}
			}
		}

		// Token: 0x06000FB0 RID: 4016 RVA: 0x00100DF0 File Offset: 0x000FEFF0
		private void FixTaiwuReadingStrategyExpireTime(DataContext context)
		{
			foreach (KeyValuePair<ItemKey, ReadingBookStrategies> kv in DomainManager.Taiwu.GetAllReadingBooks())
			{
				DomainManager.Extra.TryFixStrategiesExpireTime(context, kv.Key, kv.Value);
			}
		}

		// Token: 0x06000FB1 RID: 4017 RVA: 0x00100E5C File Offset: 0x000FF05C
		private void FixTaiwuObsoleteBuildingCore(DataContext context)
		{
			List<short> templateIds = new List<short>
			{
				236,
				235
			};
			List<ItemSourceType> sourceTypes = new List<ItemSourceType>
			{
				ItemSourceType.Inventory,
				ItemSourceType.Warehouse,
				ItemSourceType.Treasury,
				ItemSourceType.Trough,
				ItemSourceType.StockStorageWarehouse,
				ItemSourceType.StockStorageGoodsShelf
			};
			List<ValueTuple<ItemKey, ItemSourceType>> toRemoveItems = new List<ValueTuple<ItemKey, ItemSourceType>>();
			foreach (ItemSourceType sourceType in sourceTypes)
			{
				IReadOnlyDictionary<ItemKey, int> items = this.GetItems(sourceType);
				foreach (ItemKey itemKey in items.Keys)
				{
					bool flag = itemKey.ItemType == 12 && templateIds.Contains(itemKey.TemplateId);
					if (flag)
					{
						toRemoveItems.Add(new ValueTuple<ItemKey, ItemSourceType>(itemKey, sourceType));
					}
				}
			}
			foreach (ValueTuple<ItemKey, ItemSourceType> valueTuple in toRemoveItems)
			{
				ItemKey itemKey2 = valueTuple.Item1;
				ItemSourceType sourceType2 = valueTuple.Item2;
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(29, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Remove Taiwu Obsolete Item : ");
				defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(itemKey2);
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				this.RemoveItem(context, itemKey2, 1, sourceType2, true, false);
			}
		}

		// Token: 0x06000FB2 RID: 4018 RVA: 0x0010100C File Offset: 0x000FF20C
		private void FixTaiwuStockStorageGoodsShelf(DataContext context)
		{
			TaiwuVillageStorage storage = DomainManager.Extra.GetStockStorage();
			Inventory inventory = storage.Inventories[1];
			Inventory changeInventory = new Inventory();
			foreach (KeyValuePair<ItemKey, int> keyValuePair in inventory.Items)
			{
				ItemKey itemKey3;
				int num;
				keyValuePair.Deconstruct(out itemKey3, out num);
				ItemKey itemKey = itemKey3;
				int amount = num;
				ItemDisplayData itemData = new ItemDisplayData
				{
					Key = itemKey
				};
				bool canStore = GameData.Domains.Taiwu.VillagerRole.SharedMethods.CheckCanStoreItem(ItemSourceType.StockStorageGoodsShelf, itemData, -1);
				bool flag = !canStore;
				if (flag)
				{
					changeInventory.OfflineAdd(itemKey, amount);
				}
			}
			foreach (KeyValuePair<ItemKey, int> keyValuePair in changeInventory.Items)
			{
				ItemKey itemKey3;
				int num;
				keyValuePair.Deconstruct(out itemKey3, out num);
				ItemKey itemKey2 = itemKey3;
				int amount2 = num;
				inventory.OfflineRemove(itemKey2);
				DomainManager.Taiwu.AddItem(context, itemKey2, amount2, ItemSourceType.Warehouse, false);
			}
			storage.NeedCommit = true;
			DomainManager.Extra.CommitTaiwuVillageStorages(context);
		}

		// Token: 0x06000FB3 RID: 4019 RVA: 0x00101140 File Offset: 0x000FF340
		private void FixObsoletePoisonImmunities(DataContext context)
		{
			bool flag = !DomainManager.Extra.RemovePoisonImmunities(context, this._taiwuCharId);
			if (!flag)
			{
				sbyte groupLevel = TaiwuDomain.GetWorldCreationGroupLevel(0);
				short legacyId = SwordTomb.Instance[0].Legacies[(int)groupLevel];
				this.ApplyLegacyAffect(context, this._taiwuChar, legacyId);
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(52, 2);
				defaultInterpolatedStringHandler.AppendLiteral("Removing ");
				defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(this._taiwuChar);
				defaultInterpolatedStringHandler.AppendLiteral("'s poison immunities and applied ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(legacyId);
				defaultInterpolatedStringHandler.AppendLiteral("'s effect.");
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
			}
		}

		// Token: 0x06000FB4 RID: 4020 RVA: 0x001011F0 File Offset: 0x000FF3F0
		public void FixTaiwuSettlementTreasuryLoveTokenItem(DataContext context)
		{
			SettlementTreasury settlementTreasury = DomainManager.Taiwu.GetTaiwuTreasury();
			List<ItemKey> keys = settlementTreasury.Inventory.Items.Keys.ToList<ItemKey>();
			foreach (ItemKey itemKey in keys)
			{
				bool flag = !ModificationStateHelper.IsActive(itemKey.ModificationState, 4);
				if (!flag)
				{
					ItemBase itemBase = DomainManager.Item.GetBaseItem(itemKey);
					ItemKey realKey = itemBase.GetItemKey();
					bool flag2 = realKey.Equals(itemKey);
					if (!flag2)
					{
						int amount = settlementTreasury.Inventory.Items[itemKey];
						settlementTreasury.Inventory.OfflineRemove(itemKey);
						settlementTreasury.Inventory.OfflineAdd(realKey, amount);
					}
				}
			}
			this.CommitTaiwuSettlementTreasury(context);
		}

		// Token: 0x06000FB5 RID: 4021 RVA: 0x001012D4 File Offset: 0x000FF4D4
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public ValueTuple<int, int, int> PracticeCombatSkillWithExp(DataContext context, short skillTemplateId)
		{
			return new ValueTuple<int, int, int>(-1, -1, -1);
		}

		// Token: 0x06000FB6 RID: 4022 RVA: 0x001012DE File Offset: 0x000FF4DE
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public int GetPracticeCostExp(short skillTemplateId)
		{
			return 0;
		}

		// Token: 0x06000FB7 RID: 4023 RVA: 0x001012E1 File Offset: 0x000FF4E1
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public int CalcPracticeResult(DataContext context, short skillTemplateId, short attainment = -1)
		{
			return 0;
		}

		// Token: 0x06000FB8 RID: 4024 RVA: 0x001012E4 File Offset: 0x000FF4E4
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public sbyte GetLearnCombatSkillPracticeLevel(short combatSkillTemplateId)
		{
			return 0;
		}

		// Token: 0x06000FB9 RID: 4025 RVA: 0x001012E7 File Offset: 0x000FF4E7
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public bool CanBreakOut(short templateId)
		{
			return true;
		}

		// Token: 0x06000FBA RID: 4026 RVA: 0x001012EA File Offset: 0x000FF4EA
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public SkillBreakBonusCollection AutoBreakOut(DataContext context, short skillTemplateId, ushort selectedPages)
		{
			return null;
		}

		// Token: 0x06000FBB RID: 4027 RVA: 0x001012ED File Offset: 0x000FF4ED
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public int GetRemainingBonusCount(DataContext context, short skillTemplateId)
		{
			return 0;
		}

		// Token: 0x06000FBC RID: 4028 RVA: 0x001012F0 File Offset: 0x000FF4F0
		[Obsolete("This method is obsolete, and will be removed in future.")]
		public int GetBreakGridCostExp(CombatSkillItem skillConfig)
		{
			return 0;
		}

		// Token: 0x06000FBD RID: 4029 RVA: 0x001012F4 File Offset: 0x000FF4F4
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			22
		})]
		private int CalcTaiwuGroupMaxCount()
		{
			int maxCount = 10;
			return maxCount + DomainManager.Building.CalcExtraTaiwuGroupMaxCountByStrategyRoom();
		}

		// Token: 0x06000FBE RID: 4030 RVA: 0x00101318 File Offset: 0x000FF518
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		[SingleValueDependency(19, new ushort[]
		{
			284
		})]
		private int CalcWarehouseMaxLoad()
		{
			int maxLoad = 5000;
			BuildingScaleItem config = BuildingScale.Instance[112];
			List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
			for (int i = 0; i < taiwuBuildingList.Count; i++)
			{
				Location location = taiwuBuildingList[i];
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
				{
					BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
					BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
					BuildingBlockDataEx blockDataEx;
					bool flag = blockData.TemplateId == 48 && blockData.CanUse() && DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
					if (flag)
					{
						maxLoad += config.LevelEffect.GetOrLast((int)(blockDataEx.CalcUnlockedLevelCount() - 1)) * 100;
					}
				}
			}
			return maxLoad;
		}

		// Token: 0x06000FBF RID: 4031 RVA: 0x0010141C File Offset: 0x000FF61C
		[SingleValueCollectionDependency(19, new ushort[]
		{
			18
		})]
		private int CalcTroughCurrLoad()
		{
			return DomainManager.Extra.CalcTroughCurrLoad();
		}

		// Token: 0x06000FC0 RID: 4032 RVA: 0x00101438 File Offset: 0x000FF638
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		private int CalcTroughMaxLoad()
		{
			int maxLoad = 0;
			BuildingScaleItem config = BuildingScale.Instance[110];
			List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
			for (int i = 0; i < taiwuBuildingList.Count; i++)
			{
				Location location = taiwuBuildingList[i];
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
				{
					BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
					BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
					bool flag = blockData.TemplateId == 49;
					if (flag)
					{
						maxLoad += config.LevelEffect[0] * 100;
					}
				}
			}
			return maxLoad;
		}

		// Token: 0x06000FC1 RID: 4033 RVA: 0x00101510 File Offset: 0x000FF710
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		[SingleValueDependency(5, new ushort[]
		{
			12
		})]
		[SingleValueDependency(19, new ushort[]
		{
			284
		})]
		private int CalcBuildingSpaceLimit()
		{
			int maxSpace = this.GetTaiwuVillageBaseSpace();
			bool prosperousConstruction = this._prosperousConstruction;
			if (prosperousConstruction)
			{
				maxSpace += 20;
			}
			maxSpace += this.GetBuildingSpaceExtraAdd();
			Location taiwuLocation = this.GetTaiwuVillageLocation();
			return maxSpace + DomainManager.Building.GetBuildingBlockEffect(taiwuLocation, EBuildingScaleEffect.BuildingSpaceBonus, -1);
		}

		// Token: 0x06000FC2 RID: 4034 RVA: 0x0010155C File Offset: 0x000FF75C
		private int GetTaiwuVillageBaseSpace()
		{
			int maxSpace = 0;
			BuildingScaleItem config = BuildingScale.Instance[107];
			List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
			Location taiwuLocation = this.GetTaiwuVillageLocation();
			for (int i = 0; i < taiwuBuildingList.Count; i++)
			{
				Location location = taiwuBuildingList[i];
				bool flag = location.AreaId != taiwuLocation.AreaId || location.BlockId != taiwuLocation.BlockId;
				if (!flag)
				{
					BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
					for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
					{
						BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
						BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
						BuildingBlockDataEx blockDataEx;
						bool flag2 = blockData.TemplateId == 44 && blockData.CanUse() && DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
						if (flag2)
						{
							maxSpace += config.LevelEffect.GetOrLast((int)(blockDataEx.CalcUnlockedLevelCount() - 1));
						}
					}
				}
			}
			return maxSpace;
		}

		// Token: 0x06000FC3 RID: 4035 RVA: 0x00101694 File Offset: 0x000FF894
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		private int CalcBuildingSpaceCurr()
		{
			int currentSpace = 0;
			List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
			Location taiwuLocation = this.GetTaiwuVillageLocation();
			for (int i = 0; i < taiwuBuildingList.Count; i++)
			{
				Location location = taiwuBuildingList[i];
				bool flag = location.AreaId != taiwuLocation.AreaId || location.BlockId != taiwuLocation.BlockId;
				if (!flag)
				{
					BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
					for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
					{
						BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
						BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
						bool flag2 = blockData.TemplateId < 0;
						if (!flag2)
						{
							bool flag3 = BuildingBlock.Instance[blockData.TemplateId].Type == EBuildingBlockType.Building || BuildingBlock.Instance[blockData.TemplateId].Type == EBuildingBlockType.MainBuilding;
							if (flag3)
							{
								currentSpace += (int)BuildingBlock.Instance[blockData.TemplateId].Width;
							}
						}
					}
				}
			}
			return currentSpace;
		}

		// Token: 0x06000FC4 RID: 4036 RVA: 0x001017DC File Offset: 0x000FF9DC
		[SingleValueCollectionDependency(5, new ushort[]
		{
			7
		})]
		[SingleValueCollectionDependency(19, new ushort[]
		{
			195
		})]
		[SingleValueDependency(19, new ushort[]
		{
			230,
			231,
			232,
			234
		})]
		private int CalcWarehouseCurrLoad()
		{
			int value = 0;
			foreach (KeyValuePair<ItemKey, int> keyValuePair in this._warehouseItems)
			{
				ItemKey itemKey2;
				int num;
				keyValuePair.Deconstruct(out itemKey2, out num);
				ItemKey itemKey = itemKey2;
				int amount = num;
				ItemBase item = DomainManager.Item.GetBaseItem(itemKey);
				value += item.GetWeight() * amount;
			}
			bool flag = this._taiwuVillageSettlementId >= 0;
			if (flag)
			{
				value += this.GetTaiwuTreasury().Inventory.GetTotalWeight();
			}
			value += DomainManager.Extra.GetStockStorage().GetTotalWeight();
			value += DomainManager.Extra.GetCraftStorage().GetTotalWeight();
			value += DomainManager.Extra.GetMedicineStorage().GetTotalWeight();
			value += DomainManager.Extra.GetFoodStorage().GetTotalWeight();
			return value;
		}

		// Token: 0x06000FC5 RID: 4037 RVA: 0x001018D0 File Offset: 0x000FFAD0
		[SingleValueDependency(5, new ushort[]
		{
			67
		})]
		[ObjectCollectionDependency(6, 4, new ushort[]
		{
			4
		}, Scope = InfluenceScope.CharWhoEquippedTheItem, Condition = InfluenceCondition.ItemIsEquipped)]
		private int CalcMoveTimeCostPercent()
		{
			int timeCostPercent = 0;
			bool isOverweight = false;
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
				timeCostPercent = Math.Max(timeCostPercent, groupChar.CalcMoveTimePercent());
				isOverweight = (isOverweight || groupChar.IsOverweight);
			}
			bool flag = !isOverweight;
			if (flag)
			{
				timeCostPercent = DomainManager.Taiwu.GetTaiwu().CalcMoveTimePercent();
			}
			return timeCostPercent;
		}

		// Token: 0x06000FC6 RID: 4038 RVA: 0x00101974 File Offset: 0x000FFB74
		[SingleValueDependency(5, new ushort[]
		{
			34
		})]
		[ObjectCollectionDependency(6, 3, new ushort[]
		{
			4
		}, Scope = InfluenceScope.CharWhoEquippedTheItem, Condition = InfluenceCondition.ItemIsEquipped)]
		private void CalcClothingDurability(List<IntPair> value)
		{
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
				ItemKey itemKey = groupChar.GetEquipment()[4];
				value.Add((!itemKey.IsValid()) ? new IntPair(charId, 0) : new IntPair(charId, (int)DomainManager.Item.GetBaseItem(itemKey).GetCurrDurability()));
			}
		}

		// Token: 0x06000FC7 RID: 4039 RVA: 0x00101A14 File Offset: 0x000FFC14
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			104,
			105
		}, Condition = InfluenceCondition.CharIsInTaiwuGroup)]
		[SingleValueDependency(5, new ushort[]
		{
			34
		})]
		[SingleValueCollectionDependency(19, new ushort[]
		{
			247
		}, Scope = InfluenceScope.TaiwuChar)]
		private void CalcOverweightSanctionPercent(List<IntPair> value)
		{
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
				bool isOverweight = groupChar.IsOverweight;
				if (isOverweight)
				{
					value.Add(new IntPair(charId, groupChar.CalcOverweightSanctionPercent()));
				}
			}
			foreach (int charId2 in this._taiwuSpecialGroup)
			{
				GameData.Domains.Character.Character groupChar2 = DomainManager.Character.GetElement_Objects(charId2);
				bool isOverweight2 = groupChar2.IsOverweight;
				if (isOverweight2)
				{
					value.Add(new IntPair(charId2, groupChar2.CalcOverweightSanctionPercent()));
				}
			}
		}

		// Token: 0x06000FC8 RID: 4040 RVA: 0x00101B04 File Offset: 0x000FFD04
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			92,
			57
		}, Condition = InfluenceCondition.CharIsTaiwu)]
		[SingleValueDependency(5, new ushort[]
		{
			26
		})]
		[SingleValueDependency(19, new ushort[]
		{
			78
		})]
		private void CalcWeaponCurrInnerRatios(sbyte[] value)
		{
			ItemKey[] equipment = this._taiwuChar.GetEquipment();
			sbyte[] expectInnerRatios = this.GetWeaponInnerRatios();
			for (int i = 0; i < 7; i++)
			{
				if (!true)
				{
				}
				short num;
				if (i >= 3)
				{
					switch (i)
					{
					case 3:
						num = 0;
						break;
					case 4:
						num = 1;
						break;
					case 5:
						num = 2;
						break;
					default:
						num = 884;
						break;
					}
				}
				else
				{
					num = equipment[i].TemplateId;
				}
				if (!true)
				{
				}
				short templateId = num;
				bool flag = templateId < 0;
				if (!flag)
				{
					sbyte expectRatio = (i < 6) ? expectInnerRatios[i] : DomainManager.Extra.GetVoiceWeaponInnerRatio();
					value[i] = this._taiwuChar.CalcWeaponInnerRatio(templateId, expectRatio);
				}
			}
		}

		// Token: 0x06000FC9 RID: 4041 RVA: 0x00101BC0 File Offset: 0x000FFDC0
		[SingleValueDependency(1, new ushort[]
		{
			0
		})]
		private int CalcMaterialResourceMaxCount()
		{
			return 999999999;
		}

		// Token: 0x06000FCA RID: 4042 RVA: 0x00101BD8 File Offset: 0x000FFDD8
		[SingleValueCollectionDependency(5, new ushort[]
		{
			56
		})]
		[SingleValueDependency(19, new ushort[]
		{
			106
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			22
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			3
		})]
		[SingleValueDependency(19, new ushort[]
		{
			180
		})]
		[SingleValueDependency(19, new ushort[]
		{
			22
		})]
		[SingleValueDependency(19, new ushort[]
		{
			160
		})]
		[SingleValueDependency(19, new ushort[]
		{
			284
		})]
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueDependency(1, new ushort[]
		{
			18
		})]
		[SingleValueDependency(1, new ushort[]
		{
			7
		})]
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			34
		}, Condition = InfluenceCondition.CharIsTaiwu)]
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			97,
			98,
			56
		}, Condition = InfluenceCondition.CharIsTaiwuWorker)]
		private void CalcResourceChange(int[] value)
		{
			bool flag = !DomainManager.World.GetWorldFunctionsStatus(10);
			if (flag)
			{
				for (sbyte resourceType = 0; resourceType < 8; resourceType += 1)
				{
					value[(int)resourceType] = 0;
				}
			}
			else
			{
				this.CalcResourceChangeBeforeExpand(value);
				sbyte i = 0;
				while ((int)i < value.Length)
				{
					value[(int)i] += DomainManager.Extra.CalcResourceChangeByJiaoPool(i);
					i += 1;
				}
				value[7] += DomainManager.Taiwu.GetVillagerRoleHeadTotalAuthorityCost();
				value[7] += DomainManager.Organization.CalcApprovingRateEffectAuthorityGain();
			}
		}

		// Token: 0x06000FCB RID: 4043 RVA: 0x00101C70 File Offset: 0x000FFE70
		public void CalcResourceChangeBeforeExpand(int[] value)
		{
			this.CalcResourceBlockIncomeEffectValues(ref value);
			foreach (KeyValuePair<int, VillagerWorkData> entry in this._villagerWork)
			{
				VillagerWorkData workData = entry.Value;
				bool flag = workData.WorkType == 10 && this.CanWork(workData.CharacterId);
				if (flag)
				{
					int addResource = workData.GetCollectResourceIncome();
					value[(int)workData.ResourceType] += addResource;
				}
			}
			List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
			for (int i = 0; i < taiwuBuildingList.Count; i++)
			{
				Location location = taiwuBuildingList[i];
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
				{
					BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
					BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
					BuildingBlockDataEx blockDataEx;
					bool flag2 = blockData.RootBlockIndex >= 0 || !DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
					if (!flag2)
					{
						BuildingBlockItem configData = BuildingBlock.Instance[blockData.TemplateId];
						bool isCollectResourceBuilding = configData.IsCollectResourceBuilding;
						if (isCollectResourceBuilding)
						{
							sbyte resourceType = DomainManager.Building.GetCollectBuildingResourceType(blockKey);
							sbyte getResourceType = (resourceType < 6) ? resourceType : 5;
							value[(int)getResourceType] += DomainManager.Building.CalcResourceOutputCount(blockKey, getResourceType);
						}
						bool flag3 = blockData.NeedMaintenanceCost();
						if (flag3)
						{
							int[] maintenanceCost = GameData.Domains.Building.SharedMethods.GetFinalMaintenanceCost(configData);
							for (int j = 0; j < maintenanceCost.Length; j++)
							{
								value[j] -= maintenanceCost[j];
							}
						}
						bool flag4 = blockData.TemplateId == 45 && blockData.CanUse();
						if (flag4)
						{
							value[7] += DomainManager.Building.CalculateGainAuthorityByShrinePerMonth(blockKey);
						}
						bool flag5 = blockData.Durability == 0 && blockDataEx.CalcUnlockedLevelCount() == 1 && configData.DestoryType == 1;
						if (flag5)
						{
							value[7] -= (int)configData.MaxDurability;
						}
					}
				}
			}
			bool flag6 = DomainManager.World.GetCurrMonthInYear() == (sbyte)(GlobalConfig.Instance.CricketActiveStartMonth - 1);
			if (flag6)
			{
				value[7] += BuildingDomain.GetCricketAuthorityGain();
			}
		}

		// Token: 0x06000FCC RID: 4044 RVA: 0x00101F0C File Offset: 0x0010010C
		public void CalcResourceBlockIncomeEffectValues(ref int[] value)
		{
			Location taiwuLocation = DomainManager.Taiwu.GetTaiwuVillageLocation();
			ResourceInts resourcesChange = DomainManager.Building.CalcResourceBlockIncomeEffects(taiwuLocation).Item1;
			DomainManager.Building.FinalizeResourceBlockIncomeEffectValues(ref resourcesChange, true);
			for (int i = 0; i < value.Length; i++)
			{
				value[i] += resourcesChange.Get(i);
			}
		}

		// Token: 0x06000FCD RID: 4045 RVA: 0x00101F70 File Offset: 0x00100170
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		private short CalcWorkLocationMaxCount()
		{
			BuildingBlockData blockData;
			DomainManager.Building.TryGetElement_BuildingBlocks(default(BuildingBlockKey), out blockData);
			int count = (int)GlobalConfig.Instance.MarkLocationBaseMaxCount;
			return (short)count;
		}

		// Token: 0x06000FCE RID: 4046 RVA: 0x00101FA8 File Offset: 0x001001A8
		[ObjectCollectionDependency(3, 1, new ushort[]
		{
			10
		}, Condition = InfluenceCondition.CivilianSettlementIsTaiwuVillage)]
		[SingleValueDependency(5, new ushort[]
		{
			0
		})]
		[SingleValueDependency(5, new ushort[]
		{
			55
		})]
		private short CalcTotalVillagerCount()
		{
			short count = 0;
			bool flag = this._taiwuVillageSettlementId >= 0;
			if (flag)
			{
				List<int> memberList = ObjectPool<List<int>>.Instance.Get();
				DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
				count += (short)memberList.Count;
				bool flag2 = memberList.Contains(this._taiwuCharId);
				if (flag2)
				{
					count -= 1;
				}
				ObjectPool<List<int>>.Instance.Return(memberList);
			}
			return count;
		}

		// Token: 0x06000FCF RID: 4047 RVA: 0x00102024 File Offset: 0x00100224
		[ObjectCollectionDependency(3, 1, new ushort[]
		{
			10
		}, Condition = InfluenceCondition.CivilianSettlementIsTaiwuVillage)]
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			76
		}, Condition = InfluenceCondition.CharIsTaiwuVillager)]
		[SingleValueDependency(5, new ushort[]
		{
			0
		})]
		[SingleValueDependency(5, new ushort[]
		{
			55
		})]
		private short CalcTotalAdultVillagerCount()
		{
			List<int> memberList = ObjectPool<List<int>>.Instance.Get();
			DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
			for (int i = memberList.Count - 1; i >= 0; i--)
			{
				bool flag = DomainManager.Character.GetElement_Objects(memberList[i]).GetPhysiologicalAge() < 16;
				if (flag)
				{
					memberList.RemoveAt(i);
				}
			}
			short count = (short)memberList.Count;
			bool flag2 = memberList.Contains(this._taiwuCharId);
			if (flag2)
			{
				count -= 1;
			}
			ObjectPool<List<int>>.Instance.Return(memberList);
			return count;
		}

		// Token: 0x06000FD0 RID: 4048 RVA: 0x001020D0 File Offset: 0x001002D0
		[ObjectCollectionDependency(3, 1, new ushort[]
		{
			10
		}, Condition = InfluenceCondition.CivilianSettlementIsTaiwuVillage)]
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			17,
			76,
			69
		}, Condition = InfluenceCondition.CharIsTaiwuVillager)]
		[SingleValueDependency(5, new ushort[]
		{
			34
		})]
		[SingleValueDependency(5, new ushort[]
		{
			55
		})]
		[SingleValueCollectionDependency(5, new ushort[]
		{
			56
		})]
		private short CalcAvailableVillagerCount()
		{
			List<int> memberList = ObjectPool<List<int>>.Instance.Get();
			DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
			for (int i = memberList.Count - 1; i >= 0; i--)
			{
				bool flag = !this.IsVillagerAvailableForWork(memberList[i], true);
				if (flag)
				{
					memberList.RemoveAt(i);
				}
			}
			short count = (short)memberList.Count;
			ObjectPool<List<int>>.Instance.Return(memberList);
			return count;
		}

		// Token: 0x06000FD1 RID: 4049 RVA: 0x0010215C File Offset: 0x0010035C
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			98
		}, Condition = InfluenceCondition.CharIsTaiwu)]
		private unsafe byte CalcReferenceBookSlotUnlockStates()
		{
			LifeSkillShorts lifeSkillAttainments = *this._taiwuChar.GetLifeSkillAttainments();
			byte unlockCount = 1;
			for (int i = 0; i < 16; i++)
			{
				bool flag = (int)(*(ref lifeSkillAttainments.Items.FixedElementField + (IntPtr)i * 2)) >= GlobalConfig.Instance.ReferenceBookSlotUnlockParams[2];
				if (flag)
				{
					unlockCount = 3;
					break;
				}
				bool flag2 = (int)(*(ref lifeSkillAttainments.Items.FixedElementField + (IntPtr)i * 2)) >= GlobalConfig.Instance.ReferenceBookSlotUnlockParams[1];
				if (flag2)
				{
					unlockCount = 2;
				}
			}
			if (!true)
			{
			}
			byte result;
			if (unlockCount != 2)
			{
				if (unlockCount != 3)
				{
					result = 1;
				}
				else
				{
					result = 7;
				}
			}
			else
			{
				result = 3;
			}
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x06000FD2 RID: 4050 RVA: 0x00102218 File Offset: 0x00100418
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueDependency(1, new ushort[]
		{
			27
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		[SingleValueCollectionDependency(19, new ushort[]
		{
			245
		})]
		private bool CalcVillagerLearnLifeSkillsFromSect()
		{
			int currDate = DomainManager.World.GetCurrDate();
			ProfessionData professionData = DomainManager.Extra.GetProfessionData(16);
			TeaTasterSkillsData skillsData = professionData.SkillsData as TeaTasterSkillsData;
			bool flag = skillsData != null && skillsData.VillagersLastLearnSkillDate + 3 >= currDate;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				Location location = this.GetTaiwuVillageLocation();
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
				{
					BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
					BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
					bool flag2 = blockData.TemplateId != 281;
					if (!flag2)
					{
						BuildingBlockDataEx blockDataEx;
						bool flag3 = !DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
						if (!flag3)
						{
							return blockDataEx.CalcUnlockedLevelCount() > 0;
						}
					}
				}
				result = false;
			}
			return result;
		}

		// Token: 0x06000FD3 RID: 4051 RVA: 0x00102318 File Offset: 0x00100518
		[SingleValueDependency(9, new ushort[]
		{
			2
		})]
		[SingleValueDependency(1, new ushort[]
		{
			27
		})]
		[SingleValueCollectionDependency(9, new ushort[]
		{
			1
		})]
		[SingleValueCollectionDependency(19, new ushort[]
		{
			245
		})]
		private bool CalcVillagerLearnCombatSkillsFromSect()
		{
			int currDate = DomainManager.World.GetCurrDate();
			ProfessionData professionData = DomainManager.Extra.GetProfessionData(7);
			WineTasterSkillsData skillsData = professionData.SkillsData as WineTasterSkillsData;
			bool flag = skillsData != null && skillsData.VillagersLastLearnSkillDate + 3 >= currDate;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				Location location = this.GetTaiwuVillageLocation();
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
				{
					BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
					BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
					bool flag2 = blockData.TemplateId != 282;
					if (!flag2)
					{
						BuildingBlockDataEx blockDataEx;
						bool flag3 = !DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
						if (!flag3)
						{
							return blockDataEx.CalcUnlockedLevelCount() > 0;
						}
					}
				}
				result = false;
			}
			return result;
		}

		// Token: 0x06000FD4 RID: 4052 RVA: 0x00102418 File Offset: 0x00100618
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			100
		}, Condition = InfluenceCondition.CharIsTaiwu)]
		private unsafe byte CalcReferenceSkillSlotUnlockStates()
		{
			CombatSkillShorts combatSkillAttainments = *this._taiwuChar.GetCombatSkillAttainments();
			byte unlockCount = 1;
			for (int i = 0; i < 14; i++)
			{
				bool flag = (int)(*(ref combatSkillAttainments.Items.FixedElementField + (IntPtr)i * 2)) >= GlobalConfig.Instance.ReferenceSkillSlotUnlockParams[2];
				if (flag)
				{
					unlockCount = 3;
					break;
				}
				bool flag2 = (int)(*(ref combatSkillAttainments.Items.FixedElementField + (IntPtr)i * 2)) >= GlobalConfig.Instance.ReferenceSkillSlotUnlockParams[1];
				if (flag2)
				{
					unlockCount = 2;
				}
			}
			if (!true)
			{
			}
			byte result;
			if (unlockCount != 2)
			{
				if (unlockCount != 3)
				{
					result = 1;
				}
				else
				{
					result = 7;
				}
			}
			else
			{
				result = 3;
			}
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x06000FD5 RID: 4053 RVA: 0x001024D4 File Offset: 0x001006D4
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			26
		}, Condition = InfluenceCondition.CharIsInTaiwuGroup)]
		private Injuries CalcTaiwuGroupWorstInjuries()
		{
			HashSet<int> ids = DomainManager.Taiwu.GetGroupCharIds().GetCollection();
			Injuries res = default(Injuries);
			res.Initialize();
			foreach (int id in ids)
			{
				Injuries injuries = DomainManager.Character.GetElement_Objects(id).GetInjuries();
				for (sbyte bodyPart = 0; bodyPart < 7; bodyPart += 1)
				{
					ValueTuple<sbyte, sbyte> valueTuple = injuries.Get(bodyPart);
					sbyte outer = valueTuple.Item1;
					sbyte inner = valueTuple.Item2;
					bool flag = res.Get(bodyPart, true) < inner;
					if (flag)
					{
						res.Set(bodyPart, true, inner);
					}
					bool flag2 = res.Get(bodyPart, false) < outer;
					if (flag2)
					{
						res.Set(bodyPart, false, outer);
					}
				}
			}
			return res;
		}

		// Token: 0x06000FD6 RID: 4054 RVA: 0x001025D8 File Offset: 0x001007D8
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			34
		}, Condition = InfluenceCondition.CharIsTaiwu)]
		[SingleValueDependency(19, new ushort[]
		{
			230,
			231,
			232,
			234
		})]
		private ResourceInts CalcTotalResources()
		{
			ResourceInts value = default(ResourceInts);
			value.Initialize();
			ref ResourceInts charResources = ref this._taiwuChar.GetResources();
			value.Add(ref charResources);
			SettlementTreasury treasury;
			bool flag = !DomainManager.Extra.TryGetElement_SettlementTreasuries(this._taiwuVillageSettlementId, out treasury);
			ResourceInts result;
			if (flag)
			{
				result = value;
			}
			else
			{
				value.Add(ref treasury.Resources);
				TaiwuVillageStorage stockStorage = DomainManager.Extra.GetStockStorage();
				TaiwuVillageStorage craftStorage = DomainManager.Extra.GetCraftStorage();
				TaiwuVillageStorage medicineStorage = DomainManager.Extra.GetMedicineStorage();
				TaiwuVillageStorage foodStorage = DomainManager.Extra.GetFoodStorage();
				value.Add(ref stockStorage.Resources);
				value.Add(ref craftStorage.Resources);
				value.Add(ref medicineStorage.Resources);
				value.Add(ref foodStorage.Resources);
				result = value;
			}
			return result;
		}

		// Token: 0x06000FD7 RID: 4055 RVA: 0x001026AC File Offset: 0x001008AC
		[SingleValueCollectionDependency(19, new ushort[]
		{
			247
		}, Scope = InfluenceScope.TaiwuChar)]
		[SingleValueDependency(8, new ushort[]
		{
			32
		})]
		private List<int> CalcTaiwuSpecialGroup(List<int> value)
		{
			int taiwuCharId = this.GetTaiwuCharId();
			IReadOnlySet<int> specialGroup = DomainManager.Extra.GetSpecialGroup(taiwuCharId);
			value.Clear();
			value.AddRange(specialGroup);
			foreach (int specialGroupCharId in DomainManager.Combat.GetTaiwuSpecialGroupCharIds())
			{
				bool flag = !value.Contains(specialGroupCharId);
				if (flag)
				{
					value.Add(specialGroupCharId);
				}
			}
			return value;
		}

		// Token: 0x06000FD8 RID: 4056 RVA: 0x00102740 File Offset: 0x00100940
		[SingleValueCollectionDependency(5, new ushort[]
		{
			71
		})]
		private List<int> CalcTaiwuGearMateGroup(List<int> value)
		{
			List<int> specialGroup = DomainManager.Taiwu.GetTaiwuSpecialGroup();
			value.Clear();
			foreach (int specialMember in specialGroup)
			{
				GameData.Domains.Character.Character character;
				bool flag = DomainManager.Character.TryGetElement_Objects(specialMember, out character);
				if (flag)
				{
					bool flag2 = character.GetTemplateId() == 836;
					if (flag2)
					{
						value.Add(specialMember);
					}
				}
			}
			return value;
		}

		// Token: 0x06000FD9 RID: 4057 RVA: 0x001027D8 File Offset: 0x001009D8
		[ObjectCollectionDependency(4, 0, new ushort[]
		{
			19
		}, Condition = InfluenceCondition.CharIsTaiwu)]
		private bool CalcCanBreakOut()
		{
			return this._taiwuChar.GetHealth() > 0;
		}

		// Token: 0x17000025 RID: 37
		// (get) Token: 0x06000FDA RID: 4058 RVA: 0x001027F8 File Offset: 0x001009F8
		public Dictionary<ItemKey, int> WarehouseItems
		{
			get
			{
				return this._warehouseItems;
			}
		}

		// Token: 0x06000FDB RID: 4059 RVA: 0x00102800 File Offset: 0x00100A00
		[DomainMethod]
		public void WarehouseAdd(DataContext context, ItemKey itemKey, int amount)
		{
			Tester.Assert(itemKey.IsValid(), "");
			bool flag = amount <= 0;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(45, 2);
				defaultInterpolatedStringHandler.AppendLiteral("WarehouseAdd amount <= 0, itemKey: ");
				defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(itemKey);
				defaultInterpolatedStringHandler.AppendLiteral(", amount: ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(amount);
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			else
			{
				DomainManager.Item.SetOwner(itemKey, ItemOwnerType.Warehouse, (int)this._taiwuVillageSettlementId);
				int oriAmount;
				bool flag2 = this._warehouseItems.TryGetValue(itemKey, out oriAmount);
				if (flag2)
				{
					Tester.Assert(ItemTemplateHelper.IsPureStackable(itemKey), "");
					this.SetElement_WarehouseItems(itemKey, oriAmount + amount, context);
				}
				else
				{
					this.AddElement_WarehouseItems(itemKey, amount, context);
				}
				Events.RaiseTaiwuItemModified(context, itemKey);
			}
		}

		// Token: 0x06000FDC RID: 4060 RVA: 0x001028D0 File Offset: 0x00100AD0
		[DomainMethod]
		public void WarehouseAddList(DataContext context, List<ItemKey> keyList)
		{
			Tester.Assert(keyList != null, "");
			Tester.Assert(keyList.Count > 0, "");
			foreach (ItemKey key in keyList)
			{
				this.WarehouseAdd(context, key, 1);
			}
		}

		// Token: 0x06000FDD RID: 4061 RVA: 0x00102948 File Offset: 0x00100B48
		[DomainMethod]
		public void WarehouseRemove(DataContext context, ItemKey itemKey, int amount, bool deleteItem = false)
		{
			Tester.Assert(itemKey.IsValid(), "");
			Tester.Assert(amount > 0, "");
			DomainManager.Item.RemoveOwner(itemKey, ItemOwnerType.Warehouse, (int)this._taiwuVillageSettlementId);
			int currAmount = this._warehouseItems[itemKey] - amount;
			bool flag = currAmount > 0;
			if (flag)
			{
				this.SetElement_WarehouseItems(itemKey, currAmount, context);
			}
			else
			{
				bool flag2 = currAmount == 0;
				if (!flag2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 2);
					defaultInterpolatedStringHandler.AppendLiteral("Item amount cannot be negative after removing: ");
					defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(itemKey);
					defaultInterpolatedStringHandler.AppendLiteral(", ");
					defaultInterpolatedStringHandler.AppendFormatted<int>(amount);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.RemoveElement_WarehouseItems(itemKey, context);
				bool flag3 = itemKey.ItemType == 0;
				if (flag3)
				{
					DomainManager.Extra.ClearLegendaryBookWeaponSlot(context, itemKey);
				}
				bool flag4 = ItemType.IsEquipmentItemType(itemKey.ItemType);
				if (flag4)
				{
					EquipmentBase baseEquipment = DomainManager.Item.GetBaseEquipment(itemKey);
					baseEquipment.SetModificationState(baseEquipment.GetModificationState(), context);
				}
				if (deleteItem)
				{
					DomainManager.Item.RemoveItem(context, itemKey);
				}
			}
		}

		// Token: 0x06000FDE RID: 4062 RVA: 0x00102A68 File Offset: 0x00100C68
		[DomainMethod]
		public void WarehouseRemoveList(DataContext context, List<ItemKey> keyList, bool deleteItem = false)
		{
			Tester.Assert(keyList != null, "");
			Tester.Assert(keyList.Count > 0, "");
			foreach (ItemKey key in keyList)
			{
				this.WarehouseRemove(context, key, 1, deleteItem);
			}
		}

		// Token: 0x06000FDF RID: 4063 RVA: 0x00102AE0 File Offset: 0x00100CE0
		public ItemKey CreateWarehouseItem(DataContext context, sbyte itemType, short templateId, int amount)
		{
			ItemKey itemKey = ItemKey.Invalid;
			bool flag = amount <= 1 || ItemTemplateHelper.IsStackable(itemType, templateId);
			if (flag)
			{
				itemKey = DomainManager.Item.CreateItem(context, itemType, templateId);
				this.WarehouseAdd(context, itemKey, amount);
			}
			else
			{
				for (int i = 0; i < amount; i++)
				{
					itemKey = DomainManager.Item.CreateItem(context, itemType, templateId);
					this.AddElement_WarehouseItems(itemKey, 1, context);
					DomainManager.Item.SetOwner(itemKey, ItemOwnerType.Warehouse, (int)this._taiwuVillageSettlementId);
				}
			}
			return itemKey;
		}

		// Token: 0x06000FE0 RID: 4064 RVA: 0x00102B6C File Offset: 0x00100D6C
		[DomainMethod]
		public void PutItemIntoWarehouse(DataContext context, ItemKey itemKey, int amount)
		{
			bool flag = itemKey.ItemType == 0;
			if (flag)
			{
				DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(true);
			}
			this._taiwuChar.RemoveInventoryItem(context, itemKey, amount, false, false);
			this.WarehouseAdd(context, itemKey, amount);
			bool flag2 = itemKey.ItemType == 0;
			if (flag2)
			{
				DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(false);
			}
		}

		// Token: 0x06000FE1 RID: 4065 RVA: 0x00102BC7 File Offset: 0x00100DC7
		[DomainMethod]
		public void PutItemListIntoWarehouse(DataContext context, List<ItemKey> keyList)
		{
			DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(true);
			this._taiwuChar.RemoveInventoryItemList(context, keyList, false);
			this.WarehouseAddList(context, keyList);
			DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(false);
		}

		// Token: 0x06000FE2 RID: 4066 RVA: 0x00102BFC File Offset: 0x00100DFC
		[DomainMethod]
		public void TakeOutItemFromWarehouse(DataContext context, ItemKey itemKey, int amount)
		{
			bool flag = itemKey.ItemType == 0;
			if (flag)
			{
				DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(true);
			}
			this.WarehouseRemove(context, itemKey, amount, false);
			this._taiwuChar.AddInventoryItem(context, itemKey, amount, false);
			bool flag2 = itemKey.ItemType == 0;
			if (flag2)
			{
				DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(false);
			}
		}

		// Token: 0x06000FE3 RID: 4067 RVA: 0x00102C57 File Offset: 0x00100E57
		[DomainMethod]
		public void TakeOutItemListFromWarehouse(DataContext context, List<ItemKey> keyList)
		{
			DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(true);
			this.WarehouseRemoveList(context, keyList, false);
			this._taiwuChar.AddInventoryItemList(context, keyList);
			DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(false);
		}

		// Token: 0x06000FE4 RID: 4068 RVA: 0x00102C8C File Offset: 0x00100E8C
		[DomainMethod]
		public bool CanTransferItemToWarehouse(DataContext context)
		{
			Location location = this._taiwuChar.GetLocation();
			bool flag = !location.IsValid();
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				Location rootLocation = DomainManager.Map.GetBlock(location).GetRootBlock().GetLocation();
				BuildingAreaData area;
				bool flag2 = !DomainManager.Building.TryGetElement_BuildingAreas(rootLocation, out area);
				result = (!flag2 && (BuildingDomain.HasBuilt(rootLocation, area, 48, true) || BuildingDomain.HasBuilt(rootLocation, area, 257, true) || BuildingDomain.HasBuilt(rootLocation, area, 258, true) || BuildingDomain.HasBuilt(rootLocation, area, 44, true)));
			}
			return result;
		}

		// Token: 0x06000FE5 RID: 4069 RVA: 0x00102D28 File Offset: 0x00100F28
		[return: TupleElementNames(new string[]
		{
			"merchantSourceType",
			"merchantType"
		})]
		public ValueTuple<OpenShopEventArguments.EMerchantSourceType, sbyte> GetAreaMerchantInfo(short areaId)
		{
			sbyte merchantType = -1;
			OpenShopEventArguments.EMerchantSourceType merchantSourceType = OpenShopEventArguments.EMerchantSourceType.None;
			MapAreaData mapAreaData = DomainManager.Map.GetAreaByAreaId(areaId);
			short blockId = mapAreaData.SettlementInfos.First<SettlementInfo>().BlockId;
			Location rootLocation = new Location(areaId, blockId);
			BuildingAreaData area;
			bool flag = !DomainManager.Building.TryGetElement_BuildingAreas(rootLocation, out area);
			ValueTuple<OpenShopEventArguments.EMerchantSourceType, sbyte> result;
			if (flag)
			{
				result = new ValueTuple<OpenShopEventArguments.EMerchantSourceType, sbyte>(merchantSourceType, merchantType);
			}
			else
			{
				for (short i = 274; i <= 280; i += 1)
				{
					bool flag2 = BuildingDomain.HasBuilt(rootLocation, area, i, true);
					if (flag2)
					{
						BuildingBlockItem buildingConfig = BuildingBlock.Instance[i];
						merchantType = buildingConfig.MerchantId;
						MerchantTypeItem merchantTypeConfig = Config.MerchantType.Instance[merchantType];
						merchantSourceType = ((merchantTypeConfig.HeadArea == mapAreaData.GetTemplateId()) ? OpenShopEventArguments.EMerchantSourceType.MerchantHeadBuilding : OpenShopEventArguments.EMerchantSourceType.MerchantBranchBuilding);
						break;
					}
				}
				bool flag3 = BuildingDomain.HasBuilt(rootLocation, area, 318, true);
				if (flag3)
				{
					merchantSourceType = OpenShopEventArguments.EMerchantSourceType.SpecialBuilding;
					BuildingBlockItem buildingConfig2 = BuildingBlock.Instance[318];
					merchantType = buildingConfig2.MerchantId;
				}
				result = new ValueTuple<OpenShopEventArguments.EMerchantSourceType, sbyte>(merchantSourceType, merchantType);
			}
			return result;
		}

		// Token: 0x06000FE6 RID: 4070 RVA: 0x00102E3C File Offset: 0x0010103C
		[DomainMethod]
		public void EnterMerchant()
		{
			ValueTuple<OpenShopEventArguments.EMerchantSourceType, sbyte> areaMerchantInfo = this.GetAreaMerchantInfo(this._taiwuChar.GetLocation().AreaId);
			DomainManager.Merchant.StartBuildingShopAction(areaMerchantInfo.Item1, areaMerchantInfo.Item2);
		}

		// Token: 0x06000FE7 RID: 4071 RVA: 0x00102E78 File Offset: 0x00101078
		[DomainMethod]
		public int GetSelectMapBlockHasMerchantId(DataContext context, Location location)
		{
			bool flag = !location.IsValid();
			int result;
			if (flag)
			{
				result = -1;
			}
			else
			{
				Location rootLocation = DomainManager.Map.GetBlock(location).GetRootBlock().GetLocation();
				BuildingAreaData area;
				bool flag2 = !DomainManager.Building.TryGetElement_BuildingAreas(rootLocation, out area);
				if (flag2)
				{
					result = -1;
				}
				else
				{
					for (short i = 274; i <= 280; i += 1)
					{
						bool flag3 = BuildingDomain.HasBuilt(rootLocation, area, i, true);
						if (flag3)
						{
							return (int)i;
						}
					}
					bool flag4 = BuildingDomain.HasBuilt(rootLocation, area, 318, true);
					if (flag4)
					{
						result = 318;
					}
					else
					{
						result = -1;
					}
				}
			}
			return result;
		}

		// Token: 0x06000FE8 RID: 4072 RVA: 0x00102F24 File Offset: 0x00101124
		[DomainMethod]
		[Obsolete("Use CalcResourceOutputCount() replace", false)]
		public int CalcBuildingResourceOutput(BuildingBlockKey blockKey)
		{
			BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
			BuildingBlockItem configData = BuildingBlock.Instance[blockData.TemplateId];
			bool flag = !configData.IsCollectResourceBuilding;
			int result;
			if (flag)
			{
				result = -1;
			}
			else
			{
				List<short> neighborList = ObjectPool<List<short>>.Instance.Get();
				Location location = DomainManager.Building.GetTaiwuBuildingAreas()[0];
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				areaData.GetNeighborBlocks(blockKey.BuildingBlockIndex, configData.Width, neighborList, null, 1);
				CharacterList managerList;
				DomainManager.Building.TryGetElement_ShopManagerDict(blockKey, out managerList);
				int resourceOutput = 0;
				sbyte resourceType = DomainManager.Building.GetCollectBuildingResourceType(blockKey);
				sbyte lifeSkillType = configData.RequireLifeSkillType;
				int i = 0;
				while (i < neighborList.Count)
				{
					BuildingBlockKey neighborKey = new BuildingBlockKey(location.AreaId, location.BlockId, neighborList[i]);
					BuildingBlockData neighborBlock = DomainManager.Building.GetElement_BuildingBlocks(neighborKey);
					BuildingBlockItem neighborConfigData = BuildingBlock.Instance[blockData.TemplateId];
					bool flag2 = BuildingBlockData.IsResource(neighborConfigData.Type) && configData.DependBuildings[0] == neighborBlock.TemplateId;
					if (flag2)
					{
						bool flag3 = !managerList.GetCollection().Exists((int charId) => charId >= 0 && this.CanWork(charId));
						if (!flag3)
						{
							for (int j = 0; j < managerList.GetCount(); j++)
							{
								int charId2 = managerList.GetCollection()[j];
								bool flag4 = charId2 >= 0 && this.CanWork(charId2);
								if (flag4)
								{
									GameData.Domains.Character.Character manageChar = DomainManager.Character.GetElement_Objects(charId2);
									resourceOutput += (int)DomainManager.Building.BaseWorkContribution;
									resourceOutput += (int)manageChar.GetLifeSkillAttainment(lifeSkillType);
								}
							}
						}
					}
					IL_1A5:
					i++;
					continue;
					goto IL_1A5;
				}
				ObjectPool<List<short>>.Instance.Return(neighborList);
				result = resourceOutput;
			}
			return result;
		}

		// Token: 0x06000FE9 RID: 4073 RVA: 0x00103104 File Offset: 0x00101304
		[DomainMethod]
		public List<ItemDisplayData> GetCanOperateItemDisplayDataInVillage(DataContext context, short itemSubType)
		{
			bool canTransfer = this.CanTransferItemToWarehouse(context);
			List<ItemDisplayData> warehouseItems = this.GetWarehouseItemsBySubType(context, itemSubType);
			bool flag = canTransfer;
			if (flag)
			{
				List<ItemDisplayData> inventoryItems = DomainManager.Character.GetInventoryItems(this._taiwuCharId, itemSubType);
				for (int i = 0; i < inventoryItems.Count; i++)
				{
					ItemDisplayData targetItemDisplayData = this.GetTargetItemDisplayData(warehouseItems, inventoryItems[i].Key);
					bool flag2 = targetItemDisplayData != null && ItemTemplateHelper.IsStackable(inventoryItems[i].Key.ItemType, inventoryItems[i].Key.TemplateId);
					if (flag2)
					{
						targetItemDisplayData.Amount += inventoryItems[i].Amount;
					}
					else
					{
						warehouseItems.Add(inventoryItems[i]);
					}
				}
			}
			return warehouseItems;
		}

		// Token: 0x06000FEA RID: 4074 RVA: 0x001031E8 File Offset: 0x001013E8
		[DomainMethod]
		public List<ItemDisplayData> GetCannotOperateItemDisplayDataInInventory(DataContext context, short itemSubType)
		{
			bool canTransfer = this.CanTransferItemToWarehouse(context);
			List<ItemDisplayData> itemDisplayDataList = new List<ItemDisplayData>();
			bool flag = !canTransfer;
			if (flag)
			{
				List<ItemDisplayData> inventoryItems = DomainManager.Character.GetInventoryItems(this._taiwuCharId, itemSubType);
				for (int i = 0; i < inventoryItems.Count; i++)
				{
					ItemDisplayData targetItemDisplayData = this.GetTargetItemDisplayData(itemDisplayDataList, inventoryItems[i].Key);
					bool flag2 = targetItemDisplayData != null && ItemTemplateHelper.IsStackable(inventoryItems[i].Key.ItemType, inventoryItems[i].Key.TemplateId);
					if (flag2)
					{
						targetItemDisplayData.Amount += inventoryItems[i].Amount;
					}
					else
					{
						itemDisplayDataList.Add(inventoryItems[i]);
					}
				}
			}
			return itemDisplayDataList;
		}

		// Token: 0x06000FEB RID: 4075 RVA: 0x001032CC File Offset: 0x001014CC
		private ItemDisplayData GetTargetItemDisplayData(List<ItemDisplayData> itemDisplayDataList, ItemKey itemKey)
		{
			ItemDisplayData targetItemDisplayData = null;
			for (int i = 0; i < itemDisplayDataList.Count; i++)
			{
				bool flag = itemKey.ItemType == itemDisplayDataList[i].Key.ItemType && itemKey.TemplateId == itemDisplayDataList[i].Key.TemplateId;
				if (flag)
				{
					targetItemDisplayData = itemDisplayDataList[i];
				}
			}
			return targetItemDisplayData;
		}

		// Token: 0x06000FEC RID: 4076 RVA: 0x00103340 File Offset: 0x00101540
		public int GetWarehouseItemCount(ItemKey itemKey)
		{
			int value;
			bool flag = this._warehouseItems.TryGetValue(itemKey, out value);
			int result;
			if (flag)
			{
				result = value;
			}
			else
			{
				result = 0;
			}
			return result;
		}

		// Token: 0x06000FED RID: 4077 RVA: 0x0010336C File Offset: 0x0010156C
		public void FindWarehouseItems(Predicate<ItemBase> predicate, [TupleElementNames(new string[]
		{
			"itemKey",
			"amount"
		})] List<ValueTuple<ItemKey, int>> items)
		{
			foreach (KeyValuePair<ItemKey, int> keyValuePair in this._warehouseItems)
			{
				ItemKey itemKey2;
				int num;
				keyValuePair.Deconstruct(out itemKey2, out num);
				ItemKey itemKey = itemKey2;
				int amount = num;
				ItemBase item = DomainManager.Item.GetBaseItem(itemKey);
				bool flag = predicate(item);
				if (flag)
				{
					items.Add(new ValueTuple<ItemKey, int>(itemKey, amount));
				}
			}
		}

		// Token: 0x06000FEE RID: 4078 RVA: 0x001033F8 File Offset: 0x001015F8
		public void FindWarehouseItems(List<Predicate<ItemBase>> predicates, [TupleElementNames(new string[]
		{
			"itemKey",
			"amount"
		})] List<ValueTuple<ItemKey, int>> items)
		{
			foreach (KeyValuePair<ItemKey, int> keyValuePair in this._warehouseItems)
			{
				ItemKey itemKey2;
				int num;
				keyValuePair.Deconstruct(out itemKey2, out num);
				ItemKey itemKey = itemKey2;
				int amount = num;
				ItemBase item = DomainManager.Item.GetBaseItem(itemKey);
				bool flag = ItemMatchers.MatchAll(item, predicates);
				if (flag)
				{
					items.Add(new ValueTuple<ItemKey, int>(itemKey, amount));
				}
			}
		}

		// Token: 0x06000FEF RID: 4079 RVA: 0x00103484 File Offset: 0x00101684
		public List<ItemKey> GetWarehouseAllItemKey()
		{
			return this._warehouseItems.Keys.ToList<ItemKey>();
		}

		// Token: 0x06000FF0 RID: 4080 RVA: 0x00103498 File Offset: 0x00101698
		public void InitializeOwnedItems()
		{
			foreach (ItemSourceType sourceType in TaiwuDomain.TaiwuVillageStorages)
			{
				ItemOwnerType ownerType = TaiwuDomain.ItemSourceToOwner(sourceType);
				IReadOnlyDictionary<ItemKey, int> items = this.GetItems(sourceType);
				foreach (KeyValuePair<ItemKey, int> keyValuePair in items)
				{
					ItemKey itemKey2;
					int num;
					keyValuePair.Deconstruct(out itemKey2, out num);
					ItemKey itemKey = itemKey2;
					DomainManager.Item.SetOwner(itemKey, ownerType, (int)this._taiwuVillageSettlementId);
				}
			}
		}

		// Token: 0x06000FF1 RID: 4081 RVA: 0x00103534 File Offset: 0x00101734
		public void LoseOverloadWarehouseItems(DataContext context)
		{
			TaiwuDomain.<>c__DisplayClass122_0 CS$<>8__locals1 = new TaiwuDomain.<>c__DisplayClass122_0();
			CS$<>8__locals1.context = context;
			CS$<>8__locals1.<>4__this = this;
			CS$<>8__locals1.neighborList = ObjectPool<List<MapBlockData>>.Instance.Get();
			CS$<>8__locals1.monthlyNotifications = DomainManager.World.GetMonthlyNotificationCollection();
			InstantNotificationCollection instantNotifications = DomainManager.World.GetInstantNotificationCollection();
			CS$<>8__locals1.currDate = DomainManager.World.GetCurrDate();
			CS$<>8__locals1.taiwuVillageStoragesRecordCollection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			CS$<>8__locals1.addSecretInformation = false;
			CS$<>8__locals1.secretInfoParamItemKey = ItemKey.Invalid;
			CS$<>8__locals1.taiwuVillageLocation = this.GetTaiwuVillageLocation();
			CS$<>8__locals1.reduceHappiness = 0;
			int troughCurrLoad = DomainManager.Extra.CalcTroughCurrLoad();
			int troughMaxLoad = this.GetTroughMaxLoad();
			bool flag = troughCurrLoad > troughMaxLoad;
			if (flag)
			{
				CS$<>8__locals1.<LoseOverloadWarehouseItems>g__LoseOverloadItems|1(ItemSourceType.Trough, DomainManager.Extra.TroughItems, troughCurrLoad - troughMaxLoad);
			}
			int overloadedWeight = this.GetWarehouseCurrLoad() - this.GetWarehouseMaxLoad();
			bool flag2 = overloadedWeight <= 0;
			if (flag2)
			{
				CS$<>8__locals1.<LoseOverloadWarehouseItems>g__Clean|0();
			}
			else
			{
				foreach (ItemSourceType sourceType in TaiwuDomain.TaiwuVillageStorages)
				{
					IReadOnlyDictionary<ItemKey, int> items = this.GetItems(sourceType);
					CS$<>8__locals1.<LoseOverloadWarehouseItems>g__LoseOverloadItems|1(sourceType, items, overloadedWeight);
					overloadedWeight = this.GetWarehouseCurrLoad() - this.GetWarehouseMaxLoad();
					bool flag3 = overloadedWeight <= 0;
					if (flag3)
					{
						break;
					}
				}
				DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(CS$<>8__locals1.context, CS$<>8__locals1.taiwuVillageStoragesRecordCollection);
				bool addSecretInformation = CS$<>8__locals1.addSecretInformation;
				if (addSecretInformation)
				{
					SecretInformationCollection secretInformationCollection = DomainManager.Information.GetSecretInformationCollection();
					int secretInfoOffset = secretInformationCollection.AddLoseOverloadingItem(this._taiwuCharId, (ulong)CS$<>8__locals1.secretInfoParamItemKey, CS$<>8__locals1.taiwuVillageLocation);
					DomainManager.Information.AddSecretInformationMetaDataWithNecessity(CS$<>8__locals1.context, secretInfoOffset, true, false, delegate(ICollection<int> charIds)
					{
						foreach (int charId in charIds)
						{
							GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
							Location location = character.GetLocation();
							GameData.Domains.Character.Ai.PersonalNeed personalNeed = GameData.Domains.Character.Ai.PersonalNeed.CreatePersonalNeed(24, location);
							character.AddPersonalNeed(CS$<>8__locals1.context, personalNeed);
						}
					});
				}
				bool flag4 = CS$<>8__locals1.reduceHappiness > 0;
				if (flag4)
				{
					this._taiwuChar.ChangeHappiness(CS$<>8__locals1.context, -CS$<>8__locals1.reduceHappiness);
				}
				instantNotifications.AddHappinessDecreased(this._taiwuCharId);
				CS$<>8__locals1.<LoseOverloadWarehouseItems>g__Clean|0();
			}
		}

		// Token: 0x06000FF2 RID: 4082 RVA: 0x00103730 File Offset: 0x00101930
		public static TaiwuVillageStorageType GetTaiwuVillageStorageType(ItemSourceType itemSourceType)
		{
			if (!true)
			{
			}
			TaiwuVillageStorageType result;
			switch (itemSourceType)
			{
			case ItemSourceType.Invalid:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.Equipment:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.Inventory:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.Warehouse:
				result = TaiwuVillageStorageType.Warehouse;
				goto IL_9F;
			case ItemSourceType.Treasury:
				result = TaiwuVillageStorageType.Treasury;
				goto IL_9F;
			case ItemSourceType.Trough:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.StockStorageGoodsShelf:
				result = TaiwuVillageStorageType.Stock;
				goto IL_9F;
			case ItemSourceType.EquipmentPlan:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.JiaoPool:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.SettlementTreasury:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.OldTreasury:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			case ItemSourceType.Resources:
				result = TaiwuVillageStorageType.Count;
				goto IL_9F;
			}
			result = TaiwuVillageStorageType.Count;
			IL_9F:
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x06000FF3 RID: 4083 RVA: 0x001037E4 File Offset: 0x001019E4
		public static ItemSourceType ItemOwnerToSource(ItemOwnerType ownerType)
		{
			if (!true)
			{
			}
			ItemSourceType result;
			switch (ownerType)
			{
			case ItemOwnerType.CharacterInventory:
				result = ItemSourceType.Inventory;
				goto IL_C1;
			case ItemOwnerType.CharacterEquipment:
				result = ItemSourceType.Equipment;
				goto IL_C1;
			case ItemOwnerType.Warehouse:
				result = ItemSourceType.Warehouse;
				goto IL_C1;
			case ItemOwnerType.Treasury:
				result = ItemSourceType.Treasury;
				goto IL_C1;
			case ItemOwnerType.StockStorageWarehouse:
				result = ItemSourceType.StockStorageWarehouse;
				goto IL_C1;
			case ItemOwnerType.StockStorageGoodsShelf:
				result = ItemSourceType.StockStorageGoodsShelf;
				goto IL_C1;
			case ItemOwnerType.CraftStorageWarehouse:
				result = ItemSourceType.CraftStorageWarehouse;
				goto IL_C1;
			case ItemOwnerType.CraftStorageMaterial:
				result = ItemSourceType.CraftStorageMaterial;
				goto IL_C1;
			case ItemOwnerType.CraftStorageToFix:
				result = ItemSourceType.CraftStorageToFix;
				goto IL_C1;
			case ItemOwnerType.CraftStorageToDisassemble:
				result = ItemSourceType.CraftStorageToDisassemble;
				goto IL_C1;
			case ItemOwnerType.MedicineStorageWarehouse:
				result = ItemSourceType.MedicineStorageWarehouse;
				goto IL_C1;
			case ItemOwnerType.MedicineStorageMaterial:
				result = ItemSourceType.MedicineStorageMaterial;
				goto IL_C1;
			case ItemOwnerType.MedicineStorageToDetox:
				result = ItemSourceType.MedicineStorageToDetox;
				goto IL_C1;
			case ItemOwnerType.MedicineStorageToAddPoison:
				result = ItemSourceType.MedicineStorageToAddPoison;
				goto IL_C1;
			case ItemOwnerType.FoodStorageWarehouse:
				result = ItemSourceType.FoodStorageWarehouse;
				goto IL_C1;
			case ItemOwnerType.FoodStorageMaterial:
				result = ItemSourceType.FoodStorageMaterial;
				goto IL_C1;
			case ItemOwnerType.Trough:
				result = ItemSourceType.Trough;
				goto IL_C1;
			}
			throw new ArgumentOutOfRangeException("ownerType", ownerType, null);
			IL_C1:
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x06000FF4 RID: 4084 RVA: 0x001038BC File Offset: 0x00101ABC
		public static ItemOwnerType ItemSourceToOwner(ItemSourceType sourceType)
		{
			if (!true)
			{
			}
			ItemOwnerType result;
			switch (sourceType)
			{
			case ItemSourceType.Equipment:
				result = ItemOwnerType.CharacterEquipment;
				goto IL_C6;
			case ItemSourceType.Inventory:
				result = ItemOwnerType.CharacterInventory;
				goto IL_C6;
			case ItemSourceType.Warehouse:
				result = ItemOwnerType.Warehouse;
				goto IL_C6;
			case ItemSourceType.Treasury:
				result = ItemOwnerType.Treasury;
				goto IL_C6;
			case ItemSourceType.Trough:
				result = ItemOwnerType.Trough;
				goto IL_C6;
			case ItemSourceType.StockStorageWarehouse:
				result = ItemOwnerType.StockStorageWarehouse;
				goto IL_C6;
			case ItemSourceType.StockStorageGoodsShelf:
				result = ItemOwnerType.StockStorageGoodsShelf;
				goto IL_C6;
			case ItemSourceType.CraftStorageWarehouse:
				result = ItemOwnerType.CraftStorageWarehouse;
				goto IL_C6;
			case ItemSourceType.CraftStorageMaterial:
				result = ItemOwnerType.CraftStorageMaterial;
				goto IL_C6;
			case ItemSourceType.CraftStorageToFix:
				result = ItemOwnerType.CraftStorageToFix;
				goto IL_C6;
			case ItemSourceType.CraftStorageToDisassemble:
				result = ItemOwnerType.CraftStorageToDisassemble;
				goto IL_C6;
			case ItemSourceType.MedicineStorageWarehouse:
				result = ItemOwnerType.MedicineStorageWarehouse;
				goto IL_C6;
			case ItemSourceType.MedicineStorageMaterial:
				result = ItemOwnerType.MedicineStorageMaterial;
				goto IL_C6;
			case ItemSourceType.MedicineStorageToDetox:
				result = ItemOwnerType.MedicineStorageToDetox;
				goto IL_C6;
			case ItemSourceType.MedicineStorageToAddPoison:
				result = ItemOwnerType.MedicineStorageToAddPoison;
				goto IL_C6;
			case ItemSourceType.FoodStorageWarehouse:
				result = ItemOwnerType.FoodStorageWarehouse;
				goto IL_C6;
			case ItemSourceType.FoodStorageMaterial:
				result = ItemOwnerType.FoodStorageMaterial;
				goto IL_C6;
			case ItemSourceType.SettlementTreasury:
				result = ItemOwnerType.Treasury;
				goto IL_C6;
			}
			throw new ArgumentOutOfRangeException("sourceType", sourceType, null);
			IL_C6:
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x06000FF5 RID: 4085 RVA: 0x00103998 File Offset: 0x00101B98
		public unsafe void LoseOverloadResources(DataContext context)
		{
			MonthlyNotificationCollection monthlyNotification = DomainManager.World.GetMonthlyNotificationCollection();
			int maxAmount = DomainManager.Taiwu.GetMaterialResourceMaxCount();
			TaiwuDomain.<>c__DisplayClass126_0 CS$<>8__locals1;
			CS$<>8__locals1.currDate = DomainManager.World.GetCurrDate();
			Location location = this._taiwuChar.GetLocation();
			LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
			CS$<>8__locals1.taiwuVillageStoragesRecordCollection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			ResourceInts totalResources = *this.GetTotalResources();
			ResourceInts taiwuResources = *this._taiwuChar.GetResources();
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			TaiwuVillageStorage stockStorage = DomainManager.Extra.GetStockStorage();
			TaiwuVillageStorage craftStorage = DomainManager.Extra.GetCraftStorage();
			TaiwuVillageStorage medicineStorage = DomainManager.Extra.GetMedicineStorage();
			TaiwuVillageStorage foodStorage = DomainManager.Extra.GetFoodStorage();
			bool treasuryUpdated = false;
			for (sbyte type = 0; type < 6; type += 1)
			{
				int currTotalAmount = *totalResources[(int)type];
				bool flag = currTotalAmount <= maxAmount;
				if (!flag)
				{
					int lostAmount = currTotalAmount - maxAmount;
					int toLoseAmount = lostAmount;
					bool flag2 = TaiwuDomain.<LoseOverloadResources>g__LoseResource|126_0(type, ref taiwuResources, ref toLoseAmount, TaiwuVillageStorageType.Count, ref CS$<>8__locals1);
					if (flag2)
					{
						this._taiwuChar.SetResources(ref taiwuResources, context);
					}
					bool flag3 = TaiwuDomain.<LoseOverloadResources>g__LoseResource|126_0(type, ref treasury.Resources, ref toLoseAmount, TaiwuVillageStorageType.Treasury, ref CS$<>8__locals1);
					if (flag3)
					{
						treasuryUpdated = true;
					}
					bool flag4 = TaiwuDomain.<LoseOverloadResources>g__LoseResource|126_0(type, ref stockStorage.Resources, ref toLoseAmount, TaiwuVillageStorageType.Stock, ref CS$<>8__locals1);
					if (flag4)
					{
						stockStorage.NeedCommit = true;
					}
					bool flag5 = TaiwuDomain.<LoseOverloadResources>g__LoseResource|126_0(type, ref craftStorage.Resources, ref toLoseAmount, TaiwuVillageStorageType.Craft, ref CS$<>8__locals1);
					if (flag5)
					{
						craftStorage.NeedCommit = true;
					}
					bool flag6 = TaiwuDomain.<LoseOverloadResources>g__LoseResource|126_0(type, ref medicineStorage.Resources, ref toLoseAmount, TaiwuVillageStorageType.Medicine, ref CS$<>8__locals1);
					if (flag6)
					{
						medicineStorage.NeedCommit = true;
					}
					bool flag7 = TaiwuDomain.<LoseOverloadResources>g__LoseResource|126_0(type, ref foodStorage.Resources, ref toLoseAmount, TaiwuVillageStorageType.Food, ref CS$<>8__locals1);
					if (flag7)
					{
						foodStorage.NeedCommit = true;
					}
					bool flag8 = treasuryUpdated || stockStorage.NeedCommit || craftStorage.NeedCommit || medicineStorage.NeedCommit || foodStorage.NeedCommit;
					if (flag8)
					{
						DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, CS$<>8__locals1.taiwuVillageStoragesRecordCollection);
					}
					bool flag9 = DomainManager.Taiwu._prevMonthResourceCollection[(int)type] != maxAmount;
					if (flag9)
					{
						monthlyNotification.AddLoseResourceCausedByInventoryFull(this._taiwuCharId, type);
						lifeRecordCollection.AddLoseOverloadingResource(this._taiwuCharId, CS$<>8__locals1.currDate, location, type, lostAmount);
					}
				}
			}
			bool flag10 = treasuryUpdated;
			if (flag10)
			{
				this.SetTaiwuTreasury(context, treasury);
			}
		}

		// Token: 0x06000FF6 RID: 4086 RVA: 0x00103BF6 File Offset: 0x00101DF6
		public void AddBuildingSpaceExtra(DataContext context, int add)
		{
			this._buildingSpaceExtraAdd += add;
			this.SetBuildingSpaceExtraAdd(this._buildingSpaceExtraAdd, context);
		}

		// Token: 0x06000FF7 RID: 4087 RVA: 0x00103C18 File Offset: 0x00101E18
		[DomainMethod]
		[Obsolete("使用TransferItem代替")]
		public bool TransferAllItems(DataContext context, bool isToWarehouse, List<ItemKey> keyList)
		{
			bool flag = !this.CanTransferItemToWarehouse(context);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(true);
				if (isToWarehouse)
				{
					foreach (ItemKey key in keyList)
					{
						bool flag2 = !this._taiwuChar.GetInventory().Items.ContainsKey(key);
						if (!flag2)
						{
							bool flag3 = this._curReadingBook.Equals(key) || this._referenceBooks.Contains(key);
							if (!flag3)
							{
								ItemBase baseItem = DomainManager.Item.GetBaseItem(key);
								bool flag4 = !baseItem.GetTransferable();
								if (!flag4)
								{
									this._taiwuChar.RemoveInventoryItem(context, key, 1, false, false);
									this.WarehouseAdd(context, key, 1);
								}
							}
						}
					}
				}
				else
				{
					foreach (ItemKey key2 in keyList)
					{
						bool flag5 = !this._warehouseItems.ContainsKey(key2);
						if (!flag5)
						{
							this.WarehouseRemove(context, key2, 1, false);
							this._taiwuChar.AddInventoryItem(context, key2, 1, false);
						}
					}
				}
				DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(false);
				result = true;
			}
			return result;
		}

		// Token: 0x06000FF8 RID: 4088 RVA: 0x00103DA4 File Offset: 0x00101FA4
		[DomainMethod]
		public void WarehouseDiscardItem(DataContext context, ItemKey itemKey, int count = 1)
		{
			this.WarehouseRemove(context, itemKey, count, false);
		}

		// Token: 0x06000FF9 RID: 4089 RVA: 0x00103DB4 File Offset: 0x00101FB4
		[DomainMethod]
		public void WarehouseDiscardItemList(DataContext context, List<ItemKey> keyList)
		{
			Tester.Assert(keyList != null, "");
			Tester.Assert(keyList.Count > 0, "");
			foreach (ItemKey key in keyList)
			{
				this.WarehouseDiscardItem(context, key, 1);
			}
		}

		// Token: 0x06000FFA RID: 4090 RVA: 0x00103E2C File Offset: 0x0010202C
		[DomainMethod]
		public bool TransferItem(DataContext context, sbyte from, sbyte to, ItemKey itemKey, int amount, bool offLine = false)
		{
			bool flag = !this.CanTransferItemToWarehouse(context);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				bool flag2 = itemKey.ItemType == 0;
				if (flag2)
				{
					DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(true);
				}
				bool flag3 = to == 4 && !GameData.Domains.Building.SharedMethods.CheckItemCanFeedChicken(itemKey);
				if (flag3)
				{
					result = false;
				}
				else
				{
					this.RemoveItem(context, itemKey, amount, from, false, offLine);
					this.AddItem(context, itemKey, amount, to, offLine);
					bool flag4 = itemKey.ItemType == 0;
					if (flag4)
					{
						DomainManager.Extra.SetKeepLegendaryWeaponSlotOnItemRemovedFlag(false);
					}
					result = true;
				}
			}
			return result;
		}

		// Token: 0x06000FFB RID: 4091 RVA: 0x00103EC0 File Offset: 0x001020C0
		[DomainMethod]
		public bool TransferItemList(DataContext context, sbyte from, sbyte to, List<ItemKey> keyList)
		{
			bool flag = !this.CanTransferItemToWarehouse(context);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				foreach (ItemKey key in keyList)
				{
					this.TransferItem(context, from, to, key, 1, true);
				}
				this.CommitOfflineOperation(context, (ItemSourceType)from);
				this.CommitOfflineOperation(context, (ItemSourceType)to);
				result = true;
			}
			return result;
		}

		// Token: 0x06000FFC RID: 4092 RVA: 0x00103F44 File Offset: 0x00102144
		[DomainMethod]
		public bool TransferResource(DataContext context, ItemSourceType srcType, ItemSourceType destType, sbyte resourceType, int amount)
		{
			this.RemoveResource(context, srcType, resourceType, amount);
			this.AddResource(context, destType, resourceType, amount);
			return true;
		}

		// Token: 0x06000FFD RID: 4093 RVA: 0x00103F74 File Offset: 0x00102174
		public unsafe void AddResource(DataContext context, ItemSourceType sourceType, sbyte resourceType, int amount)
		{
			bool flag = amount <= 0;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(63, 3);
				defaultInterpolatedStringHandler.AppendLiteral("AddResource amount <= 0, sourceType: ");
				defaultInterpolatedStringHandler.AppendFormatted<ItemSourceType>(sourceType);
				defaultInterpolatedStringHandler.AppendLiteral(", resourceType: ");
				defaultInterpolatedStringHandler.AppendFormatted<sbyte>(resourceType);
				defaultInterpolatedStringHandler.AppendLiteral(", amount: ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(amount);
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			else
			{
				bool flag2 = sourceType == ItemSourceType.Treasury;
				if (flag2)
				{
					SettlementTreasury settlementTreasury = this.GetTaiwuTreasury();
					settlementTreasury.Resources.Add(resourceType, amount);
					this.SetTaiwuTreasury(context, settlementTreasury);
				}
				else
				{
					bool flag3 = sourceType == ItemSourceType.Inventory || sourceType == ItemSourceType.Resources;
					bool flag4 = flag3;
					if (flag4)
					{
						ResourceInts resources = *this.GetTaiwu().GetResources();
						resources.Add(resourceType, amount);
						this.GetTaiwu().SetResources(ref resources, context);
					}
					else
					{
						if (!true)
						{
						}
						TaiwuVillageStorage taiwuVillageStorage;
						if (sourceType <= ItemSourceType.CraftStorageWarehouse)
						{
							if (sourceType == ItemSourceType.StockStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetStockStorage();
								goto IL_15D;
							}
							if (sourceType == ItemSourceType.CraftStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetCraftStorage();
								goto IL_15D;
							}
						}
						else
						{
							if (sourceType == ItemSourceType.MedicineStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetMedicineStorage();
								goto IL_15D;
							}
							if (sourceType == ItemSourceType.FoodStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetFoodStorage();
								goto IL_15D;
							}
						}
						throw new ArgumentOutOfRangeException("sourceType", sourceType, null);
						IL_15D:
						if (!true)
						{
						}
						TaiwuVillageStorage storage = taiwuVillageStorage;
						storage.Resources.Add(resourceType, amount);
						storage.NeedCommit = true;
					}
				}
			}
		}

		// Token: 0x06000FFE RID: 4094 RVA: 0x00104100 File Offset: 0x00102300
		public void AddResource(DataContext context, ItemSourceType sourceType, ref ResourceInts resources)
		{
			for (sbyte resourceType = 0; resourceType < 6; resourceType += 1)
			{
				this.AddResource(context, sourceType, resourceType, resources.Get((int)resourceType));
			}
		}

		// Token: 0x06000FFF RID: 4095 RVA: 0x00104130 File Offset: 0x00102330
		public unsafe void RemoveResource(DataContext context, ItemSourceType sourceType, sbyte resourceType, int amount)
		{
			bool flag = amount <= 0;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(66, 3);
				defaultInterpolatedStringHandler.AppendLiteral("RemoveResource amount <= 0, sourceType: ");
				defaultInterpolatedStringHandler.AppendFormatted<ItemSourceType>(sourceType);
				defaultInterpolatedStringHandler.AppendLiteral(", resourceType: ");
				defaultInterpolatedStringHandler.AppendFormatted<sbyte>(resourceType);
				defaultInterpolatedStringHandler.AppendLiteral(", amount: ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(amount);
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			else
			{
				bool flag2 = sourceType == ItemSourceType.Treasury;
				if (flag2)
				{
					SettlementTreasury settlementTreasury = this.GetTaiwuTreasury();
					settlementTreasury.Resources.Subtract(resourceType, amount);
					this.SetTaiwuTreasury(context, settlementTreasury);
				}
				else
				{
					bool flag3 = sourceType == ItemSourceType.Inventory || sourceType == ItemSourceType.Resources;
					bool flag4 = flag3;
					if (flag4)
					{
						ResourceInts resources = *this.GetTaiwu().GetResources();
						resources.Subtract(resourceType, amount);
						this.GetTaiwu().SetResources(ref resources, context);
					}
					else
					{
						if (!true)
						{
						}
						TaiwuVillageStorage taiwuVillageStorage;
						if (sourceType <= ItemSourceType.CraftStorageWarehouse)
						{
							if (sourceType == ItemSourceType.StockStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetStockStorage();
								goto IL_15D;
							}
							if (sourceType == ItemSourceType.CraftStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetCraftStorage();
								goto IL_15D;
							}
						}
						else
						{
							if (sourceType == ItemSourceType.MedicineStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetMedicineStorage();
								goto IL_15D;
							}
							if (sourceType == ItemSourceType.FoodStorageWarehouse)
							{
								taiwuVillageStorage = DomainManager.Extra.GetFoodStorage();
								goto IL_15D;
							}
						}
						throw new ArgumentOutOfRangeException("sourceType", sourceType, null);
						IL_15D:
						if (!true)
						{
						}
						TaiwuVillageStorage storage = taiwuVillageStorage;
						storage.Resources.Subtract(resourceType, amount);
						storage.NeedCommit = true;
					}
				}
			}
		}

		// Token: 0x06001000 RID: 4096 RVA: 0x001042BC File Offset: 0x001024BC
		public void RemoveResource(DataContext context, ItemSourceType sourceType, ref ResourceInts resources)
		{
			for (sbyte resourceType = 0; resourceType < 6; resourceType += 1)
			{
				this.RemoveResource(context, sourceType, resourceType, resources.Get((int)resourceType));
			}
		}

		// Token: 0x06001001 RID: 4097 RVA: 0x001042EC File Offset: 0x001024EC
		[DomainMethod]
		public bool FindTaiwuBuilding(short buildingTemplateId, bool checkUsable = true)
		{
			Location location = DomainManager.Taiwu.GetTaiwuVillageLocation();
			BuildingAreaData buildingArea = DomainManager.Building.GetBuildingAreaData(location);
			BuildingBlockData building = BuildingDomain.FindBuilding(location, buildingArea, buildingTemplateId, checkUsable);
			return building != null;
		}

		// Token: 0x06001002 RID: 4098 RVA: 0x00104324 File Offset: 0x00102524
		public BuildingBlockData GetTaiwuBuildingBlockData(short buildingTemplateId)
		{
			Location location = DomainManager.Taiwu.GetTaiwuVillageLocation();
			BuildingAreaData buildingArea = DomainManager.Building.GetBuildingAreaData(location);
			return BuildingDomain.FindBuilding(location, buildingArea, buildingTemplateId, true);
		}

		// Token: 0x06001003 RID: 4099 RVA: 0x00104358 File Offset: 0x00102558
		[return: TupleElementNames(new string[]
		{
			"attainmentEffect",
			"upgradeMakeItem",
			"hasBuilding"
		})]
		public ValueTuple<int, bool, bool> GetTaiwuCraftBuildingEffect(sbyte lifeSkillType)
		{
			Location taiwuVillageLocation = DomainManager.Taiwu.GetTaiwuVillageLocation();
			short buildingBlockTemplateId = -1;
			BuildingBlock.Instance.Iterate(delegate(BuildingBlockItem b)
			{
				bool flag2 = b.CanMakeItem && b.RequireLifeSkillType == lifeSkillType;
				bool result3;
				if (flag2)
				{
					buildingBlockTemplateId = b.TemplateId;
					result3 = false;
				}
				else
				{
					result3 = true;
				}
				return result3;
			});
			BuildingBlockData buildingBlockData = DomainManager.Taiwu.GetTaiwuBuildingBlockData(buildingBlockTemplateId);
			bool flag = buildingBlockData != null;
			ValueTuple<int, bool, bool> result2;
			if (flag)
			{
				BuildingBlockKey buildingBlockKey = new BuildingBlockKey(taiwuVillageLocation.AreaId, taiwuVillageLocation.BlockId, buildingBlockData.BlockIndex);
				ValueTuple<int, bool> result = DomainManager.Building.GetBuildingEffectForMake(buildingBlockKey, lifeSkillType);
				result2 = new ValueTuple<int, bool, bool>(result.Item1, result.Item2, true);
			}
			else
			{
				result2 = new ValueTuple<int, bool, bool>(0, false, false);
			}
			return result2;
		}

		// Token: 0x06001004 RID: 4100 RVA: 0x0010440C File Offset: 0x0010260C
		public void ReturnBuildingCoreItem(DataContext context, BuildingBlockItem configData)
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			bool canTransfer = DomainManager.Taiwu.CanTransferItemToWarehouse(context);
			bool flag = canTransfer;
			if (flag)
			{
				taiwuChar.CreateInventoryItem(context, 12, configData.BuildingCoreItem, 1);
			}
			else
			{
				ItemKey itemKey = DomainManager.Item.CreateItem(context, 12, configData.BuildingCoreItem);
				DomainManager.Taiwu.WarehouseAdd(context, itemKey, 1);
			}
		}

		// Token: 0x06001005 RID: 4101 RVA: 0x00104470 File Offset: 0x00102670
		[DomainMethod]
		public int GetItemCount(sbyte itemType, short itemTemplateId)
		{
			int count = 0;
			ItemKey[] equipment = this._taiwuChar.GetEquipment();
			foreach (ItemKey itemKey in equipment)
			{
				bool flag = itemKey.ItemType == itemType && itemKey.TemplateId == itemTemplateId;
				if (flag)
				{
					count++;
				}
			}
			count += this._taiwuChar.GetInventory().GetInventoryItemCount(itemType, itemTemplateId);
			foreach (ItemSourceType sourceType in TaiwuDomain.TaiwuVillageStorages)
			{
				IReadOnlyDictionary<ItemKey, int> items = this.GetItems(sourceType);
				foreach (KeyValuePair<ItemKey, int> pair in items)
				{
					bool flag2 = pair.Key.ItemType == itemType && pair.Key.TemplateId == itemTemplateId;
					if (flag2)
					{
						count += pair.Value;
					}
				}
			}
			return count;
		}

		// Token: 0x06001006 RID: 4102 RVA: 0x00104588 File Offset: 0x00102788
		[DomainMethod]
		[Obsolete]
		public Dictionary<sbyte, VillagerRoleActionSetting> GetAllVillagerRoleActionSetting(DataContext context)
		{
			return DomainManager.Extra.GetVillagerRoleActionSettingDict(context);
		}

		// Token: 0x06001007 RID: 4103 RVA: 0x00104598 File Offset: 0x00102798
		[DomainMethod]
		[Obsolete]
		public VillagerRoleActionSetting GetVillagerRoleActionSetting(DataContext context, TaiwuVillageStorageType storageType)
		{
			Dictionary<sbyte, VillagerRoleActionSetting> dict = this.GetAllVillagerRoleActionSetting(context);
			return dict.GetValueOrDefault((sbyte)storageType);
		}

		// Token: 0x06001008 RID: 4104 RVA: 0x001045B9 File Offset: 0x001027B9
		[DomainMethod]
		[Obsolete]
		public void SetVillagerRoleActionSetting(DataContext context, TaiwuVillageStorageType storageType, VillagerRoleActionSetting setting)
		{
			DomainManager.Extra.SetVillagerRoleActionSetting(context, storageType, setting);
		}

		// Token: 0x06001009 RID: 4105 RVA: 0x001045CC File Offset: 0x001027CC
		[DomainMethod]
		public static int GetStrategyRoomLevel()
		{
			int level = 0;
			List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
			for (int i = 0; i < taiwuBuildingList.Count; i++)
			{
				Location location = taiwuBuildingList[i];
				BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
				for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
				{
					BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
					BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
					BuildingBlockDataEx blockDataEx;
					bool flag = blockData.TemplateId == 98 && blockData.CanUse() && DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
					if (flag)
					{
						return (int)blockDataEx.CalcUnlockedLevelCount();
					}
				}
			}
			return level;
		}

		// Token: 0x0600100A RID: 4106 RVA: 0x001046AC File Offset: 0x001028AC
		[DomainMethod]
		[return: TupleElementNames(new string[]
		{
			"villageProvide",
			"spaceExtraAdd",
			"prosperousConstruction",
			"ResourceBlockEffect"
		})]
		public ValueTuple<int, int, int, int> GetTaiwuVillageSpaceLimitInfo()
		{
			int villageProvide = this.GetTaiwuVillageBaseSpace();
			Location taiwuLocation = this.GetTaiwuVillageLocation();
			int resourceBlockEffect = DomainManager.Building.GetBuildingBlockEffect(taiwuLocation, EBuildingScaleEffect.BuildingSpaceBonus, -1);
			return new ValueTuple<int, int, int, int>(villageProvide, this._buildingSpaceExtraAdd, this._prosperousConstruction ? 20 : 0, resourceBlockEffect);
		}

		// Token: 0x0600100B RID: 4107 RVA: 0x001046F8 File Offset: 0x001028F8
		[DomainMethod]
		public unsafe void SelectCombatSkillAttainmentPanelPlan(DataContext context, sbyte combatSkillType, sbyte planId)
		{
			this.SaveCombatSkillAttainmentPanelPlan(context, combatSkillType, this._currCombatSkillAttainmentPanelPlanIds[(int)combatSkillType]);
			this._currCombatSkillAttainmentPanelPlanIds[(int)combatSkillType] = planId;
			this.SetCurrCombatSkillAttainmentPanelPlanIds(this._currCombatSkillAttainmentPanelPlanIds, context);
			short[] panels = this._taiwuChar.GetCombatSkillAttainmentPanels();
			int panelSize = 126;
			short[] array;
			short* pPlans;
			if ((array = this._combatSkillAttainmentPanelPlans) == null || array.Length == 0)
			{
				pPlans = null;
			}
			else
			{
				pPlans = &array[0];
			}
			short* pCurrPlan = pPlans + panelSize * (int)planId + combatSkillType * 9;
			CombatSkillAttainmentPanelsHelper.SetPanel(panels, combatSkillType, pCurrPlan);
			array = null;
			for (sbyte grade = 0; grade < 9; grade += 1)
			{
				short combatSkillTemplateId = CombatSkillAttainmentPanelsHelper.Get(panels, combatSkillType, grade);
				CombatSkillKey combatSkillKey = new CombatSkillKey(this._taiwuCharId, combatSkillTemplateId);
				GameData.Domains.CombatSkill.CombatSkill combatSkill;
				bool flag = DomainManager.CombatSkill.TryGetElement_CombatSkills(combatSkillKey, out combatSkill) && !combatSkill.GetRevoked() && CombatSkillStateHelper.IsBrokenOut(combatSkill.GetActivationState());
				if (!flag)
				{
					CombatSkillAttainmentPanelsHelper.Set(panels, combatSkillType, grade, -1);
				}
			}
			this.QuickFillCombatSkillAttainmentPanel(context, combatSkillType);
		}

		// Token: 0x0600100C RID: 4108 RVA: 0x001047F4 File Offset: 0x001029F4
		private unsafe void SaveCombatSkillAttainmentPanelPlan(DataContext context, sbyte combatSkillType, sbyte planId)
		{
			short[] panels = this._taiwuChar.GetCombatSkillAttainmentPanels();
			int panelSize = 126;
			short[] array;
			short* pPlans;
			if ((array = this._combatSkillAttainmentPanelPlans) == null || array.Length == 0)
			{
				pPlans = null;
			}
			else
			{
				pPlans = &array[0];
			}
			short* pCurrPlan = pPlans + panelSize * (int)planId + combatSkillType * 9;
			CombatSkillAttainmentPanelsHelper.GetPanel(panels, combatSkillType, pCurrPlan);
			array = null;
			this.SetCombatSkillAttainmentPanelPlans(this._combatSkillAttainmentPanelPlans, context);
		}

		// Token: 0x0600100D RID: 4109 RVA: 0x0010485C File Offset: 0x00102A5C
		private bool QuickFillCombatSkillAttainmentPanel(DataContext context, sbyte combatSkillType)
		{
			Dictionary<short, GameData.Domains.CombatSkill.CombatSkill> learnedCombatSkills = DomainManager.CombatSkill.GetCharCombatSkills(this._taiwuCharId);
			List<KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill>> viableSkills = (from pair in learnedCombatSkills
			where Config.CombatSkill.Instance[pair.Key].Type == combatSkillType && !pair.Value.GetRevoked() && CombatSkillStateHelper.IsBrokenOut(pair.Value.GetActivationState())
			select pair).ToList<KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill>>();
			short[] taiwuPanel = this._taiwuChar.GetCombatSkillAttainmentPanels();
			bool changed = false;
			for (sbyte grade = 0; grade < 9; grade += 1)
			{
				bool flag = CombatSkillAttainmentPanelsHelper.Get(taiwuPanel, combatSkillType, grade) != -1;
				if (!flag)
				{
					foreach (KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill> viableSkill in viableSkills)
					{
						short templateId = viableSkill.Key;
						bool flag2 = Config.CombatSkill.Instance[templateId].Grade != grade;
						if (!flag2)
						{
							CombatSkillAttainmentPanelsHelper.Set(taiwuPanel, combatSkillType, grade, templateId);
							changed = true;
							break;
						}
					}
				}
			}
			this._taiwuChar.SetCombatSkillAttainmentPanels(taiwuPanel, context);
			return changed;
		}

		// Token: 0x0600100E RID: 4110 RVA: 0x00104980 File Offset: 0x00102B80
		[DomainMethod]
		public byte[] GetGenericGridAllocation()
		{
			CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			return plan.GenericGridAllocation;
		}

		// Token: 0x0600100F RID: 4111 RVA: 0x001049A8 File Offset: 0x00102BA8
		public void SetGenericGridAllocation(DataContext context, byte[] genericGridAllocation)
		{
			CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			byte[] allocation = plan.GenericGridAllocation;
			for (int i = 0; i < allocation.Length; i++)
			{
				allocation[i] = genericGridAllocation[i];
			}
			this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, plan, context);
		}

		// Token: 0x06001010 RID: 4112 RVA: 0x001049F4 File Offset: 0x00102BF4
		[DomainMethod]
		public unsafe bool MasteredSkillWillChangePlan(short skillTemplateId)
		{
			CombatSkillEquipment combatSkillEquipment = this._taiwuChar.GetCombatSkillEquipment();
			CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			bool flag = !combatSkillEquipment.IsCombatSkillEquipped(skillTemplateId);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				Span<sbyte> span = new Span<sbyte>(stackalloc byte[(UIntPtr)5], 5);
				Span<sbyte> gridCounts = span;
				sbyte totalGenericGrid = this._taiwuChar.GetCombatSkillSlotCounts(gridCounts);
				span = new Span<sbyte>(stackalloc byte[(UIntPtr)4], 4);
				Span<sbyte> costCounts = span;
				for (sbyte equipType = 1; equipType < 5; equipType += 1)
				{
					*costCounts[(int)(equipType - 1)] = CharacterDomain.GetCombatSkillsCostedGrid(this._taiwuCharId, combatSkillEquipment, equipType);
				}
				span = new Span<sbyte>(stackalloc byte[(UIntPtr)4], 4);
				Span<sbyte> specificGrids = span;
				GameData.Domains.CombatSkill.CombatSkill skill = DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillTemplateId));
				skill.GetSpecificGridCount(specificGrids, false);
				for (sbyte equipType2 = 1; equipType2 < 5; equipType2 += 1)
				{
					sbyte totalGrid = *gridCounts[(int)equipType2];
					sbyte costedGrid = *costCounts[(int)(equipType2 - 1)];
					sbyte specificGrid = *specificGrids[(int)(equipType2 - 1)];
					bool flag2 = totalGrid - specificGrid < costedGrid;
					if (flag2)
					{
						return true;
					}
				}
				byte[] genericGridAllocation = plan.GenericGridAllocation;
				int costedGenericGrid = genericGridAllocation.Sum();
				sbyte specificGenericGrid = skill.GetGenericGridCount(false);
				result = ((int)(totalGenericGrid - specificGenericGrid) < costedGenericGrid);
			}
			return result;
		}

		// Token: 0x06001011 RID: 4113 RVA: 0x00104B44 File Offset: 0x00102D44
		[Obsolete]
		public unsafe void ClearExceedCombatSkills(DataContext context)
		{
			bool flag = !DomainManager.Character.IsCharacterAlive(this._taiwuCharId);
			if (!flag)
			{
				CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
				sbyte* pGridCounts = stackalloc sbyte[(UIntPtr)5];
				Span<sbyte> gridCounts = new Span<sbyte>((void*)pGridCounts, 5);
				int totalGenericGrid = (int)this._taiwuChar.GetCombatSkillSlotCounts(gridCounts);
				bool flag2 = this._taiwuChar.ClearExceededCombatSkills(context, 0, (int)(*gridCounts[0]));
				if (flag2)
				{
					totalGenericGrid = (int)this._taiwuChar.GetCombatSkillSlotCounts(gridCounts);
				}
				for (int i = 0; i < plan.GenericGridAllocation.Length; i++)
				{
					byte allocatedGenericGridCount = plan.GenericGridAllocation[i];
					bool flag3 = totalGenericGrid >= (int)allocatedGenericGridCount;
					if (flag3)
					{
						totalGenericGrid -= (int)allocatedGenericGridCount;
					}
					else
					{
						allocatedGenericGridCount = (byte)totalGenericGrid;
						plan.GenericGridAllocation[i] = allocatedGenericGridCount;
						totalGenericGrid = 0;
					}
				}
				for (sbyte equipType = 1; equipType < 5; equipType += 1)
				{
					this._taiwuChar.ClearExceededCombatSkills(context, equipType);
				}
				this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, plan, context);
			}
		}

		// Token: 0x06001012 RID: 4114 RVA: 0x00104C4C File Offset: 0x00102E4C
		[DomainMethod]
		public unsafe void AllocateGenericGrid(DataContext context, sbyte equipType)
		{
			bool flag = equipType < 1;
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(26, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Invalid generic grid type:");
				defaultInterpolatedStringHandler.AppendFormatted<sbyte>(equipType);
				throw new ArgumentException(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			Span<sbyte> span = new Span<sbyte>(stackalloc byte[(UIntPtr)5], 5);
			Span<sbyte> gridCounts = span;
			sbyte genericSlotCount = this._taiwuChar.GetCombatSkillSlotCounts(gridCounts);
			CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			int index = (int)(equipType - 1);
			int cost = GameData.Domains.Character.CombatSkillHelper.GetGenericAllocationNextCost(equipType, (int)plan.GenericGridAllocation[index]);
			int remaining = this._taiwuChar.ApplyGenericCombatSkillSlotAllocations(gridCounts, (int)genericSlotCount);
			bool flag2 = cost > remaining;
			if (flag2)
			{
				throw new InvalidOperationException("No more available generic grid");
			}
			byte[] genericGridAllocation = plan.GenericGridAllocation;
			int num = index;
			genericGridAllocation[num] += 1;
			this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, plan, context);
		}

		// Token: 0x06001013 RID: 4115 RVA: 0x00104D18 File Offset: 0x00102F18
		[DomainMethod]
		public void DeallocateGenericGrid(DataContext context, sbyte equipType)
		{
			bool flag = equipType < 1;
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(26, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Invalid generic grid type:");
				defaultInterpolatedStringHandler.AppendFormatted<sbyte>(equipType);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			byte allocatedCount = plan.GenericGridAllocation[(int)(equipType - 1)];
			bool flag2 = allocatedCount == 0;
			if (flag2)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("No generic grid allocated in type:");
				defaultInterpolatedStringHandler.AppendFormatted<sbyte>(equipType);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			byte[] genericGridAllocation = plan.GenericGridAllocation;
			sbyte b = equipType - 1;
			genericGridAllocation[(int)b] = genericGridAllocation[(int)b] - 1;
			this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, plan, context);
		}

		// Token: 0x06001014 RID: 4116 RVA: 0x00104DD0 File Offset: 0x00102FD0
		[DomainMethod]
		public void UpdateCombatSkillPlan(DataContext context, int index)
		{
			CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			bool flag = this._currCombatSkillPlanId != index;
			if (flag)
			{
				plan.Record(this._taiwuChar);
				this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, plan, context);
				this.SetCurrCombatSkillPlanId(index, context);
				plan = this._combatSkillPlans[this._currCombatSkillPlanId];
			}
			DomainManager.Extra.UpdateTaiwuMasteredCombatSkillsByPlan(context);
			DomainManager.Character.ApplyCombatSkillPlan(context, this._taiwuChar, plan);
			this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, plan, context);
		}

		// Token: 0x06001015 RID: 4117 RVA: 0x00104E60 File Offset: 0x00103060
		[DomainMethod]
		public void CopyCombatSkillPlan(DataContext context)
		{
			byte planCount = DomainManager.Extra.GetUnlockedCombatSkillPlanCount();
			bool flag = planCount == 9;
			if (!flag)
			{
				DomainManager.Extra.SetUnlockedCombatSkillPlanCount(planCount + 1, context);
				CombatSkillPlan curr = this._combatSkillPlans[this._currCombatSkillPlanId];
				curr.Record(this._taiwuChar);
				this.SetElement_CombatSkillPlans(this._currCombatSkillPlanId, curr, context);
				CombatSkillPlan plan = this._combatSkillPlans[(int)planCount];
				plan.Assign(curr);
				this.SetElement_CombatSkillPlans((int)planCount, plan, context);
				DomainManager.Extra.CopyTaiwuCombatSkillsPlan(context, this._currCombatSkillPlanId, (int)planCount);
				this.UpdateCombatSkillPlan(context, (int)planCount);
			}
		}

		// Token: 0x06001016 RID: 4118 RVA: 0x00104EF8 File Offset: 0x001030F8
		[DomainMethod]
		public void AppendCombatSkillPlan(DataContext context)
		{
			byte planCount = DomainManager.Extra.GetUnlockedCombatSkillPlanCount();
			bool flag = planCount == 9;
			if (!flag)
			{
				DomainManager.Extra.SetUnlockedCombatSkillPlanCount(planCount + 1, context);
				CombatSkillPlan plan = this._combatSkillPlans[(int)planCount];
				plan.Reset();
				this.SetElement_CombatSkillPlans((int)planCount, plan, context);
				this.UpdateCombatSkillPlan(context, (int)planCount);
			}
		}

		// Token: 0x06001017 RID: 4119 RVA: 0x00104F4F File Offset: 0x0010314F
		[DomainMethod]
		public void ClearCombatSkillPlan(DataContext context)
		{
			DomainManager.Character.UnequipAllCombatSkills(context, this._taiwuCharId);
		}

		// Token: 0x06001018 RID: 4120 RVA: 0x00104F64 File Offset: 0x00103164
		[DomainMethod]
		public void DeleteCombatSkillPlan(DataContext context)
		{
			byte planCount = DomainManager.Extra.GetUnlockedCombatSkillPlanCount();
			bool flag = planCount == 1;
			if (!flag)
			{
				DomainManager.Extra.SetUnlockedCombatSkillPlanCount(planCount - 1, context);
				CombatSkillPlan plan = this._combatSkillPlans[this._currCombatSkillPlanId];
				plan.Reset();
				for (int i = this._currCombatSkillPlanId; i < (int)(planCount - 1); i++)
				{
					this.SetElement_CombatSkillPlans(i, this._combatSkillPlans[i + 1], context);
				}
				this.SetElement_CombatSkillPlans((int)(planCount - 1), plan, context);
				DomainManager.Extra.DeleteTaiwuCombatSkillsPlan(context, this._currCombatSkillPlanId);
				bool flag2 = this._currCombatSkillPlanId != (int)(planCount - 1);
				if (flag2)
				{
					this.UpdateCombatSkillPlan(context, this._currCombatSkillPlanId);
				}
				else
				{
					this.ClearCombatSkillPlan(context);
					this.UpdateCombatSkillPlan(context, this._currCombatSkillPlanId - 1);
				}
			}
		}

		// Token: 0x06001019 RID: 4121 RVA: 0x00105038 File Offset: 0x00103238
		public void RegisterCombatSkill(DataContext context, GameData.Domains.CombatSkill.CombatSkill skill)
		{
			short skillTemplateId = skill.GetId().SkillTemplateId;
			ushort readingState = skill.GetReadingState();
			TaiwuCombatSkill notLearnedCombatSkill;
			bool flag = this._notLearnCombatSkillReadingProgress.TryGetValue(skillTemplateId, out notLearnedCombatSkill);
			if (flag)
			{
				for (byte i = 0; i < 15; i += 1)
				{
					bool flag2 = CombatSkillStateHelper.IsPageRead(readingState, i);
					if (flag2)
					{
						notLearnedCombatSkill.SetBookPageReadingProgress(i, 100);
					}
				}
				this.RemoveElement_NotLearnCombatSkillReadingProgress(skillTemplateId, context);
				this.AddElement_CombatSkills(skillTemplateId, notLearnedCombatSkill, context);
			}
			else
			{
				bool flag3 = !this._combatSkills.ContainsKey(skillTemplateId);
				if (flag3)
				{
					TaiwuCombatSkill taiwuCombatSkill = new TaiwuCombatSkill(readingState);
					this.AddElement_CombatSkills(skillTemplateId, taiwuCombatSkill, context);
				}
				else
				{
					AdaptableLog.Warning("Combat skill " + Config.CombatSkill.Instance[skillTemplateId].Name + " is already learned.", true);
				}
			}
		}

		// Token: 0x0600101A RID: 4122 RVA: 0x00105105 File Offset: 0x00103305
		public void UnregisterCombatSkill(DataContext context, short skillTemplateId)
		{
			this.RemoveElement_CombatSkills(skillTemplateId, context);
		}

		// Token: 0x0600101B RID: 4123 RVA: 0x00105114 File Offset: 0x00103314
		public void RegisterLifeSkill(DataContext context, GameData.Domains.Character.LifeSkillItem skill)
		{
			short skillTemplateId = skill.SkillTemplateId;
			byte readingState = skill.ReadingState;
			TaiwuLifeSkill notLearnedTaiwuLifeSkill;
			bool flag = this._notLearnLifeSkillReadingProgress.TryGetValue(skillTemplateId, out notLearnedTaiwuLifeSkill);
			if (flag)
			{
				for (byte i = 0; i < 5; i += 1)
				{
					bool flag2 = CombatSkillStateHelper.IsPageRead((ushort)readingState, i);
					if (flag2)
					{
						notLearnedTaiwuLifeSkill.SetBookPageReadingProgress(i, 100);
					}
				}
				this.RemoveElement_NotLearnLifeSkillReadingProgress(skillTemplateId, context);
				this.AddElement_LifeSkills(skillTemplateId, notLearnedTaiwuLifeSkill, context);
			}
			else
			{
				bool flag3 = !this._lifeSkills.ContainsKey(skillTemplateId);
				if (flag3)
				{
					TaiwuLifeSkill taiwuLifeSkill = new TaiwuLifeSkill((ushort)readingState);
					this.AddElement_LifeSkills(skillTemplateId, taiwuLifeSkill, context);
				}
				else
				{
					AdaptableLog.Warning("Life skill " + LifeSkill.Instance[skillTemplateId].Name + " is already learned.", true);
				}
			}
		}

		// Token: 0x0600101C RID: 4124 RVA: 0x001051DB File Offset: 0x001033DB
		public void UnregisterLifeSkill(DataContext context, short skillTemplateId)
		{
			this.RemoveElement_LifeSkills(skillTemplateId, context);
		}

		// Token: 0x0600101D RID: 4125 RVA: 0x001051E8 File Offset: 0x001033E8
		public void RegisterProtagonistLifeSkillsAndCombatSkills(DataContext context, List<GameData.Domains.Character.LifeSkillItem> lifeSkills, List<GameData.Domains.CombatSkill.CombatSkill> combatSkills, short readLifeSkillTemplateId, short readCombatSkillTemplateId, byte combatSkillBookPageTypes)
		{
			int i = 0;
			int count = lifeSkills.Count;
			while (i < count)
			{
				this.RegisterLifeSkill(context, lifeSkills[i]);
				i++;
			}
			int j = 0;
			int count2 = combatSkills.Count;
			while (j < count2)
			{
				this.RegisterCombatSkill(context, combatSkills[j]);
				j++;
			}
			bool flag = readLifeSkillTemplateId >= 0;
			if (flag)
			{
				TaiwuLifeSkill skill = this.GetElement_LifeSkills(readLifeSkillTemplateId);
				for (byte k = 0; k < 5; k += 1)
				{
					skill.SetBookPageReadingProgress(k, 50);
				}
				this.SetElement_LifeSkills(readLifeSkillTemplateId, skill, context);
			}
			bool flag2 = readCombatSkillTemplateId >= 0;
			if (flag2)
			{
				TaiwuCombatSkill skill2 = this.GetElement_CombatSkills(readCombatSkillTemplateId);
				sbyte outlinePageType = SkillBookStateHelper.GetOutlinePageType(combatSkillBookPageTypes);
				byte pageIndex = CombatSkillStateHelper.GetOutlinePageInternalIndex(outlinePageType);
				skill2.SetBookPageReadingProgress(pageIndex, 50);
				for (byte pageId = 1; pageId < 6; pageId += 1)
				{
					sbyte normalPageType = SkillBookStateHelper.GetNormalPageType(combatSkillBookPageTypes, pageId);
					pageIndex = CombatSkillStateHelper.GetNormalPageInternalIndex(normalPageType, pageId);
					skill2.SetBookPageReadingProgress(pageIndex, 50);
				}
				this.SetElement_CombatSkills(readCombatSkillTemplateId, skill2, context);
			}
		}

		// Token: 0x0600101E RID: 4126 RVA: 0x00105310 File Offset: 0x00103510
		public ItemKey GetCombatSkillBookAndRead(DataContext context, short combatSkillTemplateId, sbyte progress)
		{
			GameData.Domains.Character.Character taiwu = this.GetTaiwu();
			short bookTemplateId = Config.CombatSkill.Instance[combatSkillTemplateId].BookId;
			sbyte outlinePageType = taiwu.GetBehaviorType();
			ItemKey itemKey = DomainManager.Item.CreateSkillBook(context, bookTemplateId, -1, -1, outlinePageType, 50, true);
			GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(itemKey.Id);
			bool flag = !taiwu.GetLearnedCombatSkills().Contains(combatSkillTemplateId);
			if (flag)
			{
				DomainManager.Character.LearnCombatSkill(context, this._taiwuCharId, combatSkillTemplateId, 0);
			}
			TaiwuCombatSkill skill = this.GetTaiwuCombatSkill(combatSkillTemplateId);
			byte internalIndex = CombatSkillStateHelper.GetOutlinePageInternalIndex(outlinePageType);
			sbyte currProgress = skill.GetBookPageReadingProgress(internalIndex);
			skill.SetBookPageReadingProgress(internalIndex, Math.Max(progress, currProgress));
			byte pageTypes = book.GetPageTypes();
			for (byte pageId = 1; pageId < 6; pageId += 1)
			{
				sbyte normalPageType = SkillBookStateHelper.GetNormalPageType(pageTypes, pageId);
				internalIndex = CombatSkillStateHelper.GetNormalPageInternalIndex(normalPageType, pageId);
				currProgress = skill.GetBookPageReadingProgress(internalIndex);
				skill.SetBookPageReadingProgress(internalIndex, Math.Max(progress, currProgress));
			}
			this.SetTaiwuCombatSkill(context, combatSkillTemplateId, skill);
			taiwu.AddInventoryItem(context, itemKey, 1, false);
			return itemKey;
		}

		// Token: 0x0600101F RID: 4127 RVA: 0x0010542C File Offset: 0x0010362C
		public ItemKey GetLifeSkillBookAndRead(DataContext context, short lifeSkillTemplateId, sbyte progress)
		{
			GameData.Domains.Character.Character taiwu = this.GetTaiwu();
			short bookTemplateId = LifeSkill.Instance[lifeSkillTemplateId].SkillBookId;
			ItemKey itemKey = DomainManager.Item.CreateSkillBook(context, bookTemplateId, -1, -1, -1, 50, true);
			bool flag = taiwu.FindLearnedLifeSkillIndex(lifeSkillTemplateId) < 0;
			if (flag)
			{
				DomainManager.Character.LearnLifeSkill(context, this._taiwuCharId, lifeSkillTemplateId, 0);
			}
			TaiwuLifeSkill skill = this.GetTaiwuLifeSkill(lifeSkillTemplateId);
			for (byte i = 0; i < 5; i += 1)
			{
				sbyte currProgress = skill.GetBookPageReadingProgress(i);
				skill.SetBookPageReadingProgress(i, Math.Max(currProgress, progress));
			}
			this.SetTaiwuLifeSkill(context, lifeSkillTemplateId, skill);
			taiwu.AddInventoryItem(context, itemKey, 1, false);
			return itemKey;
		}

		// Token: 0x06001020 RID: 4128 RVA: 0x001054E4 File Offset: 0x001036E4
		public bool TryGetTaiwuLifeSkill(short skillTemplateId, out TaiwuLifeSkill lifeSkill)
		{
			return this._lifeSkills.TryGetValue(skillTemplateId, out lifeSkill);
		}

		// Token: 0x06001021 RID: 4129 RVA: 0x00105504 File Offset: 0x00103704
		public bool TryGetNotLearnLifeSkillReadingProgress(short skillTemplateId, out TaiwuLifeSkill notLearnLifeSkill)
		{
			return this._notLearnLifeSkillReadingProgress.TryGetValue(skillTemplateId, out notLearnLifeSkill);
		}

		// Token: 0x06001022 RID: 4130 RVA: 0x00105524 File Offset: 0x00103724
		public void TaiwuLearnLifeSkill(DataContext context, short skillTemplateId, byte readingState = 0)
		{
			DomainManager.Character.LearnLifeSkill(context, this._taiwuCharId, skillTemplateId, readingState);
			bool flag = this._notLearnLifeSkillReadingProgress.ContainsKey(skillTemplateId);
			if (flag)
			{
				this.SetElement_LifeSkills(skillTemplateId, this.GetElement_NotLearnLifeSkillReadingProgress(skillTemplateId), context);
				this.RemoveElement_NotLearnLifeSkillReadingProgress(skillTemplateId, context);
			}
		}

		// Token: 0x06001023 RID: 4131 RVA: 0x00105574 File Offset: 0x00103774
		public bool TryGetTaiwuCombatSkill(short skillTemplateId, out TaiwuCombatSkill combatSkill)
		{
			return this._combatSkills.TryGetValue(skillTemplateId, out combatSkill);
		}

		// Token: 0x06001024 RID: 4132 RVA: 0x00105594 File Offset: 0x00103794
		public bool TryGetNotLearnCombatSkillReadingProgress(short skillTemplateId, out TaiwuCombatSkill notLearnCombatSkill)
		{
			return this._notLearnCombatSkillReadingProgress.TryGetValue(skillTemplateId, out notLearnCombatSkill);
		}

		// Token: 0x06001025 RID: 4133 RVA: 0x001055B4 File Offset: 0x001037B4
		public void TaiwuLearnCombatSkill(DataContext context, short skillTemplateId, ushort readingState = 0)
		{
			DomainManager.Character.LearnCombatSkill(context, this._taiwuCharId, skillTemplateId, readingState);
			bool flag = this._notLearnCombatSkillReadingProgress.ContainsKey(skillTemplateId);
			if (flag)
			{
				this.SetElement_CombatSkills(skillTemplateId, this.GetElement_NotLearnCombatSkillReadingProgress(skillTemplateId), context);
				this.RemoveElement_NotLearnCombatSkillReadingProgress(skillTemplateId, context);
			}
		}

		// Token: 0x06001026 RID: 4134 RVA: 0x00105604 File Offset: 0x00103804
		[DomainMethod]
		public bool SetActivePage(DataContext context, short skillId, byte pageId, sbyte direction)
		{
			return DomainManager.CombatSkill.SetActivePage(context, this._taiwuCharId, skillId, pageId, direction);
		}

		// Token: 0x06001027 RID: 4135 RVA: 0x0010562C File Offset: 0x0010382C
		[DomainMethod]
		public SkillBreakPlate GetBreakPlateData(short skillTemplateId)
		{
			SkillBreakPlate plate;
			return DomainManager.Extra.TryGetElement_SkillBreakPlates(skillTemplateId, out plate) ? plate : null;
		}

		// Token: 0x06001028 RID: 4136 RVA: 0x00105654 File Offset: 0x00103854
		[DomainMethod]
		public SkillBreakPlate EnterSkillBreakPlate(DataContext context, short skillId, ushort selectedPages)
		{
			GameData.Domains.CombatSkill.CombatSkill skill;
			bool flag = !DomainManager.CombatSkill.TryGetElement_CombatSkills(new ValueTuple<int, short>(this._taiwuCharId, skillId), out skill);
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(18, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Skill ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(skillId);
				defaultInterpolatedStringHandler.AppendLiteral(" not learned");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			bool flag2 = !skill.CanBreakout();
			if (flag2)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(23, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Skill ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(skillId);
				defaultInterpolatedStringHandler.AppendLiteral(" cannot break out");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			bool flag3 = CombatSkillStateHelper.GetActiveOutlinePageType(selectedPages) == -1 || CombatSkillStateHelper.GetReadNormalPagesCount(selectedPages) != 5;
			if (flag3)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(43, 2);
				defaultInterpolatedStringHandler.AppendLiteral("Skill ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(skillId);
				defaultInterpolatedStringHandler.AppendLiteral(" selected break out page ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(selectedPages);
				defaultInterpolatedStringHandler.AppendLiteral(" not correct");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			CombatSkillItem skillConfig = Config.CombatSkill.Instance[skillId];
			SkillBreakPlate plate;
			bool flag4 = !DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
			if (flag4)
			{
				SkillBreakPlateItem config = skillConfig.SkillBreakPlate;
				bool flag5 = DomainManager.TutorialChapter.InGuiding && skillId == 706;
				if (flag5)
				{
					config = SkillBreakPlate.Instance[9];
				}
				ValueTuple<int, int> clearedSkillPlateStepInfo = DomainManager.Extra.GetClearedSkillPlateStepInfo(skillId);
				int lastSuccess = clearedSkillPlateStepInfo.Item1;
				int lastFailed = clearedSkillPlateStepInfo.Item2;
				plate = new SkillBreakPlate(context.Random, config, selectedPages, lastSuccess, lastFailed);
				DomainManager.Extra.RemoveClearedSkillPlateStepInfo(context, skillId);
			}
			plate.StepBase = (int)this._taiwuChar.GetSkillBreakoutAvailableStepsCount(skillId);
			plate.BaseSuccessRate = this.CalcTaiwuBreakBaseSuccessRate(skillConfig);
			DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
			return plate;
		}

		// Token: 0x06001029 RID: 4137 RVA: 0x00105840 File Offset: 0x00103A40
		[DomainMethod]
		public void ClearBreakPlate(DataContext context, short skillId, bool fromGmCmd = false)
		{
			int successCount = 0;
			int failedCount = 0;
			SkillBreakPlateObsolete plateObsolete;
			bool flag = this._skillBreakPlateObsoleteDict.TryGetValue(skillId, out plateObsolete);
			if (flag)
			{
				this.RemoveElement_SkillBreakPlateObsoleteDict(skillId, context);
				this.RemoveElement_SkillBreakBonusDict(skillId, context);
				ValueTuple<int, int> succeedAndFailCount = plateObsolete.GetSucceedAndFailCount(true);
				successCount = succeedAndFailCount.Item1;
				failedCount = succeedAndFailCount.Item2;
			}
			SkillBreakPlate plate;
			bool flag2 = DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
			if (flag2)
			{
				DomainManager.Extra.RemoveSkillBreakPlate(context, skillId);
				successCount = plate.SuccessCount;
				failedCount = plate.FailedCount;
			}
			DomainManager.Extra.AddClearedSkillPlateStepInfo(context, skillId, successCount, failedCount);
			bool flag3 = this._taiwuChar.GetLoopingNeigong() == skillId;
			if (flag3)
			{
				this._taiwuChar.SetLoopingNeigong(-1, context);
			}
			CharacterDomain.TryRemoveCombatSkillFromAttainmentPanel(context, this._taiwuChar, skillId);
			TaiwuCombatSkill taiwuSkill;
			bool flag4 = this.TryGetElement_CombatSkills(skillId, out taiwuSkill);
			if (flag4)
			{
				bool flag5 = !fromGmCmd;
				if (flag5)
				{
					taiwuSkill.LastClearBreakPlateTime = DomainManager.World.GetCurrDate();
				}
				taiwuSkill.FullPowerCastTimes = 0;
				this.SetElement_CombatSkills(skillId, taiwuSkill, context);
			}
			GameData.Domains.CombatSkill.CombatSkill skill;
			bool flag6 = DomainManager.CombatSkill.TryGetElement_CombatSkills(new ValueTuple<int, short>(this._taiwuCharId, skillId), out skill);
			if (flag6)
			{
				skill.SetActivationState(0, context);
			}
			bool flag7 = this._taiwuChar.IsCombatSkillEquipped(skillId);
			if (flag7)
			{
				DomainManager.SpecialEffect.Remove(context, this._taiwuCharId, skillId, 2);
			}
		}

		// Token: 0x0600102A RID: 4138 RVA: 0x00105990 File Offset: 0x00103B90
		[DomainMethod]
		public SkillBreakPlate SelectSkillBreakGrid(DataContext context, short skillId, SkillBreakPlateIndex index)
		{
			SkillBreakPlate plate = DomainManager.Extra.GetElement_SkillBreakPlates(skillId);
			int baseCostExp = this.GetBreakBaseCostExp(skillId);
			int costExp = plate.CalcCostExp(baseCostExp, index);
			bool flag = this._taiwuChar.GetExp() < costExp;
			SkillBreakPlate result;
			if (flag)
			{
				result = null;
			}
			else
			{
				bool selectInGoneMad;
				bool flag2 = !plate.SelectBreak(context.Random, index, out selectInGoneMad);
				if (flag2)
				{
					result = null;
				}
				else
				{
					this._taiwuChar.ChangeExp(context, -costExp);
					CombatSkillItem config = Config.CombatSkill.Instance[skillId];
					bool success = plate.Success;
					if (success)
					{
						this.FinishBreak(context, skillId, plate);
					}
					SkillBreakGridTypeItem gridConfig = SkillBreakGridType.Instance[plate[index].TemplateId];
					bool flag3 = gridConfig.HealthCost != 0;
					if (flag3)
					{
						this._taiwuChar.ChangeHealth(context, (int)(-(int)gridConfig.HealthCost));
					}
					bool goneMadInAllBreak = DomainManager.SpecialEffect.ModifyData(this._taiwuCharId, skillId, 267, false, -1, -1, -1);
					bool flag4 = selectInGoneMad || goneMadInAllBreak;
					if (flag4)
					{
						Injuries injuries = this._taiwuChar.GetInjuries();
						short disorderOfQi = 0;
						int overflowInjuryValue = GameData.Domains.Character.CombatSkillHelper.CalcForceBreakoutInjuriesAndDisorderOfQi(context.Random, config, ref injuries, ref disorderOfQi);
						this._taiwuChar.SetInjuries(injuries, context);
						this._taiwuChar.ChangeDisorderOfQiRandomRecovery(context, (int)disorderOfQi);
						int costHealth = -(overflowInjuryValue * (int)GlobalConfig.Instance.ReduceHealthPerFatalDamageMark[1]);
						costHealth += (int)DisorderLevelOfQi.GetDisorderLevelOfQiConfig(this._taiwuChar.GetDisorderOfQi()).BreakCostHealth;
						this._taiwuChar.ChangeHealth(context, costHealth);
					}
					DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
					result = plate;
				}
			}
			return result;
		}

		// Token: 0x0600102B RID: 4139 RVA: 0x00105B20 File Offset: 0x00103D20
		[DomainMethod]
		public int GetBreakBaseCostExp(short skillId)
		{
			CombatSkillItem skillConfig = Config.CombatSkill.Instance[skillId];
			sbyte templateId = skillConfig.Grade;
			bool inGuiding = DomainManager.TutorialChapter.InGuiding;
			if (inGuiding)
			{
				templateId = 0;
			}
			return (int)SkillBreakPlate.Instance[templateId].CostExp;
		}

		// Token: 0x0600102C RID: 4140 RVA: 0x00105B68 File Offset: 0x00103D68
		[DomainMethod]
		public List<SkillBreakPlateBonus> GetAvailableRelationBonuses(short skillId)
		{
			HashSet<RelationKey> usingAdoreCharIds = new HashSet<RelationKey>();
			HashSet<RelationKey> usingEnemyCharIds = new HashSet<RelationKey>();
			HashSet<RelationKey> usingFamilyAndFriendCharIds = new HashSet<RelationKey>();
			foreach (SkillBreakPlate plate in DomainManager.Extra.GetConflictRelationSkillBreakPlates(skillId))
			{
				foreach (SkillBreakPlateBonus bonus in plate.GetBonusesWithoutCheck())
				{
					bool flag = bonus.RelationType == 16384;
					if (flag)
					{
						usingAdoreCharIds.Add(bonus.RelationKey);
					}
					bool flag2 = bonus.RelationType == 32768;
					if (flag2)
					{
						usingEnemyCharIds.Add(bonus.RelationKey);
					}
					bool flag3 = bonus.Type == ESkillBreakPlateBonusType.Friend;
					if (flag3)
					{
						usingFamilyAndFriendCharIds.Add(bonus.RelationKey);
					}
				}
			}
			List<SkillBreakPlateBonus> result = new List<SkillBreakPlateBonus>();
			RelatedCharacters relatedCharacters = DomainManager.Character.GetRelatedCharacters(this._taiwuCharId);
			foreach (int charId in relatedCharacters.Adored.GetCollection())
			{
				bool flag4 = !DomainManager.Character.IsCharacterAlive(charId);
				if (!flag4)
				{
					SkillBreakPlateBonus bonus2 = SkillBreakPlateBonusHelper.CreateRelation(charId, this._taiwuCharId, 16384);
					bool flag5 = bonus2.ShouldBeRemoved() || usingAdoreCharIds.Contains(bonus2.RelationKey);
					if (!flag5)
					{
						result.Add(bonus2);
					}
				}
			}
			foreach (int charId2 in relatedCharacters.Enemies.GetCollection())
			{
				bool flag6 = !DomainManager.Character.IsCharacterAlive(charId2);
				if (!flag6)
				{
					SkillBreakPlateBonus bonus3 = SkillBreakPlateBonusHelper.CreateRelation(charId2, this._taiwuCharId, 32768);
					bool flag7 = bonus3.ShouldBeRemoved() || usingEnemyCharIds.Contains(bonus3.RelationKey);
					if (!flag7)
					{
						result.Add(bonus3);
					}
				}
			}
			HashSet<int> familyAndFriendCharIds = ObjectPool<HashSet<int>>.Instance.Get();
			familyAndFriendCharIds.Clear();
			relatedCharacters.GetAllTwoWayRelatedCharIds(familyAndFriendCharIds);
			foreach (int charId3 in familyAndFriendCharIds)
			{
				bool flag8 = !DomainManager.Character.IsCharacterAlive(charId3);
				if (!flag8)
				{
					SkillBreakPlateBonus bonus4 = SkillBreakPlateBonusHelper.CreateFriend(charId3, this._taiwuCharId, skillId);
					bool flag9 = bonus4.ShouldBeRemoved() || usingFamilyAndFriendCharIds.Contains(bonus4.RelationKey);
					if (!flag9)
					{
						result.Add(bonus4);
					}
				}
			}
			ObjectPool<HashSet<int>>.Instance.Return(familyAndFriendCharIds);
			return result;
		}

		// Token: 0x0600102D RID: 4141 RVA: 0x00105E88 File Offset: 0x00104088
		[DomainMethod]
		public SkillBreakPlate ClearBonus(DataContext context, short skillId, SkillBreakPlateIndex index)
		{
			SkillBreakPlate plate;
			bool flag = !DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
			SkillBreakPlate result;
			if (flag)
			{
				result = null;
			}
			else
			{
				bool flag2 = !plate.ClearBonus(index);
				if (flag2)
				{
					result = null;
				}
				else
				{
					DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
					DomainManager.Extra.UpdateSkillActivationState(context, skillId, plate);
					result = plate;
				}
			}
			return result;
		}

		// Token: 0x0600102E RID: 4142 RVA: 0x00105EE4 File Offset: 0x001040E4
		[DomainMethod]
		public SkillBreakPlate SetBonusItem(DataContext context, short skillId, SkillBreakPlateIndex index, ItemKey itemKey, sbyte itemSourceType)
		{
			SkillBreakPlate plate;
			bool flag = !DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
			SkillBreakPlate result;
			if (flag)
			{
				result = null;
			}
			else
			{
				bool flag2 = !plate.SetBonus(index, SkillBreakPlateBonusHelper.CreateItem(itemKey));
				if (flag2)
				{
					result = null;
				}
				else
				{
					this.RemoveItem(context, itemKey, 1, itemSourceType, true, false);
					DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
					DomainManager.Extra.UpdateSkillActivationState(context, skillId, plate);
					result = plate;
				}
			}
			return result;
		}

		// Token: 0x0600102F RID: 4143 RVA: 0x00105F54 File Offset: 0x00104154
		[DomainMethod]
		public SkillBreakPlate SetBonusRelation(DataContext context, short skillId, SkillBreakPlateIndex index, int charId, ushort relationType)
		{
			bool flag = charId == this._taiwuCharId;
			SkillBreakPlate result;
			if (flag)
			{
				result = null;
			}
			else
			{
				SkillBreakPlate plate;
				bool flag2 = !DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
				if (flag2)
				{
					result = null;
				}
				else
				{
					bool flag3 = !plate.SetBonus(index, SkillBreakPlateBonusHelper.CreateRelation(charId, this._taiwuCharId, relationType));
					if (flag3)
					{
						result = null;
					}
					else
					{
						DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
						DomainManager.Extra.UpdateSkillActivationState(context, skillId, plate);
						result = plate;
					}
				}
			}
			return result;
		}

		// Token: 0x06001030 RID: 4144 RVA: 0x00105FD0 File Offset: 0x001041D0
		[DomainMethod]
		public SkillBreakPlate SetBonusFriend(DataContext context, short skillId, SkillBreakPlateIndex index, int charId)
		{
			bool flag = charId == this._taiwuCharId;
			SkillBreakPlate result;
			if (flag)
			{
				result = null;
			}
			else
			{
				SkillBreakPlate plate;
				bool flag2 = !DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
				if (flag2)
				{
					result = null;
				}
				else
				{
					bool flag3 = !plate.SetBonus(index, SkillBreakPlateBonusHelper.CreateFriend(charId, this._taiwuCharId, skillId));
					if (flag3)
					{
						result = null;
					}
					else
					{
						DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
						DomainManager.Extra.UpdateSkillActivationState(context, skillId, plate);
						result = plate;
					}
				}
			}
			return result;
		}

		// Token: 0x06001031 RID: 4145 RVA: 0x0010604C File Offset: 0x0010424C
		[DomainMethod]
		public SkillBreakPlate SetBonusExp(DataContext context, short skillId, SkillBreakPlateIndex index, int expLevel)
		{
			bool flag = expLevel < 0 || expLevel >= SkillBreakPlateConstants.ExpLevelValues.Count;
			SkillBreakPlate result;
			if (flag)
			{
				result = null;
			}
			else
			{
				int expValue = SkillBreakPlateConstants.ExpLevelValues[expLevel];
				bool flag2 = this._taiwuChar.GetExp() < expValue;
				if (flag2)
				{
					result = null;
				}
				else
				{
					SkillBreakPlate plate;
					bool flag3 = !DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
					if (flag3)
					{
						result = null;
					}
					else
					{
						bool flag4 = !plate.SetBonus(index, SkillBreakPlateBonusHelper.CreateExp(expLevel));
						if (flag4)
						{
							result = null;
						}
						else
						{
							this._taiwuChar.ChangeExp(context, -expValue);
							DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
							DomainManager.Extra.UpdateSkillActivationState(context, skillId, plate);
							result = plate;
						}
					}
				}
			}
			return result;
		}

		// Token: 0x06001032 RID: 4146 RVA: 0x00106108 File Offset: 0x00104308
		public bool GetAutoBreakPlate(DataContext context, short skillId, out SkillBreakPlate plate, out SkillBreakPlateObsolete obsoletePlate)
		{
			bool existNew = DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate);
			bool existOld = this.TryGetElement_SkillBreakPlateObsoleteDict(skillId, out obsoletePlate);
			bool flag = existNew && existOld;
			if (flag)
			{
				this.RemoveElement_SkillBreakPlateObsoleteDict(skillId, context);
			}
			bool flag2 = existNew;
			if (flag2)
			{
				obsoletePlate = null;
			}
			return existNew || existOld;
		}

		// Token: 0x06001033 RID: 4147 RVA: 0x00106150 File Offset: 0x00104350
		public bool UpdateBreakPlateSelectedPages(DataContext context, short skillId, ushort activationState)
		{
			bool anyChanged = false;
			SkillBreakPlateObsolete obsoletePlate;
			bool flag = this._skillBreakPlateObsoleteDict.TryGetValue(skillId, out obsoletePlate);
			if (flag)
			{
				obsoletePlate.SelectedPages = activationState;
				this.SetElement_SkillBreakPlateObsoleteDict(skillId, obsoletePlate, context);
				anyChanged = true;
			}
			SkillBreakPlate plate;
			bool flag2 = DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out plate) && plate.UpdateSelectedPages(activationState);
			if (flag2)
			{
				DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
				anyChanged = true;
			}
			return anyChanged;
		}

		// Token: 0x06001034 RID: 4148 RVA: 0x001061BF File Offset: 0x001043BF
		public bool TryGetSkillBreakPlate(short skillId, out SkillBreakPlate breakPlate)
		{
			return DomainManager.Extra.TryGetElement_SkillBreakPlates(skillId, out breakPlate);
		}

		// Token: 0x06001035 RID: 4149 RVA: 0x001061D0 File Offset: 0x001043D0
		public void OverwriteBreakPlateWithConflictCombatSkill(DataContext context, ConflictCombatSkill conflictCombatSkill)
		{
			short skillId = conflictCombatSkill.TemplateId;
			bool flag = conflictCombatSkill.BreakPlate != null;
			if (flag)
			{
				DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, conflictCombatSkill.BreakPlate);
			}
			else
			{
				this.SetElement_SkillBreakPlateObsoleteDict(skillId, conflictCombatSkill.BreakPlateObsolete, context);
				SkillBreakBonusCollection bonusCollection = conflictCombatSkill.BonusCollection ?? new SkillBreakBonusCollection();
				conflictCombatSkill.BreakPlateObsolete.CalcSkillBreakBonusCollection(bonusCollection);
				this.SetElement_SkillBreakBonusDict(skillId, conflictCombatSkill.BonusCollection, context);
			}
		}

		// Token: 0x06001036 RID: 4150 RVA: 0x00106244 File Offset: 0x00104444
		public SkillBreakBonusCollection GetBreakGridBonusCollection(short skillTemplateId)
		{
			SkillBreakBonusCollection bonusCollection;
			this._skillBreakBonusDict.TryGetValue(skillTemplateId, out bonusCollection);
			return bonusCollection;
		}

		// Token: 0x06001037 RID: 4151 RVA: 0x00106268 File Offset: 0x00104468
		private unsafe byte CalcTaiwuBreakBaseSuccessRate(CombatSkillItem skillConfig)
		{
			int baseSuccessRate = (int)(30 + (9 - skillConfig.Grade) * 5);
			bool flag = skillConfig.SectId != 0;
			if (flag)
			{
				short settlementId = DomainManager.Organization.GetSettlementIdByOrgTemplateId(skillConfig.SectId);
				Sect sect = DomainManager.Organization.GetElement_Sects(settlementId);
				short approvingRate = sect.CalcApprovingRate();
				bool flag2 = approvingRate >= 500;
				if (flag2)
				{
					baseSuccessRate += 10;
				}
			}
			baseSuccessRate += Math.Min((int)(*this._taiwuChar.GetMaxMainAttributes()[5] / 10), 30);
			int consummateLevel = (int)(this._taiwuChar.IsLoseConsummateBonusByFeature() ? 0 : this._taiwuChar.GetConsummateLevel());
			baseSuccessRate += ConsummateLevel.Instance[consummateLevel].AddBreakSuccessRate;
			Location location = this._taiwuChar.GetLocation();
			int buildingEffect = DomainManager.Building.GetBuildingBlockEffect(location, EBuildingScaleEffect.BreakOutSuccessRate, (int)skillConfig.Type);
			bool flag3 = buildingEffect != 0;
			if (flag3)
			{
				baseSuccessRate *= buildingEffect;
			}
			bool flag4 = location.IsValid();
			if (flag4)
			{
				AreaAdventureData adventuresInArea = DomainManager.Adventure.GetAdventuresInArea(location.AreaId);
				AdventureSiteData site;
				bool flag5 = adventuresInArea.AdventureSites.TryGetValue(location.BlockId, out site) && site.SiteState >= 2 && site.TemplateId == 43;
				if (flag5)
				{
					baseSuccessRate += 10;
				}
			}
			byte difficulty = DomainManager.Extra.GetBreakoutDifficulty();
			short difficultyAdjust = WorldCreation.Instance[9].InfluenceFactors[(int)difficulty];
			baseSuccessRate += (int)difficultyAdjust;
			return (byte)Math.Clamp(baseSuccessRate, 0, 100);
		}

		// Token: 0x06001038 RID: 4152 RVA: 0x001063F4 File Offset: 0x001045F4
		private unsafe void FinishBreak(DataContext context, short skillTemplateId, SkillBreakPlate plate)
		{
			GameData.Domains.CombatSkill.CombatSkill combatSkill = DomainManager.CombatSkill.GetElement_CombatSkills(new ValueTuple<int, short>(this._taiwuCharId, skillTemplateId));
			combatSkill.SetActivationState(plate.SelectedPages, context);
			int forceBreakoutSteps = plate.StepCostedGoneMad;
			bool flag = forceBreakoutSteps < 0;
			if (flag)
			{
				forceBreakoutSteps = 0;
			}
			combatSkill.SetForcedBreakoutStepsCount((sbyte)forceBreakoutSteps, context);
			CombatSkillItem configData = Config.CombatSkill.Instance[skillTemplateId];
			short[] attainmentPanels = this._taiwuChar.GetCombatSkillAttainmentPanels();
			short* attainmentSkillList = stackalloc short[(UIntPtr)18];
			CombatSkillAttainmentPanelsHelper.GetPanel(attainmentPanels, configData.Type, attainmentSkillList);
			bool flag2 = attainmentSkillList[configData.Grade] < 0;
			if (flag2)
			{
				CombatSkillAttainmentPanelsHelper.Set(attainmentPanels, configData.Type, configData.Grade, skillTemplateId);
				this._taiwuChar.SetCombatSkillAttainmentPanels(attainmentPanels, context);
			}
			bool flag3 = this._taiwuChar.IsCombatSkillEquipped(skillTemplateId);
			if (flag3)
			{
				DomainManager.SpecialEffect.UpdateEquippedSkillEffect(context, this._taiwuChar);
			}
			this.AddLegacyPoint(context, 24, 100);
		}

		// Token: 0x06001039 RID: 4153 RVA: 0x001064E4 File Offset: 0x001046E4
		public void AddFullPowerCastTimes(DataContext context, short skillTemplateId)
		{
			TaiwuCombatSkill taiwuSkill;
			bool flag = this.TryGetElement_CombatSkills(skillTemplateId, out taiwuSkill) && (int)taiwuSkill.FullPowerCastTimes < TaiwuCombatSkill.FullPowerAddBreakSuccessRate.Length;
			if (flag)
			{
				TaiwuCombatSkill taiwuCombatSkill = taiwuSkill;
				taiwuCombatSkill.FullPowerCastTimes += 1;
				this.SetElement_CombatSkills(skillTemplateId, taiwuSkill, context);
			}
		}

		// Token: 0x0600103A RID: 4154 RVA: 0x00106530 File Offset: 0x00104730
		public void ChangeCurrBreakPlate(DataContext context, short skillId, SkillBreakPlate plate, SkillBreakPlateObsolete plateObsolete, int lastClearTime, int lastForceBreakoutStepsCount)
		{
			GameData.Domains.CombatSkill.CombatSkill skill = DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillId));
			TaiwuCombatSkill taiwuSkill = this.GetElement_CombatSkills(skillId);
			this.ChangeCurrBreakPlateBasic(context, skillId, plate, plateObsolete);
			this.ChangeCurrBreakPlateBonus(context, skillId, plateObsolete);
			bool flag = (plate == null || !plate.Success) && (plateObsolete == null || !plateObsolete.Finished);
			if (flag)
			{
				bool flag2 = this._taiwuChar.GetLoopingNeigong() == skillId;
				if (flag2)
				{
					this._taiwuChar.SetLoopingNeigong(-1, context);
				}
				CharacterDomain.TryRemoveCombatSkillFromAttainmentPanel(context, this._taiwuChar, skillId);
			}
			taiwuSkill.LastClearBreakPlateTime = lastClearTime;
			this.SetElement_CombatSkills(skillId, taiwuSkill, context);
			skill.SetForcedBreakoutStepsCount((sbyte)lastForceBreakoutStepsCount, context);
			ushort oldActivationState = skill.GetActivationState();
			ushort newActivationState = (plate != null && plate.Success) ? plate.SelectedPages : ((plateObsolete != null && plateObsolete.Finished) ? plateObsolete.SelectedPages : 0);
			skill.SetActivationState(newActivationState, context);
			bool flag3 = skill.Template.EquipType == 0;
			if (flag3)
			{
				this._taiwuChar.UpdateAllocatedGenericGrids(context);
			}
			bool flag4 = !this._taiwuChar.IsCombatSkillEquipped(skillId) || !this._taiwuChar.GetCombatSkillCanAffect(skillId);
			if (!flag4)
			{
				bool flag5 = CombatSkillStateHelper.IsBrokenOut(oldActivationState);
				if (flag5)
				{
					DomainManager.SpecialEffect.Remove(context, this._taiwuCharId, skillId, 2);
				}
				bool flag6 = CombatSkillStateHelper.IsBrokenOut(newActivationState);
				if (flag6)
				{
					DomainManager.SpecialEffect.Add(context, this._taiwuCharId, skillId, 2, -1);
				}
			}
		}

		// Token: 0x0600103B RID: 4155 RVA: 0x001066B0 File Offset: 0x001048B0
		private void ChangeCurrBreakPlateBasic(DataContext context, short skillId, SkillBreakPlate plate, SkillBreakPlateObsolete plateObsolete)
		{
			SkillBreakPlateObsolete skillBreakPlateObsolete;
			bool plateObsoleteExist = this.TryGetElement_SkillBreakPlateObsoleteDict(skillId, out skillBreakPlateObsolete);
			SkillBreakPlate skillBreakPlate;
			bool flag = this.TryGetSkillBreakPlate(skillId, out skillBreakPlate) && plate == null;
			if (flag)
			{
				DomainManager.Extra.RemoveSkillBreakPlate(context, skillId);
			}
			bool flag2 = plateObsoleteExist && plateObsolete == null;
			if (flag2)
			{
				this.RemoveElement_SkillBreakPlateObsoleteDict(skillId, context);
			}
			bool flag3 = plate != null;
			if (flag3)
			{
				DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillId, plate);
			}
			bool flag4 = plateObsolete == null;
			if (!flag4)
			{
				bool flag5 = plateObsoleteExist;
				if (flag5)
				{
					this.SetElement_SkillBreakPlateObsoleteDict(skillId, plateObsolete, context);
				}
				else
				{
					this.AddElement_SkillBreakPlateObsoleteDict(skillId, plateObsolete, context);
				}
			}
		}

		// Token: 0x0600103C RID: 4156 RVA: 0x0010674C File Offset: 0x0010494C
		private void ChangeCurrBreakPlateBonus(DataContext context, short skillId, SkillBreakPlateObsolete plateObsolete)
		{
			SkillBreakBonusCollection bonusCollection;
			bool bonusExist = this.TryGetElement_SkillBreakBonusDict(skillId, out bonusCollection);
			bool flag = bonusExist && plateObsolete == null;
			if (flag)
			{
				this.RemoveElement_SkillBreakBonusDict(skillId, context);
			}
			bool flag2 = plateObsolete == null || !plateObsolete.Finished;
			if (!flag2)
			{
				if (bonusCollection == null)
				{
					bonusCollection = new SkillBreakBonusCollection();
				}
				plateObsolete.CalcSkillBreakBonusCollection(bonusCollection);
				bool flag3 = bonusExist;
				if (flag3)
				{
					this.SetElement_SkillBreakBonusDict(skillId, bonusCollection, context);
				}
				else
				{
					this.AddElement_SkillBreakBonusDict(skillId, bonusCollection, context);
				}
			}
		}

		// Token: 0x0600103D RID: 4157 RVA: 0x001067C0 File Offset: 0x001049C0
		public void AddTeachTaiwuLifeSkill(DataContext context, int charId, short skillId)
		{
			bool flag = !this._teachTaiwuLifeSkillDict.ContainsKey(charId);
			if (flag)
			{
				this.AddElement_TeachTaiwuLifeSkillDict(charId, GameData.Utilities.ShortList.Create(), context);
			}
			GameData.Utilities.ShortList skillList = this._teachTaiwuLifeSkillDict[charId];
			bool flag2 = skillList.Items.Count >= 3;
			if (flag2)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(62, 2);
				defaultInterpolatedStringHandler.AppendLiteral("Npc ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(charId);
				defaultInterpolatedStringHandler.AppendLiteral(" already teached ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(skillList.Items.Count);
				defaultInterpolatedStringHandler.AppendLiteral(" life skills to taiwu, cannnot teach more");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			skillList.Items.Add(skillId);
			this.SetElement_TeachTaiwuLifeSkillDict(charId, skillList, context);
		}

		// Token: 0x0600103E RID: 4158 RVA: 0x00106884 File Offset: 0x00104A84
		public void ClearTeachTaiwuLifeSkillList(DataContext context, int charId)
		{
			bool flag = !this._teachTaiwuLifeSkillDict.ContainsKey(charId);
			if (!flag)
			{
				this.RemoveElement_TeachTaiwuLifeSkillDict(charId, context);
			}
		}

		// Token: 0x0600103F RID: 4159 RVA: 0x001068B0 File Offset: 0x00104AB0
		public void AddTeachTaiwuCombatSkill(DataContext context, int charId, short skillId)
		{
			bool flag = !this._teachTaiwuCombatSkillDict.ContainsKey(charId);
			if (flag)
			{
				this.AddElement_TeachTaiwuCombatSkillDict(charId, GameData.Utilities.ShortList.Create(), context);
			}
			GameData.Utilities.ShortList skillList = this._teachTaiwuCombatSkillDict[charId];
			bool flag2 = skillList.Items.Count >= 3;
			if (flag2)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(64, 2);
				defaultInterpolatedStringHandler.AppendLiteral("Npc ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(charId);
				defaultInterpolatedStringHandler.AppendLiteral(" already teached ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(skillList.Items.Count);
				defaultInterpolatedStringHandler.AppendLiteral(" combat skills to taiwu, cannnot teach more");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			skillList.Items.Add(skillId);
			this.SetElement_TeachTaiwuCombatSkillDict(charId, skillList, context);
		}

		// Token: 0x06001040 RID: 4160 RVA: 0x00106974 File Offset: 0x00104B74
		public void ClearTeachTaiwuCombatSkillList(DataContext context, int charId)
		{
			bool flag = !this._teachTaiwuCombatSkillDict.ContainsKey(charId);
			if (!flag)
			{
				this.RemoveElement_TeachTaiwuCombatSkillDict(charId, context);
			}
		}

		// Token: 0x17000026 RID: 38
		// (get) Token: 0x06001041 RID: 4161 RVA: 0x001069A0 File Offset: 0x00104BA0
		public CivilianSettlement TaiwuVillage
		{
			get
			{
				if (this._taiwuVillage == null)
				{
					this._taiwuVillage = DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId);
				}
				return this._taiwuVillage;
			}
		}

		// Token: 0x06001042 RID: 4162 RVA: 0x001069D8 File Offset: 0x00104BD8
		[DomainMethod]
		public void EscapeToAdjacentBlock(DataContext context)
		{
			Location taiwuLocation = this._taiwuChar.GetLocation();
			short randomAdjacentBlockId = DomainManager.Map.GetRandomAdjacentBlockId(context.Random, taiwuLocation.AreaId, taiwuLocation.BlockId);
			DomainManager.Map.Move(context, randomAdjacentBlockId, true);
			this.SetNeedToEscape(false, context);
		}

		// Token: 0x06001043 RID: 4163 RVA: 0x00106A28 File Offset: 0x00104C28
		[DomainMethod]
		public void TaiwuAddFeature(DataContext context, short featureId)
		{
			GameData.Domains.Character.Character taiwu = DomainManager.Taiwu.GetTaiwu();
			taiwu.AddFeature(context, featureId, true);
		}

		// Token: 0x06001044 RID: 4164 RVA: 0x00106A4C File Offset: 0x00104C4C
		public void SetTaiwu(DataContext context, GameData.Domains.Character.Character newTaiwuChar)
		{
			bool flag = this._taiwuChar != null;
			if (flag)
			{
				this._previousTaiwuIds.Add(this._taiwuChar.GetId());
				this.SetPreviousTaiwuIds(this._previousTaiwuIds, context);
			}
			int newTaiwuId = newTaiwuChar.GetId();
			for (int i = 0; i < this._combatGroupCharIds.Length; i++)
			{
				bool flag2 = this._combatGroupCharIds[i] == newTaiwuId;
				if (flag2)
				{
					this.SetElement_CombatGroupCharIds(i, -1, context);
				}
			}
			this.SetTaiwuCharId(newTaiwuId, context);
			this._taiwuChar = newTaiwuChar;
			DomainManager.Extra.UpdateTaiwuSkillDataListener(context);
			DomainManager.Extra.UpdateTaiwuLegendaryBookEffects(context);
			DomainManager.Taiwu.TryRemoveReferenceSkillAtLockedSlot(context);
		}

		// Token: 0x06001045 RID: 4165 RVA: 0x00106B04 File Offset: 0x00104D04
		public sbyte GetTaiwuVillageStateSect()
		{
			sbyte stateTemplateId = DomainManager.World.GetTaiwuVillageStateTemplateId();
			return MapState.Instance[stateTemplateId].SectID;
		}

		// Token: 0x06001046 RID: 4166 RVA: 0x00106B34 File Offset: 0x00104D34
		public GameData.Domains.Character.Character GetTaiwu()
		{
			return this._taiwuChar;
		}

		// Token: 0x06001047 RID: 4167 RVA: 0x00106B4C File Offset: 0x00104D4C
		public bool CanTaiwuBeSneakyHarmfulActionTarget()
		{
			return this._canTaiwuBeSneakyHarmfulActionTarget;
		}

		// Token: 0x06001048 RID: 4168 RVA: 0x00106B64 File Offset: 0x00104D64
		public void ResetEquipmentPlans(DataContext context)
		{
			for (int i = 0; i < this._equipmentsPlans.Length; i++)
			{
				for (int j = 0; j < this._equipmentsPlans[i].Slots.Length; j++)
				{
					this._equipmentsPlans[i].Slots[j] = ItemKey.Invalid;
				}
				this.SetElement_EquipmentsPlans(i, this._equipmentsPlans[i], context);
			}
			this.SetCurrEquipmentPlanId(0, context);
		}

		// Token: 0x06001049 RID: 4169 RVA: 0x00106BE0 File Offset: 0x00104DE0
		public void SetWeaponInnerRatio(DataContext context, int index, sbyte innerRatio)
		{
			bool flag = index < 6;
			if (flag)
			{
				this._weaponInnerRatios[index] = innerRatio;
				this.SetWeaponInnerRatios(this._weaponInnerRatios, context);
			}
			else
			{
				DomainManager.Extra.SetVoiceWeaponInnerRatio(innerRatio, context);
			}
		}

		// Token: 0x0600104A RID: 4170 RVA: 0x00106C20 File Offset: 0x00104E20
		public void UpdateTaiwuWeaponInnerRatios(DataContext context, sbyte srcSlot, sbyte destSlot, ItemKey srcItemKey)
		{
			sbyte[] weaponSlots = EquipmentSlot.EquipmentType2Slots[0];
			bool flag = !weaponSlots.Exist(destSlot);
			if (!flag)
			{
				int srcWeaponIndex = weaponSlots.IndexOf(srcSlot);
				int destWeaponIndex = weaponSlots.IndexOf(destSlot);
				bool flag2 = srcWeaponIndex >= 0;
				if (flag2)
				{
					ref sbyte ptr = ref this._weaponInnerRatios[srcWeaponIndex];
					sbyte[] weaponInnerRatios = this._weaponInnerRatios;
					int num = destWeaponIndex;
					sbyte b = this._weaponInnerRatios[destWeaponIndex];
					sbyte b2 = this._weaponInnerRatios[srcWeaponIndex];
					ptr = b;
					weaponInnerRatios[num] = b2;
				}
				else
				{
					this._weaponInnerRatios[destWeaponIndex] = Config.Weapon.Instance[srcItemKey.TemplateId].DefaultInnerRatio;
				}
				this.SetWeaponInnerRatios(this._weaponInnerRatios, context);
			}
		}

		// Token: 0x0600104B RID: 4171 RVA: 0x00106CD0 File Offset: 0x00104ED0
		public void AddAppointment(DataContext context, int charId, short settlementId)
		{
			bool flag = this._appointments.ContainsKey(charId);
			if (flag)
			{
				this.SetElement_Appointments(charId, settlementId, context);
			}
			else
			{
				this.AddElement_Appointments(charId, settlementId, context);
			}
		}

		// Token: 0x0600104C RID: 4172 RVA: 0x00106D04 File Offset: 0x00104F04
		public void RemoveAppointment(DataContext context, int charId)
		{
			bool flag = this._appointments.ContainsKey(charId);
			if (flag)
			{
				this.RemoveElement_Appointments(charId, context);
			}
		}

		// Token: 0x0600104D RID: 4173 RVA: 0x00106D2B File Offset: 0x00104F2B
		public void PrenatalEducateForMainAttribute(DataContext context, short bonus)
		{
			this._babyBonusMainAttributes += bonus;
			this.SetBabyBonusMainAttributes(this._babyBonusMainAttributes, context);
		}

		// Token: 0x0600104E RID: 4174 RVA: 0x00106D4B File Offset: 0x00104F4B
		public void PrenatalEducateForLifeSkill(DataContext context, short bonus)
		{
			this._babyBonusLifeSkillQualifications += bonus;
			this.SetBabyBonusLifeSkillQualifications(this._babyBonusLifeSkillQualifications, context);
		}

		// Token: 0x0600104F RID: 4175 RVA: 0x00106D6B File Offset: 0x00104F6B
		public void PrenatalEducateForCombatSkill(DataContext context, short bonus)
		{
			this._babyBonusCombatSkillQualifications += bonus;
			this.SetBabyBonusCombatSkillQualifications(this._babyBonusCombatSkillQualifications, context);
		}

		// Token: 0x06001050 RID: 4176 RVA: 0x00106D8C File Offset: 0x00104F8C
		public unsafe void ApplyPrenatalEducationBonus(DataContext context, GameData.Domains.Character.Character child)
		{
			bool flag = this._babyBonusMainAttributes != 0;
			if (flag)
			{
				MainAttributes bonus = default(MainAttributes);
				for (sbyte type = 0; type < 6; type += 1)
				{
					*(ref bonus.Items.FixedElementField + (IntPtr)type * 2) = this._babyBonusMainAttributes;
				}
				child.ChangeBaseMainAttributes(context, bonus);
			}
			bool flag2 = this._babyBonusLifeSkillQualifications != 0;
			if (flag2)
			{
				LifeSkillShorts bonus2 = default(LifeSkillShorts);
				for (sbyte type2 = 0; type2 < 16; type2 += 1)
				{
					*(ref bonus2.Items.FixedElementField + (IntPtr)type2 * 2) = this._babyBonusLifeSkillQualifications;
				}
				child.ChangeBaseLifeSkillQualifications(context, ref bonus2);
			}
			bool flag3 = this._babyBonusCombatSkillQualifications != 0;
			if (flag3)
			{
				CombatSkillShorts bonus3 = default(CombatSkillShorts);
				for (sbyte type3 = 0; type3 < 14; type3 += 1)
				{
					*(ref bonus3.Items.FixedElementField + (IntPtr)type3 * 2) = this._babyBonusCombatSkillQualifications;
				}
				child.ChangeBaseCombatSkillQualifications(context, ref bonus3);
			}
		}

		// Token: 0x06001051 RID: 4177 RVA: 0x00106E8B File Offset: 0x0010508B
		public void ClearPrenatalEducationBonus(DataContext context)
		{
			this.SetBabyBonusMainAttributes(0, context);
			this.SetBabyBonusLifeSkillQualifications(0, context);
			this.SetBabyBonusCombatSkillQualifications(0, context);
		}

		// Token: 0x06001052 RID: 4178 RVA: 0x00106EA9 File Offset: 0x001050A9
		public void AddItem(DataContext context, ItemKey itemKey, int amount, sbyte itemSourceType, bool offLine = false)
		{
			this.AddItem(context, itemKey, amount, (ItemSourceType)itemSourceType, offLine);
		}

		// Token: 0x06001053 RID: 4179 RVA: 0x00106EBC File Offset: 0x001050BC
		public void AddItem(DataContext context, ItemKey itemKey, int amount, ItemSourceType itemSourceType, bool offLine = false)
		{
			switch (itemSourceType)
			{
			case ItemSourceType.Equipment:
			case ItemSourceType.Inventory:
				this._taiwuChar.AddInventoryItem(context, itemKey, amount, offLine);
				break;
			case ItemSourceType.Warehouse:
				DomainManager.Taiwu.WarehouseAdd(context, itemKey, amount);
				break;
			case ItemSourceType.Treasury:
				this.StoreItemInTreasury(context, itemKey, amount, offLine);
				break;
			case ItemSourceType.Trough:
				DomainManager.Extra.TroughAdd(context, itemKey, amount);
				break;
			case ItemSourceType.StockStorageWarehouse:
				DomainManager.Extra.AddStockStorageItem(context, 0, itemKey, amount);
				break;
			case ItemSourceType.StockStorageGoodsShelf:
				DomainManager.Extra.AddStockStorageItem(context, 1, itemKey, amount);
				break;
			default:
				if (itemSourceType != ItemSourceType.OldTreasury)
				{
					throw new ArgumentOutOfRangeException("itemSourceType", itemSourceType, null);
				}
				DomainManager.Extra.TreasuryAdd(context, itemKey, amount);
				break;
			}
		}

		// Token: 0x06001054 RID: 4180 RVA: 0x00106F80 File Offset: 0x00105180
		public void AddItemList(DataContext context, List<ItemKey> keyList, ItemSourceType itemSourceType)
		{
			Tester.Assert(keyList != null, "");
			Tester.Assert(keyList.Count > 0, "");
			foreach (ItemKey key in keyList)
			{
				this.AddItem(context, key, 1, itemSourceType, true);
			}
			this.CommitOfflineOperation(context, itemSourceType);
		}

		// Token: 0x06001055 RID: 4181 RVA: 0x00107004 File Offset: 0x00105204
		public void RemoveItem(DataContext context, ItemKey itemKey, int amount, sbyte itemSourceType, bool deleteItem, bool offLine = false)
		{
			this.RemoveItem(context, itemKey, amount, (ItemSourceType)itemSourceType, deleteItem, offLine);
		}

		// Token: 0x06001056 RID: 4182 RVA: 0x00107018 File Offset: 0x00105218
		public void RemoveItem(DataContext context, ItemKey itemKey, int amount, ItemSourceType itemSourceType, bool deleteItem, bool offLine = false)
		{
			switch (itemSourceType)
			{
			case ItemSourceType.Equipment:
			case ItemSourceType.Inventory:
				this._taiwuChar.RemoveInventoryItem(context, itemKey, amount, deleteItem, offLine);
				break;
			case ItemSourceType.Warehouse:
				DomainManager.Taiwu.WarehouseRemove(context, itemKey, amount, deleteItem);
				break;
			case ItemSourceType.Treasury:
				DomainManager.Taiwu.TakeItemFromTreasury(context, itemKey, amount, deleteItem, offLine);
				break;
			case ItemSourceType.Trough:
				DomainManager.Extra.TroughRemove(context, itemKey, amount, deleteItem);
				break;
			case ItemSourceType.StockStorageWarehouse:
				DomainManager.Extra.RemoveStockStorageItem(context, 0, itemKey, amount, deleteItem);
				break;
			case ItemSourceType.StockStorageGoodsShelf:
				DomainManager.Extra.RemoveStockStorageItem(context, 1, itemKey, amount, deleteItem);
				break;
			default:
				if (itemSourceType != ItemSourceType.OldTreasury)
				{
					throw new ArgumentOutOfRangeException("itemSourceType", itemSourceType, null);
				}
				DomainManager.Extra.TreasuryRemove(context, itemKey, amount, deleteItem);
				break;
			}
		}

		// Token: 0x06001057 RID: 4183 RVA: 0x001070F4 File Offset: 0x001052F4
		public void RemoveItemList(DataContext context, List<ItemKey> keyList, ItemSourceType itemSourceType, bool deleteItem)
		{
			Tester.Assert(keyList != null, "");
			Tester.Assert(keyList.Count > 0, "");
			foreach (ItemKey key in keyList)
			{
				this.RemoveItem(context, key, 1, itemSourceType, deleteItem, true);
			}
			this.CommitOfflineOperation(context, itemSourceType);
		}

		// Token: 0x06001058 RID: 4184 RVA: 0x00107178 File Offset: 0x00105378
		public void CommitOfflineOperation(DataContext context, ItemSourceType itemSourceType)
		{
			switch (itemSourceType)
			{
			case ItemSourceType.Equipment:
			case ItemSourceType.Inventory:
				this._taiwuChar.SetInventory(this._taiwuChar.GetInventory(), context);
				break;
			case ItemSourceType.Treasury:
			{
				SettlementTreasury settlementTreasury = this.GetTaiwuTreasury();
				this.SetTaiwuTreasury(context, settlementTreasury);
				break;
			}
			}
		}

		// Token: 0x06001059 RID: 4185 RVA: 0x001071DC File Offset: 0x001053DC
		public ItemSourceType GetNotPureStackableItemSource(ItemKey itemKey)
		{
			bool flag = !ItemTemplateHelper.IsPureStackable(itemKey);
			ItemSourceType result;
			if (flag)
			{
				result = ItemSourceType.Invalid;
			}
			else
			{
				foreach (KeyValuePair<ItemKey, int> pair in this._taiwuChar.GetInventory().Items)
				{
					bool flag2 = itemKey.Equals(pair.Key);
					if (flag2)
					{
						return ItemSourceType.Inventory;
					}
				}
				foreach (KeyValuePair<ItemKey, int> pair2 in this._warehouseItems)
				{
					bool flag3 = itemKey.Equals(pair2.Key);
					if (flag3)
					{
						return ItemSourceType.Warehouse;
					}
				}
				foreach (KeyValuePair<ItemKey, int> pair3 in DomainManager.Extra.TroughItems)
				{
					bool flag4 = itemKey.Equals(pair3.Key);
					if (flag4)
					{
						return ItemSourceType.Trough;
					}
				}
				result = ItemSourceType.Invalid;
			}
			return result;
		}

		// Token: 0x0600105A RID: 4186 RVA: 0x0010731C File Offset: 0x0010551C
		public void RemoveTaiwuItemFromTaiwuStorage(DataContext context, ItemKey itemKey, int count, bool deleteItem)
		{
			bool flag = itemKey.IsValid();
			if (flag)
			{
				int amount;
				bool flag2 = DomainManager.Taiwu.GetItems(ItemSourceType.Inventory).TryGetValue(itemKey, out amount);
				if (flag2)
				{
					DomainManager.Taiwu.RemoveItem(context, itemKey, count, 1, deleteItem && amount == count, false);
				}
				else
				{
					bool flag3 = DomainManager.Taiwu.GetItems(ItemSourceType.Warehouse).TryGetValue(itemKey, out amount);
					if (flag3)
					{
						DomainManager.Taiwu.RemoveItem(context, itemKey, count, 2, deleteItem && amount == count, false);
					}
					else
					{
						bool flag4 = DomainManager.Taiwu.GetItems(ItemSourceType.Treasury).TryGetValue(itemKey, out amount);
						if (flag4)
						{
							DomainManager.Taiwu.RemoveItem(context, itemKey, count, 3, deleteItem && amount == count, false);
						}
					}
				}
			}
		}

		// Token: 0x0600105B RID: 4187 RVA: 0x001073D8 File Offset: 0x001055D8
		public int GetTaiwuItemCountFromSources(sbyte itemType, short itemTemplateId, IList<ItemSourceType> itemSourceTypes)
		{
			bool flag = itemSourceTypes == null;
			int result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				int count = 0;
				foreach (ItemSourceType itemSourceType in itemSourceTypes)
				{
					IReadOnlyDictionary<ItemKey, int> items = DomainManager.Taiwu.GetItems(itemSourceType);
					foreach (KeyValuePair<ItemKey, int> pair in items)
					{
						bool flag2 = pair.Key.ItemType == itemType && pair.Key.TemplateId == itemTemplateId;
						if (flag2)
						{
							count += pair.Value;
						}
					}
				}
				result = count;
			}
			return result;
		}

		// Token: 0x0600105C RID: 4188 RVA: 0x001074B0 File Offset: 0x001056B0
		public bool RemoveTaiwuItemFromSources(DataContext context, sbyte itemType, short itemTemplateId, int count, IList<ItemSourceType> itemSourceTypes, bool deleteItem)
		{
			bool flag = itemSourceTypes == null;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				int totalCount = 0;
				List<ValueTuple<ItemKey, int, ItemSourceType>> itemList = new List<ValueTuple<ItemKey, int, ItemSourceType>>();
				foreach (ItemSourceType itemSourceType in itemSourceTypes)
				{
					IReadOnlyDictionary<ItemKey, int> items = DomainManager.Taiwu.GetItems(itemSourceType);
					foreach (KeyValuePair<ItemKey, int> pair in items)
					{
						bool flag2 = pair.Key.ItemType != itemType || pair.Key.TemplateId != itemTemplateId;
						if (!flag2)
						{
							totalCount += pair.Value;
							itemList.Add(new ValueTuple<ItemKey, int, ItemSourceType>(pair.Key, pair.Value, itemSourceType));
						}
					}
				}
				bool flag3 = totalCount < count;
				if (flag3)
				{
					result = false;
				}
				else
				{
					foreach (ValueTuple<ItemKey, int, ItemSourceType> valueTuple in itemList)
					{
						ItemKey key = valueTuple.Item1;
						int haveCount = valueTuple.Item2;
						ItemSourceType itemSourceType2 = valueTuple.Item3;
						bool flag4 = count <= 0;
						if (flag4)
						{
							break;
						}
						int removeCount = Math.Min(count, haveCount);
						DomainManager.Taiwu.RemoveItem(context, key, removeCount, itemSourceType2, deleteItem, false);
						count -= removeCount;
					}
					result = true;
				}
			}
			return result;
		}

		// Token: 0x0600105D RID: 4189 RVA: 0x00107658 File Offset: 0x00105858
		public bool IsTaiwuAvoidMapBlockEnemies()
		{
			return false;
		}

		// Token: 0x0600105E RID: 4190 RVA: 0x0010766C File Offset: 0x0010586C
		public bool IsTaiwuAvoidTravelingEnemies()
		{
			return DomainManager.Extra.IsProfessionalSkillUnlockedAndEquipped(28);
		}

		// Token: 0x0600105F RID: 4191 RVA: 0x0010768C File Offset: 0x0010588C
		public bool IsCharacterRelationFriendlyTaiwu(int charId)
		{
			return DomainManager.Character.IsCharacterRelationFriendly(this._taiwuCharId, charId);
		}

		// Token: 0x06001060 RID: 4192 RVA: 0x001076B0 File Offset: 0x001058B0
		[DomainMethod]
		public ValueTuple<int, int> GetRelationCharacterCountOnBlock(Location location)
		{
			ValueTuple<int, int> count = new ValueTuple<int, int>(0, 0);
			MapBlockData blockData = DomainManager.Map.GetBlock(location);
			bool flag = blockData.CharacterSet == null;
			ValueTuple<int, int> result;
			if (flag)
			{
				result = count;
			}
			else
			{
				foreach (int charId in blockData.CharacterSet)
				{
					GameData.Domains.Character.Character targetChar = DomainManager.Character.GetElement_Objects(charId);
					bool flag2 = targetChar.GetAgeGroup() == 0;
					if (!flag2)
					{
						RelatedCharacter selfToTarget;
						bool hasSelfToTargetRelation = DomainManager.Character.TryGetRelation(this._taiwuCharId, targetChar.GetId(), out selfToTarget);
						RelatedCharacter targetToSelf;
						bool hasTargetToSelfRelation = DomainManager.Character.TryGetRelation(targetChar.GetId(), this._taiwuCharId, out targetToSelf);
						bool flag3 = !hasSelfToTargetRelation && !hasTargetToSelfRelation;
						if (!flag3)
						{
							sbyte categorySelfToTarget = AiHelper.ActionTargetRelationCategory.GetTargetRelationCategory(selfToTarget.RelationType);
							sbyte categoryTargetToSelf = AiHelper.ActionTargetRelationCategory.GetTargetRelationCategory(targetToSelf.RelationType);
							bool flag4 = categorySelfToTarget == 1 || categoryTargetToSelf == 1;
							if (flag4)
							{
								count.Item1++;
							}
							bool flag5 = categorySelfToTarget == 2 || categoryTargetToSelf == 2;
							if (flag5)
							{
								count.Item2++;
							}
						}
					}
				}
				result = count;
			}
			return result;
		}

		// Token: 0x06001061 RID: 4193 RVA: 0x00107800 File Offset: 0x00105A00
		[DomainMethod]
		public int GetConsumedCountOnBlock(Location location)
		{
			int count = 0;
			bool flag = !location.IsValid();
			int result;
			if (flag)
			{
				result = count;
			}
			else
			{
				MapBlockData blockData = DomainManager.Map.GetBlock(location);
				bool flag2 = blockData.CharacterSet == null;
				if (flag2)
				{
					result = count;
				}
				else
				{
					foreach (int charId in blockData.CharacterSet)
					{
						GameData.Domains.Character.Character targetChar = DomainManager.Character.GetElement_Objects(charId);
						bool flag3 = targetChar.GetLegendaryBookOwnerState() == 3;
						if (flag3)
						{
							count++;
						}
					}
					result = count;
				}
			}
			return result;
		}

		// Token: 0x06001062 RID: 4194 RVA: 0x001078B0 File Offset: 0x00105AB0
		[DomainMethod]
		public int GetPastLifeRelationCharacterCountOnBlock(Location location)
		{
			int count = 0;
			MapBlockData blockData = DomainManager.Map.GetBlock(location);
			bool flag = blockData.CharacterSet == null;
			int result;
			if (flag)
			{
				result = count;
			}
			else
			{
				foreach (int charId in blockData.CharacterSet)
				{
					ValueTuple<ushort, ushort> categorySelfToTarget = DomainManager.Extra.GetDreamBackRelationTypeWithTaiwu(charId);
					short temp;
					bool flag2 = DomainManager.Extra.TryGetDreamBackLifeRecordByRelatedCharId(charId, out temp);
					if (flag2)
					{
						count++;
					}
					else
					{
						bool flag3 = categorySelfToTarget.Item1 != 0 && categorySelfToTarget.Item2 > 0;
						if (flag3)
						{
							count++;
						}
					}
				}
				result = count;
			}
			return result;
		}

		// Token: 0x06001063 RID: 4195 RVA: 0x00107974 File Offset: 0x00105B74
		[DomainMethod]
		public unsafe List<ItemDisplayData> ChoosyGetMaterial(DataContext context, sbyte resourceType, int count)
		{
			this._taiwuChar.ChangeResource(context, resourceType, -count * GlobalConfig.Instance.ChoosyResourceBaseCost);
			List<ItemKey> itemKeyList = new List<ItemKey>();
			List<short> materialIdList = new List<short>();
			List<ChoosyItem> choosyConfigList = new List<ChoosyItem>();
			LifeSkillShorts lifeSkillAttainments = *DomainManager.Taiwu.GetTaiwu().GetLifeSkillAttainments();
			bool flag = resourceType == 5;
			if (flag)
			{
				choosyConfigList.AddRange(Choosy.Instance.Where(delegate(ChoosyItem c)
				{
					sbyte lifeSkillType = c.LifeSkillType;
					return lifeSkillType - 8 <= 1;
				}));
			}
			else
			{
				ResourceTypeItem resourceConfig = Config.ResourceType.Instance[resourceType];
				sbyte lifeSkillType = resourceConfig.LifeSkillType;
				choosyConfigList.AddRange(from c in Choosy.Instance
				where c.LifeSkillType == lifeSkillType
				select c);
			}
			for (int i = 0; i < count; i++)
			{
				int gradeIndex = 0;
				ChoosyItem choosyConfig = choosyConfigList.GetRandom(context.Random);
				short lifeSkillAttainment = *lifeSkillAttainments[(int)choosyConfig.LifeSkillType];
				string lifeSKillName = Config.LifeSkillType.Instance[choosyConfig.LifeSkillType].Name;
				int remainRate;
				DomainManager.Extra.TryGetChoosyRemainUpgradeRate(choosyConfig.TemplateId, out remainRate);
				int remainCount;
				DomainManager.Extra.TryGetChoosyRemainUpgradeCount(choosyConfig.TemplateId, out remainCount);
				int upgradeRate = Math.Min(choosyConfig.MaxUpgradeRate, choosyConfig.BaseUpgradeRate + remainRate);
				int maxCount = Math.Min(choosyConfig.MaxUpgradeCount, choosyConfig.BaseUpgradeCount + remainCount) / 10000;
				int usedCount = 0;
				int logIndex = Math.Min(choosyConfig.GradeList.Count - 1, maxCount + 1);
				short logGrade = choosyConfig.GradeList[logIndex];
				bool success = false;
				while (usedCount < maxCount)
				{
					usedCount++;
					int random = context.Random.Next(10000);
					bool flag2 = random > 10000 - upgradeRate;
					if (flag2)
					{
						gradeIndex++;
						bool flag3 = gradeIndex >= choosyConfig.GradeList.Count - 1;
						if (flag3)
						{
							success = true;
							break;
						}
					}
				}
				bool flag4 = success;
				if (flag4)
				{
					remainRate = 0;
					remainCount = 0;
				}
				else
				{
					remainRate += choosyConfig.UpgradeRateAttainmentBonus * (int)lifeSkillAttainment / choosyConfig.AttainmentRate;
					remainRate = Math.Min(remainRate, choosyConfig.MaxUpgradeRate - choosyConfig.BaseUpgradeRate);
					remainCount += choosyConfig.UpgradeCountAttainmentBonus * (int)lifeSkillAttainment / choosyConfig.AttainmentRate;
					remainCount = Math.Min(remainCount, choosyConfig.MaxUpgradeCount - choosyConfig.BaseUpgradeCount);
				}
				bool needHalf = gradeIndex == choosyConfig.GradeList.Count - 2;
				bool flag5 = needHalf;
				if (flag5)
				{
					remainRate /= 2;
				}
				DomainManager.Extra.SetChoosyRemainUpgradeRate(choosyConfig.TemplateId, remainRate, context);
				DomainManager.Extra.SetChoosyRemainUpgradeCount(choosyConfig.TemplateId, remainCount, context);
				short grade = choosyConfig.GradeList[gradeIndex];
				materialIdList.Clear();
				Config.Material.Instance.Iterate(delegate(MaterialItem materialItem)
				{
					short templateId = materialItem.TemplateId;
					bool flag10 = templateId >= 280 && templateId <= 341;
					bool result;
					if (flag10)
					{
						result = true;
					}
					else
					{
						bool flag11 = materialItem.ResourceType == resourceType && (short)materialItem.Grade == grade && materialItem.DropRate > 0;
						if (flag11)
						{
							materialIdList.Add(materialItem.TemplateId);
						}
						result = true;
					}
					return result;
				});
				bool flag6 = materialIdList.Count > 0;
				if (flag6)
				{
					short targetId = materialIdList.GetRandom(context.Random);
					ItemKey itemKey = DomainManager.Item.CreateItem(context, 5, targetId);
					this._taiwuChar.AddInventoryItem(context, itemKey, 1, false);
					itemKeyList.Add(itemKey);
				}
			}
			itemKeyList = (from key in itemKeyList
			orderby ItemTemplateHelper.GetItemSubType(key.ItemType, key.TemplateId), ItemTemplateHelper.GetGrade(key.ItemType, key.TemplateId)
			select key).ToList<ItemKey>();
			List<ItemDisplayData> resultList = DomainManager.Item.GetItemDisplayDataListOptional(itemKeyList, this._taiwuCharId, 1, true);
			foreach (ItemDisplayData itemDisplayData in resultList)
			{
				sbyte skillType = ItemTemplateHelper.GetResourceType(itemDisplayData.Key.ItemType, itemDisplayData.Key.TemplateId);
				bool flag7 = skillType - 1 <= 3;
				bool flag8 = flag7;
				if (flag8)
				{
					MaterialItem config = Config.Material.Instance[itemDisplayData.Key.TemplateId];
					int key2 = (config.RefiningEffect < 0) ? 21 : 22;
					int seniority = ProfessionFormulaImpl.Calculate(key2, itemDisplayData.Value);
					DomainManager.Extra.ChangeProfessionSeniority(context, 2, seniority, true, false);
				}
				else
				{
					bool flag9 = skillType == 5;
					if (flag9)
					{
						int seniority2 = ProfessionFormulaImpl.Calculate(89, itemDisplayData.Value);
						DomainManager.Extra.ChangeProfessionSeniority(context, 13, seniority2, true, false);
					}
				}
			}
			return resultList;
		}

		// Token: 0x06001064 RID: 4196 RVA: 0x00107E84 File Offset: 0x00106084
		public unsafe void AddChoosyRemainUpgradeData(DataContext context)
		{
			LifeSkillShorts lifeSkillAttainments = *DomainManager.Taiwu.GetTaiwu().GetLifeSkillAttainments();
			sbyte id = 0;
			while ((int)id < Choosy.Instance.Count)
			{
				ChoosyItem choosyConfig = Choosy.Instance[(short)id];
				int upgradeCount;
				DomainManager.Extra.TryGetChoosyRemainUpgradeCount((short)id, out upgradeCount);
				int upgradeRate;
				DomainManager.Extra.TryGetChoosyRemainUpgradeRate((short)id, out upgradeRate);
				short lifeSkillAttainment = *lifeSkillAttainments[(int)choosyConfig.LifeSkillType];
				int maxAddCount = choosyConfig.UpgradeCountAttainmentBonus * (int)lifeSkillAttainment / choosyConfig.AttainmentRate;
				int maxAddRate = choosyConfig.UpgradeRateAttainmentBonus * (int)lifeSkillAttainment / choosyConfig.AttainmentRate;
				int randomAddCount = (maxAddCount > 0) ? context.Random.Next(maxAddCount) : 0;
				int randomAddRate = (maxAddRate > 0) ? context.Random.Next(maxAddRate) : 0;
				int finalAddCount = Math.Min(choosyConfig.MaxUpgradeCount, upgradeCount + randomAddCount);
				int finalAddRate = Math.Min(choosyConfig.MaxUpgradeRate, upgradeRate + randomAddRate);
				DomainManager.Extra.SetChoosyRemainUpgradeCount((short)id, finalAddCount, context);
				DomainManager.Extra.SetChoosyRemainUpgradeRate((short)id, finalAddRate, context);
				id += 1;
			}
		}

		// Token: 0x06001065 RID: 4197 RVA: 0x00107F98 File Offset: 0x00106198
		[DomainMethod]
		public void DeleteTaiwuFeature(DataContext context, short featureId)
		{
			CharacterFeatureItem config = CharacterFeature.Instance[featureId];
			bool flag = !config.CanDeleteManually;
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(31, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Can't delete feature: ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(featureId);
				defaultInterpolatedStringHandler.AppendLiteral(" manually");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			taiwuChar.RemoveFeature(context, featureId);
		}

		// Token: 0x06001066 RID: 4198 RVA: 0x00108010 File Offset: 0x00106210
		public bool IsTaiwuContainPunishmentFeature(short orgTemplateId)
		{
			List<short> featureIds = DomainManager.Taiwu.GetTaiwu().GetFeatureIds();
			List<short> punishmentFeatureIds = Organization.Instance[(int)orgTemplateId].TaiwuPunishementFeature;
			bool flag = punishmentFeatureIds == null || punishmentFeatureIds.Count == 0;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				foreach (short featureId in punishmentFeatureIds)
				{
					bool flag2 = featureIds.Contains(featureId);
					if (flag2)
					{
						return true;
					}
				}
				result = false;
			}
			return result;
		}

		// Token: 0x06001067 RID: 4199 RVA: 0x001080B0 File Offset: 0x001062B0
		public bool IsTaiwuAbleToGetTaught(GameData.Domains.Character.Character teacher)
		{
			Settlement settlement = DomainManager.Organization.GetSettlementByOrgTemplateId(2);
			sbyte stateId = DomainManager.Map.GetStateIdByAreaId(settlement.GetLocation().AreaId);
			return teacher.GetBelongMapState() != stateId || !DomainManager.Taiwu.IsTaiwuContainPunishmentFeature(2);
		}

		// Token: 0x06001068 RID: 4200 RVA: 0x00108100 File Offset: 0x00106300
		public void UpdateConsummateLevelBrokenFeature(DataContext context)
		{
			this._taiwuChar.RemoveFeatureGroup(context, 756);
			bool flag = !DomainManager.World.GetWorldFunctionsStatus(26);
			if (!flag)
			{
				bool flag2 = this._taiwuChar.GetConsummateLevel() == GlobalConfig.Instance.MaxConsummateLevel;
				if (!flag2)
				{
					this._taiwuChar.AddFeature(context, (DomainManager.World.GetMainStoryLineProgress() > 10) ? 756 : 757, false);
				}
			}
		}

		// Token: 0x06001069 RID: 4201 RVA: 0x0010817C File Offset: 0x0010637C
		public void UpdateTaiwuPunishment(DataContext context)
		{
			bool flag = this.IsTaiwuContainPunishmentFeature(13);
			if (flag)
			{
			}
		}

		// Token: 0x0600106A RID: 4202 RVA: 0x00108198 File Offset: 0x00106398
		public void AddJieqingPunishmentMonthlyEvent(DataContext context)
		{
			bool jieqingPunishmentAssassinAlreadyAdd = this.JieqingPunishmentAssassinAlreadyAdd;
			if (!jieqingPunishmentAssassinAlreadyAdd)
			{
				List<short> featureIds = this._taiwuChar.GetFeatureIds();
				for (int i = 0; i < featureIds.Count; i++)
				{
					short featureId = featureIds[i];
					bool flag = featureId >= 595 && featureId <= 599;
					if (flag)
					{
						MonthlyEventCollection monthlyEventCollection = DomainManager.World.GetMonthlyEventCollection();
						monthlyEventCollection.AddJieQingPunishmentAssassin(this._taiwuChar.GetId(), this._taiwuChar.GetLocation(), -1);
						break;
					}
				}
			}
		}

		// Token: 0x0600106B RID: 4203 RVA: 0x0010822C File Offset: 0x0010642C
		[return: TupleElementNames(new string[]
		{
			"charId",
			"action"
		})]
		public ValueTuple<int, BasePrioritizedAction> TryGetHuntTaiwuPrioritizedAction()
		{
			Settlement settlement = DomainManager.Organization.GetSettlementByOrgTemplateId(13);
			List<int> members = ObjectPool<List<int>>.Instance.Get();
			settlement.GetMembers().GetAllMembers(members);
			for (int i = 0; i < members.Count; i++)
			{
				int charId = members[i];
				BasePrioritizedAction prioritizedAction;
				bool flag = DomainManager.Character.TryGetCharacterPrioritizedAction(charId, out prioritizedAction) && prioritizedAction.ActionType == 22;
				if (flag)
				{
					ObjectPool<List<int>>.Instance.Return(members);
					return new ValueTuple<int, BasePrioritizedAction>(charId, prioritizedAction);
				}
			}
			ObjectPool<List<int>>.Instance.Return(members);
			return new ValueTuple<int, BasePrioritizedAction>(-1, null);
		}

		// Token: 0x0600106C RID: 4204 RVA: 0x001082D8 File Offset: 0x001064D8
		public void TaiwuAddFeatureTryInterruptHuntTaiwuAction(DataContext context, short featureId)
		{
			bool flag = featureId < 595 || featureId > 599;
			bool flag2 = flag;
			if (!flag2)
			{
				ValueTuple<int, BasePrioritizedAction> actionTuple = this.TryGetHuntTaiwuPrioritizedAction();
				bool flag3 = actionTuple.Item1 == -1;
				if (!flag3)
				{
					GameData.Domains.Character.Character character;
					bool flag4 = !DomainManager.Character.TryGetElement_Objects(actionTuple.Item1, out character);
					if (!flag4)
					{
						bool flag5 = !PrioritizedActionTypeHelper.CheckHuntTaiwuCondition(featureId, (int)character.GetConsummateLevel(), (int)this._taiwuChar.GetConsummateLevel());
						if (flag5)
						{
							actionTuple.Item2.OnInterrupt(context, character);
							DomainManager.Character.RemoveCharacterPrioritizedAction(context, character.GetId());
							character.ResetPrioritizedActionCooldown(context, 22, false);
						}
					}
				}
			}
		}

		// Token: 0x0600106D RID: 4205 RVA: 0x0010838C File Offset: 0x0010658C
		public void TaiwuRemoveFeatureTryInterruptHuntTaiwuAction(DataContext context, short featureId, List<short> featureIds)
		{
			bool flag = featureId < 595 || featureId > 599;
			bool flag2 = flag;
			if (!flag2)
			{
				ValueTuple<int, BasePrioritizedAction> actionTuple = this.TryGetHuntTaiwuPrioritizedAction();
				bool flag3 = actionTuple.Item1 == -1;
				if (!flag3)
				{
					GameData.Domains.Character.Character character;
					bool flag4 = !DomainManager.Character.TryGetElement_Objects(actionTuple.Item1, out character);
					if (!flag4)
					{
						bool interrupt = true;
						for (int i = 0; i < featureIds.Count; i++)
						{
							short featureIdCurr = featureIds[i];
							bool flag5 = featureIdCurr >= 595 && featureIdCurr <= 599;
							if (flag5)
							{
								interrupt = false;
							}
						}
						bool flag6 = interrupt;
						if (flag6)
						{
							actionTuple.Item2.OnInterrupt(context, character);
							DomainManager.Character.RemoveCharacterPrioritizedAction(context, character.GetId());
							character.ResetPrioritizedActionCooldown(context, 22, false);
						}
					}
				}
			}
		}

		// Token: 0x0600106E RID: 4206 RVA: 0x00108475 File Offset: 0x00106675
		[DomainMethod]
		public int GetLastCricketPlan()
		{
			return DomainManager.Extra.GetLastCricketPlan();
		}

		// Token: 0x0600106F RID: 4207 RVA: 0x00108481 File Offset: 0x00106681
		[DomainMethod]
		public void SetLastCricketPlan(DataContext context, int value)
		{
			DomainManager.Extra.SetLastCricketPlan(context, value);
		}

		// Token: 0x06001070 RID: 4208 RVA: 0x00108490 File Offset: 0x00106690
		[DomainMethod]
		public List<ItemKey> RequestValidCricketPlan(int index, CricketCombatConfig config)
		{
			List<CricketCombatPlan> plans = DomainManager.Extra.GetCricketPlans();
			CricketCombatPlan plan = plans.GetOrDefault(index);
			int num;
			if (plan != null)
			{
				List<ItemKey> crickets = plan.Crickets;
				if (crickets != null)
				{
					num = ((crickets.Count > 0) ? 1 : 0);
					goto IL_30;
				}
			}
			num = 0;
			IL_30:
			bool flag = num == 0;
			List<ItemKey> result2;
			if (flag)
			{
				result2 = null;
			}
			else
			{
				Inventory inventory = this._taiwuChar.GetInventory();
				List<ItemKey> result = new List<ItemKey>();
				foreach (ItemKey key in plan.Crickets.Where(new Func<ItemKey, bool>(inventory.Items.ContainsKey)))
				{
					GameData.Domains.Item.Cricket cricket;
					bool flag2 = DomainManager.Item.TryGetElement_Crickets(key.Id, out cricket) && cricket.Match(config);
					if (flag2)
					{
						result.Add(key);
					}
				}
				result2 = result;
			}
			return result2;
		}

		// Token: 0x06001071 RID: 4209 RVA: 0x00108580 File Offset: 0x00106780
		[DomainMethod]
		public void SetCricketPlan(DataContext context, int index, ItemKey cricket, int cricketIndex)
		{
			List<CricketCombatPlan> plans = DomainManager.Extra.GetCricketPlans();
			CricketCombatPlan plan = plans.GetOrDefault(index);
			bool flag;
			if (plan == null)
			{
				flag = false;
			}
			else
			{
				List<ItemKey> crickets = plan.Crickets;
				flag = (((crickets != null) ? new ItemKey?(crickets.GetOrDefault(cricketIndex, ItemKey.Invalid)) : null) == cricket);
			}
			bool flag2 = flag;
			if (!flag2)
			{
				bool flag3 = plan == null || plan.Crickets == null;
				if (flag3)
				{
					plan = plans.SetOrAdd(index, new CricketCombatPlan
					{
						Crickets = new List<ItemKey>()
					}, null);
				}
				plan.Crickets.SetOrAdd(cricketIndex, cricket, ItemKey.Invalid);
				DomainManager.Extra.SetCricketPlans(context, plans);
			}
		}

		// Token: 0x06001072 RID: 4210 RVA: 0x00108644 File Offset: 0x00106844
		[DomainMethod]
		public void ClearCricketPlan(DataContext context, int index)
		{
			List<CricketCombatPlan> plans = DomainManager.Extra.GetCricketPlans();
			CricketCombatPlan plan = plans.GetOrDefault(index);
			int num;
			if (plan != null)
			{
				List<ItemKey> crickets = plan.Crickets;
				if (crickets != null)
				{
					num = ((crickets.Count > 0) ? 1 : 0);
					goto IL_2D;
				}
			}
			num = 0;
			IL_2D:
			bool flag = num == 0;
			if (!flag)
			{
				plan.Crickets.Clear();
				DomainManager.Extra.SetCricketPlans(context, plans);
			}
		}

		// Token: 0x06001073 RID: 4211 RVA: 0x001086A0 File Offset: 0x001068A0
		public void ReplaceCricketPlan(DataContext context, ItemKey srcCricket, ItemKey dstCricket)
		{
			List<CricketCombatPlan> plans = DomainManager.Extra.GetCricketPlans();
			bool flag = plans.ReplaceCricket(srcCricket.Id, dstCricket);
			if (flag)
			{
				DomainManager.Extra.SetCricketPlans(context, plans);
			}
		}

		// Token: 0x06001074 RID: 4212 RVA: 0x001086D8 File Offset: 0x001068D8
		public override void PackCrossArchiveGameData(CrossArchiveGameData crossArchiveGameData)
		{
			crossArchiveGameData.PreviousTaiwuCharIds = this._previousTaiwuIds;
			if (crossArchiveGameData.WarehouseItems == null)
			{
				crossArchiveGameData.WarehouseItems = new Dictionary<ItemKey, int>();
			}
			foreach (KeyValuePair<ItemKey, int> keyValuePair in this._warehouseItems)
			{
				ItemKey itemKey3;
				int num;
				keyValuePair.Deconstruct(out itemKey3, out num);
				ItemKey itemKey = itemKey3;
				int amount = num;
				crossArchiveGameData.PackWarehouseItem(itemKey, amount);
			}
			crossArchiveGameData.TaiwuCombatSkills = this._combatSkills;
			crossArchiveGameData.TaiwuLifeSkills = this._lifeSkills;
			crossArchiveGameData.NotLearnedCombatSkills = this._notLearnCombatSkillReadingProgress;
			crossArchiveGameData.NotLearnedLifeSkills = this._notLearnLifeSkillReadingProgress;
			crossArchiveGameData.SkillBreakPlateObsoleteDict = this._skillBreakPlateObsoleteDict;
			crossArchiveGameData.SkillBreakBonusDict = this._skillBreakBonusDict;
			crossArchiveGameData.CurrCombatSkillPlanId = this._currCombatSkillPlanId;
			crossArchiveGameData.CombatSkillPlans = this._combatSkillPlans;
			crossArchiveGameData.CurrEquipmentPlanId = this._currEquipmentPlanId;
			crossArchiveGameData.WeaponInnerRatios = this._weaponInnerRatios;
			crossArchiveGameData.EquipmentsPlans = this._equipmentsPlans;
			foreach (EquipmentPlan plan in this._equipmentsPlans)
			{
				foreach (ItemKey itemKey2 in plan.Slots)
				{
					bool flag = itemKey2.IsValid();
					if (flag)
					{
						DomainManager.Item.PackCrossArchiveItem(crossArchiveGameData, itemKey2);
					}
				}
			}
			crossArchiveGameData.CurrCombatSkillAttainmentPanelPlanIds = this._currCombatSkillAttainmentPanelPlanIds;
			crossArchiveGameData.CombatSkillAttainmentPanelPlans = this._combatSkillAttainmentPanelPlans;
			crossArchiveGameData.CurrLifeSkillAttainmentPanelPlanIndex = this._currLifeSkillAttainmentPanelPlanIndex;
			crossArchiveGameData.BuildingSpaceExtraAdd = this._buildingSpaceExtraAdd;
		}

		// Token: 0x06001075 RID: 4213 RVA: 0x00108880 File Offset: 0x00106A80
		public override void UnpackCrossArchiveGameData(DataContext context, CrossArchiveGameData crossArchiveGameData)
		{
		}

		// Token: 0x06001076 RID: 4214 RVA: 0x00108884 File Offset: 0x00106A84
		public void UnpackCrossArchiveGameData_Building(DataContext context, CrossArchiveGameData crossArchiveGameData)
		{
			this._taiwuChar.ChangeResources(context, ref crossArchiveGameData.TaiwuResources);
			bool flag = crossArchiveGameData.WarehouseItems != null;
			if (flag)
			{
				foreach (KeyValuePair<ItemKey, int> pair in crossArchiveGameData.WarehouseItems)
				{
					ItemKey itemKey = DomainManager.Item.UnpackCrossArchiveItem(context, crossArchiveGameData, pair.Key);
					bool flag2 = itemKey.IsValid() && DomainManager.Item.ItemExists(itemKey);
					if (flag2)
					{
						this.WarehouseAdd(context, itemKey, pair.Value);
					}
					else
					{
						Logger logger = TaiwuDomain.Logger;
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(47, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Invalid treasury item found during dreamback: ");
						defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(itemKey);
						defaultInterpolatedStringHandler.AppendLiteral(".");
						logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
					}
				}
			}
			crossArchiveGameData.WarehouseItems = null;
			this.AddBuildingSpaceExtra(context, crossArchiveGameData.BuildingSpaceExtraAdd);
		}

		// Token: 0x06001077 RID: 4215 RVA: 0x00108998 File Offset: 0x00106B98
		public void UnpackCrossArchiveGameData_Items(DataContext context, CrossArchiveGameData crossArchiveGameData, bool overwriteWeapons)
		{
			this._curReadingBook = ItemKey.Invalid;
			this.SetCurReadingBook(this._curReadingBook, context);
			for (int i = 0; i < this._referenceBooks.Length; i++)
			{
				this._referenceBooks[i] = ItemKey.Invalid;
			}
			this.SetReferenceBooks(this._referenceBooks, context);
			this.ClearReadingBooks(context);
			crossArchiveGameData.ReadingBooks = null;
			if (overwriteWeapons)
			{
				this.SetCurrEquipmentPlanId(crossArchiveGameData.CurrEquipmentPlanId, context);
				for (int j = 0; j < 5; j++)
				{
					EquipmentPlan equipmentPlan = crossArchiveGameData.EquipmentsPlans[j];
					for (int k = 0; k < equipmentPlan.Slots.Length; k++)
					{
						ItemKey srcItemKey = equipmentPlan.Slots[k];
						bool flag = srcItemKey.IsValid();
						if (flag)
						{
							equipmentPlan.Slots[k] = DomainManager.Item.UnpackCrossArchiveItem(context, crossArchiveGameData, srcItemKey);
						}
					}
					this.SetElement_EquipmentsPlans(j, crossArchiveGameData.EquipmentsPlans[j], context);
				}
				this.SetWeaponInnerRatios(crossArchiveGameData.WeaponInnerRatios, context);
			}
			crossArchiveGameData.WeaponInnerRatios = null;
			crossArchiveGameData.EquipmentsPlans = null;
		}

		// Token: 0x06001078 RID: 4216 RVA: 0x00108AC4 File Offset: 0x00106CC4
		public void UnpackCrossArchiveGameData_LifeSkills(DataContext context, CrossArchiveGameData crossArchiveGameData)
		{
			TaiwuDomain.<>c__DisplayClass288_0 CS$<>8__locals1;
			CS$<>8__locals1.<>4__this = this;
			CS$<>8__locals1.context = context;
			Dictionary<short, TaiwuLifeSkill> dreamBackLifeSkills = crossArchiveGameData.TaiwuLifeSkills;
			bool flag = dreamBackLifeSkills != null;
			if (flag)
			{
				foreach (KeyValuePair<short, TaiwuLifeSkill> keyValuePair in dreamBackLifeSkills)
				{
					short num;
					TaiwuLifeSkill taiwuLifeSkill;
					keyValuePair.Deconstruct(out num, out taiwuLifeSkill);
					short skillId = num;
					TaiwuLifeSkill dreamBackLifeSkill = taiwuLifeSkill;
					bool flag2 = !this.<UnpackCrossArchiveGameData_LifeSkills>g__CombineDreamBackTaiwuLifeSkill|288_0(skillId, dreamBackLifeSkill, ref CS$<>8__locals1);
					if (flag2)
					{
						this.AddElement_LifeSkills(skillId, dreamBackLifeSkill, CS$<>8__locals1.context);
					}
				}
			}
			Dictionary<short, TaiwuLifeSkill> dreamBackNotLearnedLifeSkills = crossArchiveGameData.NotLearnedLifeSkills;
			bool flag3 = dreamBackNotLearnedLifeSkills != null;
			if (flag3)
			{
				foreach (KeyValuePair<short, TaiwuLifeSkill> keyValuePair in dreamBackNotLearnedLifeSkills)
				{
					short num;
					TaiwuLifeSkill taiwuLifeSkill;
					keyValuePair.Deconstruct(out num, out taiwuLifeSkill);
					short skillId2 = num;
					TaiwuLifeSkill dreamBackLifeSkill2 = taiwuLifeSkill;
					bool flag4 = !this.<UnpackCrossArchiveGameData_LifeSkills>g__CombineDreamBackTaiwuLifeSkill|288_0(skillId2, dreamBackLifeSkill2, ref CS$<>8__locals1);
					if (flag4)
					{
						this.AddElement_NotLearnLifeSkillReadingProgress(skillId2, dreamBackLifeSkill2, CS$<>8__locals1.context);
					}
				}
			}
			for (int i = 0; i < this._currLifeSkillAttainmentPanelPlanIndex.Length; i++)
			{
				this.SetElement_CurrLifeSkillAttainmentPanelPlanIndex(i, crossArchiveGameData.CurrLifeSkillAttainmentPanelPlanIndex[i], CS$<>8__locals1.context);
			}
			crossArchiveGameData.TaiwuLifeSkills = null;
			crossArchiveGameData.NotLearnedLifeSkills = null;
			crossArchiveGameData.CurrLifeSkillAttainmentPanelPlanIndex = null;
		}

		// Token: 0x06001079 RID: 4217 RVA: 0x00108C3C File Offset: 0x00106E3C
		public void UnpackCrossArchiveGameData_CombatSkills(DataContext context, CrossArchiveGameData crossArchiveGameData, bool overwriteEquipments)
		{
			TaiwuDomain.<>c__DisplayClass289_0 CS$<>8__locals1;
			CS$<>8__locals1.<>4__this = this;
			CS$<>8__locals1.context = context;
			int currDate = DomainManager.World.GetCurrDate();
			int dateDiff = currDate - DomainManager.Extra.GetFinalDateBeforeDreamBack();
			Dictionary<short, TaiwuCombatSkill> dreamBackCombatSkills = crossArchiveGameData.TaiwuCombatSkills;
			bool flag = dreamBackCombatSkills != null;
			if (flag)
			{
				foreach (KeyValuePair<short, TaiwuCombatSkill> keyValuePair in dreamBackCombatSkills)
				{
					short num;
					TaiwuCombatSkill taiwuCombatSkill;
					keyValuePair.Deconstruct(out num, out taiwuCombatSkill);
					short skillId = num;
					TaiwuCombatSkill dreamBackCombatSkill = taiwuCombatSkill;
					bool flag2 = dreamBackCombatSkill.LastClearBreakPlateTime >= 0;
					if (flag2)
					{
						dreamBackCombatSkill.LastClearBreakPlateTime += dateDiff;
					}
					bool flag3 = !this.<UnpackCrossArchiveGameData_CombatSkills>g__CombineDreamBackTaiwuCombatSkill|289_0(skillId, dreamBackCombatSkill, ref CS$<>8__locals1);
					if (flag3)
					{
						this.AddElement_CombatSkills(skillId, dreamBackCombatSkill, CS$<>8__locals1.context);
					}
				}
			}
			Dictionary<short, TaiwuCombatSkill> dreamBackNotLearnedCombatSkills = crossArchiveGameData.NotLearnedCombatSkills;
			bool flag4 = dreamBackNotLearnedCombatSkills != null;
			if (flag4)
			{
				foreach (KeyValuePair<short, TaiwuCombatSkill> keyValuePair in dreamBackNotLearnedCombatSkills)
				{
					short num;
					TaiwuCombatSkill taiwuCombatSkill;
					keyValuePair.Deconstruct(out num, out taiwuCombatSkill);
					short skillId2 = num;
					TaiwuCombatSkill dreamBackCombatSkill2 = taiwuCombatSkill;
					bool flag5 = !this.<UnpackCrossArchiveGameData_CombatSkills>g__CombineDreamBackTaiwuCombatSkill|289_0(skillId2, dreamBackCombatSkill2, ref CS$<>8__locals1);
					if (flag5)
					{
						this.AddElement_NotLearnCombatSkillReadingProgress(skillId2, dreamBackCombatSkill2, CS$<>8__locals1.context);
					}
				}
			}
			Dictionary<short, SkillBreakPlate> conflictingSkillBreakPlates = new Dictionary<short, SkillBreakPlate>();
			Dictionary<short, SkillBreakPlateObsolete> conflictingSkillBreakPlateObsoletes = new Dictionary<short, SkillBreakPlateObsolete>();
			Dictionary<short, SkillBreakBonusCollection> conflictingSkillBreakBonuses = new Dictionary<short, SkillBreakBonusCollection>();
			List<short> skillBreakPlateKeys = new List<short>();
			crossArchiveGameData.SkillBreakPlateObsoleteDict.RemoveDuplicateKeys(crossArchiveGameData.SkillBreakPlateDict, skillBreakPlateKeys);
			skillBreakPlateKeys.Clear();
			bool flag6 = crossArchiveGameData.SkillBreakPlateDict != null;
			if (flag6)
			{
				skillBreakPlateKeys.AddRange(crossArchiveGameData.SkillBreakPlateDict.Keys);
			}
			bool flag7 = crossArchiveGameData.SkillBreakPlateObsoleteDict != null;
			if (flag7)
			{
				skillBreakPlateKeys.AddRange(crossArchiveGameData.SkillBreakPlateObsoleteDict.Keys);
			}
			foreach (short skillId3 in skillBreakPlateKeys)
			{
				Dictionary<short, SkillBreakPlate> skillBreakPlateDict = crossArchiveGameData.SkillBreakPlateDict;
				SkillBreakPlate crossPlate = (skillBreakPlateDict != null) ? skillBreakPlateDict.GetValueOrDefault(skillId3) : null;
				Dictionary<short, SkillBreakPlateObsolete> skillBreakPlateObsoleteDict = crossArchiveGameData.SkillBreakPlateObsoleteDict;
				SkillBreakPlateObsolete crossPlateObsolete = (skillBreakPlateObsoleteDict != null) ? skillBreakPlateObsoleteDict.GetValueOrDefault(skillId3) : null;
				bool flag8 = crossPlate != null && crossPlateObsolete != null;
				if (flag8)
				{
					crossPlateObsolete = null;
				}
				SkillBreakPlate plate;
				SkillBreakPlateObsolete plateObsolete;
				bool flag9 = !this.GetAutoBreakPlate(CS$<>8__locals1.context, skillId3, out plate, out plateObsolete) || (plate != null && !plate.Success) || (plateObsolete != null && !plateObsolete.Finished);
				if (flag9)
				{
					bool flag10 = crossPlate != null;
					if (flag10)
					{
						DomainManager.Extra.SetOrAddSkillBreakPlate(CS$<>8__locals1.context, skillId3, crossPlate);
					}
					bool flag11 = crossPlateObsolete != null;
					if (flag11)
					{
						bool flag12 = plateObsolete == null;
						if (flag12)
						{
							this.AddElement_SkillBreakPlateObsoleteDict(skillId3, crossPlateObsolete, CS$<>8__locals1.context);
						}
						else
						{
							this.SetElement_SkillBreakPlateObsoleteDict(skillId3, crossPlateObsolete, CS$<>8__locals1.context);
						}
					}
					bool flag13 = crossPlateObsolete != null && crossPlateObsolete.Finished;
					if (flag13)
					{
						SkillBreakBonusCollection bonusCollection = crossArchiveGameData.SkillBreakBonusDict[skillId3];
						crossPlateObsolete.CalcSkillBreakBonusCollection(bonusCollection);
						this.AddElement_SkillBreakBonusDict(skillId3, bonusCollection, CS$<>8__locals1.context);
					}
				}
				else
				{
					bool flag14 = crossPlate != null;
					if (flag14)
					{
						conflictingSkillBreakPlates.Add(skillId3, crossPlate);
					}
					bool flag15 = crossPlateObsolete != null;
					if (flag15)
					{
						SkillBreakBonusCollection crossArchiveBreakBonusCollection = crossArchiveGameData.SkillBreakBonusDict[skillId3];
						conflictingSkillBreakPlateObsoletes.Add(skillId3, crossPlateObsolete);
						conflictingSkillBreakBonuses.Add(skillId3, crossArchiveBreakBonusCollection);
					}
				}
			}
			crossArchiveGameData.SkillBreakPlateDict = conflictingSkillBreakPlates;
			crossArchiveGameData.SkillBreakPlateObsoleteDict = conflictingSkillBreakPlateObsoletes;
			crossArchiveGameData.SkillBreakBonusDict = conflictingSkillBreakBonuses;
			if (overwriteEquipments)
			{
				short[] equippedCombatSkills = this._taiwuChar.GetEquippedCombatSkills();
				short[] dreamBackEquippedCombatSkills = crossArchiveGameData.TaiwuChar.GetEquippedCombatSkills();
				Array.Copy(dreamBackEquippedCombatSkills, equippedCombatSkills, equippedCombatSkills.Length);
				this._taiwuChar.SetEquippedCombatSkills(equippedCombatSkills, CS$<>8__locals1.context);
				bool flag16 = crossArchiveGameData.ExternalEquippedCombatSkills != null;
				if (flag16)
				{
					DomainManager.Extra.SetCharacterEquippedCombatSkills(CS$<>8__locals1.context, this._taiwuCharId, crossArchiveGameData.ExternalEquippedCombatSkills);
				}
				this.SetCurrCombatSkillPlanId(crossArchiveGameData.CurrCombatSkillPlanId, CS$<>8__locals1.context);
				for (int i = 0; i < this._combatSkillPlans.Length; i++)
				{
					this.SetElement_CombatSkillPlans(i, crossArchiveGameData.CombatSkillPlans[i], CS$<>8__locals1.context);
				}
				short[] dreamBackPanel = crossArchiveGameData.TaiwuChar.GetCombatSkillAttainmentPanels();
				short[] panel = this._taiwuChar.GetCombatSkillAttainmentPanels();
				dreamBackPanel.CopyTo(panel, 0);
				this._taiwuChar.SetCombatSkillAttainmentPanels(panel, CS$<>8__locals1.context);
				this.SetCombatSkillAttainmentPanelPlans(crossArchiveGameData.CombatSkillAttainmentPanelPlans, CS$<>8__locals1.context);
				this.SetCurrCombatSkillAttainmentPanelPlanIds(crossArchiveGameData.CurrCombatSkillAttainmentPanelPlanIds, CS$<>8__locals1.context);
			}
			this._taiwuChar.SetCurrNeili(this._taiwuChar.GetMaxNeili(), CS$<>8__locals1.context);
			crossArchiveGameData.CombatSkillPlans = null;
			crossArchiveGameData.CombatSkillAttainmentPanelPlans = null;
			crossArchiveGameData.CurrCombatSkillAttainmentPanelPlanIds = null;
		}

		// Token: 0x17000027 RID: 39
		// (get) Token: 0x0600107A RID: 4218 RVA: 0x00109160 File Offset: 0x00107360
		// (set) Token: 0x0600107B RID: 4219 RVA: 0x00109168 File Offset: 0x00107368
		public DebateGame Debate { get; private set; }

		// Token: 0x0600107C RID: 4220 RVA: 0x00109174 File Offset: 0x00107374
		[DomainMethod]
		public int GetIsTaiwuFirstByLuck(DataContext context, int npcId)
		{
			int taiwuLuck = 0;
			int npcLuck = 0;
			foreach (int id in this.GetGroupCharIds().GetCollection())
			{
				taiwuLuck += (int)DomainManager.Character.GetElement_Objects(id).GetPersonality(5);
			}
			GameData.Domains.Character.Character opponent = DomainManager.Character.GetElement_Objects(npcId);
			int leaderId = opponent.GetLeaderId();
			bool flag = leaderId == this._taiwuCharId;
			if (flag)
			{
				npcLuck = taiwuLuck;
			}
			else
			{
				bool flag2 = leaderId >= 0;
				if (flag2)
				{
					foreach (int charId in DomainManager.Character.GetGroup(leaderId).GetCollection())
					{
						npcLuck += (int)DomainManager.Character.GetElement_Objects(charId).GetPersonality(5);
					}
				}
				else
				{
					npcLuck += (int)opponent.GetPersonality(5);
				}
			}
			int prob = 50 + taiwuLuck - npcLuck;
			return context.Random.CheckPercentProb(prob) ? 1 : -1;
		}

		// Token: 0x0600107D RID: 4221 RVA: 0x001092AC File Offset: 0x001074AC
		[DomainMethod]
		public DebateGame DebateGameInitialize(DataContext context, sbyte type, bool isTaiwuFirst, int npcId, List<int> spectatorIds)
		{
			GameData.Domains.Character.Character taiwu = this.GetTaiwu();
			GameData.Domains.Character.Character npc = DomainManager.Character.GetElement_Objects(npcId);
			List<short> taiwuCards = taiwu.GetUnlockedDebateStrategyList();
			List<short> npcCards = npc.GetUnlockedDebateStrategyList();
			List<sbyte> taiwuCardTypes = this.DebateGameGetTaiwuSelectedCardTypes();
			List<sbyte> npcCardTypes = DomainManager.Extra.DebateGameGetPlayerSelectedStrategyCardTypes(npcId);
			int taiwuBases = (int)taiwu.GetLifeSkillAttainment(type) * context.Random.Next(DebateConstants.AttainmentToBasesPercent[0], DebateConstants.AttainmentToBasesPercent[1]) / 100;
			int npcBases = (int)npc.GetLifeSkillAttainment(type) * context.Random.Next(DebateConstants.AttainmentToBasesPercent[0], DebateConstants.AttainmentToBasesPercent[1]) / 100;
			for (int i = taiwuCards.Count - 1; i >= 0; i--)
			{
				bool flag = !taiwuCardTypes.Contains(DebateStrategy.Instance[taiwuCards[i]].LifeSkillType);
				if (flag)
				{
					taiwuCards.RemoveAt(i);
				}
			}
			for (int j = npcCards.Count - 1; j >= 0; j--)
			{
				bool flag2 = !npcCardTypes.Contains(DebateStrategy.Instance[npcCards[j]].LifeSkillType);
				if (flag2)
				{
					npcCards.RemoveAt(j);
				}
			}
			DebatePlayer playerLeft = new DebatePlayer(taiwu.GetId(), DebateConstants.MaxPressure, taiwuBases, taiwuCards);
			DebatePlayer playerRight = new DebatePlayer(npc.GetId(), DebateConstants.MaxPressure, npcBases, npcCards);
			Dictionary<IntPair, DebateNode> debateGrid = new Dictionary<IntPair, DebateNode>();
			for (int y = 0; y < DebateConstants.DebateLineCount; y++)
			{
				for (int x = 0; x < DebateConstants.DebateLineNodeCount; x++)
				{
					debateGrid[new IntPair(x, y)] = new DebateNode(x, y);
				}
			}
			this._pawnId = 0;
			this._nodeEffectId = 0;
			this._activatedStrategyId = 0;
			this._debateRevealedPawnCount = new ValueTuple<int, int>(0, 0);
			bool flag3 = spectatorIds != null;
			if (flag3)
			{
				foreach (int spectatorId in spectatorIds)
				{
					GameData.Domains.Character.Character spectator = DomainManager.Character.GetElement_Objects(spectatorId);
					bool flag4 = spectator.GetCreatingType() == 1;
					if (flag4)
					{
						bool flag5 = npc.GetCreatingType() == 1;
						if (flag5)
						{
							DomainManager.Character.TryCreateRelation(context, spectatorId, this._debateNpcId);
						}
						DomainManager.Character.TryCreateRelation(context, spectatorId, this._taiwuCharId);
					}
					this._debateSpectatorCooldownMap[spectatorId] = 0;
				}
			}
			this.Debate = new DebateGame(type, isTaiwuFirst, playerLeft, playerRight, spectatorIds ?? new List<int>(), debateGrid, false);
			this.DebateGameInitializeAi(context, npc);
			this.DebateGameInitializeStrategyActions();
			return this.Debate;
		}

		// Token: 0x0600107E RID: 4222 RVA: 0x00109574 File Offset: 0x00107774
		[DomainMethod]
		public List<int> DebateGamePickSpectators(DataContext context, sbyte lifeSkillType, int npcId, bool isTaiwu, List<int> spectatorIds)
		{
			this._debateLifeSkillType = lifeSkillType;
			this._debateNpcId = npcId;
			this._debateNpc = DomainManager.Character.GetElement_Objects(this._debateNpcId);
			List<int> result = new List<int>();
			List<int> sorted = new List<int>();
			HashSet<int> opponentGroupCharIds = new HashSet<int>();
			GameData.Domains.Character.Character opponent = DomainManager.Character.GetElement_Objects(npcId);
			bool flag = opponent.GetCreatingType() != 1;
			if (flag)
			{
				bool flag2 = !isTaiwu;
				if (flag2)
				{
					CharacterItem config = Config.Character.Instance[opponent.GetTemplateId()];
					bool flag3 = config.MinionGroupId >= 0;
					if (flag3)
					{
						MinionGroupItem minionGroup = MinionGroup.Instance[config.MinionGroupId];
						foreach (short templateId in minionGroup.Minions)
						{
							int id = DomainManager.Character.CreateNonIntelligentCharacter(context, templateId);
							result.Add(id);
							this._debateNpcSpectators.Add(id);
						}
					}
					return result;
				}
			}
			else
			{
				int leaderId = opponent.GetLeaderId();
				bool flag4 = leaderId >= 0 && leaderId != this._taiwuCharId;
				if (flag4)
				{
					foreach (int charId in DomainManager.Character.GetGroup(leaderId).GetCollection())
					{
						opponentGroupCharIds.Add(charId);
					}
				}
			}
			Location location = this.GetTaiwu().GetLocation();
			bool flag5 = location.IsValid();
			if (flag5)
			{
				List<MapBlockData> blocks = new List<MapBlockData>();
				DomainManager.Map.GetRealNeighborBlocks(location.AreaId, location.BlockId, blocks, DebateConstants.SpectatorPickRange, true);
				foreach (MapBlockData blockData in blocks)
				{
					bool flag6 = blockData.CharacterSet == null || blockData.CharacterSet.Count == 0;
					if (!flag6)
					{
						foreach (int charId2 in blockData.CharacterSet)
						{
							sorted.Add(charId2);
						}
					}
				}
			}
			else
			{
				bool flag7 = !isTaiwu;
				if (flag7)
				{
					foreach (int charId3 in opponentGroupCharIds)
					{
						sorted.Add(charId3);
					}
				}
			}
			if (isTaiwu)
			{
				foreach (int id2 in this.GetGroupCharIds().GetCollection())
				{
					sorted.Add(id2);
				}
			}
			for (int index = sorted.Count - 1; index >= 0; index--)
			{
				int charId4 = sorted[index];
				GameData.Domains.Character.Character character;
				bool flag8 = charId4 == this._debateNpcId || charId4 == this._taiwuCharId || !DomainManager.Character.TryGetElement_Objects(charId4, out character) || character.GetAgeGroup() == 0 || character.GetFeatureIds().Contains(218) || character.GetLegendaryBookOwnerState() == 3 || (isTaiwu && opponentGroupCharIds.Contains(charId4));
				if (flag8)
				{
					sorted.RemoveAt(index);
				}
			}
			bool flag9 = spectatorIds != null;
			if (flag9)
			{
				foreach (int spectatorId in spectatorIds)
				{
					sorted.Remove(spectatorId);
				}
			}
			if (isTaiwu)
			{
				sorted.Sort(new Comparison<int>(this.DebateGameCompareSpectatorByAttainment));
			}
			else
			{
				sbyte behaviorType = this._debateNpc.GetBehaviorType();
				sbyte b = behaviorType;
				sbyte b2 = b;
				if (b2 > 1)
				{
					if (b2 - 3 > 1)
					{
						sorted.Sort(new Comparison<int>(this.DebateGameCompareSpectatorByMixedImpression));
					}
					else
					{
						sorted.Sort(new Comparison<int>(this.DebateGameCompareSpectatorByTaiwuImpression));
					}
				}
				else
				{
					sorted.Sort(new Comparison<int>(this.DebateGameCompareSpectatorByNpcImpression));
				}
			}
			int count = isTaiwu ? sorted.Count : Math.Min(3, sorted.Count);
			for (int i = 0; i < count; i++)
			{
				result.Add(sorted[0]);
				sorted.RemoveAt(0);
			}
			bool flag10 = !isTaiwu;
			if (flag10)
			{
				foreach (int id3 in result)
				{
					this._debateNpcSpectators.Add(id3);
				}
			}
			return result;
		}

		// Token: 0x0600107F RID: 4223 RVA: 0x00109AC0 File Offset: 0x00107CC0
		[DomainMethod]
		public DebateGame DebateGameNextState(DataContext context)
		{
			this.Debate.DebateOperations.Clear();
			sbyte state = this.Debate.State;
			sbyte b = state;
			if (b != 0)
			{
				if (b == 1)
				{
					bool isTaiwuFirst = this.Debate.IsTaiwuFirst;
					if (isTaiwuFirst)
					{
						this.DebateGameTryApplyComment(context, false, 0);
						this.DebateGameTryApplyComment(context, false, 8);
					}
					else
					{
						this.DebateGameTryApplyComment(context, true, 0);
						this.DebateGameTryApplyComment(context, true, 8);
					}
				}
			}
			else
			{
				bool isTaiwuFirst2 = this.Debate.IsTaiwuFirst;
				if (isTaiwuFirst2)
				{
					this.DebateGameTryApplyComment(context, true, 0);
					this.DebateGameTryApplyComment(context, true, 8);
				}
				else
				{
					this.DebateGameTryApplyComment(context, false, 0);
					this.DebateGameTryApplyComment(context, false, 8);
				}
			}
			this.Debate.State = (this.Debate.State + 1) % 3;
			this._debateCardUsedCount = 0;
			this._debateBeatPawnCount = new ValueTuple<int, int>(0, 0);
			bool flag = this.Debate.State == 0;
			if (flag)
			{
				this.Debate.IsTaiwuAiProcessedInRound = false;
				this.Debate.Round++;
				this.DebateGameUpdateNodeEffects(context);
				bool flag2 = this.Debate.Round > 0;
				if (flag2)
				{
					this.DebateGameUpdatePlayerStrategyCard(context, true);
					this.DebateGameUpdatePlayerStrategyCard(context, false);
				}
				bool flag3 = this.Debate.Round > 1;
				if (flag3)
				{
					this.DebateGameRecoverResources(context, true);
					this.DebateGameRecoverResources(context, false);
					this.DebateGameRemoveDeadPawns();
				}
				this.DebateGameUpdateRoundStartStrategyEffect(context);
				bool flag4 = this.Debate.Round > DebateConstants.PressureAutoIncreaseRound;
				if (flag4)
				{
					this.DebateGameChangePlayerPressure(new ValueTuple<int, int>(DebateConstants.PressureAutoIncreaseValue, DebateConstants.PressureAutoIncreaseValue));
				}
				bool flag5 = this.Debate.Round >= DebateConstants.MaxRound && !this.Debate.IsGameOver;
				if (flag5)
				{
					this.DebateGameTryProcessEnd();
				}
			}
			bool flag6 = !this.Debate.IsGameOver;
			if (flag6)
			{
				this.DebateGameProcessState(context);
			}
			return this.Debate;
		}

		// Token: 0x06001080 RID: 4224 RVA: 0x00109CD0 File Offset: 0x00107ED0
		[DomainMethod]
		public DebateGame DebateGameMakeMove(DataContext context, IntPair coordinate, bool isTaiwu, sbyte grade, bool countAsMakeMove = true)
		{
			Tester.Assert(this.Debate.DebateGrid[coordinate].PawnId < 0, "");
			bool flag = isTaiwu && !this.Debate.IsTaiwuAi && countAsMakeMove;
			if (flag)
			{
				this.Debate.DebateOperations.Clear();
			}
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu);
			int cost = this.Debate.GetPawnGradeToBase(player.MaxBases, (int)grade);
			this.DebateGameChangePlayerBases(player, -cost, false, -1);
			bool makeMoveFailed = this.DebateGameCheckPressure(context, isTaiwu, 7);
			this.DebateGameAddPawn(context, coordinate, isTaiwu, grade, 0, makeMoveFailed);
			if (countAsMakeMove)
			{
				this.DebateGameTryApplyNoCountAsMakeMove(coordinate, isTaiwu, makeMoveFailed);
			}
			bool flag2 = makeMoveFailed;
			if (flag2)
			{
				this.DebateGameApplyPressureEffect(isTaiwu, 7, player.Pressure, -1);
			}
			return this.Debate;
		}

		// Token: 0x06001081 RID: 4225 RVA: 0x00109DA8 File Offset: 0x00107FA8
		[DomainMethod]
		public DebateGame DebateGameSetTaiwuAi(DataContext context, bool isAi)
		{
			this.Debate.DebateOperations.Clear();
			this.Debate.IsTaiwuAi = isAi;
			bool flag = isAi && this.Debate.GetIsTaiwuTurn();
			if (flag)
			{
				this.DebateGameTaiwuTurn(context);
			}
			return this.Debate;
		}

		// Token: 0x06001082 RID: 4226 RVA: 0x00109DFC File Offset: 0x00107FFC
		[DomainMethod]
		public void DebateGameSetTaiwuSelectedCardTypes(DataContext context, List<sbyte> types)
		{
			int res = 0;
			bool flag = types != null;
			if (flag)
			{
				foreach (sbyte type in types)
				{
					res |= 1 << (int)type;
				}
			}
			DomainManager.Extra.SetTaiwuSelectedDebateCardType(res, context);
		}

		// Token: 0x06001083 RID: 4227 RVA: 0x00109E68 File Offset: 0x00108068
		[DomainMethod]
		public List<sbyte> DebateGameGetTaiwuSelectedCardTypes()
		{
			int bit = DomainManager.Extra.GetTaiwuSelectedDebateCardType();
			List<sbyte> res = new List<sbyte>();
			bool flag = bit <= 0;
			List<sbyte> result;
			if (flag)
			{
				result = res;
			}
			else
			{
				for (sbyte i = 0; i < 16; i += 1)
				{
					bool flag2 = (bit & 1 << (int)i) != 0;
					if (flag2)
					{
						res.Add(i);
					}
				}
				result = res;
			}
			return result;
		}

		// Token: 0x06001084 RID: 4228 RVA: 0x00109ED0 File Offset: 0x001080D0
		[DomainMethod]
		public DebateGame DebateGameRemoveCards(bool isTaiwu, List<int> removingCards)
		{
			bool flag = isTaiwu && !this.Debate.IsTaiwuAi;
			if (flag)
			{
				this.Debate.DebateOperations.Clear();
			}
			removingCards.Sort();
			for (int i = removingCards.Count - 1; i >= 0; i--)
			{
				int index = removingCards[i];
				this.DebateGameRemovePlayerCanUseCard(isTaiwu, this.Debate.GetStrategyCardLocation(isTaiwu, 7), index, 0, true);
			}
			bool flag2 = removingCards.Count > 0;
			if (flag2)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, 4, new int[]
				{
					removingCards.Count
				}));
			}
			return this.Debate;
		}

		// Token: 0x06001085 RID: 4229 RVA: 0x00109F90 File Offset: 0x00108190
		[DomainMethod]
		public DebateGame DebateGameResetCards(bool isTaiwu)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu);
			int pressure = player.Pressure;
			player.OwnedCards.AddRange(player.UsedCards);
			player.UsedCards.Clear();
			this.DebateGameSetPlayerPressure(player, player.Pressure + GlobalConfig.Instance.DebateResetCardsPressureDelta);
			this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, 68, new int[]
			{
				player.Pressure - pressure
			}));
			return this.Debate;
		}

		// Token: 0x06001086 RID: 4230 RVA: 0x0010A020 File Offset: 0x00108220
		[DomainMethod]
		public bool DebateGameTryForceWin(DataContext context)
		{
			int taiwuVal = Math.Max(1, (int)this._taiwuChar.GetLifeSkillAttainment(this.Debate.LifeSkillType) * (100 + this.Debate.PlayerLeft.GamePoint * DebateConstants.SurrenderAttainmentFactor) / 100);
			int npcVal = Math.Max(1, (int)this._debateNpc.GetLifeSkillAttainment(this.Debate.LifeSkillType) * (100 + this.Debate.PlayerRight.GamePoint * DebateConstants.SurrenderAttainmentFactor) / 100);
			int percent = taiwuVal * GlobalConfig.Instance.DebateSurrenderFactor / npcVal + Math.Max(1, this.Debate.PlayerRight.Pressure) - DebateConstants.SurrenderBehaviorFactor[(int)this._debateNpc.GetBehaviorType()];
			return context.Random.CheckPercentProb(percent);
		}

		// Token: 0x06001087 RID: 4231 RVA: 0x0010A0EC File Offset: 0x001082EC
		[DomainMethod]
		public DebateResult DebateGameOver(DataContext context, bool isTaiwuWin, bool isSurrender)
		{
			DebateResult result = new DebateResult();
			sbyte taiwuConsummateLevel = this._taiwuChar.GetConsummateLevel();
			sbyte npcConsummateLevel = this._debateNpc.GetConsummateLevel();
			short taiwuAttainment = this._taiwuChar.GetLifeSkillAttainment(this._debateLifeSkillType);
			short npcAttainment = this._debateNpc.GetLifeSkillAttainment(this._debateLifeSkillType);
			bool npcShouldCount = this._debateNpc.GetCreatingType() == 1;
			sbyte taiwuHappiness = this._taiwuChar.GetHappiness();
			sbyte npcHappiness = this._debateNpc.GetHappiness();
			result.IsTaiwuWin = isTaiwuWin;
			if (isTaiwuWin)
			{
				this.DebateGameApplyDebateEvaluation(context, 0, true, result);
				int percent = (int)(npcAttainment * 100 / taiwuAttainment);
				bool flag = percent <= DebateConstants.BullyPercent;
				if (flag)
				{
					this.DebateGameApplyDebateEvaluation(context, 2, true, result);
				}
				else
				{
					bool flag2 = percent >= DebateConstants.OverComePercent;
					if (flag2)
					{
						this.DebateGameApplyDebateEvaluation(context, 3, true, result);
					}
				}
			}
			else
			{
				this.DebateGameApplyDebateEvaluation(context, 1, false, result);
				if (isSurrender)
				{
					this.DebateGameApplyDebateEvaluation(context, 4, false, result);
				}
			}
			foreach (int spectatorId in this.Debate.Spectators)
			{
				result.Favorability[spectatorId] = new IntPair(this.DebateGameGetSpectatorFavor(spectatorId, this._taiwuCharId), 0);
			}
			result.AddHappiness(this._taiwuCharId, result.HappinessDelta);
			result.AddHappiness(this._debateNpcId, -result.HappinessDelta);
			foreach (int spectatorId2 in this.Debate.Spectators)
			{
				GameData.Domains.Character.Character spectator = DomainManager.Character.GetElement_Objects(spectatorId2);
				bool flag3 = spectator.GetCreatingType() != 1;
				if (!flag3)
				{
					bool flag4 = this._debateNpcSpectators.Contains(spectatorId2);
					if (flag4)
					{
						spectator.ChangeHappiness(context, -result.HappinessDelta);
					}
					else
					{
						spectator.ChangeHappiness(context, result.HappinessDelta);
					}
				}
			}
			foreach (GameData.Domains.Taiwu.Debate.DebateComment comment in this.Debate.Comments)
			{
				bool flag5 = comment.PlayerId == this._taiwuCharId || npcShouldCount;
				if (flag5)
				{
					this.DebateGameApplyComment(context, comment, result);
				}
			}
			bool flag6 = result.Happiness.ContainsKey(this._taiwuCharId);
			if (flag6)
			{
				this._taiwuChar.ChangeHappiness(context, result.GetHappiness(this._taiwuCharId));
			}
			bool flag7 = result.Happiness.ContainsKey(this._debateNpcId) && this._debateNpc.GetCreatingType() == 1;
			if (flag7)
			{
				this._debateNpc.ChangeHappiness(context, result.GetHappiness(this._debateNpcId));
			}
			result.IsTaiwuWin = isTaiwuWin;
			result.Happiness[this._taiwuCharId] = new IntPair((int)taiwuHappiness, (int)this._taiwuChar.GetHappiness());
			result.Happiness[this._debateNpcId] = new IntPair((int)npcHappiness, (int)this._debateNpc.GetHappiness());
			foreach (int spectatorId3 in this.Debate.Spectators)
			{
				result.Favorability[spectatorId3] = new IntPair(result.Favorability[spectatorId3].First, this.DebateGameGetSpectatorFavor(spectatorId3, this._taiwuCharId));
			}
			int expIndex = Math.Clamp((int)npcConsummateLevel, 0, GlobalConfig.Instance.CombatGetExpBase.Length - 1);
			int exp = (int)GlobalConfig.Instance.CombatGetExpBase[expIndex];
			exp += result.ExpA;
			exp = exp * result.ExpB / 100;
			exp = exp * (100 + result.ExpCMax + result.ExpCMin) / 100;
			result.Exp = new IntPair(this._taiwuChar.GetExp(), exp);
			this._taiwuChar.ChangeExp(context, exp);
			Events.RaiseEvaluationAddExp(context, exp);
			int authorityIndex = Math.Clamp((int)npcConsummateLevel, 0, GlobalConfig.Instance.CombatGetAuthorityBase.Length - 1);
			int authority = (int)GlobalConfig.Instance.CombatGetAuthorityBase[authorityIndex];
			authority += result.AuthorityA;
			authority = authority * result.AuthorityB / 100;
			authority = authority * (100 + result.AuthorityCMax + result.AuthorityCMin) / 100;
			result.Authority = new IntPair(this._taiwuChar.GetResource(7), authority);
			this._taiwuChar.ChangeResource(context, 7, authority);
			sbyte readInLifeSkillCombatCount = DomainManager.Extra.GetReadInLifeSkillCombatCount();
			ItemKey currBook = this.GetCurReadingBook();
			SkillBookItem bookCfg = Config.SkillBook.Instance[currBook.TemplateId];
			int chanceReading = (int)(40 + (npcConsummateLevel - taiwuConsummateLevel) * 10);
			chanceReading += result.ReadRate;
			bool flag8 = readInLifeSkillCombatCount > 0 && currBook.IsValid() && this.GetTotalReadingProgress(currBook.Id) < 100 && bookCfg.LifeSkillTemplateId >= 0 && context.Random.CheckPercentProb(chanceReading);
			if (flag8)
			{
				result.ShowReadingEvent = true;
				DomainManager.Extra.SetReadInLifeSkillCombatCount(readInLifeSkillCombatCount - 1, context);
				result.ShowReadingEvent2 = this.UpdateReadingProgressInCombat(context);
				bool showReadingEvent = result.ShowReadingEvent2;
				if (showReadingEvent)
				{
					DomainManager.Extra.AddReadingEventBookId(context, currBook.Id);
				}
			}
			sbyte loopInLifeSkillCombatCount = DomainManager.Extra.GetLoopInLifeSkillCombatCount();
			short loopingNeigongTemplateId = this._taiwuChar.GetLoopingNeigong();
			CombatSkillKey skillKey = new CombatSkillKey(this._taiwuChar.GetId(), loopingNeigongTemplateId);
			int chanceLooping = (int)(40 + (npcConsummateLevel - taiwuConsummateLevel) * 10);
			chanceLooping += result.LoopRate;
			GameData.Domains.CombatSkill.CombatSkill skill;
			bool flag9 = loopInLifeSkillCombatCount > 0 && loopingNeigongTemplateId >= 0 && DomainManager.CombatSkill.TryGetElement_CombatSkills(skillKey, out skill) && skill.GetObtainedNeili() >= skill.GetTotalObtainableNeili() && context.Random.CheckPercentProb(chanceLooping);
			if (flag9)
			{
				DomainManager.Extra.SetLoopInLifeSkillCombatCount(loopInLifeSkillCombatCount - 1, context);
				this.ApplyNeigongLoopingImprovementOnce(context, 100);
				result.ShowLoopingEvent = true;
				result.ShowLoopingEvent2 = this.TryAddLoopingEvent(context, chanceLooping);
				InstantNotificationCollection instantCollection = DomainManager.World.GetInstantNotificationCollection();
				instantCollection.AddQiArtInLifeSkillCombatNoChance(loopingNeigongTemplateId);
			}
			if (isTaiwuWin)
			{
				sbyte debateLifeSkillType = this._debateLifeSkillType;
				sbyte b = debateLifeSkillType;
				if (b != 12)
				{
					if (b != 13)
					{
						ProfessionFormulaItem formula = ProfessionFormula.Instance[30];
						int addSeniority = formula.Calculate((int)npcAttainment);
						DomainManager.Extra.ChangeProfessionSeniority(context, 4, addSeniority, true, false);
					}
					else
					{
						ProfessionFormulaItem formula2 = ProfessionFormula.Instance[81];
						int addSeniority2 = formula2.Calculate((int)npcAttainment);
						DomainManager.Extra.ChangeProfessionSeniority(context, 12, addSeniority2, true, false);
					}
				}
				else
				{
					ProfessionFormulaItem formula3 = ProfessionFormula.Instance[94];
					int addSeniority3 = formula3.Calculate((int)npcAttainment);
					DomainManager.Extra.ChangeProfessionSeniority(context, 14, addSeniority3, true, false);
				}
			}
			foreach (int charId in result.Happiness.Keys)
			{
				result.CharacterDisplayDataMap[charId] = DomainManager.Character.GetCharacterDisplayData(charId);
			}
			foreach (int charId2 in result.Favorability.Keys)
			{
				result.CharacterDisplayDataMap[charId2] = DomainManager.Character.GetCharacterDisplayData(charId2);
			}
			this._debateStrategyActions = null;
			this._debateAiTaiwu = null;
			this._debateAiNpc = null;
			this.Debate = null;
			this._debateSpectatorCooldownMap.Clear();
			this._debateNpcSpectators.Clear();
			DomainManager.TaiwuEvent.RecordCombatResult(isTaiwuWin);
			return result;
		}

		// Token: 0x06001088 RID: 4232 RVA: 0x0010A900 File Offset: 0x00108B00
		private void DebateGameProcessState(DataContext context)
		{
			this.DebateGameUpdateCanMakeMoveNode();
			this.DebateGameUpdatePlayerMakeMoveCount();
			switch (this.Debate.State)
			{
			case 0:
			{
				bool isTaiwuFirst = this.Debate.IsTaiwuFirst;
				if (isTaiwuFirst)
				{
					this.DebateGameTaiwuTurn(context);
				}
				else
				{
					this.DebateGameNpcTurn(context);
				}
				break;
			}
			case 1:
			{
				bool isTaiwuFirst2 = this.Debate.IsTaiwuFirst;
				if (isTaiwuFirst2)
				{
					this.DebateGameNpcTurn(context);
				}
				else
				{
					this.DebateGameTaiwuTurn(context);
				}
				break;
			}
			case 2:
				this.DebateGamePawnTurn(context);
				break;
			}
		}

		// Token: 0x06001089 RID: 4233 RVA: 0x0010A990 File Offset: 0x00108B90
		private void DebateGameTaiwuTurn(DataContext context)
		{
			bool flag = this.Debate.IsTaiwuAi && !this.Debate.IsTaiwuAiProcessedInRound;
			if (flag)
			{
				this.DebateGameStartAiOperation(context, true);
			}
		}

		// Token: 0x0600108A RID: 4234 RVA: 0x0010A9C9 File Offset: 0x00108BC9
		private void DebateGameNpcTurn(DataContext context)
		{
			this.DebateGameStartAiOperation(context, false);
		}

		// Token: 0x0600108B RID: 4235 RVA: 0x0010A9D8 File Offset: 0x00108BD8
		private void DebateGamePawnTurn(DataContext context)
		{
			this._debateVisitedPawns.Clear();
			for (int i = 0; i < DebateConstants.DebateLineCount; i++)
			{
				this.DebateGameProcessLine(context, i);
			}
		}

		// Token: 0x0600108C RID: 4236 RVA: 0x0010AA10 File Offset: 0x00108C10
		private void DebateGameRecoverResources(DataContext context, bool isTaiwu)
		{
			DebatePlayer player = isTaiwu ? this.Debate.PlayerLeft : this.Debate.PlayerRight;
			bool noBasesRecover = this.DebateGameCheckPressure(context, isTaiwu, 5);
			bool noStrategyRecover = this.DebateGameCheckPressure(context, isTaiwu, 4);
			int strategyRecover = DebateConstants.StrategyPointRecover;
			int basesRecover = DebateConstants.BasesRecoverPercent;
			bool flag = noStrategyRecover;
			if (flag)
			{
				this.DebateGameApplyPressureEffect(isTaiwu, 4, player.Pressure, -1);
				strategyRecover = strategyRecover * DebateConstants.PressureStrategyRecoverPercent / 100;
			}
			bool flag2 = noBasesRecover;
			if (flag2)
			{
				this.DebateGameApplyPressureEffect(isTaiwu, 5, player.Pressure, -1);
				basesRecover = basesRecover * DebateConstants.PressureBasesRecoverPercent / 100;
			}
			List<DebateOperation> debateOperations = this.Debate.DebateOperations;
			sbyte type = 20;
			short templateId = 0;
			int[] array = new int[4];
			array[0] = strategyRecover;
			array[2] = basesRecover;
			debateOperations.Add(new DebateOperation(type, isTaiwu, templateId, array));
			this.DebateGameChangePlayerStrategyPoint(player, strategyRecover);
			this.DebateGameChangePlayerBases(player, player.MaxBases * basesRecover / 100, false, -1);
		}

		// Token: 0x0600108D RID: 4237 RVA: 0x0010AAF0 File Offset: 0x00108CF0
		private void DebateGameRemoveDeadPawns()
		{
			List<int> toRemoveList = ObjectPool<List<int>>.Instance.Get();
			toRemoveList.Clear();
			foreach (KeyValuePair<int, Pawn> keyValuePair in this.Debate.Pawns)
			{
				int num;
				Pawn pawn2;
				keyValuePair.Deconstruct(out num, out pawn2);
				int id = num;
				Pawn pawn = pawn2;
				bool flag = !pawn.IsAlive;
				if (flag)
				{
					toRemoveList.Add(id);
				}
			}
			foreach (int id2 in toRemoveList)
			{
				this.DebateGameRemovePawn(id2);
			}
			ObjectPool<List<int>>.Instance.Return(toRemoveList);
		}

		// Token: 0x0600108E RID: 4238 RVA: 0x0010ABD0 File Offset: 0x00108DD0
		private void DebateGameUpdateNodeEffects(DataContext context)
		{
			foreach (DebateNode node in this.Debate.DebateGrid.Values)
			{
				bool flag = node.EffectState.TemplateId >= 0;
				if (flag)
				{
					node.EffectState.Duration--;
					bool flag2 = node.EffectState.Duration <= 0;
					if (flag2)
					{
						this.DebateGameRemoveNodeEffect(node);
					}
				}
			}
			foreach (int spectatorId in this.Debate.Spectators)
			{
				bool flag3 = this._debateSpectatorCooldownMap[spectatorId] > 0;
				if (flag3)
				{
					Dictionary<int, int> debateSpectatorCooldownMap = this._debateSpectatorCooldownMap;
					int key = spectatorId;
					debateSpectatorCooldownMap[key]--;
				}
				else
				{
					bool flag4 = !context.Random.CheckPercentProb(DebateConstants.AddNodeEffectProb);
					if (!flag4)
					{
						sbyte behaviorType = DomainManager.Character.GetElement_Objects(spectatorId).GetBehaviorType();
						foreach (DebateNodeEffectItem config in ((IEnumerable<DebateNodeEffectItem>)DebateNodeEffect.Instance))
						{
							bool flag5 = config.BehaviorType == behaviorType && this.DebateGameTryAddNodeEffect(context, config.TemplateId, spectatorId);
							if (flag5)
							{
								break;
							}
						}
					}
				}
			}
			foreach (DebateNode node2 in this.Debate.DebateGrid.Values)
			{
				bool flag6 = node2.EffectState.TemplateId >= 0 && node2.PawnId >= 0;
				if (flag6)
				{
					this.DebateGameTryApplyNodeEffect(context, node2.Coordinate, EDebateNodeEffectRemoveType.Instant);
				}
			}
		}

		// Token: 0x0600108F RID: 4239 RVA: 0x0010AE0C File Offset: 0x0010900C
		private void DebateGameUpdateRoundStartStrategyEffect(DataContext context)
		{
			foreach (KeyValuePair<int, Pawn> keyValuePair in this.Debate.Pawns)
			{
				int num;
				Pawn pawn2;
				keyValuePair.Deconstruct(out num, out pawn2);
				int pawnId = num;
				Pawn pawn = pawn2;
				bool isAlive = pawn.IsAlive;
				if (isAlive)
				{
					this.DebateGameApplyPawnStrategyEffectByTriggerType(context, pawnId, EDebateStrategyTriggerType.RoundStart);
				}
			}
		}

		// Token: 0x06001090 RID: 4240 RVA: 0x0010AE88 File Offset: 0x00109088
		private void DebateGameUpdatePlayerStrategyCard(DataContext context, bool isTaiwu)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu);
			this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, -1, null));
			int addCount = Math.Min(player.OwnedCards.Count, Math.Min(GlobalConfig.Instance.DebateMaxShuffleCard, GlobalConfig.Instance.DebateMaxCanUseCards - player.CanUseCards.Count));
			bool flag = addCount <= 0;
			if (!flag)
			{
				CollectionUtils.Shuffle<short>(context.Random, player.OwnedCards);
				for (int i = 0; i < addCount; i++)
				{
					this.DebateGameAddPlayerCanUseCard(isTaiwu, this.Debate.GetStrategyCardLocation(isTaiwu, 6), 0);
				}
				this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, 3, new int[]
				{
					addCount
				}));
			}
		}

		// Token: 0x06001091 RID: 4241 RVA: 0x0010AF60 File Offset: 0x00109160
		private void DebateGameUpdateCanMakeMoveNode()
		{
			for (int y = 0; y < DebateConstants.DebateLineCount; y++)
			{
				for (int x = 0; x < DebateConstants.DebateLineNodeCount; x++)
				{
					IntPair coordinate = new IntPair(x, y);
					this.Debate.DebateGrid[coordinate].TaiwuCanMakeMove = this.Debate.GetNodeCanMakeMove(coordinate, true);
					this.Debate.DebateGrid[coordinate].NpcCanMakeMove = this.Debate.GetNodeCanMakeMove(coordinate, false);
				}
			}
		}

		// Token: 0x06001092 RID: 4242 RVA: 0x0010AFEB File Offset: 0x001091EB
		private void DebateGameUpdatePlayerMakeMoveCount()
		{
			this.Debate.PlayerLeft.MakeMoveCount = 0;
			this.Debate.PlayerRight.MakeMoveCount = 0;
		}

		// Token: 0x06001093 RID: 4243 RVA: 0x0010B010 File Offset: 0x00109210
		private void DebateGameTryProcessEnd()
		{
			bool flag = this.Debate.Round >= DebateConstants.MaxRound;
			if (flag)
			{
				this.Debate.IsTaiwuWin = ((this.Debate.PlayerLeft.GamePoint == this.Debate.PlayerRight.GamePoint) ? this.Debate.IsTaiwuFirst : (this.Debate.PlayerLeft.GamePoint > this.Debate.PlayerRight.GamePoint));
				this.Debate.IsGameOver = true;
			}
			else
			{
				bool flag2 = this.Debate.PlayerLeft.GamePoint <= 0;
				if (flag2)
				{
					this.Debate.IsTaiwuWin = (this.Debate.PlayerRight.GamePoint <= 0 && this.Debate.IsTaiwuFirst);
					this.Debate.IsGameOver = true;
				}
				else
				{
					bool flag3 = this.Debate.PlayerRight.GamePoint <= 0;
					if (flag3)
					{
						this.Debate.IsTaiwuWin = true;
						this.Debate.IsGameOver = true;
					}
				}
			}
		}

		// Token: 0x06001094 RID: 4244 RVA: 0x0010B130 File Offset: 0x00109330
		private void DebateGameExecutePawnConflict(DataContext context, int taiwuPawnId, int npcPawnId, bool isTaiwuPawnTurn)
		{
			int pawnLeftBases = this.Debate.GetPawnBases(taiwuPawnId, npcPawnId, true, true);
			int pawnRightBases = this.Debate.GetPawnBases(npcPawnId, taiwuPawnId, true, true);
			bool isTaiwuWin = pawnLeftBases > pawnRightBases || (pawnLeftBases == pawnRightBases && isTaiwuPawnTurn);
			int result = isTaiwuWin ? 0 : 1;
			bool loserPawnIsZero = isTaiwuWin ? this.Debate.Pawns[npcPawnId].IsZero : this.Debate.Pawns[taiwuPawnId].IsZero;
			bool loserPawnCurrentIsZero = isTaiwuWin ? (pawnRightBases == 0) : (pawnLeftBases == 0);
			this.DebateGameRevealPawnBasesAndStrategy(context, taiwuPawnId);
			this.DebateGameRevealPawnBasesAndStrategy(context, npcPawnId);
			int strategyId;
			bool flag = this.Debate.TryGetPawnStrategyEffectId(taiwuPawnId, 6, true, out strategyId);
			if (flag)
			{
				this.DebateGameAddStrategyRecord(true, 27, new List<short>
				{
					this.Debate.ActivatedStrategies[strategyId].TemplateId
				}, null, null);
			}
			bool flag2 = this.Debate.TryGetPawnStrategyEffectId(npcPawnId, 6, false, out strategyId);
			if (flag2)
			{
				this.DebateGameAddStrategyRecord(false, 27, new List<short>
				{
					this.Debate.ActivatedStrategies[strategyId].TemplateId
				}, null, null);
			}
			IntPair bases = new IntPair(pawnLeftBases, pawnRightBases);
			this.Debate.DebateOperations.Add(new DebateOperation(0, taiwuPawnId, npcPawnId, result, bases, this.Debate.PlayerLeft, this.Debate.PlayerRight));
			this.DebateGameProcessPawnConflictResult(context, npcPawnId, pawnLeftBases, !isTaiwuWin);
			this.DebateGameProcessPawnConflictResult(context, taiwuPawnId, pawnRightBases, isTaiwuWin);
			this.DebateGameChangePlayerPressure(isTaiwuWin ? ((loserPawnIsZero && loserPawnCurrentIsZero) ? new ValueTuple<int, int>(DebateConstants.PressureDeltaInConflict, 0) : new ValueTuple<int, int>(0, DebateConstants.PressureDeltaInConflict)) : ((loserPawnIsZero && loserPawnCurrentIsZero) ? new ValueTuple<int, int>(0, DebateConstants.PressureDeltaInConflict) : new ValueTuple<int, int>(DebateConstants.PressureDeltaInConflict, 0)));
		}

		// Token: 0x06001095 RID: 4245 RVA: 0x0010B2F4 File Offset: 0x001094F4
		private void DebateGameRevealPawnBasesAndStrategy(DataContext context, int pawnId)
		{
			Pawn pawn = this.Debate.Pawns[pawnId];
			this.DebateGameSetPawnRevealed(context, pawnId);
			foreach (int strategyId in pawn.Strategies)
			{
				bool flag = strategyId >= 0;
				if (flag)
				{
					this.Debate.ActivatedStrategies[strategyId].IsRevealed = true;
				}
			}
		}

		// Token: 0x06001096 RID: 4246 RVA: 0x0010B35C File Offset: 0x0010955C
		private void DebateGameProcessPawnConflictResult(DataContext context, int pawnId, int otherPawnBases, bool isWin)
		{
			this._oneTimeStrategyActionList.Clear();
			Pawn pawn = this.Debate.Pawns[pawnId];
			this.DebateGameApplyPawnStrategyEffectByTriggerType(context, pawnId, (!isWin) ? EDebateStrategyTriggerType.ConflictLose : EDebateStrategyTriggerType.ConflictWin);
			bool flag = !isWin;
			if (flag)
			{
				this.DebateGameSetPawnDead(context, pawnId, 0, false);
			}
			bool flag2 = pawn.IsAlive && !pawn.IsImmuneDebuff && !pawn.IsImmuneRemove;
			if (flag2)
			{
				this.DebateGameSetPawnBases(pawnId, pawn.Bases - otherPawnBases);
			}
			foreach (Action action in this._oneTimeStrategyActionList)
			{
				if (action != null)
				{
					action();
				}
			}
		}

		// Token: 0x06001097 RID: 4247 RVA: 0x0010B430 File Offset: 0x00109630
		private void DebateGameProcessLine(DataContext context, int y)
		{
			bool isTaiwuFirst = y % 2 == 0 && this.Debate.IsTaiwuFirst;
			bool isTaiwuPawnTurn = isTaiwuFirst;
			bool[] isDone = new bool[2];
			while (!isDone[0] || !isDone[1])
			{
				int ptr = isTaiwuPawnTurn ? 0 : 1;
				int direction = isTaiwuPawnTurn ? -1 : 1;
				int pawnId = -1;
				int startPos = isTaiwuPawnTurn ? (DebateConstants.DebateLineNodeCount - 1) : 0;
				bool flag = isDone[ptr];
				if (flag)
				{
					isTaiwuPawnTurn = !isTaiwuPawnTurn;
				}
				else
				{
					int x = startPos;
					while (this.Debate.GetCoordinateValid(x))
					{
						pawnId = this.Debate.DebateGrid[new IntPair(x, y)].PawnId;
						bool flag2 = pawnId >= 0 && this.Debate.Pawns[pawnId].IsOwnedByTaiwu == isTaiwuPawnTurn && !this._debateVisitedPawns.Contains(pawnId);
						if (flag2)
						{
							break;
						}
						pawnId = -1;
						x += direction;
					}
					bool flag3 = pawnId < 0;
					if (flag3)
					{
						isDone[ptr] = true;
						isTaiwuPawnTurn = !isTaiwuPawnTurn;
					}
					else
					{
						Pawn pawn = this.Debate.Pawns[pawnId];
						IntPair coordinate = this.Debate.GetPawnTargetPosition(pawnId);
						bool flag4 = !this.Debate.GetCoordinateValid(coordinate);
						if (!flag4)
						{
							this.DebateGameTryApplyPawnMoveMore(pawnId);
							this.DebateGameApplyPawnStrategyEffectByTriggerType(context, pawnId, EDebateStrategyTriggerType.PawnActing);
							bool pawnIsHalt = this.Debate.GetPawnIsHalt(pawnId);
							if (pawnIsHalt)
							{
								int strategyId;
								bool flag5 = this.Debate.TryGetPawnStrategyEffectId(pawnId, 34, !pawn.IsOwnedByTaiwu, out strategyId);
								if (flag5)
								{
									this.DebateGameAddStrategyRecord(pawn.IsOwnedByTaiwu, 61, new List<short>
									{
										this.Debate.ActivatedStrategies[strategyId].TemplateId
									}, null, null);
								}
								isTaiwuPawnTurn = !isTaiwuPawnTurn;
							}
							else
							{
								int otherId = this.Debate.DebateGrid[coordinate].PawnId;
								bool flag6 = otherId < 0;
								if (flag6)
								{
									this.DebateGamePawnMoveForward(context, pawnId);
									bool flag7 = this._debateVisitedPawns.Contains(pawnId);
									if (flag7)
									{
										this.DebateGameTryApplyPawnMoveMore(pawnId);
									}
									bool flag8 = this._debateVisitedPawns.Contains(pawnId);
									if (flag8)
									{
										isTaiwuPawnTurn = !isTaiwuPawnTurn;
									}
								}
								else
								{
									bool flag9 = this.Debate.Pawns[pawnId].IsOwnedByTaiwu == this.Debate.Pawns[otherId].IsOwnedByTaiwu;
									if (flag9)
									{
										bool flag10 = this._debateVisitedPawns.Contains(pawnId);
										if (flag10)
										{
											isTaiwuPawnTurn = !isTaiwuPawnTurn;
										}
									}
									else
									{
										int taiwuPawnId = isTaiwuPawnTurn ? pawnId : otherId;
										int npcPawnId = isTaiwuPawnTurn ? otherId : pawnId;
										this.DebateGameApplyPawnStrategyEffectByTriggerType(context, pawnId, EDebateStrategyTriggerType.ConflictStart);
										this.DebateGameApplyPawnStrategyEffectByTriggerType(context, otherId, EDebateStrategyTriggerType.ConflictStart);
										bool flag11 = pawn.IsSwitchLocation || this.Debate.Pawns[otherId].IsSwitchLocation;
										if (flag11)
										{
											IntPair taiwuCoordinate = this.Debate.Pawns[taiwuPawnId].Coordinate;
											IntPair npcCoordinate = this.Debate.Pawns[npcPawnId].Coordinate;
											this.DebateGameSetPawnCoordinate(context, taiwuPawnId, npcCoordinate, false);
											this.DebateGameSetPawnCoordinate(context, npcPawnId, taiwuCoordinate, false);
										}
										else
										{
											this.DebateGameExecutePawnConflict(context, taiwuPawnId, npcPawnId, isTaiwuPawnTurn);
											bool flag12 = this.Debate.Pawns[pawnId].IsAlive && this.Debate.GetNodeCanTeleportPawn(this.Debate.GetPawnTargetPosition(pawnId));
											if (flag12)
											{
												this.DebateGamePawnMoveForward(context, pawnId);
											}
										}
										bool flag13 = this._debateVisitedPawns.Contains(pawnId);
										if (flag13)
										{
											this.DebateGameTryApplyPawnMoveMore(pawnId);
										}
										bool flag14 = this._debateVisitedPawns.Contains(pawnId);
										if (flag14)
										{
											isTaiwuPawnTurn = !isTaiwuPawnTurn;
										}
									}
								}
							}
						}
					}
				}
			}
		}

		// Token: 0x06001098 RID: 4248 RVA: 0x0010B7F8 File Offset: 0x001099F8
		private void DebateGamePawnMoveForward(DataContext context, int pawnId)
		{
			IntPair coordinate = this.Debate.GetPawnTargetPosition(pawnId);
			bool flag = this.Debate.DebateGrid[coordinate].PawnId < 0;
			if (flag)
			{
				this.DebateGameSetPawnCoordinate(context, pawnId, coordinate, false);
			}
			this.DebateGameApplyPawnStrategyEffectByTriggerType(context, pawnId, EDebateStrategyTriggerType.PawnForward);
		}

		// Token: 0x06001099 RID: 4249 RVA: 0x0010B848 File Offset: 0x00109A48
		private void DebateGameApplyPawnDamage(DataContext context, int pawnId)
		{
			Pawn pawn = this.Debate.Pawns[pawnId];
			bool damaged = pawn.Damaged;
			if (!damaged)
			{
				this.DebateGameApplyPawnStrategyEffectByTriggerType(context, pawnId, EDebateStrategyTriggerType.PawnDamage);
				DebatePlayer loser = this.Debate.GetPlayerByPlayerIsTaiwu(!pawn.IsOwnedByTaiwu);
				DebatePlayer winner = this.Debate.GetPlayerByPlayerIsTaiwu(pawn.IsOwnedByTaiwu);
				bool flag = pawn.NodeDamage > 0;
				if (flag)
				{
					this.DebateGameChangePlayerGamePoint(loser, -pawn.NodeDamage, true, !pawn.IsOwnedByTaiwu, 4);
				}
				this.DebateGameChangePlayerGamePoint(loser, -DebateConstants.PawnDamageToGamePoint, false, !pawn.IsOwnedByTaiwu, -1);
				this.Debate.DebateOperations.Add(new DebateOperation(4, !pawn.IsOwnedByTaiwu, pawnId, pawn.Coordinate, this.Debate.PlayerLeft, this.Debate.PlayerRight));
				List<DebateOperation> debateOperations = this.Debate.DebateOperations;
				sbyte type = 20;
				bool isTaiwu = !pawn.IsOwnedByTaiwu;
				short templateId = 2;
				int[] array = new int[4];
				array[2] = DebateConstants.PawnDamageToGamePoint;
				debateOperations.Add(new DebateOperation(type, isTaiwu, templateId, array));
				foreach (PawnDamageInfo damageInfo in pawn.DamageList)
				{
					bool flag2 = !damageInfo.IsToSelf && !damageInfo.IsStrategyDamage;
					if (flag2)
					{
						this.DebateGameChangePlayerGamePoint(loser, -damageInfo.Damage, true, damageInfo.IsTaiwuCasted, -1);
					}
				}
				int damageToOpponent = DebateConstants.PawnDamageToGamePoint + pawn.DamageToOpponent;
				this.DebateGameChangePlayerGamePoint(winner, damageToOpponent * pawn.ChangeSelfGamePointByDamagePercent / 100, true, pawn.ChangeSelfGamePointByDamagePercentIsCastedByTaiwu, -1);
				foreach (PawnDamageInfo damageInfo2 in pawn.DamageList)
				{
					bool flag3 = !damageInfo2.IsToSelf && damageInfo2.IsStrategyDamage;
					if (flag3)
					{
						this.DebateGameChangePlayerGamePoint(loser, -damageInfo2.Damage, true, damageInfo2.IsTaiwuCasted, -1);
					}
				}
				foreach (PawnDamageInfo damageInfo3 in pawn.DamageList)
				{
					bool isToSelf = damageInfo3.IsToSelf;
					if (isToSelf)
					{
						this.DebateGameChangePlayerGamePoint(winner, -damageInfo3.Damage, true, damageInfo3.IsTaiwuCasted, -1);
					}
				}
				this._debateAiTaiwu.UpdateLineWeightByDamage(pawn.IsOwnedByTaiwu, pawn.Coordinate.Second);
				this._debateAiNpc.UpdateLineWeightByDamage(!pawn.IsOwnedByTaiwu, pawn.Coordinate.Second);
				this.DebateGameSetPawnDead(context, pawnId, 1, false);
				pawn.Damaged = true;
			}
		}

		// Token: 0x0600109A RID: 4250 RVA: 0x0010BB20 File Offset: 0x00109D20
		private int DebateGameGetSpectatorFavor(int spectatorId, int playerId)
		{
			RelatedCharacter relation;
			return (int)(DomainManager.Character.TryGetRelation(spectatorId, playerId, out relation) ? relation.Favorability : 0);
		}

		// Token: 0x0600109B RID: 4251 RVA: 0x0010BB4C File Offset: 0x00109D4C
		private void DebateGameApplyDebateEvaluation(DataContext context, short templateId, bool isWin, DebateResult result)
		{
			DebateEvaluationItem config = DebateEvaluation.Instance[templateId];
			result.ExpA += config.ExpA;
			result.ExpB += config.ExpB;
			result.AuthorityA += config.AuthorityA;
			result.AuthorityB += config.AuthorityB;
			result.FavorIncreaseB += config.FavorIncreaseB;
			result.FavorDecreaseB += config.FavorDecreaseB;
			result.ReadRate += config.ReadRate;
			result.LoopRate += config.LoopRate;
			result.HappinessDelta += config.HappinessDelta;
			result.Evaluations.Add(templateId);
			bool flag = config.ExpC > result.ExpCMax;
			if (flag)
			{
				result.ExpCMax = config.ExpC;
			}
			else
			{
				bool flag2 = config.ExpC < result.ExpCMin;
				if (flag2)
				{
					result.ExpCMin = config.ExpC;
				}
			}
			bool flag3 = config.AuthorityC > result.AuthorityCMax;
			if (flag3)
			{
				result.AuthorityCMax = config.AuthorityC;
			}
			else
			{
				bool flag4 = config.AuthorityC < result.AuthorityCMin;
				if (flag4)
				{
					result.AuthorityCMin = config.AuthorityC;
				}
			}
			bool flag5 = config.FavorIncreaseC > result.FavorIncreaseCMax;
			if (flag5)
			{
				result.FavorIncreaseCMax = config.FavorIncreaseC;
			}
			else
			{
				bool flag6 = config.FavorIncreaseC < result.FavorIncreaseCMin;
				if (flag6)
				{
					result.FavorIncreaseCMin = config.FavorIncreaseC;
				}
			}
			bool flag7 = config.FavorDecreaseC > result.FavorDecreaseCMax;
			if (flag7)
			{
				result.FavorDecreaseCMax = config.FavorDecreaseC;
			}
			else
			{
				bool flag8 = config.FavorDecreaseC < result.FavorDecreaseCMin;
				if (flag8)
				{
					result.FavorDecreaseCMin = config.FavorDecreaseC;
				}
			}
			bool flag9 = config.FameAction >= 0;
			if (flag9)
			{
				this._taiwuChar.RecordFameAction(context, config.FameAction, -1, 1, true);
			}
			foreach (LegacyPointReference data in config.AddLegacyPoint)
			{
				int value = isWin ? data.WinPercent : data.FailPercent;
				bool flag10 = value > 0;
				if (flag10)
				{
					DomainManager.Taiwu.AddLegacyPoint(context, data.TemplateId, value);
				}
			}
		}

		// Token: 0x0600109C RID: 4252 RVA: 0x0010BDDC File Offset: 0x00109FDC
		private void DebateGameApplyComment(DataContext context, GameData.Domains.Taiwu.Debate.DebateComment comment, DebateResult result)
		{
			bool isTaiwu = comment.PlayerId == this._taiwuCharId;
			GameData.Domains.Character.Character character = isTaiwu ? this._taiwuChar : this._debateNpc;
			DebateCommentItem config = Config.DebateComment.Instance[comment.TemplateId];
			int delta = (int)config.Favor;
			Dictionary<short, int> counts = isTaiwu ? result.TaiwuComments : result.NpcComments;
			int count;
			bool flag = counts.TryGetValue(comment.TemplateId, out count);
			if (flag)
			{
				bool flag2 = count >= DebateConstants.CommentStackLimit;
				if (flag2)
				{
					return;
				}
				Dictionary<short, int> dictionary = counts;
				short templateId = comment.TemplateId;
				dictionary[templateId]++;
			}
			else
			{
				counts[comment.TemplateId] = 1;
			}
			result.AddHappiness(comment.PlayerId, (int)config.Happiness[(int)character.GetBehaviorType()]);
			GameData.Domains.Character.Character spectator = DomainManager.Character.GetElement_Objects(comment.SpectatorId);
			bool flag3 = spectator.GetCreatingType() != 1;
			if (!flag3)
			{
				delta += result.FavorA;
				bool flag4 = delta == 0;
				if (!flag4)
				{
					bool flag5 = delta > 0;
					if (flag5)
					{
						delta = delta * result.FavorIncreaseB / 100;
						delta = delta * (100 + result.FavorIncreaseCMax + result.FavorIncreaseCMin) / 100;
					}
					else
					{
						delta = delta * result.FavorDecreaseB / 100;
						delta = delta * (100 + result.FavorDecreaseCMax + result.FavorDecreaseCMin) / 100;
					}
					DomainManager.Character.ChangeFavorabilityOptional(context, spectator, character, delta, -1);
				}
			}
		}

		// Token: 0x0600109D RID: 4253 RVA: 0x0010BF54 File Offset: 0x0010A154
		private void DebateGameTryApplyComment(DataContext context, bool isTaiwu, short templateId)
		{
			int playerId = this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu).Id;
			DebateCommentItem config = Config.DebateComment.Instance[templateId];
			if (!true)
			{
			}
			bool flag;
			switch (templateId)
			{
			case 0:
				flag = this.DebateGameComment0(isTaiwu, config.CheckValue);
				goto IL_B1;
			case 2:
				flag = this.DebateGameComment1(isTaiwu, config.CheckValue);
				goto IL_B1;
			case 4:
				flag = this.DebateGameComment2(isTaiwu, config.CheckValue);
				goto IL_B1;
			case 6:
				flag = this.DebateGameComment3(isTaiwu, config.CheckValue);
				goto IL_B1;
			case 8:
				flag = this.DebateGameComment4(isTaiwu, config.CheckValue);
				goto IL_B1;
			}
			throw new ArgumentOutOfRangeException("templateId", templateId, null);
			IL_B1:
			if (!true)
			{
			}
			bool success = flag;
			bool flag2 = !success;
			if (!flag2)
			{
				foreach (int charId in this.Debate.Spectators)
				{
					sbyte behaviorType = DomainManager.Character.GetElement_Objects(charId).GetBehaviorType();
					int favor = this.DebateGameGetSpectatorFavor(charId, playerId);
					int positivePercent = isTaiwu ? (this._debateNpcSpectators.Contains(charId) ? DebateConstants.OtherSideCommentProb : DebateConstants.SameSideCommentProb) : (this._debateNpcSpectators.Contains(charId) ? DebateConstants.SameSideCommentProb : DebateConstants.OtherSideCommentProb);
					bool isPositive = context.Random.CheckPercentProb(positivePercent + favor / DebateConstants.CommentDivider);
					bool flag3 = behaviorType != config.BehaviorType;
					if (flag3)
					{
						config = Config.DebateComment.Instance[config.Negation];
						bool flag4 = behaviorType != config.BehaviorType;
						if (flag4)
						{
							continue;
						}
					}
					bool flag5 = !context.Random.CheckPercentProb(DebateConstants.CommentProb);
					if (!flag5)
					{
						bool flag6 = config.IsPositive != isPositive;
						if (!flag6)
						{
							this.Debate.Comments.Add(new GameData.Domains.Taiwu.Debate.DebateComment(charId, playerId, config.TemplateId));
							this.Debate.DebateOperations.Add(new DebateOperation(5, isTaiwu, new IntPair(charId, playerId), config.TemplateId, this.Debate.PlayerLeft, this.Debate.PlayerRight));
							this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, 5, new int[]
							{
								charId,
								playerId,
								(int)config.TemplateId
							}));
						}
					}
				}
			}
		}

		// Token: 0x0600109E RID: 4254 RVA: 0x0010C1F8 File Offset: 0x0010A3F8
		private bool DebateGameComment0(bool isTaiwu, int value)
		{
			return this._debateCardUsedCount == value;
		}

		// Token: 0x0600109F RID: 4255 RVA: 0x0010C214 File Offset: 0x0010A414
		private bool DebateGameComment1(bool isTaiwu, int value)
		{
			bool isTaiwuMeet = this._debateRevealedPawnCount.Item1 == value;
			bool isNpcMeet = this._debateRevealedPawnCount.Item2 == value;
			bool check = isTaiwu ? isTaiwuMeet : isNpcMeet;
			bool flag = isTaiwu && isTaiwuMeet;
			if (flag)
			{
				this._debateRevealedPawnCount.Item1 = 0;
			}
			bool flag2 = !isTaiwu && isNpcMeet;
			if (flag2)
			{
				this._debateRevealedPawnCount.Item2 = 0;
			}
			return check;
		}

		// Token: 0x060010A0 RID: 4256 RVA: 0x0010C27C File Offset: 0x0010A47C
		private bool DebateGameComment2(bool isTaiwu, int value)
		{
			return this.Debate.GetPawnCount(isTaiwu) >= value;
		}

		// Token: 0x060010A1 RID: 4257 RVA: 0x0010C2A0 File Offset: 0x0010A4A0
		private bool DebateGameComment3(bool isTaiwu, int value)
		{
			return isTaiwu ? (this._debateBeatPawnCount.Item1 >= value) : (this._debateBeatPawnCount.Item2 >= value);
		}

		// Token: 0x060010A2 RID: 4258 RVA: 0x0010C2DC File Offset: 0x0010A4DC
		private bool DebateGameComment4(bool isTaiwu, int value)
		{
			return this._debateCardUsedCount != 0 && (isTaiwu ? (this.Debate.PlayerLeft.CanUseCards.Count == value) : (this.Debate.PlayerRight.CanUseCards.Count == value));
		}

		// Token: 0x060010A3 RID: 4259 RVA: 0x0010C330 File Offset: 0x0010A530
		private int DebateGameCompareSpectatorByNpcImpression(int a, int b)
		{
			int impressionA = this.DebateGameGetSpectatorFavor(a, this._debateNpcId);
			int impressionB = this.DebateGameGetSpectatorFavor(b, this._debateNpcId);
			return (impressionA == impressionB) ? (-DomainManager.Character.GetElement_Objects(a).GetLifeSkillAttainment(this._debateLifeSkillType).CompareTo(DomainManager.Character.GetElement_Objects(b).GetLifeSkillAttainment(this._debateLifeSkillType))) : (-impressionA.CompareTo(impressionB));
		}

		// Token: 0x060010A4 RID: 4260 RVA: 0x0010C3A4 File Offset: 0x0010A5A4
		private int DebateGameCompareSpectatorByTaiwuImpression(int a, int b)
		{
			int impressionA = this.DebateGameGetSpectatorFavor(a, this._taiwuCharId);
			int impressionB = this.DebateGameGetSpectatorFavor(b, this._taiwuCharId);
			return (impressionA == impressionB) ? (-DomainManager.Character.GetElement_Objects(a).GetLifeSkillAttainment(this._debateLifeSkillType).CompareTo(DomainManager.Character.GetElement_Objects(b).GetLifeSkillAttainment(this._debateLifeSkillType))) : impressionA.CompareTo(impressionB);
		}

		// Token: 0x060010A5 RID: 4261 RVA: 0x0010C418 File Offset: 0x0010A618
		private int DebateGameCompareSpectatorByMixedImpression(int a, int b)
		{
			int impressionNpcA = this.DebateGameGetSpectatorFavor(a, this._debateNpcId);
			int impressionTaiwuA = this.DebateGameGetSpectatorFavor(a, this._taiwuCharId);
			int impressionA = Math.Max(-impressionTaiwuA, impressionNpcA);
			int impressionNpcB = this.DebateGameGetSpectatorFavor(b, this._debateNpcId);
			int impressionTaiwuB = this.DebateGameGetSpectatorFavor(b, this._taiwuCharId);
			int impressionB = Math.Max(-impressionTaiwuB, impressionNpcB);
			return (impressionA == impressionB) ? (-DomainManager.Character.GetElement_Objects(a).GetLifeSkillAttainment(this._debateLifeSkillType).CompareTo(DomainManager.Character.GetElement_Objects(b).GetLifeSkillAttainment(this._debateLifeSkillType))) : (-impressionA.CompareTo(impressionB));
		}

		// Token: 0x060010A6 RID: 4262 RVA: 0x0010C4C0 File Offset: 0x0010A6C0
		private int DebateGameCompareSpectatorByAttainment(int a, int b)
		{
			return -DomainManager.Character.GetElement_Objects(a).GetLifeSkillAttainment(this._debateLifeSkillType).CompareTo(DomainManager.Character.GetElement_Objects(b).GetLifeSkillAttainment(this._debateLifeSkillType));
		}

		// Token: 0x060010A7 RID: 4263 RVA: 0x0010C508 File Offset: 0x0010A708
		private bool DebateGameCheckPressure(DataContext context, bool isTaiwu, sbyte type)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu);
			sbyte pressureType = this.Debate.GetPressureType(player.Pressure, player.MaxPressure);
			if (!true)
			{
			}
			int num;
			switch (type)
			{
			case 4:
				num = DebateConstants.ReduceStrategyRecoverProb[(int)pressureType];
				break;
			case 5:
				num = DebateConstants.ReduceBasesRecoverProb[(int)pressureType];
				break;
			case 6:
				num = DebateConstants.UseStrategyFailedProb[(int)pressureType];
				break;
			case 7:
				num = DebateConstants.MakeMoveFailedProb[(int)pressureType];
				break;
			default:
				num = 0;
				break;
			}
			if (!true)
			{
			}
			int chance = num;
			return context.Random.CheckPercentProb(chance);
		}

		// Token: 0x060010A8 RID: 4264 RVA: 0x0010C5A0 File Offset: 0x0010A7A0
		private void DebateGameApplyPressureEffect(bool isTaiwu, sbyte type, int pressure, short templateId = -1)
		{
			switch (type)
			{
			case 4:
			{
				List<DebateOperation> debateOperations = this.Debate.DebateOperations;
				sbyte type2 = 20;
				short templateId2 = 14;
				int[] array = new int[3];
				array[1] = pressure;
				debateOperations.Add(new DebateOperation(type2, isTaiwu, templateId2, array));
				break;
			}
			case 5:
			{
				List<DebateOperation> debateOperations2 = this.Debate.DebateOperations;
				sbyte type3 = 20;
				short templateId3 = 13;
				int[] array2 = new int[3];
				array2[1] = pressure;
				debateOperations2.Add(new DebateOperation(type3, isTaiwu, templateId3, array2));
				break;
			}
			case 6:
				this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, 16, new int[]
				{
					0,
					pressure,
					(int)templateId
				}));
				break;
			case 7:
			{
				List<DebateOperation> debateOperations3 = this.Debate.DebateOperations;
				sbyte type4 = 20;
				short templateId4 = 15;
				int[] array3 = new int[3];
				array3[1] = pressure;
				debateOperations3.Add(new DebateOperation(type4, isTaiwu, templateId4, array3));
				break;
			}
			}
		}

		// Token: 0x060010A9 RID: 4265 RVA: 0x0010C670 File Offset: 0x0010A870
		private void DebateGameTryApplyNodeEffect(DataContext context, IntPair coordinate, EDebateNodeEffectRemoveType type)
		{
			bool flag = !this.Debate.GetCoordinateValid(coordinate);
			if (!flag)
			{
				DebateNode node = this.Debate.DebateGrid[coordinate];
				bool flag2 = node.PawnId < 0;
				if (!flag2)
				{
					Pawn pawn = this.Debate.Pawns[node.PawnId];
					pawn.ResetNodeValue();
					DebateNodeEffectState nodeEffect = node.EffectState;
					bool flag3 = nodeEffect.TemplateId < 0;
					if (!flag3)
					{
						DebateNodeEffectItem config = DebateNodeEffect.Instance[nodeEffect.TemplateId];
						int value = 0;
						if (!true)
						{
						}
						List<IntPair> list;
						if (type != EDebateNodeEffectRemoveType.Instant)
						{
							if (type != EDebateNodeEffectRemoveType.Trigger)
							{
								throw new ArgumentOutOfRangeException("type", type, null);
							}
							list = config.TriggerEffectList;
						}
						else
						{
							list = config.InstantEffectList;
						}
						if (!true)
						{
						}
						List<IntPair> effectList = list;
						bool flag4 = effectList.Count == 0;
						if (!flag4)
						{
							DebateOperation operation = new DebateOperation(19, nodeEffect, node.Coordinate, pawn.IsOwnedByTaiwu);
							this.Debate.DebateOperations.Add(operation);
							bool flag5 = config.RemoveType.Contains(type);
							if (flag5)
							{
								this.DebateGameRemoveNodeEffect(node);
							}
							foreach (IntPair effect in effectList)
							{
								Action<DebateStrategyActionParams> action;
								bool flag6 = this._debateStrategyActions.TryGetValue(effect.First, out action);
								if (flag6)
								{
									value = effect.Second;
									DebateStrategyActionParams param = new DebateStrategyActionParams
									{
										Context = context,
										PawnId = node.PawnId,
										Value = effect.Second,
										NodeEffect = nodeEffect,
										Coordinate = node.Coordinate,
										IsCastedByTaiwu = pawn.IsOwnedByTaiwu
									};
									action(param);
								}
							}
							bool flag7 = config.DebateRecord >= 0;
							if (flag7)
							{
								int[] param2 = this.DebateGameGetDebateNodeRecordParameters(config.DebateRecord, nodeEffect, value);
								this.Debate.DebateOperations.Add(new DebateOperation(20, pawn.IsOwnedByTaiwu, config.DebateRecord, param2));
							}
						}
					}
				}
			}
		}

		// Token: 0x060010AA RID: 4266 RVA: 0x0010C8A8 File Offset: 0x0010AAA8
		private void DebateGameTryApplyPawnMoveMore(int pawnId)
		{
			Pawn pawn = this.Debate.Pawns[pawnId];
			bool flag = !pawn.IsAlive;
			if (!flag)
			{
				bool nodeIsContainingEffect = this.Debate.GetNodeIsContainingEffect(pawn.Coordinate, 44);
				if (nodeIsContainingEffect)
				{
					int[] param = this.DebateGameGetDebateNodeRecordParameters(7, this.Debate.DebateGrid[pawn.Coordinate].EffectState, 1);
					this._debateVisitedPawns.Remove(pawnId);
					this.DebateGameRemoveNodeEffect(this.Debate.DebateGrid[pawn.Coordinate]);
					this.Debate.DebateOperations.Add(new DebateOperation(20, pawn.IsOwnedByTaiwu, 7, param));
				}
				else
				{
					this._debateVisitedPawns.Add(pawnId);
				}
			}
		}

		// Token: 0x060010AB RID: 4267 RVA: 0x0010C974 File Offset: 0x0010AB74
		private void DebateGameTryApplyNoCountAsMakeMove(IntPair coordinate, bool isTaiwu, bool makeMoveFailed)
		{
			bool nodeIsContainingEffect = this.Debate.GetNodeIsContainingEffect(coordinate, 41);
			if (nodeIsContainingEffect)
			{
				DebateNode node = this.Debate.DebateGrid[coordinate];
				DebateNodeEffectState effect = node.EffectState;
				int[] param = this.DebateGameGetDebateNodeRecordParameters(9, effect, 1);
				this.Debate.DebateOperations.Add(new DebateOperation(19, effect, node.Coordinate, isTaiwu));
				this.DebateGameRemoveNodeEffect(this.Debate.DebateGrid[coordinate]);
				bool flag = !makeMoveFailed;
				if (flag)
				{
					this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, 9, param));
				}
			}
			else
			{
				this.DebateGameChangePlayerMakeMoveCount(this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu), 1);
				bool flag2 = !makeMoveFailed;
				if (flag2)
				{
					List<DebateOperation> debateOperations = this.Debate.DebateOperations;
					sbyte type = 20;
					short templateId = 1;
					int[] array = new int[2];
					array[0] = 1;
					debateOperations.Add(new DebateOperation(type, isTaiwu, templateId, array));
				}
			}
		}

		// Token: 0x060010AC RID: 4268 RVA: 0x0010CA64 File Offset: 0x0010AC64
		private int[] DebateGameGetDebateNodeRecordParameters(short templateId, DebateNodeEffectState effect, int value)
		{
			DebateRecordItem config = DebateRecord.Instance[templateId];
			int[] res = new int[config.Parameters.Length];
			for (int i = 0; i < config.Parameters.Length; i++)
			{
				int[] array = res;
				int num = i;
				EDebateRecordParamType edebateRecordParamType = config.Parameters[i];
				if (!true)
				{
				}
				int num2;
				if (edebateRecordParamType != EDebateRecordParamType.IntValue)
				{
					switch (edebateRecordParamType)
					{
					case EDebateRecordParamType.NodeEffect:
						num2 = effect.Id;
						break;
					case EDebateRecordParamType.Character:
						num2 = (effect.IsHelpTaiwu ? this._debateNpcId : this._taiwuCharId);
						break;
					case EDebateRecordParamType.Spectator:
						num2 = effect.CasterId;
						break;
					default:
						num2 = 0;
						break;
					}
				}
				else
				{
					num2 = value;
				}
				if (!true)
				{
				}
				array[num] = num2;
			}
			return res;
		}

		// Token: 0x060010AD RID: 4269 RVA: 0x0010CB24 File Offset: 0x0010AD24
		private bool DebateGameGetSpectatorHelpTaiwu(DataContext context, int spectatorId, bool isTaiwu)
		{
			bool isSpectatorTaiwuSide = !this._debateNpcSpectators.Contains(spectatorId);
			int favor = this.DebateGameGetSpectatorFavor(spectatorId, this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu).Id);
			int prob = DebateConstants.SpectatorHelpSameSideBase + favor / DebateConstants.SpectatorHelpSameSideDivider;
			return context.Random.CheckPercentProb(prob) == isSpectatorTaiwuSide;
		}

		// Token: 0x060010AE RID: 4270 RVA: 0x0010CB7C File Offset: 0x0010AD7C
		private bool DebateGameTryAddNodeEffect(DataContext context, short templateId, int spectatorId)
		{
			bool isSpectatorTaiwuSide = !this._debateNpcSpectators.Contains(spectatorId);
			bool isHelpTaiwu = this.DebateGameGetSpectatorHelpTaiwu(context, spectatorId, isSpectatorTaiwuSide);
			bool rebelResult = context.Random.CheckPercentProb(DebateConstants.SpectatorHelpSameSideBase);
			if (!true)
			{
			}
			List<DebateNode> list2;
			switch (templateId)
			{
			case 0:
				list2 = this.DebateGameGetAvailableNodeJust(isHelpTaiwu);
				break;
			case 1:
				list2 = this.DebateGameGetAvailableNodeKind(isHelpTaiwu);
				break;
			case 2:
				list2 = this.DebateGameGetAvailableNodeEven(isHelpTaiwu);
				break;
			case 3:
				list2 = this.DebateGameGetAvailableNodeRebel(rebelResult);
				break;
			case 4:
				list2 = this.DebateGameGetAvailableNodeEgoistic(isHelpTaiwu);
				break;
			default:
				list2 = null;
				break;
			}
			if (!true)
			{
			}
			List<DebateNode> list = list2;
			bool flag = list == null;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				CollectionUtils.Shuffle<DebateNode>(context.Random, list);
				this.DebateGameAddNodeEffect(list[0], templateId, spectatorId, isHelpTaiwu);
				result = true;
			}
			return result;
		}

		// Token: 0x060010AF RID: 4271 RVA: 0x0010CC4C File Offset: 0x0010AE4C
		private List<DebateNode> DebateGameGetAvailableNodeJust(bool isTaiwuSide)
		{
			List<DebateNode> res = null;
			int startNode = this.Debate.GetStartCoordinate(!isTaiwuSide);
			foreach (DebateNode node in this.Debate.DebateGrid.Values)
			{
				bool flag = node.Coordinate.First == startNode;
				if (!flag)
				{
					bool flag2 = node.PawnId < 0;
					if (!flag2)
					{
						bool flag3 = this.Debate.Pawns[node.PawnId].IsOwnedByTaiwu == isTaiwuSide;
						if (!flag3)
						{
							bool isRevealed = this.Debate.Pawns[node.PawnId].IsRevealed;
							if (!isRevealed)
							{
								bool flag4 = node.EffectState.TemplateId >= 0;
								if (!flag4)
								{
									if (res == null)
									{
										res = new List<DebateNode>();
									}
									res.Add(node);
								}
							}
						}
					}
				}
			}
			bool flag5 = res != null;
			List<DebateNode> result;
			if (flag5)
			{
				result = res;
			}
			else
			{
				foreach (DebateNode node2 in this.Debate.DebateGrid.Values)
				{
					bool flag6 = node2.Coordinate.First == startNode;
					if (!flag6)
					{
						bool flag7 = node2.IsVantage == isTaiwuSide;
						if (!flag7)
						{
							bool flag8 = node2.EffectState.TemplateId >= 0;
							if (!flag8)
							{
								if (res == null)
								{
									res = new List<DebateNode>();
								}
								res.Add(node2);
							}
						}
					}
				}
				result = res;
			}
			return result;
		}

		// Token: 0x060010B0 RID: 4272 RVA: 0x0010CE18 File Offset: 0x0010B018
		private List<DebateNode> DebateGameGetAvailableNodeKind(bool isTaiwuSide)
		{
			List<DebateNode> res = null;
			int startNode = this.Debate.GetStartCoordinate(isTaiwuSide);
			foreach (DebateNode node in this.Debate.DebateGrid.Values)
			{
				bool flag = node.Coordinate.First == startNode;
				if (!flag)
				{
					bool flag2 = node.IsVantage != isTaiwuSide;
					if (!flag2)
					{
						bool flag3 = node.PawnId >= 0;
						if (!flag3)
						{
							bool flag4 = node.EffectState.TemplateId >= 0;
							if (!flag4)
							{
								if (res == null)
								{
									res = new List<DebateNode>();
								}
								res.Add(node);
							}
						}
					}
				}
			}
			return res;
		}

		// Token: 0x060010B1 RID: 4273 RVA: 0x0010CEF4 File Offset: 0x0010B0F4
		private List<DebateNode> DebateGameGetAvailableNodeEven(bool isTaiwuSide)
		{
			List<DebateNode> res = null;
			int startNode = this.Debate.GetStartCoordinate(isTaiwuSide);
			foreach (DebateNode node in this.Debate.DebateGrid.Values)
			{
				bool flag = node.Coordinate.First == startNode;
				if (!flag)
				{
					bool flag2 = node.IsVantage != isTaiwuSide;
					if (!flag2)
					{
						bool flag3 = node.EffectState.TemplateId >= 0;
						if (!flag3)
						{
							bool flag4 = node.PawnId >= 0;
							if (!flag4)
							{
								if (res == null)
								{
									res = new List<DebateNode>();
								}
								res.Add(node);
							}
						}
					}
				}
			}
			bool flag5 = res == null;
			if (flag5)
			{
				foreach (DebateNode node2 in this.Debate.DebateGrid.Values)
				{
					bool flag6 = node2.Coordinate.First == startNode;
					if (!flag6)
					{
						bool flag7 = node2.IsVantage != isTaiwuSide;
						if (!flag7)
						{
							bool flag8 = node2.EffectState.TemplateId >= 0;
							if (!flag8)
							{
								if (res == null)
								{
									res = new List<DebateNode>();
								}
								res.Add(node2);
							}
						}
					}
				}
			}
			return res;
		}

		// Token: 0x060010B2 RID: 4274 RVA: 0x0010D080 File Offset: 0x0010B280
		private List<DebateNode> DebateGameGetAvailableNodeRebel(bool decide)
		{
			bool flag = !decide;
			List<DebateNode> result;
			if (flag)
			{
				result = null;
			}
			else
			{
				List<DebateNode> res = null;
				int startNode0 = this.Debate.GetStartCoordinate(true);
				int startNode = this.Debate.GetStartCoordinate(false);
				foreach (DebateNode node in this.Debate.DebateGrid.Values)
				{
					bool flag2 = node.Coordinate.First == startNode0;
					if (!flag2)
					{
						bool flag3 = node.Coordinate.First == startNode;
						if (!flag3)
						{
							bool flag4 = node.PawnId >= 0;
							if (!flag4)
							{
								bool flag5 = node.EffectState.TemplateId >= 0;
								if (!flag5)
								{
									if (res == null)
									{
										res = new List<DebateNode>();
									}
									res.Add(node);
								}
							}
						}
					}
				}
				result = res;
			}
			return result;
		}

		// Token: 0x060010B3 RID: 4275 RVA: 0x0010D184 File Offset: 0x0010B384
		private List<DebateNode> DebateGameGetAvailableNodeEgoistic(bool isTaiwuSide)
		{
			List<DebateNode> res = null;
			int startNode = this.Debate.GetStartCoordinate(!isTaiwuSide);
			foreach (DebateNode node in this.Debate.DebateGrid.Values)
			{
				bool flag = node.Coordinate.First != startNode;
				if (!flag)
				{
					bool flag2 = node.EffectState.TemplateId >= 0;
					if (!flag2)
					{
						if (res == null)
						{
							res = new List<DebateNode>();
						}
						res.Add(node);
					}
				}
			}
			return res;
		}

		// Token: 0x060010B4 RID: 4276 RVA: 0x0010D23C File Offset: 0x0010B43C
		private void DebateGameInitializeAi(DataContext context, GameData.Domains.Character.Character npc)
		{
			this._debateAiTaiwu = new DebateAi(true, this._taiwuChar.GetBehaviorType());
			this._debateAiNpc = new DebateAi(false, npc.GetBehaviorType());
			this._debateAiTaiwu.Initialize(context);
			this._debateAiNpc.Initialize(context);
		}

		// Token: 0x060010B5 RID: 4277 RVA: 0x0010D290 File Offset: 0x0010B490
		private void DebateGameStartAiOperation(DataContext context, bool isTaiwu)
		{
			if (isTaiwu)
			{
				this.Debate.IsTaiwuAiProcessedInRound = true;
			}
			DebateAi ai = isTaiwu ? this._debateAiTaiwu : this._debateAiNpc;
			ai.Start(context);
		}

		// Token: 0x060010B6 RID: 4278 RVA: 0x0010D2C9 File Offset: 0x0010B4C9
		[DomainMethod]
		public void GmCmd_SetForceAiBribery(bool value)
		{
			this._forceAiBribery = value;
		}

		// Token: 0x060010B7 RID: 4279 RVA: 0x0010D2D4 File Offset: 0x0010B4D4
		[DomainMethod]
		public OperationForceAdversary GetAiBriberyDataOnPrepareLifeSkillCombat(DataContext context, int charId)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			int prob = 0;
			switch (character.GetBehaviorType())
			{
			case 2:
				prob = 10;
				break;
			case 3:
				prob = 13;
				break;
			case 4:
				prob = 16;
				break;
			}
			bool flag = DomainManager.Extra.GetAiActionRateAdjust(charId, 11, -1) != 0;
			if (flag)
			{
				prob = 0;
			}
			bool forceAiBribery = this._forceAiBribery;
			if (forceAiBribery)
			{
				prob = 100;
			}
			bool flag2 = context.Random.CheckPercentProb(prob);
			if (flag2)
			{
				bool useSecretInformation = false;
				switch (character.GetBehaviorType())
				{
				case 1:
					useSecretInformation = context.Random.CheckPercentProb(70);
					break;
				case 2:
					useSecretInformation = context.Random.CheckPercentProb(50);
					break;
				case 3:
					useSecretInformation = context.Random.CheckPercentProb(80);
					break;
				case 4:
					useSecretInformation = context.Random.CheckPercentProb(40);
					break;
				}
				bool flag3 = useSecretInformation;
				if (flag3)
				{
					SecretInformationDisplayPackage secretInformation = DomainManager.Taiwu.PickLifeSkillCombatCharacterUseSecretInformation(context, charId);
					bool flag4 = secretInformation != null && secretInformation.SecretInformationDisplayDataList.Count > 0;
					if (flag4)
					{
						return new OperationForceAdversary(0, 0, secretInformation);
					}
				}
				ItemDisplayData item = DomainManager.Taiwu.PickLifeSkillCombatCharacterUseItem(context, charId);
				bool flag5 = item != null;
				if (flag5)
				{
					return new OperationForceAdversary(0, 0, item);
				}
			}
			return null;
		}

		// Token: 0x060010B8 RID: 4280 RVA: 0x0010D444 File Offset: 0x0010B644
		private bool DebateGameSetPlayerPressure(DebatePlayer player, int value)
		{
			ValueTuple<int, int> gamePointAndPressureDelta = this.Debate.GetGamePointAndPressureDelta(player, value);
			int pressure = gamePointAndPressureDelta.Item1;
			int gamePointDelta = gamePointAndPressureDelta.Item2;
			player.Pressure = pressure;
			player.HighestPressure = Math.Max(player.Pressure, player.HighestPressure);
			bool flag = gamePointDelta < 0;
			if (flag)
			{
				bool isTaiwu = player.Id == this.Debate.PlayerLeft.Id;
				player.GamePoint = Math.Max(0, player.GamePoint + gamePointDelta);
				this.Debate.DebateOperations.Add(new DebateOperation(9, isTaiwu, this.Debate.PlayerLeft, this.Debate.PlayerRight, -1));
				List<DebateOperation> debateOperations = this.Debate.DebateOperations;
				sbyte type = 20;
				bool isTaiwu2 = isTaiwu;
				short templateId = 12;
				int[] array = new int[4];
				array[1] = pressure;
				array[2] = Math.Abs(gamePointDelta);
				debateOperations.Add(new DebateOperation(type, isTaiwu2, templateId, array));
			}
			return player.GamePoint == 0;
		}

		// Token: 0x060010B9 RID: 4281 RVA: 0x0010D531 File Offset: 0x0010B731
		private void DebateGameChangePlayerMakeMoveCount(DebatePlayer player, int delta)
		{
			player.MakeMoveCount += delta;
		}

		// Token: 0x060010BA RID: 4282 RVA: 0x0010D544 File Offset: 0x0010B744
		private void DebateGameChangePlayerPressure([TupleElementNames(new string[]
		{
			"left",
			"right"
		})] ValueTuple<int, int> delta)
		{
			bool playerLeftDead = false;
			bool playerRightDead = false;
			bool flag = delta.Item1 != 0;
			if (flag)
			{
				playerLeftDead = this.DebateGameSetPlayerPressure(this.Debate.PlayerLeft, this.Debate.PlayerLeft.Pressure + delta.Item1);
			}
			bool flag2 = delta.Item2 != 0;
			if (flag2)
			{
				playerRightDead = this.DebateGameSetPlayerPressure(this.Debate.PlayerRight, this.Debate.PlayerRight.Pressure + delta.Item2);
			}
			bool flag3 = playerLeftDead || playerRightDead;
			if (flag3)
			{
				this.DebateGameTryProcessEnd();
			}
		}

		// Token: 0x060010BB RID: 4283 RVA: 0x0010D5D4 File Offset: 0x0010B7D4
		private void DebateGameChangePlayerGamePoint(DebatePlayer player, int delta, bool needPlay = true, bool isTaiwuCasted = false, short nodeEffectTemplateId = -1)
		{
			bool flag = delta == 0;
			if (!flag)
			{
				int newGamePoint = Math.Min(DebateConstants.MaxGamePoint, player.GamePoint + delta);
				bool flag2 = player.GamePoint == newGamePoint;
				if (!flag2)
				{
					player.GamePoint = newGamePoint;
					if (needPlay)
					{
						this.Debate.DebateOperations.Add(new DebateOperation(11, isTaiwuCasted, this.Debate.PlayerLeft, this.Debate.PlayerRight, nodeEffectTemplateId));
					}
					this.DebateGameTryProcessEnd();
				}
			}
		}

		// Token: 0x060010BC RID: 4284 RVA: 0x0010D654 File Offset: 0x0010B854
		private void DebateGameAddPawn(DataContext context, IntPair coordinate, bool isOwnedByTaiwu, sbyte grade, int value = 0, bool isFailed = false)
		{
			if (isFailed)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(2, isOwnedByTaiwu, -1, coordinate, this.Debate.PlayerLeft, this.Debate.PlayerRight, 0, true));
			}
			else
			{
				int bases = this.Debate.GetPawnInitialBases(isOwnedByTaiwu, grade, value);
				Pawn pawn = new Pawn(this._pawnId, coordinate, isOwnedByTaiwu, bases);
				this.Debate.DebateGrid[coordinate].PawnId = pawn.Id;
				this.Debate.DebateOperations.Add(new DebateOperation(2, isOwnedByTaiwu, pawn.Id, coordinate, this.Debate.PlayerLeft, this.Debate.PlayerRight, pawn.Bases, false));
				this.Debate.Pawns[this._pawnId] = pawn;
				this._pawnId++;
				this.DebateGameTryApplyComment(context, pawn.IsOwnedByTaiwu, 4);
				this.DebateGameTryApplyNodeEffect(context, coordinate, EDebateNodeEffectRemoveType.Instant);
			}
		}

		// Token: 0x060010BD RID: 4285 RVA: 0x0010D758 File Offset: 0x0010B958
		private void DebateGameRemovePawn(int id)
		{
			Pawn pawn = this.Debate.Pawns[id];
			bool flag = this.Debate.DebateGrid[pawn.Coordinate].PawnId == id;
			if (flag)
			{
				this.Debate.DebateGrid[pawn.Coordinate].PawnId = -1;
			}
			foreach (int strategyId in pawn.Strategies)
			{
				bool flag2 = strategyId >= 0;
				if (flag2)
				{
					this.DebateGameRemoveStrategy(strategyId, pawn.IsOwnedByTaiwu);
				}
			}
			this.Debate.Pawns.Remove(id);
		}

		// Token: 0x060010BE RID: 4286 RVA: 0x0010D800 File Offset: 0x0010BA00
		private void DebateGameSetPawnBases(int id, int value)
		{
			this.Debate.Pawns[id].Bases = Math.Max(0, value);
			this.Debate.DebateOperations.Add(new DebateOperation(10, id, value, this.Debate.PlayerLeft, this.Debate.PlayerRight, false));
		}

		// Token: 0x060010BF RID: 4287 RVA: 0x0010D85C File Offset: 0x0010BA5C
		private void DebateGameSetPawnDead(DataContext context, int id, int cause, bool isTaiwu = false)
		{
			Pawn pawn = this.Debate.Pawns[id];
			bool isHalfImmuneRemove = pawn.IsHalfImmuneRemove;
			if (isHalfImmuneRemove)
			{
				List<IntPair> coordinates;
				bool flag = this.Debate.TryGetEmptyNode(pawn.IsOwnedByTaiwu, out coordinates);
				if (flag)
				{
					CollectionUtils.Shuffle<IntPair>(context.Random, coordinates);
					this.DebateGameSetPawnCoordinate(context, id, coordinates[0], true);
					this.DebateGameSetPawnBases(id, pawn.Bases / 2);
					return;
				}
			}
			bool isImmuneRemove = pawn.IsImmuneRemove;
			if (isImmuneRemove)
			{
				IntPair coordinate = this.Debate.GetStartCoordinate(pawn.IsOwnedByTaiwu, pawn.Coordinate.Second);
				bool flag2 = this.Debate.DebateGrid[coordinate].PawnId < 0 || this.Debate.DebateGrid[coordinate].PawnId == pawn.Id;
				if (flag2)
				{
					this.DebateGameSetPawnCoordinate(context, id, coordinate, true);
					return;
				}
			}
			bool flag3 = this.Debate.DebateGrid[this.Debate.Pawns[id].Coordinate].PawnId == id;
			if (flag3)
			{
				this.Debate.DebateGrid[this.Debate.Pawns[id].Coordinate].PawnId = -1;
			}
			this.Debate.Pawns[id].IsAlive = false;
			this.Debate.DebateOperations.Add(new DebateOperation(3, id, cause, this.Debate.PlayerLeft, this.Debate.PlayerRight, isTaiwu));
			bool flag4 = cause != 3;
			if (flag4)
			{
				this.DebateGameApplyPawnStrategyEffectByTriggerType(context, id, EDebateStrategyTriggerType.PawnDead);
			}
			if (!true)
			{
			}
			bool flag5 = cause == 0 || (cause == 2 && pawn.IsOwnedByTaiwu != isTaiwu);
			if (!true)
			{
			}
			bool countAsBeat = flag5;
			bool flag6 = countAsBeat;
			if (flag6)
			{
				bool isOwnedByTaiwu = pawn.IsOwnedByTaiwu;
				if (isOwnedByTaiwu)
				{
					this._debateBeatPawnCount.Item2 = this._debateBeatPawnCount.Item2 + 1;
				}
				else
				{
					this._debateBeatPawnCount.Item1 = this._debateBeatPawnCount.Item1 + 1;
				}
				this.DebateGameTryApplyComment(context, !pawn.IsOwnedByTaiwu, 6);
			}
		}

		// Token: 0x060010C0 RID: 4288 RVA: 0x0010DA90 File Offset: 0x0010BC90
		private void DebateGameSetPawnRevealed(DataContext context, int id)
		{
			Pawn pawn = this.Debate.Pawns[id];
			bool isRevealed = pawn.IsRevealed;
			if (!isRevealed)
			{
				pawn.IsRevealed = true;
				bool flag = pawn.Bases <= 0;
				if (flag)
				{
					bool isOwnedByTaiwu = pawn.IsOwnedByTaiwu;
					if (isOwnedByTaiwu)
					{
						this._debateRevealedPawnCount.Item1 = this._debateRevealedPawnCount.Item1 + 1;
					}
					else
					{
						this._debateRevealedPawnCount.Item2 = this._debateRevealedPawnCount.Item2 + 1;
					}
				}
				this.DebateGameTryApplyComment(context, pawn.IsOwnedByTaiwu, 2);
			}
		}

		// Token: 0x060010C1 RID: 4289 RVA: 0x0010DB10 File Offset: 0x0010BD10
		private void DebateGameSetPawnCoordinate(DataContext context, int id, IntPair coordinate, bool isImmuneRemove = false)
		{
			Pawn pawn = this.Debate.Pawns[id];
			bool flag = this.Debate.GetCoordinateValid(pawn.Coordinate) && this.Debate.DebateGrid[pawn.Coordinate].PawnId == id;
			if (flag)
			{
				this.Debate.DebateGrid[pawn.Coordinate].PawnId = -1;
			}
			pawn.Coordinate = coordinate;
			this.Debate.DebateGrid[coordinate].PawnId = id;
			this.Debate.DebateOperations.Add(new DebateOperation(1, id, coordinate, this.Debate.PlayerLeft, this.Debate.PlayerRight, isImmuneRemove));
			this.DebateGameTryApplyNodeEffect(context, coordinate, EDebateNodeEffectRemoveType.Trigger);
			bool pawnCanDamage = this.Debate.GetPawnCanDamage(pawn.IsOwnedByTaiwu, pawn.Coordinate.First);
			if (pawnCanDamage)
			{
				this.DebateGameApplyPawnDamage(context, id);
			}
		}

		// Token: 0x060010C2 RID: 4290 RVA: 0x0010DC08 File Offset: 0x0010BE08
		private void DebateGameAddNodeEffect(DebateNode node, short templateId, int casterId, bool isHelpTaiwu)
		{
			DebateNodeEffectItem config = DebateNodeEffect.Instance[templateId];
			node.EffectState = new DebateNodeEffectState(this._nodeEffectId, (int)templateId, casterId, config.Duration, isHelpTaiwu);
			this._debateSpectatorCooldownMap[casterId] = config.Cooldown;
			this.Debate.NodeEffects[this._nodeEffectId] = node.EffectState;
			this._nodeEffectId++;
			this.Debate.DebateOperations.Add(new DebateOperation(15, node.EffectState, node.Coordinate, false));
		}

		// Token: 0x060010C3 RID: 4291 RVA: 0x0010DCA0 File Offset: 0x0010BEA0
		private void DebateGameRemoveNodeEffect(DebateNode node)
		{
			DebateOperation operation = new DebateOperation(16, node.EffectState, node.Coordinate, false);
			this.Debate.DebateOperations.Add(operation);
			node.EffectState = DebateNodeEffectState.Invalid;
		}

		// Token: 0x060010C4 RID: 4292 RVA: 0x0010DCE0 File Offset: 0x0010BEE0
		private void DebateGameChangePlayerBases(DebatePlayer player, int delta, bool isTaiwu = false, short nodeEffectTemplateId = -1)
		{
			player.Bases = Math.Clamp(player.Bases + delta, 0, player.MaxBases);
			DebateOperation operation = new DebateOperation(21, isTaiwu, this.Debate.PlayerLeft, this.Debate.PlayerRight, nodeEffectTemplateId);
			this.Debate.DebateOperations.Add(operation);
		}

		// Token: 0x060010C5 RID: 4293 RVA: 0x0010DD3B File Offset: 0x0010BF3B
		private void DebateGameChangePlayerStrategyPoint(DebatePlayer player, int delta)
		{
			player.StrategyPoint = Math.Clamp(player.StrategyPoint + delta, 0, DebateConstants.MaxStrategyPoint);
		}

		// Token: 0x060010C6 RID: 4294 RVA: 0x0010DD58 File Offset: 0x0010BF58
		private void DebateGameAddStrategy(int pawnId, short templateId, bool isCastedByTaiwu)
		{
			Tester.Assert(this.Debate.GetPawnStrategyCount(pawnId) < DebateConstants.PawnStrategyLimit, "");
			ActivatedStrategy strategy = new ActivatedStrategy(this._activatedStrategyId, pawnId, templateId, isCastedByTaiwu);
			Pawn pawn = this.Debate.Pawns[pawnId];
			bool nodeIsContainingEffect = this.Debate.GetNodeIsContainingEffect(pawn.Coordinate, 32);
			if (nodeIsContainingEffect)
			{
				strategy.IsRevealed = true;
			}
			for (int i = 0; i < pawn.Strategies.Length; i++)
			{
				bool flag = pawn.Strategies[i] < 0;
				if (flag)
				{
					pawn.Strategies[i] = strategy.Id;
					this.Debate.DebateOperations.Add(new DebateOperation(6, strategy.PawnId, i, this.Debate.PlayerLeft, this.Debate.PlayerRight, false));
					break;
				}
			}
			this.Debate.ActivatedStrategies.Add(strategy.Id, strategy);
			this._activatedStrategyId++;
		}

		// Token: 0x060010C7 RID: 4295 RVA: 0x0010DE5C File Offset: 0x0010C05C
		private void DebateGameRemoveStrategy(int id, bool isCastedByTaiwu)
		{
			ActivatedStrategy strategy = this.Debate.ActivatedStrategies[id];
			Pawn pawn = this.Debate.Pawns[strategy.PawnId];
			for (int i = 0; i < pawn.Strategies.Length; i++)
			{
				bool flag = pawn.Strategies[i] == strategy.Id;
				if (flag)
				{
					pawn.Strategies[i] = -1;
					this.Debate.DebateOperations.Add(new DebateOperation(13, strategy.PawnId, i, this.Debate.PlayerLeft, this.Debate.PlayerRight, isCastedByTaiwu));
				}
			}
			this.Debate.ActivatedStrategies.Remove(id);
		}

		// Token: 0x060010C8 RID: 4296 RVA: 0x0010DF18 File Offset: 0x0010C118
		private void DebateGameChangePawnStrategy(int pawnId, int strategyId, int index, bool changeOwner)
		{
			bool flag = strategyId >= 0;
			if (flag)
			{
				ActivatedStrategy strategy = this.Debate.ActivatedStrategies[strategyId];
				if (changeOwner)
				{
					strategy.IsCastedByTaiwu = !strategy.IsCastedByTaiwu;
				}
				strategy.PawnId = pawnId;
			}
			this.Debate.Pawns[pawnId].Strategies[index] = strategyId;
		}

		// Token: 0x060010C9 RID: 4297 RVA: 0x0010DF7C File Offset: 0x0010C17C
		private void DebateGameAddPlayerCanUseCard(bool isTaiwu, int source, int index)
		{
			List<short> sourceList = this.Debate.GetStrategyCardCollection(isTaiwu, source);
			short card = sourceList[index];
			sourceList.RemoveAt(index);
			int destination = isTaiwu ? 2 : 5;
			List<short> destinationList = this.Debate.GetStrategyCardCollection(isTaiwu, destination);
			destinationList.Add(card);
			this.Debate.DebateOperations.Add(new DebateOperation(8, source, destination, destinationList.Count - 1, card, this.Debate.PlayerLeft, this.Debate.PlayerRight));
		}

		// Token: 0x060010CA RID: 4298 RVA: 0x0010E000 File Offset: 0x0010C200
		private void DebateGameRemovePlayerCanUseCard(bool isTaiwu, int destination, int index, int offset = 0, bool playAnim = true)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu);
			List<short> collection = this.Debate.GetStrategyCardCollection(isTaiwu, destination);
			int source = isTaiwu ? 2 : 5;
			short card = player.CanUseCards[index + offset];
			player.CanUseCards.RemoveAt(index + offset);
			collection.Add(card);
			if (playAnim)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(8, source, destination, index, card, this.Debate.PlayerLeft, this.Debate.PlayerRight));
			}
		}

		// Token: 0x060010CB RID: 4299 RVA: 0x0010E094 File Offset: 0x0010C294
		[DomainMethod]
		public void GmCmd_GetDebateStrategyCard(int id)
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				bool flag2 = id < 0 || id >= DebateStrategy.Instance.Count;
				if (!flag2)
				{
					bool flag3 = !this.Debate.GetIsTaiwuTurn();
					if (!flag3)
					{
						short card = (short)id;
						this.Debate.DebateOperations.Clear();
						this.Debate.PlayerLeft.CanUseCards.Add(card);
						this.Debate.DebateOperations.Add(new DebateOperation(8, -1, 2, this.Debate.PlayerLeft.CanUseCards.Count - 1, card, this.Debate.PlayerLeft, this.Debate.PlayerRight));
						GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
					}
				}
			}
		}

		// Token: 0x060010CC RID: 4300 RVA: 0x0010E16C File Offset: 0x0010C36C
		[DomainMethod]
		public void GmCmd_ChangeStrategyPoint(bool isTaiwu, int delta)
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				this.Debate.DebateOperations.Clear();
				this.DebateGameChangePlayerStrategyPoint(this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu), delta);
				GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
			}
		}

		// Token: 0x060010CD RID: 4301 RVA: 0x0010E1BC File Offset: 0x0010C3BC
		[DomainMethod]
		public void GmCmd_ChangeBases(bool isTaiwu, int delta)
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				this.Debate.DebateOperations.Clear();
				this.DebateGameChangePlayerBases(this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu), delta, false, -1);
				GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
			}
		}

		// Token: 0x060010CE RID: 4302 RVA: 0x0010E210 File Offset: 0x0010C410
		[DomainMethod]
		public void GmCmd_ChangePressure(bool isTaiwu, int delta)
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				this.Debate.DebateOperations.Clear();
				this.DebateGameChangePlayerPressure(isTaiwu ? new ValueTuple<int, int>(delta, 0) : new ValueTuple<int, int>(0, delta));
				GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
			}
		}

		// Token: 0x060010CF RID: 4303 RVA: 0x0010E268 File Offset: 0x0010C468
		[DomainMethod]
		public void GmCmd_ChangeGamePoint(bool isTaiwu, int delta)
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				this.Debate.DebateOperations.Clear();
				this.DebateGameChangePlayerGamePoint(this.Debate.GetPlayerByPlayerIsTaiwu(isTaiwu), delta, true, false, -1);
				GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
			}
		}

		// Token: 0x060010D0 RID: 4304 RVA: 0x0010E2BC File Offset: 0x0010C4BC
		[DomainMethod]
		public void GmCmd_EmptyAiOwnedCard()
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				this.Debate.PlayerRight.OwnedCards.Clear();
				GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
			}
		}

		// Token: 0x060010D1 RID: 4305 RVA: 0x0010E300 File Offset: 0x0010C500
		[DomainMethod]
		public void GmCmd_AddAiOwnedCard(int id)
		{
			bool flag = this.Debate == null;
			if (!flag)
			{
				this.Debate.PlayerRight.OwnedCards.Add((short)id);
				GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
			}
		}

		// Token: 0x060010D2 RID: 4306 RVA: 0x0010E344 File Offset: 0x0010C544
		[DomainMethod]
		public void GmCmd_AddNodeEffect(DataContext context, short templateId, int spectatorId)
		{
			this.Debate.DebateOperations.Clear();
			bool flag = this.Debate == null;
			if (!flag)
			{
				bool flag2 = spectatorId < 0;
				if (!flag2)
				{
					bool flag3 = !this.DebateGameTryAddNodeEffect(context, templateId, spectatorId);
					if (!flag3)
					{
						GameDataBridge.AddDisplayEvent<DebateGame>(DisplayEventType.ChangeLifeSkillCombatData, this.Debate);
					}
				}
			}
		}

		// Token: 0x060010D3 RID: 4307 RVA: 0x0010E39C File Offset: 0x0010C59C
		private void DebateGameInitializeStrategyActions()
		{
			this._debateStrategyActions = new Dictionary<int, Action<DebateStrategyActionParams>>
			{
				{
					4,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyDamageMore)
				},
				{
					5,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyForwardMore)
				},
				{
					7,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyDrawCardInOwned)
				},
				{
					12,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyChangeOpponentBases)
				},
				{
					13,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyChangeOpponentStrategyPoint)
				},
				{
					16,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyHalfImmuneRemove)
				},
				{
					17,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyImmuneDebuff)
				},
				{
					18,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyImmuneRemove)
				},
				{
					19,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyChangeBases)
				},
				{
					9,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyChangeSelfBases)
				},
				{
					10,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyChangeSelfStrategyPoint)
				},
				{
					20,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyRevealBases)
				},
				{
					15,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyChangeGamePoint)
				},
				{
					21,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyRemovePawn)
				},
				{
					22,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyPawnLink)
				},
				{
					11,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyApplyToSelfWhenDamage)
				},
				{
					25,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyHalfMakeMove)
				},
				{
					27,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyRecycleBases)
				},
				{
					14,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyDamageMoreToBoth)
				},
				{
					29,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyPawnBackward)
				},
				{
					31,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyDrawCardInUsed)
				},
				{
					32,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyRevealStrategy)
				},
				{
					33,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyPawnAvoidConflict)
				},
				{
					34,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyPawnHalt)
				},
				{
					37,
					new Action<DebateStrategyActionParams>(this.DebateGameApplySplitPawn)
				},
				{
					38,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyRemoveStrategy)
				},
				{
					40,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyExchangeCard)
				},
				{
					1,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyMakeMove)
				},
				{
					2,
					new Action<DebateStrategyActionParams>(this.DebateGameApplySwitchCoordinate)
				},
				{
					3,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyTeleportCoordinate)
				},
				{
					30,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyRecycleStrategy)
				},
				{
					36,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyMergePawn)
				},
				{
					39,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyExchangeStrategy)
				},
				{
					42,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyTeleportToBottom)
				},
				{
					43,
					new Action<DebateStrategyActionParams>(this.DebateGameApplyDamageMoreByNode)
				}
			};
		}

		// Token: 0x060010D4 RID: 4308 RVA: 0x0010E690 File Offset: 0x0010C890
		[DomainMethod]
		public DebateGame DebateGameCastStrategy(DataContext context, int index, bool isCastedByTaiwu, List<StrategyTarget> strategyTargets)
		{
			bool flag = isCastedByTaiwu && !this.Debate.IsTaiwuAi;
			if (flag)
			{
				this.Debate.DebateOperations.Clear();
			}
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(isCastedByTaiwu);
			short templateId = player.CanUseCards[index];
			DebateStrategyItem config = DebateStrategy.Instance[templateId];
			int extraCost = 0;
			bool castFailed = this.DebateGameCheckPressure(context, isCastedByTaiwu, 6);
			this.Debate.DebateOperations.Add(new DebateOperation(14, isCastedByTaiwu, templateId, this.Debate.PlayerLeft, this.Debate.PlayerRight, strategyTargets, castFailed));
			int dest = this.Debate.GetStrategyCardLocation(isCastedByTaiwu, 7);
			this.DebateGameRemovePlayerCanUseCard(isCastedByTaiwu, dest, index, 0, !castFailed);
			bool flag2 = !castFailed;
			if (flag2)
			{
				bool flag3 = !isCastedByTaiwu;
				if (flag3)
				{
					this.Debate.DebateOperations.Add(new DebateOperation(20, false, 17, new int[]
					{
						(int)templateId
					}));
				}
				bool flag4 = config.TriggerType == EDebateStrategyTriggerType.Instant;
				if (flag4)
				{
					extraCost += this.DebateGameApplyInstantStrategyEffect(context, index, isCastedByTaiwu, templateId, strategyTargets);
				}
				else
				{
					extraCost += this.DebateGameAddPawnStrategy(isCastedByTaiwu, templateId, strategyTargets);
				}
			}
			this.DebateGameChangePlayerStrategyPoint(player, -((int)config.UsedCost + extraCost));
			this.DebateGameUpdateCanMakeMoveNode();
			bool flag5 = castFailed;
			if (flag5)
			{
				this.DebateGameApplyPressureEffect(isCastedByTaiwu, 6, player.Pressure, templateId);
			}
			this._debateCardUsedCount++;
			return this.Debate;
		}

		// Token: 0x060010D5 RID: 4309 RVA: 0x0010E804 File Offset: 0x0010CA04
		private int[] DebateGameGetStrategyRecordParameters(short templateId, List<short> strategyTemplateIds, List<int> pawnIds, List<int> values)
		{
			DebateRecordItem config = DebateRecord.Instance[templateId];
			int[] res = new int[config.Parameters.Length];
			int pawnIdPtr = 0;
			int strategyPtr = 0;
			int valuePtr = 0;
			int i = 0;
			while (i < config.Parameters.Length)
			{
				int[] array = res;
				int num = i;
				EDebateRecordParamType edebateRecordParamType = config.Parameters[i];
				if (!true)
				{
				}
				int num2;
				if (edebateRecordParamType <= EDebateRecordParamType.Pawn)
				{
					if (edebateRecordParamType != EDebateRecordParamType.IntValue)
					{
						if (edebateRecordParamType != EDebateRecordParamType.Pawn)
						{
							goto IL_A1;
						}
						num2 = pawnIds[pawnIdPtr++];
					}
					else
					{
						num2 = Math.Abs(values[valuePtr++]);
					}
				}
				else if (edebateRecordParamType != EDebateRecordParamType.Strategy)
				{
					if (edebateRecordParamType != EDebateRecordParamType.PawnCount)
					{
						goto IL_A1;
					}
					num2 = pawnIds.Count;
				}
				else
				{
					num2 = (int)strategyTemplateIds[strategyPtr++];
				}
				IL_A6:
				if (!true)
				{
				}
				array[num] = num2;
				i++;
				continue;
				IL_A1:
				num2 = 0;
				goto IL_A6;
			}
			return res;
		}

		// Token: 0x060010D6 RID: 4310 RVA: 0x0010E8E8 File Offset: 0x0010CAE8
		private void DebateGameAddStrategyRecord(bool isTaiwu, short recordTemplateId, List<short> strategyTemplateIds, List<int> pawnIds, List<int> values)
		{
			this.Debate.DebateOperations.Add(new DebateOperation(20, isTaiwu, recordTemplateId, this.DebateGameGetStrategyRecordParameters(recordTemplateId, strategyTemplateIds, pawnIds, values)));
		}

		// Token: 0x060010D7 RID: 4311 RVA: 0x0010E91C File Offset: 0x0010CB1C
		private bool DebateGameCheckDebateRecord(bool isCastedByTaiwu, short templateId, out bool isPawnCount)
		{
			isPawnCount = false;
			bool flag = !isCastedByTaiwu || templateId < 0;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				DebateRecordItem config = DebateRecord.Instance[templateId];
				foreach (EDebateRecordParamType param in config.Parameters)
				{
					bool flag2 = param == EDebateRecordParamType.PawnCount;
					if (flag2)
					{
						isPawnCount = true;
						break;
					}
				}
				result = true;
			}
			return result;
		}

		// Token: 0x060010D8 RID: 4312 RVA: 0x0010E984 File Offset: 0x0010CB84
		private void DebateGameDecodeStrategyEffectTargets(List<StrategyTarget> strategyTargets, out List<int> pawnIds, out List<int> cards, out List<IntPair> coordinates, out List<sbyte> pawnGrades)
		{
			pawnIds = null;
			cards = null;
			coordinates = null;
			pawnGrades = null;
			bool flag = strategyTargets == null;
			if (!flag)
			{
				foreach (StrategyTarget target in strategyTargets)
				{
					switch (target.Type)
					{
					case EDebateStrategyTargetObjectType.Pawn:
						if (pawnIds == null)
						{
							pawnIds = new List<int>();
						}
						foreach (ulong data in target.List)
						{
							pawnIds.Add((int)data);
						}
						break;
					case EDebateStrategyTargetObjectType.Node:
						if (coordinates == null)
						{
							coordinates = new List<IntPair>();
						}
						foreach (ulong data2 in target.List)
						{
							coordinates.Add((IntPair)data2);
						}
						break;
					case EDebateStrategyTargetObjectType.PawnGrade:
						if (pawnGrades == null)
						{
							pawnGrades = new List<sbyte>();
						}
						foreach (ulong data3 in target.List)
						{
							pawnGrades.Add((sbyte)data3);
						}
						break;
					case EDebateStrategyTargetObjectType.StrategyCard:
						if (cards == null)
						{
							cards = new List<int>();
						}
						foreach (ulong data4 in target.List)
						{
							int value = (int)data4;
							cards.Add(value);
						}
						break;
					}
				}
			}
		}

		// Token: 0x060010D9 RID: 4313 RVA: 0x0010EBCC File Offset: 0x0010CDCC
		private void DebateGameApplyNoTargetInstantStrategyEffect(DataContext context, bool isCastedByTaiwu, short templateId)
		{
			DebateStrategyItem config = DebateStrategy.Instance[templateId];
			foreach (IntPair effect in config.EffectList)
			{
				Action<DebateStrategyActionParams> action;
				bool flag = !this._debateStrategyActions.TryGetValue(effect.First, out action);
				if (flag)
				{
					throw new Exception("Instant Debate Strategy has no effect: " + config.Name);
				}
				DebateStrategyActionParams param = new DebateStrategyActionParams
				{
					Context = context,
					IsCastedByTaiwu = isCastedByTaiwu,
					StrategyTemplateId = templateId,
					Value = effect.Second
				};
				action(param);
			}
		}

		// Token: 0x060010DA RID: 4314 RVA: 0x0010EC8C File Offset: 0x0010CE8C
		private void DebateGameApplySingleTargetInstantStrategyEffect(DataContext context, int index, bool isCastedByTaiwu, short templateId, List<StrategyTarget> strategyTargets)
		{
			DebateStrategyItem config = DebateStrategy.Instance[templateId];
			List<int> pawnIds;
			List<int> cards;
			List<IntPair> list;
			List<sbyte> list2;
			this.DebateGameDecodeStrategyEffectTargets(strategyTargets, out pawnIds, out cards, out list, out list2);
			Tester.Assert(pawnIds != null || cards != null, "");
			Tester.Assert(pawnIds == null || cards == null, "");
			bool isPawnCount;
			bool flag = pawnIds != null && this.DebateGameCheckDebateRecord(isCastedByTaiwu, config.DebateRecord, out isPawnCount);
			if (flag)
			{
				bool flag2 = isPawnCount;
				if (flag2)
				{
					List<int> selfPawnIds = null;
					List<int> opponentPawnIds = null;
					foreach (int pawnId in pawnIds)
					{
						bool isOwnedByTaiwu = this.Debate.Pawns[pawnId].IsOwnedByTaiwu;
						if (isOwnedByTaiwu)
						{
							if (selfPawnIds == null)
							{
								selfPawnIds = new List<int>();
							}
							selfPawnIds.Add(pawnId);
						}
						else
						{
							if (opponentPawnIds == null)
							{
								opponentPawnIds = new List<int>();
							}
							opponentPawnIds.Add(pawnId);
						}
					}
					bool flag3 = selfPawnIds != null;
					if (flag3)
					{
						this.DebateGameAddStrategyRecord(true, config.DebateRecord, new List<short>
						{
							config.TemplateId
						}, selfPawnIds, new List<int>
						{
							config.EffectList[0].Second
						});
					}
					bool flag4 = opponentPawnIds != null;
					if (flag4)
					{
						this.DebateGameAddStrategyRecord(true, config.DebateRecord, new List<short>
						{
							config.TemplateId
						}, opponentPawnIds, new List<int>
						{
							config.EffectList[0].Second
						});
					}
				}
				else
				{
					bool flag5 = config.DebateRecord == 18;
					if (flag5)
					{
						this.Debate.DebateOperations.Add(new DebateOperation(20, true, 18, new int[]
						{
							(int)templateId
						}));
					}
					else
					{
						foreach (int pawnId2 in pawnIds)
						{
							this.DebateGameAddStrategyRecord(true, config.DebateRecord, new List<short>
							{
								config.TemplateId
							}, new List<int>
							{
								pawnId2
							}, new List<int>
							{
								config.EffectList[0].Second
							});
						}
					}
				}
			}
			foreach (IntPair effect in config.EffectList)
			{
				Action<DebateStrategyActionParams> action;
				bool flag6 = !this._debateStrategyActions.TryGetValue(effect.First, out action);
				if (flag6)
				{
					throw new Exception("Instant Debate Strategy has no effect: " + config.Name);
				}
				DebateStrategyActionParams param = new DebateStrategyActionParams
				{
					Context = context,
					IsCastedByTaiwu = isCastedByTaiwu,
					UsingCard = index,
					StrategyTemplateId = templateId,
					Value = effect.Second
				};
				bool flag7 = pawnIds != null;
				if (flag7)
				{
					foreach (int pawnId3 in pawnIds)
					{
						param.PawnId = pawnId3;
						action(param);
					}
				}
				else
				{
					bool flag8 = cards != null;
					if (flag8)
					{
						cards.Sort();
						cards.Reverse();
						foreach (int card in cards)
						{
							param.Card = card;
							action(param);
						}
					}
				}
			}
		}

		// Token: 0x060010DB RID: 4315 RVA: 0x0010F0AC File Offset: 0x0010D2AC
		private void DebateGameApplyMultipleTargetInstantStrategyEffect(DataContext context, bool isCastedByTaiwu, short templateId, List<StrategyTarget> strategyTargets)
		{
			DebateStrategyItem config = DebateStrategy.Instance[templateId];
			Tester.Assert(config.EffectList.Count == 1, "");
			IntPair effect = config.EffectList[0];
			Action<DebateStrategyActionParams> action;
			bool flag = !this._debateStrategyActions.TryGetValue(effect.First, out action);
			if (flag)
			{
				throw new Exception("Instant Debate Strategy has no effect: " + config.Name);
			}
			List<int> pawnIds;
			List<int> cards;
			List<IntPair> coordinates;
			List<sbyte> pawnGrades;
			this.DebateGameDecodeStrategyEffectTargets(strategyTargets, out pawnIds, out cards, out coordinates, out pawnGrades);
			DebateStrategyActionParams param = new DebateStrategyActionParams
			{
				Context = context,
				IsCastedByTaiwu = isCastedByTaiwu,
				StrategyTemplateId = templateId,
				Value = effect.Second
			};
			int first = effect.First;
			int num = first;
			switch (num)
			{
			case 1:
				param.Grade = pawnGrades[0];
				param.Coordinate = coordinates[0];
				action(param);
				pawnIds = new List<int>
				{
					this.Debate.DebateGrid[coordinates[0]].PawnId
				};
				goto IL_179;
			case 2:
				break;
			case 3:
				param.PawnId = pawnIds[0];
				param.Coordinate = coordinates[0];
				action(param);
				goto IL_179;
			default:
				if (num != 36 && num != 39)
				{
					goto IL_179;
				}
				break;
			}
			param.PawnId = pawnIds[0];
			param.PawnId2 = pawnIds[1];
			action(param);
			IL_179:
			bool flag2 = isCastedByTaiwu && config.DebateRecord >= 0;
			if (flag2)
			{
				this.DebateGameAddStrategyRecord(true, config.DebateRecord, new List<short>
				{
					config.TemplateId
				}, pawnIds, new List<int>
				{
					config.EffectList[0].Second
				});
			}
		}

		// Token: 0x060010DC RID: 4316 RVA: 0x0010F28C File Offset: 0x0010D48C
		public int DebateGameApplyInstantStrategyEffect(DataContext context, int index, bool isCastedByTaiwu, short templateId, List<StrategyTarget> strategyTargets)
		{
			int cost = 0;
			DebateStrategyItem config = DebateStrategy.Instance[templateId];
			bool flag = config.EffectList == null || config.EffectList.Count == 0;
			int result;
			if (flag)
			{
				result = cost;
			}
			else
			{
				bool flag2 = config.TargetList == null || config.TargetList.Count == 0;
				if (flag2)
				{
					this.DebateGameApplyNoTargetInstantStrategyEffect(context, isCastedByTaiwu, templateId);
				}
				else
				{
					bool flag3 = config.TargetList.Count == 1;
					if (flag3)
					{
						this.DebateGameApplySingleTargetInstantStrategyEffect(context, index, isCastedByTaiwu, templateId, strategyTargets);
					}
					else
					{
						this.DebateGameApplyMultipleTargetInstantStrategyEffect(context, isCastedByTaiwu, templateId, strategyTargets);
					}
					foreach (StrategyTarget target in strategyTargets)
					{
						bool flag4 = target.Type > EDebateStrategyTargetObjectType.Pawn;
						if (!flag4)
						{
							foreach (ulong data in target.List)
							{
								int pawnId = (int)data;
								List<DebateGame.EffectItem> list = new List<DebateGame.EffectItem>();
								int value;
								bool flag5 = this.Debate.TryGetPawnStrategyEffectValue(pawnId, 28, out value, list);
								if (flag5)
								{
									cost += value;
									this.DebateGameAddStrategyRecord(isCastedByTaiwu, 54, new List<short>
									{
										list[0].StrategyTemplateId,
										templateId
									}, new List<int>
									{
										pawnId
									}, new List<int>
									{
										value
									});
								}
							}
						}
					}
				}
				result = cost;
			}
			return result;
		}

		// Token: 0x060010DD RID: 4317 RVA: 0x0010F44C File Offset: 0x0010D64C
		private int DebateGameAddPawnStrategy(bool isCastedByTaiwu, short templateId, List<StrategyTarget> strategyTargets)
		{
			int extraCost = 0;
			DebateStrategyItem config = DebateStrategy.Instance[templateId];
			foreach (StrategyTarget target in strategyTargets)
			{
				Tester.Assert(target.Type == EDebateStrategyTargetObjectType.Pawn, "");
				Tester.Assert(target.List.Count != 0, "");
				foreach (ulong data in target.List)
				{
					int pawnId = (int)data;
					List<DebateGame.EffectItem> list = new List<DebateGame.EffectItem>();
					int value;
					bool flag = this.Debate.TryGetPawnStrategyEffectValue(pawnId, 28, out value, list);
					if (flag)
					{
						extraCost += value;
						this.DebateGameAddStrategyRecord(isCastedByTaiwu, 54, new List<short>
						{
							list[0].StrategyTemplateId,
							templateId
						}, new List<int>
						{
							pawnId
						}, new List<int>
						{
							value
						});
					}
				}
			}
			foreach (StrategyTarget target2 in strategyTargets)
			{
				foreach (ulong data2 in target2.List)
				{
					int pawnId2 = (int)data2;
					bool flag2 = isCastedByTaiwu && config.TriggerType == EDebateStrategyTriggerType.Invalid && config.DebateRecord >= 0;
					if (flag2)
					{
						this.DebateGameAddStrategyRecord(true, config.DebateRecord, new List<short>
						{
							config.TemplateId
						}, new List<int>
						{
							pawnId2
						}, new List<int>
						{
							config.EffectList[0].Second
						});
					}
					this.DebateGameAddStrategy(pawnId2, templateId, isCastedByTaiwu);
				}
			}
			bool flag3 = isCastedByTaiwu && config.TriggerType != EDebateStrategyTriggerType.Invalid;
			if (flag3)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, true, 18, new int[]
				{
					(int)templateId
				}));
			}
			return extraCost;
		}

		// Token: 0x060010DE RID: 4318 RVA: 0x0010F6DC File Offset: 0x0010D8DC
		private void DebateGameApplyPawnStrategyEffectByTriggerType(DataContext context, int pawnId, EDebateStrategyTriggerType type)
		{
			Pawn pawn = this.Debate.Pawns[pawnId];
			pawn.ResetStrategyValue();
			foreach (int strategyId in pawn.Strategies)
			{
				ActivatedStrategy strategy;
				bool flag = strategyId >= 0 && this.Debate.ActivatedStrategies.TryGetValue(strategyId, out strategy) && strategy.GetTriggerType() == type;
				if (flag)
				{
					this.DebateGameApplyTriggeredStrategyEffect(context, strategy);
				}
			}
		}

		// Token: 0x060010DF RID: 4319 RVA: 0x0010F754 File Offset: 0x0010D954
		private void DebateGameApplyTriggeredStrategyEffect(DataContext context, ActivatedStrategy strategy)
		{
			TaiwuDomain.<>c__DisplayClass410_0 CS$<>8__locals1 = new TaiwuDomain.<>c__DisplayClass410_0();
			CS$<>8__locals1.<>4__this = this;
			CS$<>8__locals1.strategy = strategy;
			DebateStrategyItem config = CS$<>8__locals1.strategy.GetConfig();
			CS$<>8__locals1.index = -1;
			CS$<>8__locals1.pawn = this.Debate.Pawns[CS$<>8__locals1.strategy.PawnId];
			int[] strategies = CS$<>8__locals1.pawn.Strategies;
			for (int i = 0; i < strategies.Length; i++)
			{
				bool flag = strategies[i] == CS$<>8__locals1.index;
				if (flag)
				{
					CS$<>8__locals1.index = i;
					break;
				}
			}
			this.Debate.DebateOperations.Add(new DebateOperation(7, CS$<>8__locals1.strategy.PawnId, CS$<>8__locals1.strategy.Id, this.Debate.PlayerLeft, this.Debate.PlayerRight, false));
			bool flag2 = config.EffectList != null && config.EffectList.Count != 0;
			if (flag2)
			{
				foreach (IntPair effect in config.EffectList)
				{
					Action<DebateStrategyActionParams> action;
					bool flag3 = !this._debateStrategyActions.TryGetValue(effect.First, out action);
					if (!flag3)
					{
						DebateStrategyActionParams param = new DebateStrategyActionParams
						{
							Context = context,
							IsCastedByTaiwu = CS$<>8__locals1.strategy.IsCastedByTaiwu,
							StrategyTemplateId = CS$<>8__locals1.strategy.TemplateId,
							PawnId = CS$<>8__locals1.strategy.PawnId,
							Value = effect.Second
						};
						action(param);
					}
				}
				bool flag4 = config.DebateRecord >= 0;
				if (flag4)
				{
					this.DebateGameAddStrategyRecord(CS$<>8__locals1.pawn.IsOwnedByTaiwu, config.DebateRecord, new List<short>
					{
						config.TemplateId
					}, new List<int>
					{
						CS$<>8__locals1.strategy.PawnId
					}, new List<int>
					{
						config.EffectList[0].Second
					});
				}
			}
			bool isOneTime = config.IsOneTime;
			if (isOneTime)
			{
				this._oneTimeStrategyActionList.Add(new Action(CS$<>8__locals1.<DebateGameApplyTriggeredStrategyEffect>g__Action|0));
			}
		}

		// Token: 0x060010E0 RID: 4320 RVA: 0x0010F9A8 File Offset: 0x0010DBA8
		private void DebateGameApplyDamageMore(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].DamageList.Add(new PawnDamageInfo(param.Value, param.IsCastedByTaiwu, false, false));
		}

		// Token: 0x060010E1 RID: 4321 RVA: 0x0010F9E0 File Offset: 0x0010DBE0
		private void DebateGameApplyForwardMore(DebateStrategyActionParams param)
		{
			IntPair coordinate = this.Debate.GetPawnTargetPosition(param.PawnId);
			bool nodeCanTeleportPawn = this.Debate.GetNodeCanTeleportPawn(coordinate);
			if (nodeCanTeleportPawn)
			{
				this.DebateGameSetPawnCoordinate(param.Context, param.PawnId, coordinate, false);
			}
		}

		// Token: 0x060010E2 RID: 4322 RVA: 0x0010FA28 File Offset: 0x0010DC28
		private void DebateGameApplyDrawCardInOwned(DebateStrategyActionParams param)
		{
			int selfCount = 0;
			int opponentCount = 0;
			for (int i = 0; i < param.Value; i++)
			{
				bool isTaiwu = !param.IsCastedByTaiwu;
				List<int> collection;
				int location = this.Debate.TryGetStrategyCardIndexCollection(ref isTaiwu, 6, out collection);
				bool flag = location != -1;
				if (flag)
				{
					this.DebateGameAddPlayerCanUseCard(param.IsCastedByTaiwu, location, collection[(collection.Count == 1) ? 0 : param.Context.Random.Next(collection.Count)]);
					bool isCastedByTaiwu = param.IsCastedByTaiwu;
					if (isCastedByTaiwu)
					{
						bool flag2 = isTaiwu;
						if (flag2)
						{
							selfCount++;
						}
						else
						{
							opponentCount++;
						}
					}
				}
			}
			bool flag3 = selfCount > 0;
			if (flag3)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, true, DebateStrategy.Instance[param.StrategyTemplateId].DebateRecord, new int[]
				{
					(int)param.StrategyTemplateId,
					0,
					selfCount
				}));
			}
			bool flag4 = opponentCount > 0;
			if (flag4)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, true, DebateStrategy.Instance[param.StrategyTemplateId].DebateRecord, new int[]
				{
					(int)param.StrategyTemplateId,
					1,
					opponentCount
				}));
			}
		}

		// Token: 0x060010E3 RID: 4323 RVA: 0x0010FB78 File Offset: 0x0010DD78
		private void DebateGameApplyChangeOpponentBases(DebateStrategyActionParams param)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(!param.IsCastedByTaiwu);
			this.DebateGameChangePlayerBases(player, player.MaxBases * param.Value / 100, false, -1);
		}

		// Token: 0x060010E4 RID: 4324 RVA: 0x0010FBB8 File Offset: 0x0010DDB8
		private void DebateGameApplyChangeOpponentStrategyPoint(DebateStrategyActionParams param)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(!param.IsCastedByTaiwu);
			this.DebateGameChangePlayerStrategyPoint(player, param.Value);
		}

		// Token: 0x060010E5 RID: 4325 RVA: 0x0010FBE9 File Offset: 0x0010DDE9
		private void DebateGameApplyHalfImmuneRemove(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].IsHalfImmuneRemove = true;
		}

		// Token: 0x060010E6 RID: 4326 RVA: 0x0010FC08 File Offset: 0x0010DE08
		private void DebateGameApplyImmuneDebuff(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].IsImmuneDebuff = true;
		}

		// Token: 0x060010E7 RID: 4327 RVA: 0x0010FC27 File Offset: 0x0010DE27
		private void DebateGameApplyImmuneRemove(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].IsImmuneRemove = true;
		}

		// Token: 0x060010E8 RID: 4328 RVA: 0x0010FC48 File Offset: 0x0010DE48
		private void DebateGameApplyChangeBases(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			this.DebateGameSetPawnBases(param.PawnId, pawn.Bases * (100 + param.Value) / 100);
		}

		// Token: 0x060010E9 RID: 4329 RVA: 0x0010FC90 File Offset: 0x0010DE90
		private void DebateGameApplyChangeSelfBases(DebateStrategyActionParams param)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(param.IsCastedByTaiwu);
			this.DebateGameChangePlayerBases(player, player.MaxBases * param.Value / 100, param.IsCastedByTaiwu, (short)param.NodeEffect.TemplateId);
		}

		// Token: 0x060010EA RID: 4330 RVA: 0x0010FCDC File Offset: 0x0010DEDC
		private void DebateGameApplyChangeSelfStrategyPoint(DebateStrategyActionParams param)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(param.IsCastedByTaiwu);
			this.DebateGameChangePlayerStrategyPoint(player, param.Value);
		}

		// Token: 0x060010EB RID: 4331 RVA: 0x0010FD0A File Offset: 0x0010DF0A
		private void DebateGameApplyRevealBases(DebateStrategyActionParams param)
		{
			this.DebateGameSetPawnRevealed(param.Context, param.PawnId);
		}

		// Token: 0x060010EC RID: 4332 RVA: 0x0010FD20 File Offset: 0x0010DF20
		private void DebateGameApplyChangeGamePoint(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(pawn.IsOwnedByTaiwu);
			DebatePlayer player2 = player;
			int value = param.Value;
			bool needPlay = true;
			bool isOwnedByTaiwu = pawn.IsOwnedByTaiwu;
			DebateNodeEffectState nodeEffect = param.NodeEffect;
			this.DebateGameChangePlayerGamePoint(player2, value, needPlay, isOwnedByTaiwu, (short)((nodeEffect != null) ? nodeEffect.TemplateId : -1));
			this.DebateGameAddStrategyRecord(pawn.IsOwnedByTaiwu, 45, new List<short>
			{
				param.StrategyTemplateId
			}, null, new List<int>
			{
				param.Value
			});
		}

		// Token: 0x060010ED RID: 4333 RVA: 0x0010FDB4 File Offset: 0x0010DFB4
		private void DebateGameApplyRemovePawn(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			bool isAlive = pawn.IsAlive;
			if (isAlive)
			{
				this.DebateGameSetPawnDead(param.Context, param.PawnId, 2, param.IsCastedByTaiwu);
			}
		}

		// Token: 0x060010EE RID: 4334 RVA: 0x0010FE00 File Offset: 0x0010E000
		private void DebateGameApplyPawnLink(DebateStrategyActionParams param)
		{
			foreach (KeyValuePair<int, Pawn> keyValuePair in this.Debate.Pawns)
			{
				int num;
				Pawn pawn2;
				keyValuePair.Deconstruct(out num, out pawn2);
				int pawnId = num;
				Pawn pawn = pawn2;
				bool flag = pawnId == param.PawnId || !pawn.IsAlive;
				if (!flag)
				{
					bool flag2 = this.Debate.TryGetPawnStrategyEffectValue(pawnId, 22, out num, null);
					if (flag2)
					{
						this.DebateGameSetPawnDead(param.Context, pawnId, 3, param.IsCastedByTaiwu);
					}
				}
			}
		}

		// Token: 0x060010EF RID: 4335 RVA: 0x0010FEB4 File Offset: 0x0010E0B4
		private void DebateGameApplyApplyToSelfWhenDamage(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].ChangeSelfGamePointByDamagePercent = 100 * param.Value;
			this.Debate.Pawns[param.PawnId].ChangeSelfGamePointByDamagePercentIsCastedByTaiwu = param.IsCastedByTaiwu;
		}

		// Token: 0x060010F0 RID: 4336 RVA: 0x0010FF08 File Offset: 0x0010E108
		private void DebateGameApplyHalfMakeMove(DebateStrategyActionParams param)
		{
			IntPair coordinate = this.Debate.GetPawnBehindPosition(param.PawnId, 1);
			int bases = this.Debate.GetPawnBases(param.PawnId, -1, true, true) / 2;
			bool nodeCanTeleportPawn = this.Debate.GetNodeCanTeleportPawn(coordinate);
			if (nodeCanTeleportPawn)
			{
				this.DebateGameAddPawn(param.Context, coordinate, param.IsCastedByTaiwu, 0, bases, false);
			}
		}

		// Token: 0x060010F1 RID: 4337 RVA: 0x0010FF68 File Offset: 0x0010E168
		private void DebateGameApplyRecycleBases(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			int bases = this.Debate.GetPawnBases(param.PawnId, -1, true, true);
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(pawn.IsOwnedByTaiwu);
			bool isAlive = pawn.IsAlive;
			if (isAlive)
			{
				this.DebateGameSetPawnDead(param.Context, param.PawnId, 2, param.IsCastedByTaiwu);
				this.DebateGameChangePlayerBases(player, bases, false, -1);
				this.DebateGameAddStrategyRecord(pawn.IsOwnedByTaiwu, 53, new List<short>
				{
					param.StrategyTemplateId
				}, null, new List<int>
				{
					bases
				});
			}
		}

		// Token: 0x060010F2 RID: 4338 RVA: 0x00110014 File Offset: 0x0010E214
		private void DebateGameApplyDamageMoreToBoth(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			pawn.DamageList.Add(new PawnDamageInfo(param.Value, param.IsCastedByTaiwu, true, true));
			pawn.DamageList.Add(new PawnDamageInfo(param.Value, param.IsCastedByTaiwu, false, true));
			DebateStrategyItem config = DebateStrategy.Instance[param.StrategyTemplateId];
			this.DebateGameAddStrategyRecord(!pawn.IsOwnedByTaiwu, config.DebateRecord, new List<short>
			{
				config.TemplateId
			}, new List<int>
			{
				pawn.Id
			}, new List<int>
			{
				config.EffectList[0].Second
			});
		}

		// Token: 0x060010F3 RID: 4339 RVA: 0x001100E0 File Offset: 0x0010E2E0
		private void DebateGameApplyPawnBackward(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			bool isAlive = pawn.IsAlive;
			if (isAlive)
			{
				for (int i = param.Value; i > 0; i--)
				{
					IntPair coordinate = this.Debate.GetPawnBehindPosition(param.PawnId, i);
					bool nodeCanTeleportPawn = this.Debate.GetNodeCanTeleportPawn(coordinate);
					if (nodeCanTeleportPawn)
					{
						this.DebateGameSetPawnCoordinate(param.Context, param.PawnId, coordinate, false);
						break;
					}
				}
			}
		}

		// Token: 0x060010F4 RID: 4340 RVA: 0x00110168 File Offset: 0x0010E368
		private void DebateGameApplyDrawCardInUsed(DebateStrategyActionParams param)
		{
			int selfCount = 0;
			int opponentCount = 0;
			for (int i = 0; i < param.Value; i++)
			{
				bool isTaiwu = param.Context.Random.NextBool();
				List<int> collection;
				int location = this.Debate.TryGetStrategyCardIndexCollection(ref isTaiwu, 7, out collection);
				bool flag = location != -1;
				if (flag)
				{
					this.DebateGameAddPlayerCanUseCard(param.IsCastedByTaiwu, location, collection[(collection.Count == 1) ? 0 : param.Context.Random.Next(collection.Count)]);
					bool isCastedByTaiwu = param.IsCastedByTaiwu;
					if (isCastedByTaiwu)
					{
						bool flag2 = isTaiwu;
						if (flag2)
						{
							selfCount++;
						}
						else
						{
							opponentCount++;
						}
					}
				}
			}
			bool flag3 = selfCount > 0;
			if (flag3)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, true, DebateStrategy.Instance[param.StrategyTemplateId].DebateRecord, new int[]
				{
					(int)param.StrategyTemplateId,
					0,
					selfCount
				}));
			}
			bool flag4 = opponentCount > 0;
			if (flag4)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, true, DebateStrategy.Instance[param.StrategyTemplateId].DebateRecord, new int[]
				{
					(int)param.StrategyTemplateId,
					1,
					opponentCount
				}));
			}
		}

		// Token: 0x060010F5 RID: 4341 RVA: 0x001102C0 File Offset: 0x0010E4C0
		private void DebateGameApplyRevealStrategy(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			foreach (int strategyId in pawn.Strategies)
			{
				bool flag = strategyId >= 0;
				if (flag)
				{
					this.Debate.ActivatedStrategies[strategyId].IsRevealed = true;
				}
			}
		}

		// Token: 0x060010F6 RID: 4342 RVA: 0x00110323 File Offset: 0x0010E523
		private void DebateGameApplyPawnAvoidConflict(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].IsSwitchLocation = true;
		}

		// Token: 0x060010F7 RID: 4343 RVA: 0x00110342 File Offset: 0x0010E542
		private void DebateGameApplyPawnHalt(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].IsHalt = true;
		}

		// Token: 0x060010F8 RID: 4344 RVA: 0x00110364 File Offset: 0x0010E564
		private void DebateGameApplySplitPawn(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			int bases = this.Debate.GetPawnBases(param.PawnId, -1, true, true);
			bool isAlive = pawn.IsAlive;
			if (isAlive)
			{
				List<IntPair> coordinates = new List<IntPair>();
				bool flag = !this.Debate.TryGetEmptyNode(pawn.IsOwnedByTaiwu, coordinates) && this.Debate.DebateGrid[pawn.Coordinate].IsVantage != pawn.IsOwnedByTaiwu;
				if (!flag)
				{
					this.DebateGameSetPawnDead(param.Context, param.PawnId, 2, param.IsCastedByTaiwu);
					this.Debate.TryGetEmptyNode(pawn.IsOwnedByTaiwu, coordinates);
					int count = Math.Min(coordinates.Count, param.Value);
					bases /= count;
					for (int i = 0; i < count; i++)
					{
						bool flag2 = !this.Debate.TryGetEmptyNode(pawn.IsOwnedByTaiwu, coordinates);
						if (flag2)
						{
							break;
						}
						CollectionUtils.Shuffle<IntPair>(param.Context.Random, coordinates);
						this.DebateGameAddPawn(param.Context, coordinates[0], pawn.IsOwnedByTaiwu, 0, bases, false);
					}
				}
			}
		}

		// Token: 0x060010F9 RID: 4345 RVA: 0x001104A8 File Offset: 0x0010E6A8
		private void DebateGameApplyRemoveStrategy(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			foreach (int strategyId in pawn.Strategies)
			{
				bool flag = strategyId >= 0 && !this.Debate.ActivatedStrategies[strategyId].GetIsInertia();
				if (flag)
				{
					this.DebateGameRemoveStrategy(strategyId, param.IsCastedByTaiwu);
				}
			}
		}

		// Token: 0x060010FA RID: 4346 RVA: 0x0011051C File Offset: 0x0010E71C
		private void DebateGameApplyExchangeCard(DebateStrategyActionParams param)
		{
			List<short> list = this.Debate.PlayerLeft.CanUseCards;
			List<short> list2 = this.Debate.PlayerRight.CanUseCards;
			this.Debate.PlayerLeft.CanUseCards = list2;
			this.Debate.PlayerRight.CanUseCards = list;
			for (int i = 0; i < list.Count; i++)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(8, 2, 5, i, list[i], this.Debate.PlayerLeft, this.Debate.PlayerRight));
			}
			for (int j = 0; j < list2.Count; j++)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(8, 5, 2, j, list2[j], this.Debate.PlayerLeft, this.Debate.PlayerRight));
			}
			bool isCastedByTaiwu = param.IsCastedByTaiwu;
			if (isCastedByTaiwu)
			{
				this.Debate.DebateOperations.Add(new DebateOperation(20, true, DebateStrategy.Instance[param.StrategyTemplateId].DebateRecord, new int[]
				{
					(int)param.StrategyTemplateId
				}));
			}
		}

		// Token: 0x060010FB RID: 4347 RVA: 0x00110657 File Offset: 0x0010E857
		private void DebateGameApplyMakeMove(DebateStrategyActionParams param)
		{
			this.DebateGameMakeMove(param.Context, param.Coordinate, param.IsCastedByTaiwu, param.Grade, false);
		}

		// Token: 0x060010FC RID: 4348 RVA: 0x0011067C File Offset: 0x0010E87C
		private void DebateGameApplySwitchCoordinate(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			Pawn pawn2 = this.Debate.Pawns[param.PawnId2];
			IntPair coordinate = pawn.Coordinate;
			IntPair coordinate2 = pawn2.Coordinate;
			this.DebateGameSetPawnCoordinate(param.Context, param.PawnId, coordinate2, false);
			this.DebateGameSetPawnCoordinate(param.Context, param.PawnId2, coordinate, false);
		}

		// Token: 0x060010FD RID: 4349 RVA: 0x001106F0 File Offset: 0x0010E8F0
		private void DebateGameApplyTeleportCoordinate(DebateStrategyActionParams param)
		{
			this.DebateGameSetPawnCoordinate(param.Context, param.PawnId, param.Coordinate, false);
		}

		// Token: 0x060010FE RID: 4350 RVA: 0x00110710 File Offset: 0x0010E910
		private void DebateGameApplyRecycleStrategy(DebateStrategyActionParams param)
		{
			DebatePlayer player = this.Debate.GetPlayerByPlayerIsTaiwu(param.IsCastedByTaiwu);
			int offset = (param.Card > param.UsingCard) ? -1 : 0;
			short card = player.CanUseCards[param.Card + offset];
			sbyte cost = DebateStrategy.Instance[card].UsedCost;
			this.DebateGameChangePlayerStrategyPoint(player, (int)cost);
			this.DebateGameRemovePlayerCanUseCard(param.IsCastedByTaiwu, this.Debate.GetStrategyCardLocation(param.IsCastedByTaiwu, 7), param.Card, offset, true);
			bool isCastedByTaiwu = param.IsCastedByTaiwu;
			if (isCastedByTaiwu)
			{
				this.DebateGameAddStrategyRecord(true, DebateStrategy.Instance[param.StrategyTemplateId].DebateRecord, new List<short>
				{
					param.StrategyTemplateId,
					card
				}, null, new List<int>
				{
					(int)cost
				});
			}
		}

		// Token: 0x060010FF RID: 4351 RVA: 0x001107EC File Offset: 0x0010E9EC
		private void DebateGameApplyMergePawn(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			Pawn pawn2 = this.Debate.Pawns[param.PawnId2];
			bool flag = !pawn2.IsAlive;
			if (!flag)
			{
				this.DebateGameSetPawnBases(param.PawnId, pawn.Bases + this.Debate.GetPawnBases(param.PawnId2, -1, true, true));
				this.DebateGameSetPawnDead(param.Context, param.PawnId2, 2, param.IsCastedByTaiwu);
			}
		}

		// Token: 0x06001100 RID: 4352 RVA: 0x0011087C File Offset: 0x0010EA7C
		private void DebateGameApplyExchangeStrategy(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			Pawn pawn2 = this.Debate.Pawns[param.PawnId2];
			bool changeOwner = pawn.IsOwnedByTaiwu != pawn2.IsOwnedByTaiwu;
			for (int i = 0; i < DebateConstants.PawnStrategyLimit; i++)
			{
				int strategyId = pawn.Strategies[i];
				int strategyId2 = pawn2.Strategies[i];
				bool flag = strategyId >= 0 && this.Debate.ActivatedStrategies[strategyId].GetIsInertia();
				if (!flag)
				{
					bool flag2 = strategyId2 >= 0 && this.Debate.ActivatedStrategies[strategyId2].GetIsInertia();
					if (!flag2)
					{
						bool flag3 = strategyId >= 0;
						if (flag3)
						{
							this.Debate.DebateOperations.Add(new DebateOperation(13, pawn.Id, i, this.Debate.PlayerLeft, this.Debate.PlayerRight, param.IsCastedByTaiwu));
						}
						bool flag4 = strategyId2 >= 0;
						if (flag4)
						{
							this.Debate.DebateOperations.Add(new DebateOperation(13, pawn2.Id, i, this.Debate.PlayerLeft, this.Debate.PlayerRight, param.IsCastedByTaiwu));
						}
					}
				}
			}
			for (int j = 0; j < DebateConstants.PawnStrategyLimit; j++)
			{
				int strategyId3 = pawn.Strategies[j];
				int strategyId4 = pawn2.Strategies[j];
				bool flag5 = strategyId3 >= 0 && this.Debate.ActivatedStrategies[strategyId3].GetIsInertia();
				if (!flag5)
				{
					bool flag6 = strategyId4 >= 0 && this.Debate.ActivatedStrategies[strategyId4].GetIsInertia();
					if (!flag6)
					{
						bool flag7 = strategyId4 >= 0;
						if (flag7)
						{
							this.Debate.DebateOperations.Add(new DebateOperation(6, pawn.Id, j, this.Debate.PlayerLeft, this.Debate.PlayerRight, false));
						}
						bool flag8 = strategyId3 >= 0;
						if (flag8)
						{
							this.Debate.DebateOperations.Add(new DebateOperation(6, pawn2.Id, j, this.Debate.PlayerLeft, this.Debate.PlayerRight, false));
						}
					}
				}
			}
			for (int k = 0; k < DebateConstants.PawnStrategyLimit; k++)
			{
				int strategyId5 = pawn.Strategies[k];
				int strategyId6 = pawn2.Strategies[k];
				bool flag9 = strategyId5 >= 0 && this.Debate.ActivatedStrategies[strategyId5].GetIsInertia();
				if (!flag9)
				{
					bool flag10 = strategyId6 >= 0 && this.Debate.ActivatedStrategies[strategyId6].GetIsInertia();
					if (!flag10)
					{
						this.DebateGameChangePawnStrategy(param.PawnId, strategyId6, k, changeOwner);
						this.DebateGameChangePawnStrategy(param.PawnId2, strategyId5, k, changeOwner);
					}
				}
			}
		}

		// Token: 0x06001101 RID: 4353 RVA: 0x00110BA0 File Offset: 0x0010EDA0
		private void DebateGameApplyTeleportToBottom(DebateStrategyActionParams param)
		{
			Pawn pawn = this.Debate.Pawns[param.PawnId];
			bool flag = !pawn.IsAlive;
			if (!flag)
			{
				bool flag2 = !this.Debate.GetCoordinateValid(pawn.Coordinate);
				if (!flag2)
				{
					int spectatorId = param.NodeEffect.CasterId;
					bool isHelpTaiwu = this.DebateGameGetSpectatorHelpTaiwu(param.Context, spectatorId, pawn.IsOwnedByTaiwu);
					int direction = isHelpTaiwu ? -1 : 1;
					int targetX = this.Debate.GetStartCoordinate(!isHelpTaiwu) + direction;
					int targetY = -1;
					for (int y = 0; y < DebateConstants.DebateLineCount; y++)
					{
						bool flag3 = this.Debate.DebateGrid[new IntPair(targetX, y)].PawnId >= 0;
						if (!flag3)
						{
							bool flag4 = targetY >= 0 && param.Context.Random.NextBool();
							if (!flag4)
							{
								targetY = y;
							}
						}
					}
					IntPair coordinate = new IntPair(targetX, targetY);
					bool coordinateValid = this.Debate.GetCoordinateValid(coordinate);
					if (coordinateValid)
					{
						this.DebateGameSetPawnCoordinate(param.Context, pawn.Id, coordinate, false);
					}
				}
			}
		}

		// Token: 0x06001102 RID: 4354 RVA: 0x00110CD6 File Offset: 0x0010EED6
		private void DebateGameApplyDamageMoreByNode(DebateStrategyActionParams param)
		{
			this.Debate.Pawns[param.PawnId].NodeDamage = param.Value;
		}

		// Token: 0x06001103 RID: 4355 RVA: 0x00110CFC File Offset: 0x0010EEFC
		[DomainMethod]
		public List<ItemDisplayData> GetAllWarehouseItems(DataContext context)
		{
			return CharacterDomain.GetItemDisplayData(this.GetTaiwuCharId(), this._warehouseItems, ItemSourceType.Warehouse);
		}

		// Token: 0x06001104 RID: 4356 RVA: 0x00110D20 File Offset: 0x0010EF20
		[DomainMethod]
		public List<ItemDisplayData> GetAllWarehouseItemsExcludeValueZero(DataContext context)
		{
			Dictionary<ItemKey, int> itemDict = ObjectPool<Dictionary<ItemKey, int>>.Instance.Get();
			itemDict.Clear();
			foreach (KeyValuePair<ItemKey, int> pair in this._warehouseItems)
			{
				bool flag = DomainManager.Item.GetBaseItem(pair.Key).GetValue() > 0;
				if (flag)
				{
					itemDict.Add(pair.Key, pair.Value);
				}
			}
			List<ItemDisplayData> result = CharacterDomain.GetItemDisplayData(this.GetTaiwuCharId(), itemDict, ItemSourceType.Warehouse);
			ObjectPool<Dictionary<ItemKey, int>>.Instance.Return(itemDict);
			return result;
		}

		// Token: 0x06001105 RID: 4357 RVA: 0x00110DD8 File Offset: 0x0010EFD8
		[DomainMethod]
		public List<ItemDisplayData> GetTaiwuAllItems(DataContext context)
		{
			List<ItemDisplayData> itemDisplayDatas = this.GetAllWarehouseItemsExcludeValueZero(context);
			itemDisplayDatas.AddRange(DomainManager.Character.GetAllInventoryItemsExcludeValueZero(this._taiwuCharId));
			return itemDisplayDatas;
		}

		// Token: 0x06001106 RID: 4358 RVA: 0x00110E0C File Offset: 0x0010F00C
		[DomainMethod]
		public List<ItemDisplayData> GetWarehouseItemsBySubType(DataContext context, short itemSubType)
		{
			Dictionary<ItemKey, int> items = (from pair in this._warehouseItems
			where ItemTemplateHelper.GetItemSubType(pair.Key.ItemType, pair.Key.TemplateId) == itemSubType
			select pair).ToDictionary((KeyValuePair<ItemKey, int> pair) => pair.Key, (KeyValuePair<ItemKey, int> pair) => pair.Value);
			return CharacterDomain.GetItemDisplayData(this.GetTaiwuCharId(), items, ItemSourceType.Warehouse);
		}

		// Token: 0x06001107 RID: 4359 RVA: 0x00110E94 File Offset: 0x0010F094
		[DomainMethod]
		public List<ItemDisplayData> GetAllTroughItems(DataContext context)
		{
			return CharacterDomain.GetItemDisplayData(this.GetTaiwuCharId(), DomainManager.Extra.TroughItems, ItemSourceType.Trough);
		}

		// Token: 0x06001108 RID: 4360 RVA: 0x00110EBC File Offset: 0x0010F0BC
		[DomainMethod]
		public List<ItemDisplayData> GetAllTreasuryItems(DataContext context)
		{
			Dictionary<ItemKey, int> items = this.GetTaiwuTreasury().Inventory.Items;
			return CharacterDomain.GetItemDisplayData(this._taiwuCharId, items, ItemSourceType.Treasury);
		}

		// Token: 0x06001109 RID: 4361 RVA: 0x00110EEC File Offset: 0x0010F0EC
		private unsafe List<ItemDisplayData> GetResourcesItems(ResourceInts resources, ItemSourceType itemSourceType)
		{
			List<ItemDisplayData> resourceItemList = new List<ItemDisplayData>();
			for (int type = 0; type < 8; type++)
			{
				int amount = *resources[type];
				bool flag = amount <= 0;
				if (!flag)
				{
					short templateId = Convert.ToInt16(321 + type);
					ItemKey itemKey = new ItemKey(12, 0, templateId, 0);
					ItemDisplayData itemData = new ItemDisplayData
					{
						Key = itemKey,
						Amount = amount,
						ItemSourceType = (sbyte)itemSourceType
					};
					resourceItemList.Add(itemData);
				}
			}
			return resourceItemList;
		}

		// Token: 0x0600110A RID: 4362 RVA: 0x00110F78 File Offset: 0x0010F178
		[DomainMethod]
		[return: TupleElementNames(new string[]
		{
			"itemSourceType",
			"list"
		})]
		public unsafe ValueTuple<ItemSourceType, List<ItemDisplayData>> GetAllItems(ItemSourceType itemSourceType, bool includeResources = false)
		{
			bool flag = itemSourceType == ItemSourceType.Resources;
			ValueTuple<ItemSourceType, List<ItemDisplayData>> result;
			if (flag)
			{
				List<ItemDisplayData> resourcesItemDataList = this.GetResourcesItems(*this.GetTaiwu().GetResources(), ItemSourceType.Resources);
				result = new ValueTuple<ItemSourceType, List<ItemDisplayData>>(itemSourceType, resourcesItemDataList);
			}
			else
			{
				List<ItemDisplayData> list = CharacterDomain.GetItemDisplayData(this.GetTaiwuCharId(), this.GetItems(itemSourceType), itemSourceType);
				if (includeResources)
				{
					ResourceInts resources = this.GetTaiwuVillageResources(itemSourceType);
					List<ItemDisplayData> resourcesItemDataList2 = this.GetResourcesItems(resources, itemSourceType);
					list.AddRange(resourcesItemDataList2);
				}
				result = new ValueTuple<ItemSourceType, List<ItemDisplayData>>(itemSourceType, list);
			}
			return result;
		}

		// Token: 0x0600110B RID: 4363 RVA: 0x00110FF8 File Offset: 0x0010F1F8
		[DomainMethod]
		[return: TupleElementNames(new string[]
		{
			"itemSourceType",
			"resource"
		})]
		public unsafe ValueTuple<ItemSourceType, ResourceInts> GetAllResources(ItemSourceType itemSourceType)
		{
			ResourceInts resourceInts;
			if (itemSourceType != ItemSourceType.Resources)
			{
				resourceInts = this.GetTaiwuVillageResources(itemSourceType);
			}
			else
			{
				GameData.Domains.Character.Character taiwu = this.GetTaiwu();
				resourceInts = ((taiwu != null) ? (*taiwu.GetResources()) : default(ResourceInts));
			}
			ResourceInts resources = resourceInts;
			return new ValueTuple<ItemSourceType, ResourceInts>(itemSourceType, resources);
		}

		// Token: 0x0600110C RID: 4364 RVA: 0x00111040 File Offset: 0x0010F240
		public IReadOnlyDictionary<ItemKey, int> GetItems(ItemSourceType itemSourceType)
		{
			IReadOnlyDictionary<ItemKey, int> result;
			switch (itemSourceType)
			{
			case ItemSourceType.Equipment:
				result = (from k in this._taiwuChar.GetEquipment()
				select k into k
				where k.IsValid()
				select k).ToDictionary((ItemKey k) => k, (ItemKey _) => 1);
				break;
			case ItemSourceType.Inventory:
				result = this._taiwuChar.GetInventory().Items;
				break;
			case ItemSourceType.Warehouse:
				result = this._warehouseItems;
				break;
			case ItemSourceType.Treasury:
				result = this.GetTaiwuTreasury().Inventory.Items;
				break;
			case ItemSourceType.Trough:
				result = DomainManager.Extra.TroughItems;
				break;
			case ItemSourceType.StockStorageWarehouse:
				result = DomainManager.Extra.GetStockStorage().Inventories[0].Items;
				break;
			case ItemSourceType.StockStorageGoodsShelf:
				result = DomainManager.Extra.GetStockStorage().Inventories[1].Items;
				break;
			default:
				throw new ArgumentOutOfRangeException("itemSourceType", itemSourceType, null);
			}
			return result;
		}

		// Token: 0x0600110D RID: 4365 RVA: 0x00111198 File Offset: 0x0010F398
		private ResourceInts GetTaiwuVillageResources(ItemSourceType itemSourceType)
		{
			if (!true)
			{
			}
			ResourceInts result;
			if (itemSourceType != ItemSourceType.Treasury)
			{
				if (itemSourceType != ItemSourceType.StockStorageWarehouse)
				{
					result = default(ResourceInts);
				}
				else
				{
					result = DomainManager.Extra.GetStockStorage().Resources;
				}
			}
			else
			{
				SettlementTreasury taiwuTreasury = this.GetTaiwuTreasury();
				result = ((taiwuTreasury != null) ? taiwuTreasury.Resources : default(ResourceInts));
			}
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x0600110E RID: 4366 RVA: 0x001111FC File Offset: 0x0010F3FC
		[Obsolete]
		public void ReceiveItems(DataContext context, [TupleElementNames(new string[]
		{
			"itemKey",
			"amount"
		})] params ValueTuple<ItemKey, int>[] items)
		{
			bool flag = items.Length == 0;
			if (!flag)
			{
				foreach (ValueTuple<ItemKey, int> item in items)
				{
					ItemDisplayData displayData = DomainManager.Item.GetItemDisplayData(item.Item1, this._taiwuCharId);
					displayData.Amount = item.Item2;
					this._receivedItems.Add(displayData);
				}
				this.SetReceivedItems(this._receivedItems, context);
			}
		}

		// Token: 0x0600110F RID: 4367 RVA: 0x00111274 File Offset: 0x0010F474
		[Obsolete]
		public void ReceiveItems(DataContext context, [TupleElementNames(new string[]
		{
			"itemKey",
			"amount"
		})] IEnumerable<ValueTuple<ItemKey, int>> items)
		{
			foreach (ValueTuple<ItemKey, int> item in items)
			{
				ItemDisplayData displayData = DomainManager.Item.GetItemDisplayData(item.Item1, this._taiwuCharId);
				displayData.Amount = item.Item2;
				this._receivedItems.Add(displayData);
			}
			this.SetReceivedItems(this._receivedItems, context);
		}

		// Token: 0x06001110 RID: 4368 RVA: 0x001112F8 File Offset: 0x0010F4F8
		[Obsolete]
		public void ReceiveCharacters(DataContext context, params int[] charIds)
		{
			for (int i = 0; i < charIds.Length; i++)
			{
				CharacterDisplayData displayData = DomainManager.Character.GetCharacterDisplayData(charIds[i]);
				this._receivedCharacters.Add(displayData);
			}
			this.SetReceivedCharacters(this._receivedCharacters, context);
		}

		// Token: 0x06001111 RID: 4369 RVA: 0x00111344 File Offset: 0x0010F544
		[Obsolete]
		public void ReceiveCharacters(DataContext context, IEnumerable<int> charIds)
		{
			foreach (int charId in charIds)
			{
				CharacterDisplayData displayData = DomainManager.Character.GetCharacterDisplayData(charId);
				this._receivedCharacters.Add(displayData);
			}
			this.SetReceivedCharacters(this._receivedCharacters, context);
		}

		// Token: 0x06001112 RID: 4370 RVA: 0x001113B4 File Offset: 0x0010F5B4
		[DomainMethod]
		public void SwitchEquipmentPlan(DataContext context, int planId)
		{
			EquipmentPlan oriPlan = this._equipmentsPlans[this._currEquipmentPlanId];
			oriPlan.Record(this._taiwuChar);
			this.SetElement_EquipmentsPlans(this._currEquipmentPlanId, oriPlan, context);
			EquipmentPlan currPlan = this._equipmentsPlans[planId];
			currPlan.Apply(context, this._taiwuChar, false);
			currPlan.Record(this._taiwuChar);
			this.SetElement_EquipmentsPlans(planId, currPlan, context);
			this.SetCurrEquipmentPlanId(planId, context);
		}

		// Token: 0x06001113 RID: 4371 RVA: 0x00111424 File Offset: 0x0010F624
		public bool CheckItemIsInEquipmentPlan(ItemKey itemKey)
		{
			int num;
			int num2;
			return this.FindItemInEquipmentPlan(itemKey, out num, out num2);
		}

		// Token: 0x06001114 RID: 4372 RVA: 0x0011143C File Offset: 0x0010F63C
		public bool FindItemInEquipmentPlan(ItemKey itemKey, out int planIndex, out int slotIndex)
		{
			planIndex = -1;
			slotIndex = -1;
			bool flag = !ItemType.IsEquipmentItemType(itemKey.ItemType);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				for (int i = 0; i < this._equipmentsPlans.Length; i++)
				{
					bool flag2 = i == this._currEquipmentPlanId;
					if (!flag2)
					{
						EquipmentPlan plan = this._equipmentsPlans[i];
						for (int j = 0; j < plan.Slots.Length; j++)
						{
							ItemKey key = plan.Slots[j];
							bool flag3 = key.Equals(itemKey);
							if (flag3)
							{
								planIndex = i;
								slotIndex = j;
								return true;
							}
						}
					}
				}
				result = false;
			}
			return result;
		}

		// Token: 0x06001115 RID: 4373 RVA: 0x001114EC File Offset: 0x0010F6EC
		public void SetEquipmentPlan(DataContext context, ItemKey itemKey, int planIndex, int slotIndex)
		{
			bool flag = !this._equipmentsPlans.CheckIndex(planIndex);
			if (!flag)
			{
				EquipmentPlan plan = this.GetElement_EquipmentsPlans(planIndex);
				bool flag2 = !plan.Slots.CheckIndex(slotIndex);
				if (!flag2)
				{
					plan.Slots[slotIndex] = itemKey;
					this.SetElement_EquipmentsPlans(planIndex, plan, context);
				}
			}
		}

		// Token: 0x06001116 RID: 4374 RVA: 0x00111548 File Offset: 0x0010F748
		public void ReCalcAllEquipment(DataContext context)
		{
			TaiwuDomain.<>c__DisplayClass468_0 CS$<>8__locals1;
			CS$<>8__locals1.context = context;
			ItemKey[] equipmentArray = this._taiwuChar.GetEquipment();
			foreach (ItemKey equipment in equipmentArray)
			{
				bool flag = equipment.IsValid();
				if (flag)
				{
					TaiwuDomain.<ReCalcAllEquipment>g__UpdateEquipment|468_1(equipment, ref CS$<>8__locals1);
				}
			}
			this._taiwuChar.SetEquipment(equipmentArray, CS$<>8__locals1.context);
			Inventory inventory = this._taiwuChar.GetInventory();
			bool inventoryModified = TaiwuDomain.<ReCalcAllEquipment>g__UpdateEquipmentsInDictionary|468_0(inventory.Items, ref CS$<>8__locals1);
			bool flag2 = inventoryModified;
			if (flag2)
			{
				this._taiwuChar.SetInventory(inventory, CS$<>8__locals1.context);
			}
			bool warehouseModified = TaiwuDomain.<ReCalcAllEquipment>g__UpdateEquipmentsInDictionary|468_0(this._warehouseItems, ref CS$<>8__locals1);
			bool flag3 = warehouseModified;
			if (flag3)
			{
				KeyValuePair<ItemKey, int> pair = this._warehouseItems.First<KeyValuePair<ItemKey, int>>();
				this.SetElement_WarehouseItems(pair.Key, pair.Value, CS$<>8__locals1.context);
			}
			TaiwuVillageStorage stockStorage = DomainManager.Extra.GetStockStorage();
			foreach (Inventory subStorage in stockStorage.Inventories)
			{
				bool flag4 = TaiwuDomain.<ReCalcAllEquipment>g__UpdateEquipmentsInDictionary|468_0(subStorage.Items, ref CS$<>8__locals1);
				if (flag4)
				{
					stockStorage.NeedCommit = true;
				}
			}
			TaiwuVillageStorage craftStorage = DomainManager.Extra.GetCraftStorage();
			foreach (Inventory subStorage2 in craftStorage.Inventories)
			{
				bool flag5 = TaiwuDomain.<ReCalcAllEquipment>g__UpdateEquipmentsInDictionary|468_0(subStorage2.Items, ref CS$<>8__locals1);
				if (flag5)
				{
					craftStorage.NeedCommit = true;
				}
			}
		}

		// Token: 0x06001117 RID: 4375 RVA: 0x001116C8 File Offset: 0x0010F8C8
		[DomainMethod]
		public void TaiwuFollowNpc(DataContext context, int npcId)
		{
			List<int> list = DomainManager.Extra.GetFollowingNpcList();
			bool flag = !this.OfflineFollowNpc(list, npcId);
			if (!flag)
			{
				DomainManager.Extra.SaveFollowingNpcList(context, list);
			}
		}

		// Token: 0x06001118 RID: 4376 RVA: 0x00111700 File Offset: 0x0010F900
		private bool OfflineFollowNpc(List<int> followingNpcList, int npcId)
		{
			bool isFollowingNpcListMax = DomainManager.Taiwu.GetIsFollowingNpcListMax();
			bool result;
			if (isFollowingNpcListMax)
			{
				result = false;
			}
			else
			{
				bool flag = followingNpcList.Contains(npcId);
				if (flag)
				{
					result = false;
				}
				else
				{
					followingNpcList.Add(npcId);
					result = true;
				}
			}
			return result;
		}

		// Token: 0x06001119 RID: 4377 RVA: 0x00111740 File Offset: 0x0010F940
		[DomainMethod]
		public void TaiwuUnfollowNpc(DataContext context, int characterId)
		{
			List<int> list = DomainManager.Extra.GetFollowingNpcList();
			bool flag = !this.OfflineUnfollowNpc(list, characterId);
			if (!flag)
			{
				DomainManager.Extra.RemoveFollowingNpcNickName(context, characterId);
				DomainManager.Extra.SaveFollowingNpcList(context, list);
			}
		}

		// Token: 0x0600111A RID: 4378 RVA: 0x00111784 File Offset: 0x0010F984
		private bool OfflineUnfollowNpc(List<int> followingNpcList, int npcId)
		{
			bool flag = !followingNpcList.Contains(npcId);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				followingNpcList.Remove(npcId);
				result = true;
			}
			return result;
		}

		// Token: 0x0600111B RID: 4379 RVA: 0x001117B4 File Offset: 0x0010F9B4
		[DomainMethod]
		public void GmCmd_FollowRandomNpc(DataContext context, int count)
		{
			List<GameData.Domains.Character.Character> chars = new List<GameData.Domains.Character.Character>();
			DomainManager.Character.FindIntelligentCharacters((GameData.Domains.Character.Character _) => true, chars);
			List<int> list = DomainManager.Extra.GetFollowingNpcList();
			for (int i = 0; i < count; i++)
			{
				int randIndex = context.Random.Next(0, chars.Count);
				GameData.Domains.Character.Character target = chars[randIndex];
				this.OfflineFollowNpc(list, target.GetId());
			}
			DomainManager.Extra.SaveFollowingNpcList(context, list);
		}

		// Token: 0x0600111C RID: 4380 RVA: 0x0011184C File Offset: 0x0010FA4C
		public bool IsCharacterFollowedByTaiwu(int npcId)
		{
			List<int> list = DomainManager.Extra.GetFollowingNpcList();
			return list.Contains(npcId);
		}

		// Token: 0x0600111D RID: 4381 RVA: 0x00111870 File Offset: 0x0010FA70
		[DomainMethod]
		public int GetFollowingNpcListMaxCount()
		{
			return 10 + DomainManager.Map.GetStationUnlockedRegularAreaCount();
		}

		// Token: 0x0600111E RID: 4382 RVA: 0x00111890 File Offset: 0x0010FA90
		[DomainMethod]
		public bool GetIsFollowingNpcListMax()
		{
			return DomainManager.Extra.GetFollowingNpcList().Count >= DomainManager.Taiwu.GetFollowingNpcListMaxCount();
		}

		// Token: 0x0600111F RID: 4383 RVA: 0x001118C0 File Offset: 0x0010FAC0
		public void GenerateAllFollowingMonthNotifications()
		{
			List<int> list = DomainManager.Extra.GetFollowingNpcList();
			MonthlyNotificationCollection monthlyNotificationCollection = DomainManager.World.GetMonthlyNotificationCollection();
			foreach (int characterId in list)
			{
				this.GenerateSingleFollowingMonthNotification(characterId, monthlyNotificationCollection);
			}
		}

		// Token: 0x06001120 RID: 4384 RVA: 0x0011192C File Offset: 0x0010FB2C
		private void GenerateSingleFollowingMonthNotification(int characterId, MonthlyNotificationCollection monthlyNotificationCollection)
		{
			GameData.Domains.Character.Character character;
			bool flag = !DomainManager.Character.TryGetElement_Objects(characterId, out character);
			if (!flag)
			{
				this.TryGenerateHealthNotification(character, monthlyNotificationCollection);
				bool added = this.TryGenerateDisorderOfQiNotification(character, monthlyNotificationCollection);
				bool flag2 = !added;
				if (flag2)
				{
					added = this.TryGenerateInjuryNotification(character, monthlyNotificationCollection);
				}
				bool flag3 = !added;
				if (flag3)
				{
					this.TryGeneratePoisonNotification(character, monthlyNotificationCollection);
				}
				this.TryGenerateKidnappedOrInAdventure(character, monthlyNotificationCollection);
			}
		}

		// Token: 0x06001121 RID: 4385 RVA: 0x00111990 File Offset: 0x0010FB90
		private void TryGenerateKidnappedOrInAdventure(GameData.Domains.Character.Character character, MonthlyNotificationCollection monthlyNotificationCollection)
		{
			bool flag = character.GetKidnapperId() != -1;
			if (flag)
			{
				monthlyNotificationCollection.AddTrappedNotice(character.GetId());
			}
			else
			{
				bool flag2 = character.IsActiveExternalRelationState(4);
				if (flag2)
				{
					bool flag3 = character.GetKidnappingEnemyNestAdventure() != -1;
					if (flag3)
					{
						monthlyNotificationCollection.AddTrappedNotice(character.GetId());
					}
				}
			}
		}

		// Token: 0x06001122 RID: 4386 RVA: 0x001119EC File Offset: 0x0010FBEC
		private unsafe bool TryGeneratePoisonNotification(GameData.Domains.Character.Character character, MonthlyNotificationCollection monthlyNotificationCollection)
		{
			PoisonInts poisoned = *character.GetPoisoned();
			for (int i = 0; i < 6; i++)
			{
				bool flag = *poisoned[i] > 0;
				if (flag)
				{
					monthlyNotificationCollection.AddInjuredNotice(character.GetId());
					return true;
				}
			}
			return false;
		}

		// Token: 0x06001123 RID: 4387 RVA: 0x00111A44 File Offset: 0x0010FC44
		private bool TryGenerateInjuryNotification(GameData.Domains.Character.Character character, MonthlyNotificationCollection monthlyNotificationCollection)
		{
			Injuries injuries = character.GetInjuries();
			for (sbyte bodyType = 0; bodyType < 7; bodyType += 1)
			{
				ValueTuple<sbyte, sbyte> valueTuple = injuries.Get(bodyType);
				sbyte outer = valueTuple.Item1;
				sbyte inner = valueTuple.Item2;
				bool flag = outer >= 2 && inner >= 2;
				if (flag)
				{
					monthlyNotificationCollection.AddInjuredNotice(character.GetId());
					return true;
				}
			}
			return false;
		}

		// Token: 0x06001124 RID: 4388 RVA: 0x00111AB4 File Offset: 0x0010FCB4
		private bool TryGenerateDisorderOfQiNotification(GameData.Domains.Character.Character character, MonthlyNotificationCollection monthlyNotificationCollection)
		{
			short disorderOfQi = character.GetDisorderOfQi();
			bool flag = disorderOfQi > 400;
			bool result;
			if (flag)
			{
				monthlyNotificationCollection.AddInjuredNotice(character.GetId());
				result = true;
			}
			else
			{
				result = false;
			}
			return result;
		}

		// Token: 0x06001125 RID: 4389 RVA: 0x00111AEC File Offset: 0x0010FCEC
		private void TryGenerateHealthNotification(GameData.Domains.Character.Character character, MonthlyNotificationCollection monthlyNotificationCollection)
		{
			short health = character.GetHealth();
			short maxHealth = character.GetLeftMaxHealth(false);
			bool flag = maxHealth > health * 5;
			if (flag)
			{
				monthlyNotificationCollection.AddDyingNotice(character.GetId());
			}
		}

		// Token: 0x06001126 RID: 4390 RVA: 0x00111B24 File Offset: 0x0010FD24
		[DomainMethod]
		public int SetFollowingNpcNickName(DataContext context, int characterId, string nickName)
		{
			return DomainManager.Extra.SetFollowingNpcNickName(context, characterId, nickName);
		}

		// Token: 0x06001127 RID: 4391 RVA: 0x00111B44 File Offset: 0x0010FD44
		[DomainMethod]
		public string GetFollowingNpcNickName(int characterId)
		{
			int key;
			bool flag = DomainManager.Extra.TryGetElement_FollowingNickNameMap(characterId, out key);
			string result;
			if (flag)
			{
				result = DomainManager.World.GetElement_CustomTexts(key);
			}
			else
			{
				result = null;
			}
			return result;
		}

		// Token: 0x06001128 RID: 4392 RVA: 0x00111B78 File Offset: 0x0010FD78
		[DomainMethod]
		public int GetFollowingNpcNickNameId(int characterId)
		{
			int key;
			bool flag = DomainManager.Extra.TryGetElement_FollowingNickNameMap(characterId, out key);
			int result;
			if (flag)
			{
				result = key;
			}
			else
			{
				result = -1;
			}
			return result;
		}

		// Token: 0x06001129 RID: 4393 RVA: 0x00111BA4 File Offset: 0x0010FDA4
		public void UpdateFollowingNotifications(DataContext context)
		{
			MonthlyNotificationCollection monthlyNotificationCollection = DomainManager.World.GetMonthlyNotificationCollection();
			foreach (int charId in DomainManager.Extra.GetFollowingNpcList())
			{
				GameData.Domains.Character.Character character;
				bool flag = DomainManager.Character.TryGetElement_Objects(charId, out character);
				if (flag)
				{
					foreach (sbyte sect in DomainManager.Organization.GetFugitiveBountySects(charId))
					{
						monthlyNotificationCollection.AddWantedNotice(charId, DomainManager.Organization.GetSettlementIdByOrgTemplateId(sect));
					}
				}
			}
		}

		// Token: 0x0600112A RID: 4394 RVA: 0x00111C6C File Offset: 0x0010FE6C
		[DomainMethod]
		public void GmCmd_AddResource(DataContext context, sbyte type, int count)
		{
			bool flag = count < 0;
			if (flag)
			{
				count = Math.Max(count, -this._taiwuChar.GetResource(type));
			}
			this._taiwuChar.ChangeResource(context, type, count);
		}

		// Token: 0x0600112B RID: 4395 RVA: 0x00111CA6 File Offset: 0x0010FEA6
		[DomainMethod]
		public void GmCmd_AddLegacyPoint(DataContext context, short template, int percent)
		{
			this.AddLegacyPoint(context, template, percent);
		}

		// Token: 0x0600112C RID: 4396 RVA: 0x00111CB4 File Offset: 0x0010FEB4
		[DomainMethod]
		public void GmCmd_FillLegacyPoint(DataContext context, short templateId)
		{
			LegacyPointItem config = LegacyPoint.Instance[templateId];
			int maxValue = TaiwuDomain.GetLegacyMaxPoint(config);
			this.DirectlyAddLegacyPoint(context, templateId, maxValue);
		}

		// Token: 0x0600112D RID: 4397 RVA: 0x00111CDF File Offset: 0x0010FEDF
		[DomainMethod]
		public void GmCmd_AddExp(DataContext context, int count)
		{
			this._taiwuChar.ChangeExp(context, count);
		}

		// Token: 0x0600112E RID: 4398 RVA: 0x00111CF0 File Offset: 0x0010FEF0
		[DomainMethod]
		public void GmCmd_SetTaiwuCombatSkillActiveState(DataContext context, short skillTemplateId, ushort selectedPages, bool bonusOn = false)
		{
			bool flag = this._skillBreakBonusDict.ContainsKey(skillTemplateId);
			if (flag)
			{
				this.RemoveElement_SkillBreakBonusDict(skillTemplateId, context);
			}
			bool flag2 = this._taiwuChar.IsCombatSkillEquipped(skillTemplateId);
			if (flag2)
			{
				DomainManager.SpecialEffect.Remove(context, this._taiwuCharId, skillTemplateId, 2);
			}
			bool flag3 = CombatSkillStateHelper.IsBrokenOut(selectedPages);
			if (flag3)
			{
				this.ClearBreakPlate(context, skillTemplateId, true);
				SkillBreakPlate plate = this.EnterSkillBreakPlate(context, skillTemplateId, selectedPages);
				if (bonusOn)
				{
					for (int i = 0; i < (int)plate.Width; i++)
					{
						for (int j = 0; j < (int)plate.Height; j++)
						{
							SkillBreakPlateGrid grid = plate[i, j];
							bool flag4 = grid.AddMaxPower > 0 || grid.TemplateId == 2;
							if (flag4)
							{
								grid.State = ESkillBreakGridState.Selected;
							}
						}
					}
				}
				plate.SelectBreakWithoutCheck(new ValueTuple<int, int>((int)((plate.Width - (SkillBreakPlate.IsProtrusion((int)(plate.Height / 2)) ? 0 : 1)) / 2), (int)(plate.Height / 2)));
				this.FinishBreak(context, skillTemplateId, plate);
				DomainManager.Extra.SetOrAddSkillBreakPlate(context, skillTemplateId, plate);
			}
			else
			{
				bool flag5 = this._skillBreakPlateObsoleteDict.ContainsKey(skillTemplateId);
				if (flag5)
				{
					this.RemoveElement_SkillBreakPlateObsoleteDict(skillTemplateId, context);
				}
				DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillTemplateId)).SetActivationState(selectedPages, context);
				CharacterDomain.TryRemoveCombatSkillFromAttainmentPanel(context, this._taiwuChar, skillTemplateId);
			}
		}

		// Token: 0x0600112F RID: 4399 RVA: 0x00111E6C File Offset: 0x0011006C
		[DomainMethod]
		public void GmCmd_MarkAllCarrierFullTamePoint(DataContext context)
		{
			TaiwuDomain.<>c__DisplayClass493_0 CS$<>8__locals1;
			CS$<>8__locals1.carrierIds = new List<int>();
			TaiwuDomain.<GmCmd_MarkAllCarrierFullTamePoint>g__TryAddCarrierId|493_0(this._taiwuChar.GetEquipment()[11], ref CS$<>8__locals1);
			Inventory inventory = this._taiwuChar.GetInventory();
			foreach (ItemKey itemKey in inventory.Items.Keys)
			{
				TaiwuDomain.<GmCmd_MarkAllCarrierFullTamePoint>g__TryAddCarrierId|493_0(itemKey, ref CS$<>8__locals1);
			}
			foreach (int carrierId in CS$<>8__locals1.carrierIds)
			{
				int maxTamePoint = DomainManager.Extra.GetCarrierMaxTamePoint(carrierId);
				DomainManager.Extra.SetCarrierTamePoint(context, carrierId, maxTamePoint);
			}
		}

		// Token: 0x06001130 RID: 4400 RVA: 0x00111F5C File Offset: 0x0011015C
		[DomainMethod]
		public void GmCmd_LifeSkillCombatAiSetAlwaysUseForceAdversary(DataContext context, sbyte playerId, bool active)
		{
			bool flag = this._lifeSkillCombat == null;
			if (!flag)
			{
				Match.Ai aiState = this._lifeSkillCombat.GetAiState(playerId);
				aiState.AlwaysUseForceAdversary = active;
			}
		}

		// Token: 0x06001131 RID: 4401 RVA: 0x00111F90 File Offset: 0x00110190
		[DomainMethod]
		public void JoinGroup(DataContext context, int charId, bool showNotification = true)
		{
			DomainManager.Extra.ApplyGroupCharEquipmentPlan(context, charId);
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			bool flag = character.GetLeaderId() >= 0;
			if (flag)
			{
				DomainManager.Character.LeaveGroup(context, character, true);
			}
			bool flag2 = character.IsCreatedWithFixedTemplate() && charId != this._taiwuCharId;
			if (flag2)
			{
				character.SetLeaderId(this._taiwuCharId, context);
				DomainManager.Extra.AddSpecialGroupCharacter(context, this._taiwuCharId, charId);
			}
			else
			{
				bool flag3 = character.GetLeaderId() == charId;
				if (flag3)
				{
					foreach (int prevGroupCharId in DomainManager.Character.GetGroup(charId).GetCollection())
					{
						bool flag4 = prevGroupCharId == charId;
						if (!flag4)
						{
							this.JoinGroup(context, prevGroupCharId, true);
						}
					}
				}
				CharacterCombatSkillConfiguration skillConfiguration = DomainManager.Extra.TryGetCharacterCombatSkillConfiguration(charId);
				bool flag5 = skillConfiguration != null;
				if (flag5)
				{
					bool isCombatSkillLocked = skillConfiguration.IsCombatSkillLocked;
					if (isCombatSkillLocked)
					{
						DomainManager.Character.ApplyCombatSkillPlan(context, character, skillConfiguration.CurrentEquipPlan);
						DomainManager.Extra.SetCharacterMasteredCombatSkills(context, charId, skillConfiguration.CurrentMasterPlan);
					}
					bool isNeiliAllocationLocked = skillConfiguration.IsNeiliAllocationLocked;
					if (isNeiliAllocationLocked)
					{
						DomainManager.Character.ApplyNeiliAllocation(context, character, skillConfiguration.NeiliAllocation);
					}
					bool isCombatSkillAttainmentLocked = skillConfiguration.IsCombatSkillAttainmentLocked;
					if (isCombatSkillAttainmentLocked)
					{
						DomainManager.Character.ApplyCombatSkillAttainmentPanels(context, character, skillConfiguration.CombatSkillAttainmentPanels);
					}
				}
				this._groupCharIds.Add(charId);
				this.SetGroupCharIds(this._groupCharIds, context);
				character.SetLeaderId(this._taiwuCharId, context);
				Events.RaiseCharacterLocationChanged(context, charId, character.GetLocation(), Location.Invalid);
				character.SetLocation(this._taiwuChar.GetLocation(), context);
				OrganizationInfo orgInfo = character.GetOrganizationInfo();
				OrganizationInfo destOrgInfo = this._taiwuChar.GetOrganizationInfo();
				bool flag6 = orgInfo.OrgTemplateId != destOrgInfo.OrgTemplateId || orgInfo.SettlementId != destOrgInfo.SettlementId;
				if (flag6)
				{
					destOrgInfo.Grade = 0;
					destOrgInfo.Principal = true;
					DomainManager.Organization.ChangeOrganization(context, character, destOrgInfo);
				}
				else
				{
					bool flag7 = orgInfo.OrgTemplateId == 16;
					if (flag7)
					{
						DomainManager.Taiwu.TryRemoveTaiwuVillageResident(context, charId);
						DomainManager.Building.TryRemoveFeastCustomer(context, charId);
					}
				}
				Tester.Assert(!character.IsActiveExternalRelationState(32), "");
				Tester.Assert(!character.IsActiveExternalRelationState(8), "");
				bool flag8 = character.IsActiveExternalRelationState(60);
				if (flag8)
				{
					character.DeactivateExternalRelationState(context, 60);
				}
				foreach (int charInTeam in this._groupCharIds.GetCollection())
				{
					bool flag9 = charInTeam == charId;
					if (!flag9)
					{
						DomainManager.Character.TryCreateRelation(context, charId, charInTeam);
					}
				}
				short currMusicId = DomainManager.Extra.GetSectXuannvPlayerMusicId();
				bool isEnabled = DomainManager.Extra.GetSectXuannvPlayerIsEnabled();
				bool flag10 = currMusicId >= 0 && isEnabled;
				if (flag10)
				{
					short featureId = Music.Instance[currMusicId].TemporaryFeature;
					character.AddFeature(context, featureId, true);
				}
				if (showNotification)
				{
					InstantNotificationCollection instantNotifications = DomainManager.World.GetInstantNotificationCollection();
					instantNotifications.AddJoinGroup(charId);
				}
				DomainManager.TaiwuEvent.RecordTeammateStateChanged(false, charId);
			}
		}

		// Token: 0x06001132 RID: 4402 RVA: 0x00112314 File Offset: 0x00110514
		[DomainMethod]
		public void LeaveGroup(DataContext context, int charId, bool bringWards = true, bool showNotification = true, bool moveToRandomAdjacentBlock = true)
		{
			for (int i = 0; i < this._combatGroupCharIds.Length; i++)
			{
				bool flag = this._combatGroupCharIds[i] == charId;
				if (flag)
				{
					this.SetElement_CombatGroupCharIds(i, -1, context);
				}
			}
			GameData.Domains.Character.Character character;
			bool characterExists = DomainManager.Character.TryGetElement_Objects(charId, out character);
			bool flag2 = characterExists && character.IsCreatedWithFixedTemplate() && charId != this._taiwuCharId;
			if (flag2)
			{
				character.SetLeaderId(-1, context);
				character.RemoveFeatureGroup(context, 416);
				DomainManager.Extra.TryRemoveSpecialGroupCharacter(context, this._taiwuCharId, charId);
			}
			else
			{
				ValueTuple<bool, bool> result = this._groupCharIds.Remove(charId);
				bool flag3 = !result.Item2;
				if (flag3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(30, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Character ");
					defaultInterpolatedStringHandler.AppendFormatted<int>(charId);
					defaultInterpolatedStringHandler.AppendLiteral(" is not in the group");
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.SetGroupCharIds(this._groupCharIds, context);
				DomainManager.Extra.RemoveManualChangeEquipGroupChar(context, charId);
				DomainManager.Extra.SaveGroupCharEquipmentPlan(context, charId);
				bool flag4 = characterExists;
				if (flag4)
				{
					CharacterCombatSkillConfiguration skillConfiguration = DomainManager.Extra.TryGetCharacterCombatSkillConfiguration(charId);
					bool flag5 = skillConfiguration != null;
					if (flag5)
					{
						bool isCombatSkillLocked = skillConfiguration.IsCombatSkillLocked;
						if (isCombatSkillLocked)
						{
							skillConfiguration.OfflineRecordCombatSkillPlan(character, skillConfiguration.CurrentPlanId);
						}
						bool isNeiliAllocationLocked = skillConfiguration.IsNeiliAllocationLocked;
						if (isNeiliAllocationLocked)
						{
							skillConfiguration.OfflineRecordNeiliAllocation(character);
						}
						bool isCombatSkillAttainmentLocked = skillConfiguration.IsCombatSkillAttainmentLocked;
						if (isCombatSkillAttainmentLocked)
						{
							skillConfiguration.OfflineRecordCombatSkillAttainmentPanels(character);
						}
						DomainManager.Extra.SetCharacterCombatSkillConfiguration(context, charId, skillConfiguration);
					}
					character.SetLeaderId(-1, context);
					Location location = this._taiwuChar.GetLocation();
					bool flag6 = !location.IsValid();
					if (flag6)
					{
						location = this._taiwuChar.GetValidLocation();
					}
					if (moveToRandomAdjacentBlock)
					{
						short adjacentBlockId = DomainManager.Map.GetRandomAdjacentBlockId(context.Random, location.AreaId, location.BlockId);
						location.BlockId = adjacentBlockId;
					}
					Events.RaiseCharacterLocationChanged(context, charId, character.GetLocation(), location);
					character.SetLocation(location, context);
					character.RemoveFeatureGroup(context, 416);
					bool flag7 = character.GetOrganizationInfo().OrgTemplateId == 16;
					if (flag7)
					{
						DomainManager.Taiwu.AddTaiwuVillageResident(context, charId);
					}
					if (bringWards)
					{
						HashSet<int> wards = ObjectPool<HashSet<int>>.Instance.Get();
						DomainManager.Character.GetWardsInGroup(character, this._groupCharIds, wards);
						DomainManager.Character.ChangeGroup(context, wards, character);
					}
					if (showNotification)
					{
						InstantNotificationCollection instantNotifications = DomainManager.World.GetInstantNotificationCollection();
						instantNotifications.AddLeaveGroup(charId);
					}
					DomainManager.TaiwuEvent.RecordTeammateStateChanged(true, charId);
				}
			}
		}

		// Token: 0x06001133 RID: 4403 RVA: 0x001125C8 File Offset: 0x001107C8
		[DomainMethod]
		public List<CharacterDisplayData> GetInventoryOverloadedGroupCharNames()
		{
			List<CharacterDisplayData> inventoryOverloadChars = new List<CharacterDisplayData>();
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
				int currLoad = groupChar.GetCurrInventoryLoad();
				int maxLoad = groupChar.GetMaxInventoryLoad();
				bool flag = currLoad > maxLoad;
				if (flag)
				{
					CharacterDisplayData data = DomainManager.Character.GetCharacterDisplayData(charId);
					inventoryOverloadChars.Add(data);
				}
			}
			foreach (int charId2 in this._taiwuSpecialGroup)
			{
				GameData.Domains.Character.Character groupChar2 = DomainManager.Character.GetElement_Objects(charId2);
				int currLoad2 = groupChar2.GetCurrInventoryLoad();
				int maxLoad2 = groupChar2.GetMaxInventoryLoad();
				bool flag2 = currLoad2 > maxLoad2;
				if (flag2)
				{
					CharacterDisplayData data2 = DomainManager.Character.GetCharacterDisplayData(charId2);
					inventoryOverloadChars.Add(data2);
				}
			}
			return inventoryOverloadChars;
		}

		// Token: 0x06001134 RID: 4404 RVA: 0x001126F4 File Offset: 0x001108F4
		[DomainMethod]
		public List<NameRelatedData> GetSeverelyInjuredGroupCharNames(bool includeTaiwu = false)
		{
			int taiwuId = DomainManager.Taiwu.GetTaiwuCharId();
			List<NameRelatedData> severelyInjuredChars = new List<NameRelatedData>();
			if (includeTaiwu)
			{
				bool added = false;
				GameData.Domains.Character.Character taiwu = DomainManager.Taiwu.GetTaiwu();
				for (sbyte bodyPart = 0; bodyPart < 7; bodyPart += 1)
				{
					ValueTuple<sbyte, sbyte> valueTuple = taiwu.GetInjuries().Get(bodyPart);
					sbyte outer = valueTuple.Item1;
					sbyte inner = valueTuple.Item2;
					bool flag = outer >= 2 || inner >= 2;
					if (flag)
					{
						NameRelatedData data = new NameRelatedData();
						CharacterDomain.GetNameRelatedData(taiwu, ref data);
						severelyInjuredChars.Add(data);
						added = true;
						break;
					}
				}
				bool flag2 = !added;
				if (flag2)
				{
					severelyInjuredChars.Add(new NameRelatedData
					{
						CharTemplateId = -1
					});
				}
			}
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				bool flag3 = charId == taiwuId;
				if (!flag3)
				{
					GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
					for (sbyte bodyPart2 = 0; bodyPart2 < 7; bodyPart2 += 1)
					{
						ValueTuple<sbyte, sbyte> valueTuple2 = groupChar.GetInjuries().Get(bodyPart2);
						sbyte outer2 = valueTuple2.Item1;
						sbyte inner2 = valueTuple2.Item2;
						bool flag4 = outer2 >= 2 || inner2 >= 2;
						if (flag4)
						{
							NameRelatedData data2 = new NameRelatedData();
							CharacterDomain.GetNameRelatedData(groupChar, ref data2);
							severelyInjuredChars.Add(data2);
							break;
						}
					}
				}
			}
			return severelyInjuredChars;
		}

		// Token: 0x06001135 RID: 4405 RVA: 0x0011289C File Offset: 0x00110A9C
		[DomainMethod]
		public List<NameRelatedData> GetDyingGroupCharNames(bool includeTaiwu = false)
		{
			List<NameRelatedData> dyingChars = new List<NameRelatedData>();
			int taiwuId = DomainManager.Taiwu.GetTaiwuCharId();
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				bool flag = charId == taiwuId && !includeTaiwu;
				if (!flag)
				{
					GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
					EHealthType type = groupChar.GetHealthType();
					bool flag2 = type <= EHealthType.CriticallyIll;
					bool flag3 = flag2;
					if (flag3)
					{
						NameRelatedData nameData = new NameRelatedData();
						CharacterDomain.GetNameRelatedData(groupChar, ref nameData);
						dyingChars.Add(nameData);
					}
				}
			}
			return dyingChars;
		}

		// Token: 0x06001136 RID: 4406 RVA: 0x00112968 File Offset: 0x00110B68
		public bool IsInGroup(int charId)
		{
			return this._groupCharIds.Contains(charId) || DomainManager.Extra.GetSpecialGroup(this._taiwuCharId).Contains(charId);
		}

		// Token: 0x06001137 RID: 4407 RVA: 0x001129A4 File Offset: 0x00110BA4
		public int GetCharCombatGroupIndex(int charId)
		{
			return this._combatGroupCharIds.IndexOf(charId);
		}

		// Token: 0x06001138 RID: 4408 RVA: 0x001129C4 File Offset: 0x00110BC4
		public void UpdateTaiwuGroupFavorabilities(DataContext context)
		{
			bool flag = this._groupCharIds.GetCount() <= 1;
			if (!flag)
			{
				HashSet<int> collection = this._groupCharIds.GetCollection();
				foreach (int selfCharId in collection)
				{
					GameData.Domains.Character.Character selfChar = DomainManager.Character.GetElement_Objects(selfCharId);
					ValueTuple<short, short> range = AiHelper.UpdateStatusConstants.SameGroupFavorabilityChange[(int)selfChar.GetBehaviorType()];
					foreach (int targetCharId in collection)
					{
						bool flag2 = selfCharId == targetCharId;
						if (!flag2)
						{
							GameData.Domains.Character.Character targetChar = DomainManager.Character.GetElement_Objects(targetCharId);
							int favorDelta = context.Random.Next((int)range.Item1, (int)(range.Item2 + 1));
							DomainManager.Character.ChangeFavorabilityOptionalMonthlyEvolution(context, selfChar, targetChar, favorDelta);
						}
					}
				}
			}
		}

		// Token: 0x06001139 RID: 4409 RVA: 0x00112AE4 File Offset: 0x00110CE4
		public void UpdateChildrenEducation(DataContext context)
		{
			HashSet<int> bloodChildren = DomainManager.Character.GetRelatedCharIds(this._taiwuCharId, 2);
			sbyte currMonth = DomainManager.World.GetCurrMonthInYear();
			MonthlyEventCollection monthlyEventCollection = DomainManager.World.GetMonthlyEventCollection();
			foreach (int bloodChildId in bloodChildren)
			{
				GameData.Domains.Character.Character character;
				bool flag = !DomainManager.Character.TryGetElement_Objects(bloodChildId, out character);
				if (!flag)
				{
					bool flag2 = !this.IsInGroup(bloodChildId);
					if (!flag2)
					{
						bool flag3 = character.GetBirthMonth() != currMonth;
						if (!flag3)
						{
							short age = character.GetCurrAge();
							short num = age;
							short num2 = num;
							if (num2 <= 6)
							{
								if (num2 != 1)
								{
									if (num2 == 3 || num2 == 6)
									{
										goto IL_E3;
									}
								}
								else
								{
									character.RemoveFeatureGroup(context, 171);
									monthlyEventCollection.AddChildZhuazhou(bloodChildId);
								}
							}
							else
							{
								if (num2 == 9 || num2 == 12)
								{
									goto IL_E3;
								}
								if (num2 == 15)
								{
									monthlyEventCollection.AddReachAdulthood(bloodChildId);
								}
							}
							continue;
							IL_E3:
							monthlyEventCollection.AddTeachChild(bloodChildId);
						}
					}
				}
			}
		}

		// Token: 0x0600113A RID: 4410 RVA: 0x00112C18 File Offset: 0x00110E18
		[DomainMethod]
		public int GetGroupBabyCount()
		{
			int count = 0;
			foreach (int charId in this._groupCharIds.GetCollection())
			{
				GameData.Domains.Character.Character groupChar = DomainManager.Character.GetElement_Objects(charId);
				bool flag = groupChar.GetAgeGroup() == 0;
				if (flag)
				{
					count++;
				}
			}
			return count;
		}

		// Token: 0x0600113B RID: 4411 RVA: 0x00112C98 File Offset: 0x00110E98
		[DomainMethod]
		public List<CharacterDisplayData> GetGroupNeiliConflictingCharDataList()
		{
			List<CharacterDisplayData> charDataList = new List<CharacterDisplayData>();
			List<int> ids = this.GetGroupCharIds().GetCollection().ToList<int>();
			int taiwuCharId = this.GetTaiwuCharId();
			ids.Remove(taiwuCharId);
			ids.Insert(0, taiwuCharId);
			foreach (int id in ids)
			{
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(id);
				NeiliTypeItem neiliTypeConfig = NeiliType.Instance[character.GetNeiliType()];
				bool showConflictingWorldState = neiliTypeConfig.ShowConflictingWorldState;
				if (showConflictingWorldState)
				{
					CharacterDisplayData charData = DomainManager.Character.GetCharacterDisplayData(id);
					charDataList.Add(charData);
				}
			}
			return charDataList;
		}

		// Token: 0x0600113C RID: 4412 RVA: 0x00112D68 File Offset: 0x00110F68
		public void SetLegacyPassingState(DataContext context, sbyte legacyPassingState)
		{
			this.SetLegacyPassingState(legacyPassingState, context);
			Events.RaiseEventOnLegacyPassingStateChange(context, legacyPassingState);
		}

		// Token: 0x0600113D RID: 4413 RVA: 0x00112D7C File Offset: 0x00110F7C
		[DomainMethod]
		public void CompletePassingLegacy(DataContext context)
		{
			this._taiwuChar.ChangeResource(context, 7, this._legacyPoint / 4);
			this.SetIsTaiwuDieOfCombatWithXiangshu(false, context);
		}

		// Token: 0x0600113E RID: 4414 RVA: 0x00112DA0 File Offset: 0x00110FA0
		[DomainMethod]
		public void SelectLegacy(DataContext context, short templateId)
		{
			LegacyItem legacyConfig = Legacy.Instance[templateId];
			this._selectedLegacies.Add(templateId);
			bool permanentlyUnique = legacyConfig.PermanentlyUnique;
			if (permanentlyUnique)
			{
				DomainManager.Extra.AddSelectedUniqueLegacies(context, templateId);
			}
		}

		// Token: 0x0600113F RID: 4415 RVA: 0x00112DE0 File Offset: 0x00110FE0
		[DomainMethod]
		public int GetLegacyMaxPointByType(short legacyType)
		{
			int total = 0;
			foreach (LegacyPointItem legacyPoint in ((IEnumerable<LegacyPointItem>)LegacyPoint.Instance))
			{
				bool flag = (short)legacyPoint.Type == legacyType;
				if (flag)
				{
					total += TaiwuDomain.GetLegacyMaxPoint(legacyPoint);
				}
			}
			return total;
		}

		// Token: 0x06001140 RID: 4416 RVA: 0x00112E4C File Offset: 0x0011104C
		[DomainMethod]
		public List<IntList> GetLegacyMaxPointAndTimesListByType(short legacyType)
		{
			List<IntList> result = new List<IntList>();
			foreach (LegacyPointItem legacyPoint in ((IEnumerable<LegacyPointItem>)LegacyPoint.Instance))
			{
				bool flag = (short)legacyPoint.Type == legacyType;
				if (flag)
				{
					IntList list = IntList.Create();
					list.Items.Add((int)legacyPoint.TemplateId);
					list.Items.Add(TaiwuDomain.GetLegacyMaxPoint(legacyPoint));
					short times;
					bool flag2 = DomainManager.Extra.TryGetElement_LegacyPointTimesDict(legacyPoint.TemplateId, out times);
					if (flag2)
					{
						list.Items.Add((int)times);
					}
					else
					{
						list.Items.Add(0);
					}
					result.Add(list);
				}
			}
			return result;
		}

		// Token: 0x06001141 RID: 4417 RVA: 0x00112F28 File Offset: 0x00111128
		[DomainMethod]
		public List<short> GetRandomLegaciesInGroup(DataContext context, sbyte groupId, int count)
		{
			List<short> legacies = new List<short>();
			while (legacies.Count < count)
			{
				short legacyId = this.GetRandomAvailableLegacy(context.Random, groupId);
				bool flag = legacies.Contains(legacyId);
				if (!flag)
				{
					legacies.Add(legacyId);
				}
			}
			return legacies;
		}

		// Token: 0x06001142 RID: 4418 RVA: 0x00112F77 File Offset: 0x00111177
		public void SetIsTaiwuDying(bool isTaiwuDying)
		{
			this._isTaiwuDying = isTaiwuDying;
		}

		// Token: 0x06001143 RID: 4419 RVA: 0x00112F84 File Offset: 0x00111184
		public void AddLegacyPoint(DataContext context, short templateId, int percent = 100)
		{
			LegacyPointItem configData = LegacyPoint.Instance[templateId];
			int addValue = (int)configData.BasePoint * percent / 100;
			int settingsPercent = TaiwuDomain.GetLegacySettingsPercent(configData);
			addValue = addValue * settingsPercent / 100;
			short taiwuSettlementId = DomainManager.Taiwu.GetTaiwuVillageSettlementId();
			int buildingBuff = DomainManager.Building.GetBuildingBlockEffect(taiwuSettlementId, EBuildingScaleEffect.LegacyPointBonusFactor, -1);
			addValue = addValue * (100 + buildingBuff) / 100;
			this.DirectlyAddLegacyPoint(context, templateId, addValue);
		}

		// Token: 0x06001144 RID: 4420 RVA: 0x00112FE8 File Offset: 0x001111E8
		private void DirectlyAddLegacyPoint(DataContext context, short templateId, int addValue)
		{
			LegacyPointItem legacyPointCfg = LegacyPoint.Instance[templateId];
			LegacyPointTypeItem legacyPointTypeCfg = LegacyPointType.Instance[legacyPointCfg.Type];
			int maxValue = TaiwuDomain.GetLegacyMaxPoint(legacyPointCfg);
			short prevValue;
			bool flag = !this._legacyPointDict.TryGetValue(templateId, out prevValue);
			if (flag)
			{
				this.AddElement_LegacyPointDict(templateId, 0, context);
				prevValue = 0;
			}
			addValue = Math.Min(addValue, maxValue - (int)prevValue);
			bool flag2 = addValue <= 0;
			if (!flag2)
			{
				int newValue = (int)prevValue + addValue;
				this.SetElement_LegacyPointDict(templateId, (short)newValue, context);
				this.SetLegacyPoint(this._legacyPoint + addValue, context);
				DomainManager.Extra.IncreaseLegacyPointTimes(context, templateId);
				bool flag3 = (int)prevValue < maxValue / 2 && newValue >= maxValue / 2;
				if (flag3)
				{
					short legacyId = this.GetRandomAvailableLegacy(context.Random, legacyPointTypeCfg.Group);
					this.AddAvailableLegacy(context, legacyId);
				}
				bool flag4 = (int)prevValue < maxValue && newValue == maxValue;
				if (flag4)
				{
					short legacyId2 = this.GetRandomAvailableLegacy(context.Random, legacyPointTypeCfg.Group);
					this.AddAvailableLegacy(context, legacyId2);
				}
			}
		}

		// Token: 0x06001145 RID: 4421 RVA: 0x001130F8 File Offset: 0x001112F8
		public int GetLegacyPointCountForLegacyType(sbyte legacyPointType)
		{
			int count = 0;
			foreach (KeyValuePair<short, short> kv in this._legacyPointDict)
			{
				LegacyPointItem legacyPointConfig = LegacyPoint.Instance[kv.Key];
				bool flag = legacyPointConfig.Type == legacyPointType;
				if (flag)
				{
					count += (int)kv.Value;
				}
			}
			return count;
		}

		// Token: 0x06001146 RID: 4422 RVA: 0x00113180 File Offset: 0x00111380
		public static int GetLegacyMaxPoint(LegacyPointItem configData)
		{
			int settingsPercent = TaiwuDomain.GetLegacySettingsPercent(configData);
			return (int)configData.MaxPoint * settingsPercent / 100;
		}

		// Token: 0x06001147 RID: 4423 RVA: 0x001131A4 File Offset: 0x001113A4
		public static int GetLegacySettingsPercent(LegacyPointItem configData)
		{
			int settingsPercent = 100;
			foreach (byte creationType in configData.BonusTypes)
			{
				int bonusIndex = DomainManager.World.GetWorldCreationSetting(creationType);
				bool flag = bonusIndex < 0;
				if (!flag)
				{
					short[] bonus = WorldCreation.Instance[creationType].LegacyPointBonus;
					bool flag2 = bonus.CheckIndex(bonusIndex);
					if (flag2)
					{
						settingsPercent += (int)bonus[bonusIndex];
					}
					else
					{
						short predefinedLogId = 19;
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 2);
						defaultInterpolatedStringHandler.AppendLiteral("index ");
						defaultInterpolatedStringHandler.AppendFormatted<int>(bonusIndex);
						defaultInterpolatedStringHandler.AppendLiteral(" is invalid for creatingType ");
						defaultInterpolatedStringHandler.AppendFormatted<byte>(creationType);
						PredefinedLog.Show(predefinedLogId, defaultInterpolatedStringHandler.ToStringAndClear());
					}
				}
			}
			return settingsPercent;
		}

		// Token: 0x06001148 RID: 4424 RVA: 0x0011326C File Offset: 0x0011146C
		public bool AddAvailableLegacy(DataContext context, short templateId)
		{
			LegacyItem config = Legacy.Instance[templateId];
			bool flag = config.IsUnique && this._availableLegacyList.Contains(templateId);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				bool flag2 = config.PermanentlyUnique && DomainManager.Extra.IsUniqueLegacySelected(templateId);
				if (flag2)
				{
					result = false;
				}
				else
				{
					this._availableLegacyList.Add(templateId);
					DomainManager.World.GetInstantNotifications().AddLegacy(templateId);
					this.SetAvailableLegacyList(this._availableLegacyList, context);
					result = true;
				}
			}
			return result;
		}

		// Token: 0x06001149 RID: 4425 RVA: 0x001132F4 File Offset: 0x001114F4
		public short GetRandomAvailableLegacy(IRandomSource random, sbyte groupId = -1)
		{
			bool flag = groupId < 0;
			if (flag)
			{
				groupId = (sbyte)random.Next(WorldCreationGroup.Instance.Count - 1);
			}
			sbyte level = TaiwuDomain.GetWorldCreationGroupLevel(groupId);
			return RandomUtils.GetRandomResult<short>(TaiwuDomain._categorizedNormalLegacyConfigs[(int)groupId][(int)level], random);
		}

		// Token: 0x0600114A RID: 4426 RVA: 0x0011333C File Offset: 0x0011153C
		public static sbyte GetWorldCreationGroupLevel(sbyte groupId)
		{
			int legacyBonusSum = TaiwuDomain.GetWorldCreationGroupLegacyBonusSum(groupId);
			for (sbyte i = (sbyte)(GlobalConfig.Instance.LegacyGroupLevelThresholds.Length - 1); i >= 0; i -= 1)
			{
				bool flag = legacyBonusSum >= (int)GlobalConfig.Instance.LegacyGroupLevelThresholds[(int)i];
				if (flag)
				{
					return i;
				}
			}
			DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(37, 2);
			defaultInterpolatedStringHandler.AppendLiteral("Invalid legacy bonus sum ");
			defaultInterpolatedStringHandler.AppendFormatted<int>(legacyBonusSum);
			defaultInterpolatedStringHandler.AppendLiteral(" for group ");
			defaultInterpolatedStringHandler.AppendFormatted<sbyte>(groupId);
			defaultInterpolatedStringHandler.AppendLiteral(".");
			throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
		}

		// Token: 0x0600114B RID: 4427 RVA: 0x001133E0 File Offset: 0x001115E0
		private static int GetWorldCreationGroupLegacyBonusSum(sbyte groupId)
		{
			int score = 0;
			WorldCreationGroupItem groupCfg = WorldCreationGroup.Instance[groupId];
			foreach (byte worldCreationId in groupCfg.WorldCreations)
			{
				WorldCreationItem worldCreationCfg = WorldCreation.Instance[worldCreationId];
				int value = DomainManager.World.GetWorldCreationSetting(worldCreationId);
				bool flag = worldCreationCfg.LegacyPointBonus.CheckIndex(value);
				if (flag)
				{
					score += (int)worldCreationCfg.LegacyPointBonus[value];
				}
			}
			return score;
		}

		// Token: 0x0600114C RID: 4428 RVA: 0x00113460 File Offset: 0x00111660
		private static void InitializeNormalLegacies()
		{
			int levelCount = GlobalConfig.Instance.LegacyGroupLevelThresholds.Length;
			int groupCount = WorldCreationGroup.Instance.Count - 1;
			TaiwuDomain._categorizedNormalLegacyConfigs = new List<ValueTuple<short, short>>[groupCount][];
			for (int i = 0; i < groupCount; i++)
			{
				TaiwuDomain._categorizedNormalLegacyConfigs[i] = new List<ValueTuple<short, short>>[levelCount];
				for (int j = 0; j < levelCount; j++)
				{
					TaiwuDomain._categorizedNormalLegacyConfigs[i][j] = new List<ValueTuple<short, short>>();
				}
			}
			foreach (LegacyItem legacyCfg in ((IEnumerable<LegacyItem>)Legacy.Instance))
			{
				bool flag = legacyCfg.Weight == 0;
				if (!flag)
				{
					TaiwuDomain._categorizedNormalLegacyConfigs[(int)legacyCfg.WorldCreationGroup][(int)legacyCfg.Level].Add(new ValueTuple<short, short>(legacyCfg.TemplateId, legacyCfg.Weight));
				}
			}
		}

		// Token: 0x0600114D RID: 4429 RVA: 0x00113558 File Offset: 0x00111758
		public void PushStateNewCharacterLegacyGrowingGrades(DataContext context, sbyte stateId, IEnumerable<sbyte> grades)
		{
			SByteList gradeList = this._stateNewCharacterLegacyGrowingGrades[(int)stateId];
			bool flag = gradeList.Items == null;
			if (flag)
			{
				gradeList = SByteList.Create();
			}
			gradeList.Items.AddRange(grades);
			this.SetElement_StateNewCharacterLegacyGrowingGrades((int)stateId, gradeList, context);
		}

		// Token: 0x0600114E RID: 4430 RVA: 0x001135A0 File Offset: 0x001117A0
		public sbyte PopStateNewCharacterLegacyGrowingGrade(DataContext context, sbyte stateId, sbyte minGrade = -1)
		{
			bool flag = stateId < 0;
			sbyte result;
			if (flag)
			{
				result = minGrade;
			}
			else
			{
				SByteList gradeList = this._stateNewCharacterLegacyGrowingGrades[(int)stateId];
				bool flag2 = gradeList.Items == null || gradeList.Items.Count == 0;
				if (flag2)
				{
					result = minGrade;
				}
				else
				{
					sbyte growingGrade = gradeList.Items[0];
					bool flag3 = growingGrade < minGrade;
					if (flag3)
					{
						result = minGrade;
					}
					else
					{
						gradeList.Items.RemoveAt(0);
						this.SetElement_StateNewCharacterLegacyGrowingGrades((int)stateId, gradeList, context);
						result = growingGrade;
					}
				}
			}
			return result;
		}

		// Token: 0x0600114F RID: 4431 RVA: 0x00113624 File Offset: 0x00111824
		public sbyte OfflinePopStateNewCharacterLegacyGrowingGrade(sbyte stateId)
		{
			bool flag = stateId < 0;
			sbyte result;
			if (flag)
			{
				result = -1;
			}
			else
			{
				SByteList gradeList = this._stateNewCharacterLegacyGrowingGrades[(int)stateId];
				bool flag2 = gradeList.Items == null || gradeList.Items.Count == 0;
				if (flag2)
				{
					result = -1;
				}
				else
				{
					sbyte growingGrade = gradeList.Items[0];
					gradeList.Items.RemoveAt(0);
					result = growingGrade;
				}
			}
			return result;
		}

		// Token: 0x06001150 RID: 4432 RVA: 0x00113690 File Offset: 0x00111890
		[DomainMethod]
		public List<int> FindSuccessorCandidates(DataContext context)
		{
			Tester.Assert(this._successorCandidates.Count == 0, "");
			sbyte legacyPassingState = this._legacyPassingState;
			sbyte b = legacyPassingState;
			if (b != 1)
			{
				if (b != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(46, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Trying to find successors in a invalid state ");
					defaultInterpolatedStringHandler.AppendFormatted<sbyte>(this._legacyPassingState);
					defaultInterpolatedStringHandler.AppendLiteral(".");
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Location location = this._taiwuChar.GetLocation();
				bool flag = !location.IsValid();
				if (flag)
				{
					location = this._taiwuChar.GetValidLocation();
				}
				List<Predicate<GameData.Domains.Character.Character>> predicates = ObjectPool<List<Predicate<GameData.Domains.Character.Character>>>.Instance.Get();
				List<GameData.Domains.Character.Character> charList = ObjectPool<List<GameData.Domains.Character.Character>>.Instance.Get();
				predicates.Clear();
				charList.Clear();
				GameData.Domains.Character.Filters.CharacterFilterRules.ToPredicates(13, predicates, -1);
				MapCharacterFilter.Find(predicates, charList, location.AreaId, false);
				TaiwuDomain.Logger.Info((predicates.Count > 0) ? "found male" : "created male");
				GameData.Domains.Character.Character maleChar = (charList.Count > 0) ? charList.GetRandom(context.Random) : DomainManager.Character.CreateTemporaryIntelligentCharacter(context, 13, location);
				predicates.Clear();
				charList.Clear();
				GameData.Domains.Character.Filters.CharacterFilterRules.ToPredicates(14, predicates, -1);
				MapCharacterFilter.Find(predicates, charList, location.AreaId, false);
				TaiwuDomain.Logger.Info((predicates.Count > 0) ? "found female" : "created female");
				GameData.Domains.Character.Character femaleChar = (charList.Count > 0) ? charList.GetRandom(context.Random) : DomainManager.Character.CreateTemporaryIntelligentCharacter(context, 14, location);
				ObjectPool<List<Predicate<GameData.Domains.Character.Character>>>.Instance.Return(predicates);
				ObjectPool<List<GameData.Domains.Character.Character>>.Instance.Return(charList);
				this._successorCandidates.Add(maleChar.GetId());
				this._successorCandidates.Add(femaleChar.GetId());
			}
			else
			{
				foreach (int charId in this._groupCharIds.GetCollection())
				{
					bool flag2 = this._taiwuCharId == charId;
					if (!flag2)
					{
						GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
						bool flag3 = AgeGroup.GetAgeGroup(character.GetCurrAge()) == 0;
						if (!flag3)
						{
							this._successorCandidates.Add(charId);
						}
					}
				}
			}
			this.SetSuccessorCandidates(this._successorCandidates, context);
			return this._successorCandidates;
		}

		// Token: 0x06001151 RID: 4433 RVA: 0x00113930 File Offset: 0x00111B30
		[DomainMethod]
		public void ConfirmChosenSuccessor(DataContext context, int newTaiwuId)
		{
			bool randomSuccessor = this._legacyPassingState == 2;
			this.ConvertAndClearSuccessorsCandidates(context, newTaiwuId);
			this.SetLegacyPassingState(context, 4);
			GameData.Domains.Character.Character newTaiwuChar = DomainManager.Character.GetElement_Objects(newTaiwuId);
			ValueTuple<short, short> healthRatio = new ValueTuple<short, short>(newTaiwuChar.GetHealth(), newTaiwuChar.GetLeftMaxHealth(false));
			DomainManager.Character.RevertAllTemporaryModifications(context, this._taiwuChar);
			this._taiwuChar.RemoveFeatureGroup(context, 756);
			this.TransferTaiwuData(context, newTaiwuChar, this._taiwuChar, randomSuccessor);
			this.SetTaiwu(context, newTaiwuChar);
			this.UpdateConsummateLevelBrokenFeature(context);
			this.ApplyAndResetLegacy(context, newTaiwuChar, false);
			short newTaiwuLeftMaxHealth = newTaiwuChar.GetLeftMaxHealth(false);
			short newTaiwuHealth = (short)Math.Clamp((int)(newTaiwuChar.GetLeftMaxHealth(false) * healthRatio.Item1) / Math.Max(1, (int)healthRatio.Item2), 0, (int)newTaiwuLeftMaxHealth);
			newTaiwuChar.SetHealth(newTaiwuHealth, context);
			Location newTaiwuLocation = newTaiwuChar.GetLocation();
			DomainManager.Map.SetBlockAndViewRangeVisible(context, newTaiwuLocation.AreaId, newTaiwuLocation.BlockId);
			this._isTaiwuDying = false;
			DomainManager.TaiwuEvent.TriggerListener("PassingLegacyComplete", true);
		}

		// Token: 0x06001152 RID: 4434 RVA: 0x00113A3C File Offset: 0x00111C3C
		public void ConvertAndClearSuccessorsCandidates(DataContext context, int newTaiwuId)
		{
			foreach (int charId in this._successorCandidates)
			{
				bool flag = !DomainManager.Character.IsTemporaryIntelligentCharacter(charId);
				if (!flag)
				{
					GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
					bool flag2 = charId == newTaiwuId;
					if (flag2)
					{
						DomainManager.Character.ConvertTemporaryIntelligentCharacter(context, character);
					}
					else
					{
						DomainManager.Character.RemoveTemporaryIntelligentCharacter(context, character);
					}
				}
			}
			this._successorCandidates.Clear();
		}

		// Token: 0x06001153 RID: 4435 RVA: 0x00113AE0 File Offset: 0x00111CE0
		public void CheckNotTaiwu(int charId)
		{
			Tester.Assert(charId != this._taiwuCharId || this._legacyPassingState != 0, "");
		}

		// Token: 0x06001154 RID: 4436 RVA: 0x00113B04 File Offset: 0x00111D04
		public unsafe void TransferTaiwuData(DataContext context, GameData.Domains.Character.Character newTaiwuChar, GameData.Domains.Character.Character oldTaiwuChar, bool randomSuccessor = false)
		{
			int newTaiwuCharId = newTaiwuChar.GetId();
			int oldTaiwuCharId = oldTaiwuChar.GetId();
			DomainManager.Character.PrepareTaiwuInheritor(context, newTaiwuChar, oldTaiwuChar);
			this.SetTaiwuGenerationsCount(this._taiwuGenerationsCount + 1, context);
			DomainManager.Taiwu.TaiwuUnfollowNpc(context, newTaiwuCharId);
			List<short> learnedCombatSkills = newTaiwuChar.GetLearnedCombatSkills();
			List<GameData.Domains.CombatSkill.CombatSkill> combatSkills = ObjectPool<List<GameData.Domains.CombatSkill.CombatSkill>>.Instance.Get();
			combatSkills.Clear();
			foreach (short combatSkillId in oldTaiwuChar.GetLearnedCombatSkills())
			{
				GameData.Domains.CombatSkill.CombatSkill oldSkill = DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(oldTaiwuCharId, combatSkillId));
				GameData.Domains.CombatSkill.CombatSkill newSkill = Serializer.CreateCopy<GameData.Domains.CombatSkill.CombatSkill>(oldSkill);
				newSkill.OfflineSetCharId(newTaiwuCharId);
				combatSkills.Add(newSkill);
				learnedCombatSkills.Add(combatSkillId);
			}
			DomainManager.CombatSkill.RegisterCombatSkills(newTaiwuCharId, combatSkills);
			DomainManager.Character.AutoActivateReadCombatSkillNormalPages(context, combatSkills, newTaiwuCharId);
			ObjectPool<List<GameData.Domains.CombatSkill.CombatSkill>>.Instance.Return(combatSkills);
			newTaiwuChar.SetLearnedCombatSkills(learnedCombatSkills, context);
			newTaiwuChar.CopyCombatSkillEquipmentFrom(context, oldTaiwuChar);
			DomainManager.SpecialEffect.AddAllBrokenSkillEffects(context, newTaiwuChar);
			newTaiwuChar.SetLoopingNeigong(oldTaiwuChar.GetLoopingNeigong(), context);
			newTaiwuChar.SetCombatSkillAttainmentPanels(oldTaiwuChar.GetCombatSkillAttainmentPanels().ToArray<short>(), context);
			List<GameData.Domains.Character.LifeSkillItem> learnedLifeSkills = newTaiwuChar.GetLearnedLifeSkills();
			learnedLifeSkills.Clear();
			learnedLifeSkills.AddRange(oldTaiwuChar.GetLearnedLifeSkills());
			newTaiwuChar.SetLearnedLifeSkills(learnedLifeSkills, context);
			GameData.Utilities.ShortList masteredCombatSkills = DomainManager.Extra.GetCharacterMasteredCombatSkills(oldTaiwuCharId);
			DomainManager.Extra.ClearCharacterMasteredCombatSkills(context, oldTaiwuCharId);
			DomainManager.Extra.SetCharacterMasteredCombatSkills(context, newTaiwuCharId, masteredCombatSkills);
			DomainManager.Extra.TransferTaiwuProficiency(context, oldTaiwuCharId, newTaiwuCharId);
			ItemKey[] emptyEquipments = new ItemKey[12];
			for (int i = 0; i < 12; i++)
			{
				emptyEquipments[i] = ItemKey.Invalid;
			}
			ItemKey[] originalTaiwuEquipment = oldTaiwuChar.GetEquipment().ToArray<ItemKey>();
			ItemKey clothingKey = originalTaiwuEquipment[4];
			bool flag;
			if (clothingKey.IsValid())
			{
				ClothingItem clothingItem = Config.Clothing.Instance[clothingKey.TemplateId];
				flag = (clothingItem == null || !clothingItem.KeepOnPassing);
			}
			else
			{
				flag = false;
			}
			bool flag2 = flag;
			if (flag2)
			{
				emptyEquipments[4] = clothingKey;
			}
			oldTaiwuChar.ChangeEquipment(context, emptyEquipments);
			List<sbyte> ownedBookTypes = DomainManager.LegendaryBook.GetCharOwnedBookTypes(oldTaiwuCharId);
			bool flag3 = ownedBookTypes != null;
			if (flag3)
			{
				for (int index = ownedBookTypes.Count - 1; index >= 0; index--)
				{
					sbyte bookType = ownedBookTypes[index];
					ItemKey itemKey = DomainManager.LegendaryBook.GetLegendaryBookItem(bookType);
					oldTaiwuChar.RemoveInventoryItem(context, itemKey, 1, false, false);
					this._taiwuCharId = newTaiwuCharId;
					newTaiwuChar.AddInventoryItem(context, itemKey, 1, false);
					this._taiwuCharId = oldTaiwuCharId;
				}
			}
			Dictionary<ItemKey, int> inventoryItems = oldTaiwuChar.GetInventory().Items;
			foreach (KeyValuePair<ItemKey, int> item in inventoryItems)
			{
				newTaiwuChar.AddInventoryItem(context, item.Key, item.Value, false);
			}
			oldTaiwuChar.SetInventory(new Inventory(), context);
			this.ResetEquipmentPlans(context);
			ResourceInts oldTaiwuResources = *oldTaiwuChar.GetResources();
			newTaiwuChar.ChangeResources(context, ref oldTaiwuResources);
			oldTaiwuResources.Initialize();
			oldTaiwuChar.SetResources(ref oldTaiwuResources, context);
			newTaiwuChar.ChangeExp(context, oldTaiwuChar.GetExp());
			oldTaiwuChar.SetExp(0, context);
			DomainManager.Information.TransferInformation(oldTaiwuCharId, newTaiwuCharId, context);
			if (randomSuccessor)
			{
				HashSet<int> groupCharSet = ObjectPool<HashSet<int>>.Instance.Get();
				groupCharSet.Clear();
				groupCharSet.UnionWith(this._groupCharIds.GetCollection());
				this._groupCharIds.Remove(oldTaiwuCharId);
				foreach (int charId in this._groupCharIds.GetCollection())
				{
					bool flag4 = DomainManager.Character.GetElement_Objects(charId).GetAgeGroup() != 0;
					if (flag4)
					{
						groupCharSet.Add(charId);
					}
				}
				foreach (int charId2 in groupCharSet)
				{
					bool flag5 = charId2 != oldTaiwuCharId && this._groupCharIds.Contains(charId2);
					if (flag5)
					{
						this.LeaveGroup(context, charId2, true, false, true);
					}
				}
				this._groupCharIds.Add(oldTaiwuCharId);
				ObjectPool<HashSet<int>>.Instance.Get();
				foreach (int charId3 in this._groupCharIds.GetCollection())
				{
					bool flag6 = charId3 != oldTaiwuCharId;
					if (flag6)
					{
						this.LeaveGroup(context, charId3, true, false, true);
					}
				}
				this.JoinGroup(context, newTaiwuCharId, false);
				oldTaiwuChar.SetLeaderId(newTaiwuCharId, context);
				newTaiwuChar.SetLeaderId(newTaiwuCharId, context);
			}
			else
			{
				foreach (int charId4 in this._groupCharIds.GetCollection())
				{
					GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId4);
					character.SetLeaderId(newTaiwuCharId, context);
				}
				DomainManager.Character.TransferKidnappedCharactersToTaiwuSuccessor(context, newTaiwuChar, oldTaiwuChar);
			}
			DomainManager.Extra.TransferSpecialGroup(context, oldTaiwuCharId, newTaiwuCharId, true);
			if (randomSuccessor)
			{
				newTaiwuChar.SetHappiness(50, context);
				List<FameActionRecord> fameActionRecords = newTaiwuChar.GetFameActionRecords();
				fameActionRecords.Clear();
				newTaiwuChar.SetFameActionRecords(fameActionRecords, context);
			}
			sbyte oldTaiwuFame = oldTaiwuChar.GetFame();
			sbyte oldTaiwuFameType = FameType.GetFameType(oldTaiwuFame);
			bool flag7 = oldTaiwuFameType >= 5;
			if (flag7)
			{
				newTaiwuChar.RecordFameAction(context, 54, -1, 1, true);
			}
			else
			{
				bool flag8 = oldTaiwuFameType <= 1;
				if (flag8)
				{
					newTaiwuChar.RecordFameAction(context, 55, -1, 1, true);
				}
			}
			DomainManager.Organization.ResetSectExploreStatuses(context);
			DomainManager.TaiwuEvent.ClearTaiwuBindingMonthlyActions(context);
			DomainManager.World.GetMonthlyEventCollection().Clear();
			DomainManager.World.TransferXiangshuAvatarRelations(context, oldTaiwuCharId, newTaiwuCharId);
			DomainManager.Extra.TransferRanshanThreeCorpsesRelations(context, oldTaiwuCharId, newTaiwuCharId);
			DomainManager.Character.TransferFixedCharacterFavorability(context, oldTaiwuCharId, newTaiwuCharId);
			DomainManager.Organization.ResetSectExploreStatuses(context);
			DomainManager.Extra.RemoveAllTaiwuExtraBonuses(context);
			DomainManager.Building.SetShrineBuyTimes(0, context);
			DomainManager.Extra.ResetInteractOfLoveData(context);
			ProfessionSkillHandle.OnTaiwuDeath(context);
			this.ClearPrenatalEducationBonus(context);
			DomainManager.Extra.TaiwuWantedResetAllSectInteracted(context);
			DomainManager.Extra.ClearAllTaiwuInteractionCooldowns(context);
			DomainManager.Extra.ClearFriendOrFamilyInteractionCooldowns(context);
			DomainManager.Extra.TransferTaiwuArtisanOrder(context, newTaiwuCharId, oldTaiwuCharId);
			DomainManager.Extra.ClearAllGearMateNeili(context);
			newTaiwuChar.SetCurrNeili(oldTaiwuChar.GetCurrNeili(), context);
			newTaiwuChar.SetExtraNeili(oldTaiwuChar.GetExtraNeili(), context);
			newTaiwuChar.SetBaseNeiliAllocation(oldTaiwuChar.GetBaseNeiliAllocation(), context);
			newTaiwuChar.SetExtraNeiliAllocation(oldTaiwuChar.GetExtraNeiliAllocation(), context);
			DomainManager.Extra.TransferExtraNeiliAllocationProgress(context, oldTaiwuChar, newTaiwuChar);
			newTaiwuChar.SetConsummateLevel(oldTaiwuChar.GetConsummateLevel(), context);
			byte oldTaiwuImmunities = DomainManager.Extra.GetPoisonImmunities(oldTaiwuCharId);
			bool flag9 = oldTaiwuImmunities > 0;
			if (flag9)
			{
				ref PoisonInts newTaiwuPoisoned = ref newTaiwuChar.GetPoisoned();
				for (sbyte poisonType = 0; poisonType < 6; poisonType += 1)
				{
					bool bit = BitOperation.GetBit(oldTaiwuImmunities, (int)poisonType);
					if (bit)
					{
						*newTaiwuPoisoned[(int)poisonType] = 0;
					}
				}
				newTaiwuChar.SetPoisoned(ref newTaiwuPoisoned, context);
				DomainManager.Extra.AddPoisonImmunities(context, newTaiwuCharId, oldTaiwuImmunities);
				DomainManager.Extra.RemovePoisonImmunities(context, oldTaiwuCharId);
			}
			List<short> oldTaiwuFeatureIds = oldTaiwuChar.GetFeatureIds();
			short templateId = 0;
			while ((int)templateId < CharacterFeature.Instance.Count)
			{
				CharacterFeatureItem config = CharacterFeature.Instance[templateId];
				bool flag10 = config.InheritableTransferTaiwu && oldTaiwuFeatureIds.Contains(templateId);
				if (flag10)
				{
					newTaiwuChar.AddFeature(context, templateId, false);
					oldTaiwuChar.RemoveFeature(context, templateId);
				}
				templateId += 1;
			}
			OrganizationInfo taiwuOrgInfo = oldTaiwuChar.GetOrganizationInfo();
			bool isTaiwuDying = this._isTaiwuDying;
			if (isTaiwuDying)
			{
				this.LeaveGroup(context, oldTaiwuCharId, false, false, true);
				short deathType = (oldTaiwuChar.GetLeftMaxHealth(false) > 0) ? 2 : 1;
				DomainManager.Character.MakeCharacterDead(context, oldTaiwuChar, deathType);
			}
			else
			{
				this.LeaveGroup(context, oldTaiwuCharId, false, true, true);
				Events.RaiseXiangshuInfectionFeatureChanged(context, oldTaiwuChar, 218);
			}
			DomainManager.Organization.ChangeGrade(context, newTaiwuChar, taiwuOrgInfo.Grade, taiwuOrgInfo.Principal);
			newTaiwuChar.RemoveFeatureGroup(context, 734);
			this._villagerFeatureHolderSet.Remove(newTaiwuCharId);
			VillagerRoleRecords records = DomainManager.Extra.GetVillagerRoleRecordsData();
			bool flag11 = records.History.RemoveAll((VillagerRoleRecordElement rc) => rc.CharacterId == newTaiwuCharId) > 0;
			if (flag11)
			{
				DomainManager.Extra.SetVillagerRoleRecordsData(context, records);
			}
		}

		// Token: 0x06001155 RID: 4437 RVA: 0x0011444C File Offset: 0x0011264C
		public void ApplyAndResetLegacy(DataContext context, GameData.Domains.Character.Character taiwuChar, bool isClearLegaciesBuilding = true)
		{
			if (isClearLegaciesBuilding)
			{
				this.ClearLegaciesBuildingTemplateIdList(context);
			}
			foreach (short selectedLegacyId in this._selectedLegacies)
			{
				this.ApplyLegacyAffect(context, taiwuChar, selectedLegacyId);
			}
			this.ResetLegacy(context);
		}

		// Token: 0x06001156 RID: 4438 RVA: 0x001144BC File Offset: 0x001126BC
		private void ResetLegacy(DataContext context)
		{
			this._selectedLegacies.Clear();
			this.ClearLegacyPointDict(context);
			this._availableLegacyList.Clear();
			this.SetAvailableLegacyList(this._availableLegacyList, context);
			this.SetLegacyPoint(0, context);
		}

		// Token: 0x06001157 RID: 4439 RVA: 0x001144F8 File Offset: 0x001126F8
		private void ClearLegaciesBuildingTemplateIdList(DataContext context)
		{
			List<short> list = DomainManager.Extra.GetLegaciesBuildingTemplateIdList();
			list.Clear();
			DomainManager.Extra.SetLegaciesBuildingTemplateIdList(list, context);
		}

		// Token: 0x06001158 RID: 4440 RVA: 0x00114528 File Offset: 0x00112728
		private unsafe void ApplyLegacyAffect(DataContext context, GameData.Domains.Character.Character newTaiwuChar, short legacyTemplateId)
		{
			LegacyItem legacyConfig = Legacy.Instance[legacyTemplateId];
			bool flag = legacyConfig.AddFeature >= 0;
			if (flag)
			{
				newTaiwuChar.AddFeature(context, legacyConfig.AddFeature, true);
			}
			bool flag2 = legacyConfig.ModifiedProperty >= 0;
			if (flag2)
			{
				DomainManager.Extra.AddTaiwuPropertyPermanentBonus(context, (ECharacterPropertyReferencedType)legacyConfig.ModifiedProperty, (EDataModifyType)legacyConfig.PropertyBonusType, legacyConfig.PropertyDelta);
			}
			bool flag3 = legacyConfig.TargetBehaviorType >= 0;
			if (flag3)
			{
				ValueTuple<short, short> moralityRange = GameData.Domains.Character.BehaviorType.Ranges[(int)legacyConfig.TargetBehaviorType];
				int morality = context.Random.Next((int)moralityRange.Item1, (int)(moralityRange.Item2 + 1));
				newTaiwuChar.SetBaseMorality((short)morality, context);
			}
			bool flag4 = legacyConfig.AddBuildingBlock >= 0;
			if (flag4)
			{
				BuildingBlockItem config = BuildingBlock.Instance[legacyConfig.AddBuildingBlock];
				bool flag5 = BuildingBlockData.IsUsefulResource(config.Type);
				if (flag5)
				{
					List<short> list = DomainManager.Extra.GetLegaciesBuildingTemplateIdList();
					list.Add(legacyConfig.AddBuildingBlock);
					DomainManager.Extra.SetLegaciesBuildingTemplateIdList(list, context);
				}
				else
				{
					Location taiwuVillageLocation = this.GetTaiwuVillageLocation();
					DomainManager.Building.PlaceBuildingAtBlock(context, taiwuVillageLocation.AreaId, taiwuVillageLocation.BlockId, legacyConfig.AddBuildingBlock, false, true);
				}
			}
			bool flag6 = legacyConfig.AddBuildingCoreItem >= 0;
			if (flag6)
			{
				ItemKey itemKey = DomainManager.Item.CreateItem(context, 12, legacyConfig.AddBuildingCoreItem);
				DomainManager.Taiwu.WarehouseAdd(context, itemKey, 1);
			}
			bool flag7 = legacyConfig.SpiritualDebtDelta != 0;
			if (flag7)
			{
				List<short> areaList = ObjectPool<List<short>>.Instance.Get();
				areaList.Clear();
				sbyte stateId = legacyConfig.AffectingState - 1;
				DomainManager.Map.GetAllAreaInState(stateId, areaList);
				int spiritualDebt = (int)(10 * legacyConfig.SpiritualDebtDelta);
				foreach (short areaId in areaList)
				{
					DomainManager.Extra.ChangeAreaSpiritualDebt(context, areaId, spiritualDebt, true, true);
				}
			}
			sbyte[] stateNewbornChildrenGrowingGrade = legacyConfig.StateNewbornChildrenGrowingGrade;
			bool flag8 = stateNewbornChildrenGrowingGrade != null && stateNewbornChildrenGrowingGrade.Length != 0;
			if (flag8)
			{
				sbyte stateId2 = legacyConfig.AffectingState - 1;
				this.PushStateNewCharacterLegacyGrowingGrades(context, stateId2, legacyConfig.StateNewbornChildrenGrowingGrade);
			}
			bool flag9 = legacyConfig.AffectingOrganization >= 0;
			if (flag9)
			{
				foreach (sbyte grade in legacyConfig.SupportingSectCharacterGrades)
				{
					DomainManager.Organization.SelectRandomSectCharacterToApproveTaiwu(context, legacyConfig.AffectingOrganization, grade);
				}
			}
			bool flag10 = legacyConfig.TargetNeiliProportionOfFiveElements.SumCheck() == 100;
			if (flag10)
			{
				newTaiwuChar.SetBaseNeiliProportionOfFiveElements(legacyConfig.TargetNeiliProportionOfFiveElements, context);
			}
			bool flag11 = legacyConfig.PoisonImmunityCount > 0;
			if (flag11)
			{
				Span<sbyte> span = new Span<sbyte>(stackalloc byte[(UIntPtr)6], 6);
				Span<sbyte> immuneTypes = span;
				for (sbyte i = 0; i < 6; i += 1)
				{
					*immuneTypes[(int)i] = i;
				}
				CollectionUtils.Shuffle<sbyte>(context.Random, immuneTypes, 6);
				ref PoisonInts poisoned = ref newTaiwuChar.GetPoisoned();
				byte poisonImmunities = 0;
				for (int j = 0; j < legacyConfig.PoisonImmunityCount; j++)
				{
					sbyte type = *immuneTypes[j];
					poisonImmunities = BitOperation.SetBit(poisonImmunities, (int)type, true);
					*poisoned[j] = 0;
				}
				newTaiwuChar.SetPoisoned(ref poisoned, context);
				DomainManager.Extra.AddPoisonImmunities(context, newTaiwuChar.GetId(), poisonImmunities);
			}
			bool flag12 = legacyConfig.TargetQualificationGrowthTypeLifeSkill >= 0;
			if (flag12)
			{
				newTaiwuChar.SetLifeSkillQualificationGrowthType(legacyConfig.TargetQualificationGrowthTypeLifeSkill, context);
			}
			bool flag13 = legacyConfig.TargetQualificationGrowthTypeCombatSkill >= 0;
			if (flag13)
			{
				newTaiwuChar.SetCombatSkillQualificationGrowthType(legacyConfig.TargetQualificationGrowthTypeCombatSkill, context);
			}
		}

		// Token: 0x06001159 RID: 4441 RVA: 0x001148E4 File Offset: 0x00112AE4
		public void SetNextLifeSkillCombatForceOperationForbid(bool isForceSilentForbid, bool isForceGiveupForbid)
		{
			this._nextLifeSkillCombatForceOperationForbid[OperationPrepareForceAdversary.ForceAdversaryOperation.Silent] = isForceSilentForbid;
			this._nextLifeSkillCombatForceOperationForbid[OperationPrepareForceAdversary.ForceAdversaryOperation.GiveUp] = isForceGiveupForbid;
		}

		// Token: 0x0600115A RID: 4442 RVA: 0x00114904 File Offset: 0x00112B04
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatStart(DataContext context, sbyte lifeSkillType, int charA, int charB, sbyte firstTurnPlayerId)
		{
			Tester.Assert(this._lifeSkillCombat == null, "");
			this._lifeSkillCombat = new Match(context, lifeSkillType, charA, charB, firstTurnPlayerId);
			bool forbid;
			bool flag = this._nextLifeSkillCombatForceOperationForbid.TryGetValue(OperationPrepareForceAdversary.ForceAdversaryOperation.Silent, out forbid) && forbid;
			if (flag)
			{
				this._lifeSkillCombat.GetPlayer(0).SetForceSilentRemainingCount(0);
				this._lifeSkillCombat.GetPlayer(1).SetForceSilentRemainingCount(0);
			}
			bool flag2 = this._nextLifeSkillCombatForceOperationForbid.TryGetValue(OperationPrepareForceAdversary.ForceAdversaryOperation.GiveUp, out forbid) && forbid;
			if (flag2)
			{
				this._lifeSkillCombat.GetPlayer(0).SetForceGiveUpRemainingCount(0);
				this._lifeSkillCombat.GetPlayer(1).SetForceGiveUpRemainingCount(0);
			}
			this._nextLifeSkillCombatForceOperationForbid.Clear();
			StatusSnapshot statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff diff = new StatusSnapshotDiff(ref statusSnapshot);
			byte[] data = new byte[diff.GetSerializedSize()];
			byte[] array;
			byte* pData;
			if ((array = data) == null || array.Length == 0)
			{
				pData = null;
			}
			else
			{
				pData = &array[0];
			}
			diff.Serialize(pData);
			array = null;
			return data;
		}

		// Token: 0x0600115B RID: 4443 RVA: 0x00114A14 File Offset: 0x00112C14
		[DomainMethod]
		public CombatResultDisplayData LifeSkillCombatTerminate(DataContext context)
		{
			Tester.Assert(this._lifeSkillCombat != null, "");
			sbyte winnerPlayerId;
			this._lifeSkillCombat.CheckResult(out winnerPlayerId);
			int competitorId = this._lifeSkillCombat.GetPlayerCharacterId(1);
			bool isTaiwuWin = winnerPlayerId == 0;
			CombatResultDisplayData result = this.ApplyLifeSkillCombatResult(context, competitorId, isTaiwuWin);
			bool flag = isTaiwuWin;
			if (flag)
			{
				GameData.Domains.Character.Character competitor = DomainManager.Character.GetElement_Objects(competitorId);
				short competitorLifeSkillAttainment = competitor.GetLifeSkillAttainment(this._lifeSkillCombat.LifeSkillType);
				short taiwuLifeSkillAttainment = this._taiwuChar.GetLifeSkillAttainment(this._lifeSkillCombat.LifeSkillType);
				bool flag2 = competitorLifeSkillAttainment >= taiwuLifeSkillAttainment;
				if (flag2)
				{
					DomainManager.Taiwu.AddLegacyPoint(context, 18, 100);
				}
				sbyte lifeSkillType = this._lifeSkillCombat.LifeSkillType;
				sbyte b = lifeSkillType;
				if (b != 12)
				{
					if (b != 13)
					{
						ProfessionFormulaItem formula = ProfessionFormula.Instance[30];
						int addSeniority = formula.Calculate((int)competitorLifeSkillAttainment);
						DomainManager.Extra.ChangeProfessionSeniority(context, 4, addSeniority, true, false);
					}
					else
					{
						ProfessionFormulaItem formula2 = ProfessionFormula.Instance[81];
						int addSeniority2 = formula2.Calculate((int)competitorLifeSkillAttainment);
						DomainManager.Extra.ChangeProfessionSeniority(context, 12, addSeniority2, true, false);
					}
				}
				else
				{
					ProfessionFormulaItem formula3 = ProfessionFormula.Instance[94];
					int addSeniority3 = formula3.Calculate((int)competitorLifeSkillAttainment);
					DomainManager.Extra.ChangeProfessionSeniority(context, 14, addSeniority3, true, false);
				}
			}
			this._lifeSkillCombat.GenerateRecordFile();
			InformationDomain informationDomain = DomainManager.Information;
			foreach (KeyValuePair<sbyte, sbyte> pair in this._lifeSkillCombat.PlayerForcedSecretInformation)
			{
				int characterId = this._lifeSkillCombat.GetPlayer(pair.Key).CharacterId;
				int adversaryCharacterId = this._lifeSkillCombat.GetPlayer(Player.PredefinedId.GetTheOtherSide(pair.Key)).CharacterId;
				int offset = informationDomain.GetSecretInformationCollection().AddForcingSilence(characterId, adversaryCharacterId);
				informationDomain.AddSecretInformationMetaDataWithNecessity(context, offset, true, true, null);
			}
			this._lifeSkillCombat = null;
			return result;
		}

		// Token: 0x0600115C RID: 4444 RVA: 0x00114C34 File Offset: 0x00112E34
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerGetUsableOperationList(DataContext context, byte[] inputData)
		{
			List<sbyte> additionalEffectCards = new List<sbyte>();
			List<sbyte> usedBookStateIndices = new List<sbyte>();
			List<int> usedFriendlyCharacterIds = new List<int>();
			fixed (byte[] array = inputData)
			{
				byte* pData;
				if (inputData == null || array.Length == 0)
				{
					pData = null;
				}
				else
				{
					pData = &array[0];
				}
				byte* pCurrData = pData;
				ushort count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int i = 0; i < (int)count; i++)
				{
					additionalEffectCards.Add(*(sbyte*)pCurrData);
					pCurrData++;
				}
				count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int j = 0; j < (int)count; j++)
				{
					usedBookStateIndices.Add(*(sbyte*)pCurrData);
					pCurrData++;
				}
				count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int k = 0; k < (int)count; k++)
				{
					usedFriendlyCharacterIds.Add(*(int*)pCurrData);
					pCurrData += 4;
				}
			}
			bool maybeHasAdditionalOperation;
			OperationList list = this._lifeSkillCombat.CalcUsableOperationList(additionalEffectCards, usedBookStateIndices, usedFriendlyCharacterIds, out maybeHasAdditionalOperation, true);
			byte[] data = new byte[list.GetSerializedSize() + 1];
			byte[] array;
			byte* pData2;
			if ((array = data) == null || array.Length == 0)
			{
				pData2 = null;
			}
			else
			{
				pData2 = &array[0];
			}
			byte* pCurrData2 = pData2;
			pCurrData2 += list.Serialize(pCurrData2);
			*pCurrData2 = (maybeHasAdditionalOperation ? 1 : 0);
			pCurrData2++;
			array = null;
			return data;
		}

		// Token: 0x0600115D RID: 4445 RVA: 0x00114D80 File Offset: 0x00112F80
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerGetSecondPhaseUsableOperationList(DataContext context, byte[] inputData)
		{
			OperationUseEffectCard firstPhaseOperation = new OperationUseEffectCard();
			List<sbyte> additionalEffectCards = new List<sbyte>();
			List<sbyte> usedBookStateIndices = new List<sbyte>();
			List<int> usedFriendlyCharacterIds = new List<int>();
			fixed (byte[] array = inputData)
			{
				byte* pData;
				if (inputData == null || array.Length == 0)
				{
					pData = null;
				}
				else
				{
					pData = &array[0];
				}
				byte* pCurrData = pData;
				pCurrData += firstPhaseOperation.Deserialize(pCurrData);
				ushort count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int i = 0; i < (int)count; i++)
				{
					additionalEffectCards.Add(*(sbyte*)pCurrData);
					pCurrData++;
				}
				count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int j = 0; j < (int)count; j++)
				{
					usedBookStateIndices.Add(*(sbyte*)pCurrData);
					pCurrData++;
				}
				count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int k = 0; k < (int)count; k++)
				{
					usedFriendlyCharacterIds.Add(*(int*)pCurrData);
					pCurrData += 4;
				}
			}
			OperationList list = this._lifeSkillCombat.CalcUsableSecondPhaseOperationList(firstPhaseOperation, additionalEffectCards, usedBookStateIndices, usedFriendlyCharacterIds);
			byte[] data = new byte[list.GetSerializedSize() + 1];
			byte[] array;
			byte* pData2;
			if ((array = data) == null || array.Length == 0)
			{
				pData2 = null;
			}
			else
			{
				pData2 = &array[0];
			}
			byte* pCurrData2 = pData2;
			pCurrData2 += list.Serialize(pCurrData2);
			array = null;
			return data;
		}

		// Token: 0x0600115E RID: 4446 RVA: 0x00114ED4 File Offset: 0x001130D4
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerCalcUsableFirstPhaseEffectCardInfo(DataContext context, sbyte effectCardTemplateId)
		{
			List<int> gridIndices;
			List<sbyte> bookIndices;
			this._lifeSkillCombat.CalcUsableFirstPhaseEffectCardInfo(effectCardTemplateId, out gridIndices, out bookIndices);
			byte[] data = new byte[2 + 4 * gridIndices.Count + 2 + bookIndices.Count];
			byte[] array;
			byte* pData;
			if ((array = data) == null || array.Length == 0)
			{
				pData = null;
			}
			else
			{
				pData = &array[0];
			}
			byte* pCurrData = pData;
			*(short*)pCurrData = (short)((ushort)gridIndices.Count);
			pCurrData += 2;
			foreach (int value in gridIndices)
			{
				*(int*)pCurrData = value;
				pCurrData += 4;
			}
			*(short*)pCurrData = (short)((ushort)bookIndices.Count);
			pCurrData += 2;
			foreach (sbyte value2 in bookIndices)
			{
				*pCurrData = (byte)value2;
				pCurrData++;
			}
			array = null;
			return data;
		}

		// Token: 0x0600115F RID: 4447 RVA: 0x00114FE8 File Offset: 0x001131E8
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerAiPickOperation(DataContext context, byte[] operationListData)
		{
			bool flag = this._lifeSkillCombat == null;
			byte[] result;
			if (flag)
			{
				result = null;
			}
			else
			{
				OperationList list = new OperationList();
				fixed (byte[] array = operationListData)
				{
					byte* pData;
					if (operationListData == null || array.Length == 0)
					{
						pData = null;
					}
					else
					{
						pData = &array[0];
					}
					list.Deserialize(pData);
				}
				OperationBase op = this._lifeSkillCombat.CalcAiOperation(context, list);
				byte[] retData = new byte[OperationBase.GetSerializeSizeWithPolymorphism(op)];
				byte[] array;
				byte* pData2;
				if ((array = retData) == null || array.Length == 0)
				{
					pData2 = null;
				}
				else
				{
					pData2 = &array[0];
				}
				OperationBase.SerializeWithPolymorphism(op, pData2);
				array = null;
				result = retData;
			}
			return result;
		}

		// Token: 0x06001160 RID: 4448 RVA: 0x00115088 File Offset: 0x00113288
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerCommitOperation(DataContext context, byte[] data)
		{
			OperationBase operation = null;
			fixed (byte[] array = data)
			{
				byte* pData;
				if (data == null || array.Length == 0)
				{
					pData = null;
				}
				else
				{
					pData = &array[0];
				}
				OperationBase.DeserializeWithPolymorphism(ref operation, pData);
			}
			bool flag = this._lifeSkillCombat == null;
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(50, 1);
				defaultInterpolatedStringHandler.AppendLiteral("commit operation ");
				defaultInterpolatedStringHandler.AppendFormatted<OperationBase>(operation);
				defaultInterpolatedStringHandler.AppendLiteral(" when lifeSkillCombat is inactive");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			StatusSnapshot previous = this._lifeSkillCombat.Dump();
			List<StatusSnapshotDiff.BookStateExtraDiff> bookStateExtraDiffs = new List<StatusSnapshotDiff.BookStateExtraDiff>();
			List<StatusSnapshotDiff.GridTrapStateExtraDiff> gridTrapStateExtraDiffs = new List<StatusSnapshotDiff.GridTrapStateExtraDiff>();
			this._lifeSkillCombat.CommitOperation(context, operation, bookStateExtraDiffs, gridTrapStateExtraDiffs);
			StatusSnapshot statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff diff = new StatusSnapshotDiff(ref previous, ref statusSnapshot);
			diff.BookStateExtraDiffList.AddRange(bookStateExtraDiffs);
			diff.GridTrapStateExtraDiffList.AddRange(gridTrapStateExtraDiffs);
			this._lifeSkillCombat.RecordDiff(diff);
			byte[] retData = new byte[diff.GetSerializedSize()];
			byte[] array;
			byte* pData2;
			if ((array = retData) == null || array.Length == 0)
			{
				pData2 = null;
			}
			else
			{
				pData2 = &array[0];
			}
			diff.Serialize(pData2);
			array = null;
			return retData;
		}

		// Token: 0x06001161 RID: 4449 RVA: 0x001151BC File Offset: 0x001133BC
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerSimulateCommitOperation(DataContext context, byte[] data)
		{
			StatusSnapshot previous = this._lifeSkillCombat.Dump();
			OperationBase operation = null;
			fixed (byte[] array = data)
			{
				byte* pData;
				if (data == null || array.Length == 0)
				{
					pData = null;
				}
				else
				{
					pData = &array[0];
				}
				OperationBase.DeserializeWithPolymorphism(ref operation, pData);
			}
			List<StatusSnapshotDiff.BookStateExtraDiff> bookStateExtraDiffs = new List<StatusSnapshotDiff.BookStateExtraDiff>();
			List<StatusSnapshotDiff.GridTrapStateExtraDiff> gridTrapStateExtraDiffs = new List<StatusSnapshotDiff.GridTrapStateExtraDiff>();
			this._lifeSkillCombat.SimulateOperationCommit(context, operation, bookStateExtraDiffs, gridTrapStateExtraDiffs);
			StatusSnapshot statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff diff = new StatusSnapshotDiff(ref previous, ref statusSnapshot);
			diff.BookStateExtraDiffList.AddRange(bookStateExtraDiffs);
			diff.GridTrapStateExtraDiffList.AddRange(gridTrapStateExtraDiffs);
			byte[] retData = new byte[diff.GetSerializedSize()];
			byte[] array;
			byte* pData2;
			if ((array = retData) == null || array.Length == 0)
			{
				pData2 = null;
			}
			else
			{
				pData2 = &array[0];
			}
			diff.Serialize(pData2);
			array = null;
			return retData;
		}

		// Token: 0x06001162 RID: 4450 RVA: 0x00115298 File Offset: 0x00113498
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerSimulateCancelOperation(DataContext context)
		{
			StatusSnapshot previous = this._lifeSkillCombat.Dump();
			this._lifeSkillCombat.SimulateOperationCancel(context);
			StatusSnapshot statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff diff = new StatusSnapshotDiff(ref previous, ref statusSnapshot);
			byte[] retData = new byte[diff.GetSerializedSize()];
			byte[] array;
			byte* pData;
			if ((array = retData) == null || array.Length == 0)
			{
				pData = null;
			}
			else
			{
				pData = &array[0];
			}
			diff.Serialize(pData);
			array = null;
			return retData;
		}

		// Token: 0x06001163 RID: 4451 RVA: 0x00115314 File Offset: 0x00113514
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerCommitOperationPreview(DataContext context, byte[] data)
		{
			OperationBase operation = null;
			fixed (byte[] array = data)
			{
				byte* pData;
				if (data == null || array.Length == 0)
				{
					pData = null;
				}
				else
				{
					pData = &array[0];
				}
				OperationBase.DeserializeWithPolymorphism(ref operation, pData);
			}
			this._lifeSkillCombat.RecordLine("-- Incoming preview --", 0);
			StatusSnapshot previous = this._lifeSkillCombat.Dump();
			List<int> pickedGridIndices = new List<int>();
			List<StatusSnapshotDiff.BookStateExtraDiff> bookStateExtraDiffs = new List<StatusSnapshotDiff.BookStateExtraDiff>();
			List<StatusSnapshotDiff.GridTrapStateExtraDiff> gridTrapStateExtraDiffs = new List<StatusSnapshotDiff.GridTrapStateExtraDiff>();
			bool flag = operation.PlayerId == this._lifeSkillCombat.CurrentPlayerId;
			if (flag)
			{
				this._lifeSkillCombat.CommitOperationProcess(context, operation, bookStateExtraDiffs, gridTrapStateExtraDiffs, false);
				this._lifeSkillCombat.SwitchCurrentPlayerProcess(context, bookStateExtraDiffs, gridTrapStateExtraDiffs, true);
			}
			StatusSnapshot statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff operationSimulatedDiff = new StatusSnapshotDiff(ref previous, ref statusSnapshot);
			operationSimulatedDiff.BookStateExtraDiffList.AddRange(bookStateExtraDiffs);
			operationSimulatedDiff.GridTrapStateExtraDiffList.AddRange(gridTrapStateExtraDiffs);
			this._lifeSkillCombat.Restore(previous);
			List<StatusSnapshotDiff.BookStateExtraDiff> bookStateExtraDiffs2 = new List<StatusSnapshotDiff.BookStateExtraDiff>();
			List<StatusSnapshotDiff.GridTrapStateExtraDiff> gridTrapStateExtraDiffs2 = new List<StatusSnapshotDiff.GridTrapStateExtraDiff>();
			bool flag2 = operation.PlayerId == this._lifeSkillCombat.CurrentPlayerId;
			if (flag2)
			{
				this._lifeSkillCombat.CommitOperationProcess(context, new OperationSilent(operation.PlayerId, this._lifeSkillCombat.PlayerSwitchCount), bookStateExtraDiffs2, gridTrapStateExtraDiffs2, false);
				this._lifeSkillCombat.SwitchCurrentPlayerProcess(context, bookStateExtraDiffs2, gridTrapStateExtraDiffs2, true);
			}
			statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff silentSimulatedDiff = new StatusSnapshotDiff(ref previous, ref statusSnapshot);
			silentSimulatedDiff.BookStateExtraDiffList.AddRange(bookStateExtraDiffs2);
			silentSimulatedDiff.GridTrapStateExtraDiffList.AddRange(gridTrapStateExtraDiffs2);
			this._lifeSkillCombat.Restore(previous);
			Dictionary<int, Grid> operationSimulatedDiffGridMap = new Dictionary<int, Grid>();
			Dictionary<int, Grid> silentSimulatedDiffGridMap = new Dictionary<int, Grid>();
			foreach (Grid grid in operationSimulatedDiff.GridStatusDiffCurrent)
			{
				operationSimulatedDiffGridMap.Add(grid.Index, grid);
			}
			foreach (Grid grid2 in silentSimulatedDiff.GridStatusDiffCurrent)
			{
				silentSimulatedDiffGridMap.Add(grid2.Index, grid2);
			}
			OperationGridBase pG = operation as OperationGridBase;
			bool flag3 = pG != null;
			if (flag3)
			{
				operationSimulatedDiffGridMap.Remove(pG.GridIndex);
			}
			foreach (KeyValuePair<int, Grid> pair in operationSimulatedDiffGridMap)
			{
				Grid siGrid;
				bool flag4 = silentSimulatedDiffGridMap.TryGetValue(pair.Key, out siGrid);
				if (flag4)
				{
					Grid opGrid = pair.Value;
					OperationPointBase opThesis = opGrid.LastHistoryOperation as OperationPointBase;
					OperationPointBase siThesis = siGrid.LastHistoryOperation as OperationPointBase;
					int opThesisPoint = (opThesis != null) ? opThesis.Point : -1;
					int siThesisPoint = (siThesis != null) ? siThesis.Point : -1;
					sbyte opThesisHouse = (opThesis != null) ? opThesis.PlayerId : -1;
					sbyte siThesisHouse = (siThesis != null) ? siThesis.PlayerId : -1;
					bool isDiff = opThesisPoint != siThesisPoint || opThesisHouse != siThesisHouse;
					bool flag5 = isDiff;
					if (flag5)
					{
						pickedGridIndices.Add(pair.Key);
					}
				}
				else
				{
					pickedGridIndices.Add(pair.Key);
				}
			}
			operationSimulatedDiff.GridTrapStateExtraDiffList.Clear();
			this._lifeSkillCombat.RecordLine("-- Ending preview --", 0);
			byte[] retData = new byte[operationSimulatedDiff.GetSerializedSize() + 2 + pickedGridIndices.Count * 4];
			byte[] array;
			byte* pData2;
			if ((array = retData) == null || array.Length == 0)
			{
				pData2 = null;
			}
			else
			{
				pData2 = &array[0];
			}
			byte* pCurrData = pData2;
			pCurrData += operationSimulatedDiff.Serialize(pCurrData);
			*(short*)pCurrData = (short)((ushort)pickedGridIndices.Count);
			pCurrData += 2;
			for (int i = 0; i < pickedGridIndices.Count; i++)
			{
				*(int*)pCurrData = pickedGridIndices[i];
				pCurrData += 4;
			}
			array = null;
			return retData;
		}

		// Token: 0x06001164 RID: 4452 RVA: 0x00115738 File Offset: 0x00113938
		[DomainMethod]
		public unsafe byte[] LifeSkillCombatCurrentPlayerAcceptForceSilent(DataContext context)
		{
			StatusSnapshot previous = this._lifeSkillCombat.Dump();
			OperationBase operation = new OperationSilent(this._lifeSkillCombat.CurrentPlayerId, this._lifeSkillCombat.PlayerSwitchCount);
			List<StatusSnapshotDiff.BookStateExtraDiff> bookStateExtraDiffs = new List<StatusSnapshotDiff.BookStateExtraDiff>();
			List<StatusSnapshotDiff.GridTrapStateExtraDiff> gridTrapStateExtraDiffs = new List<StatusSnapshotDiff.GridTrapStateExtraDiff>();
			this._lifeSkillCombat.CommitOperation(context, operation, bookStateExtraDiffs, gridTrapStateExtraDiffs);
			StatusSnapshot statusSnapshot = this._lifeSkillCombat.Dump();
			StatusSnapshotDiff diff = new StatusSnapshotDiff(ref previous, ref statusSnapshot);
			diff.BookStateExtraDiffList.AddRange(bookStateExtraDiffs);
			diff.GridTrapStateExtraDiffList.AddRange(gridTrapStateExtraDiffs);
			this._lifeSkillCombat.RecordDiff(diff);
			byte[] retData = new byte[diff.GetSerializedSize()];
			byte[] array;
			byte* pData;
			if ((array = retData) == null || array.Length == 0)
			{
				pData = null;
			}
			else
			{
				pData = &array[0];
			}
			diff.Serialize(pData);
			array = null;
			return retData;
		}

		// Token: 0x06001165 RID: 4453 RVA: 0x00115810 File Offset: 0x00113A10
		[DomainMethod]
		public unsafe List<sbyte> LifeSkillCombatCurrentPlayerGetNotUsableEffectCardTemplateIds(DataContext context, byte[] inputData)
		{
			List<sbyte> selectedEffectCardTemplateIds = new List<sbyte>();
			List<sbyte> usedBookStateIndices = new List<sbyte>();
			List<int> usedFriendlyCharacterIds = new List<int>();
			fixed (byte[] array = inputData)
			{
				byte* pData;
				if (inputData == null || array.Length == 0)
				{
					pData = null;
				}
				else
				{
					pData = &array[0];
				}
				byte* pCurrData = pData;
				ushort count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int i = 0; i < (int)count; i++)
				{
					selectedEffectCardTemplateIds.Add(*(sbyte*)pCurrData);
					pCurrData++;
				}
				count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int j = 0; j < (int)count; j++)
				{
					usedBookStateIndices.Add(*(sbyte*)pCurrData);
					pCurrData++;
				}
				count = *(ushort*)pCurrData;
				pCurrData += 2;
				for (int k = 0; k < (int)count; k++)
				{
					usedFriendlyCharacterIds.Add(*(int*)pCurrData);
					pCurrData += 4;
				}
			}
			return this._lifeSkillCombat.GetNotUsableEffectCardTemplateIds(context, usedBookStateIndices, usedFriendlyCharacterIds, selectedEffectCardTemplateIds);
		}

		// Token: 0x06001166 RID: 4454 RVA: 0x00115904 File Offset: 0x00113B04
		[DomainMethod]
		public unsafe CombatResultDisplayData ApplyLifeSkillCombatResult(DataContext context, int adversaryCharacterId, bool isTaiwuWin)
		{
			CombatResultDisplayData result = new CombatResultDisplayData();
			result.EvaluationList = new List<sbyte>();
			GameData.Domains.Character.Character taiwu = DomainManager.Taiwu.GetTaiwu();
			if (isTaiwuWin)
			{
				int authorityIndex = Math.Clamp((int)DomainManager.Character.GetElement_Objects(adversaryCharacterId).GetConsummateLevel(), 0, GlobalConfig.Instance.CombatGetAuthorityBase.Length - 1);
				int authority = (int)GlobalConfig.Instance.CombatGetAuthorityBase[authorityIndex];
				authority *= (int)GlobalConfig.Instance.LifeSkillBattleGainRatio;
				authority /= 100;
				*result.Resource[7] = authority;
				taiwu.ChangeResource(context, 7, authority);
			}
			if (isTaiwuWin)
			{
				int exp = 0;
				int expIndex = Math.Clamp((int)DomainManager.Character.GetElement_Objects(adversaryCharacterId).GetConsummateLevel(), 0, GlobalConfig.Instance.CombatGetExpBase.Length - 1);
				exp += (int)GlobalConfig.Instance.CombatGetExpBase[expIndex];
				exp *= (int)GlobalConfig.Instance.LifeSkillBattleGainRatio;
				exp /= 100;
				result.Exp = exp;
				taiwu.ChangeExp(context, exp);
				Events.RaiseEvaluationAddExp(context, exp);
			}
			sbyte readInLifeSkillCombatCount = DomainManager.Extra.GetReadInLifeSkillCombatCount();
			ItemKey currBook = DomainManager.Taiwu.GetCurReadingBook();
			SkillBookItem bookCfg = Config.SkillBook.Instance[currBook.TemplateId];
			bool flag = readInLifeSkillCombatCount > 0 && currBook.IsValid() && DomainManager.Taiwu.GetTotalReadingProgress(currBook.Id) < 100 && bookCfg.LifeSkillTemplateId >= 0;
			if (flag)
			{
				int bonusOdds = 0;
				GameData.Domains.Character.Character adversary;
				bool flag2 = isTaiwuWin && DomainManager.Character.TryGetElement_Objects(adversaryCharacterId, out adversary);
				if (flag2)
				{
					bonusOdds = (int)(40 + (adversary.GetConsummateLevel() - taiwu.GetConsummateLevel()) * 10);
				}
				bool flag3 = context.Random.CheckPercentProb(bonusOdds);
				if (flag3)
				{
					DomainManager.Extra.SetReadInLifeSkillCombatCount(readInLifeSkillCombatCount - 1, context);
					result.ShowReadingEvent = DomainManager.Taiwu.UpdateReadingProgressInCombat(context);
					result.EvaluationList.Add(33);
					bool showReadingEvent = result.ShowReadingEvent;
					if (showReadingEvent)
					{
						DomainManager.Extra.AddReadingEventBookId(context, currBook.Id);
					}
				}
			}
			this.CalcQiQrtInLifeCombat(context, adversaryCharacterId, isTaiwuWin, result);
			return result;
		}

		// Token: 0x06001167 RID: 4455 RVA: 0x00115B20 File Offset: 0x00113D20
		[Obsolete("新版较艺的相关逻辑直接写在了DebateGameOver()")]
		private void CalcQiQrtInLifeCombat(DataContext context, int adversaryCharacterId, bool isTaiwuWin, CombatResultDisplayData result)
		{
			result.ShowLoopingEvent = false;
			sbyte loopInLifeSkillCombatCount = DomainManager.Extra.GetLoopInLifeSkillCombatCount();
			bool flag = loopInLifeSkillCombatCount <= 0;
			if (!flag)
			{
				GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
				short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
				bool flag2 = loopingNeigongTemplateId < 0;
				if (!flag2)
				{
					CombatSkillKey skillKey = new CombatSkillKey(taiwuChar.GetId(), loopingNeigongTemplateId);
					GameData.Domains.CombatSkill.CombatSkill skill = DomainManager.CombatSkill.GetElement_CombatSkills(skillKey);
					short totalNeili = skill.GetTotalObtainableNeili();
					short currentNeili = skill.GetObtainedNeili();
					bool flag3 = currentNeili >= totalNeili;
					if (!flag3)
					{
						int percentProb = 0;
						GameData.Domains.Character.Character adversary;
						bool flag4 = isTaiwuWin && DomainManager.Character.TryGetElement_Objects(adversaryCharacterId, out adversary);
						if (flag4)
						{
							percentProb = (int)(40 + (adversary.GetConsummateLevel() - taiwuChar.GetConsummateLevel()) * 10);
						}
						bool flag5 = !context.Random.CheckPercentProb(percentProb);
						if (!flag5)
						{
							DomainManager.Extra.SetLoopInLifeSkillCombatCount(loopInLifeSkillCombatCount - 1, context);
							DomainManager.Taiwu.ApplyNeigongLoopingImprovementOnce(context, 100);
							result.EvaluationList.Add(43);
							InstantNotificationCollection instantCollection = DomainManager.World.GetInstantNotificationCollection();
							instantCollection.AddQiArtInLifeSkillCombatNoChance(loopingNeigongTemplateId);
							result.ShowLoopingEvent = DomainManager.Taiwu.TryAddLoopingEvent(context, percentProb);
						}
					}
				}
			}
		}

		// Token: 0x06001168 RID: 4456 RVA: 0x00115C58 File Offset: 0x00113E58
		[DomainMethod]
		public SecretInformationDisplayPackage PickLifeSkillCombatCharacterUseSecretInformation(DataContext context, int characterId)
		{
			SecretInformationDisplayPackage source = DomainManager.Information.GetSecretInformationDisplayPackageFromCharacter(characterId);
			Func<SecretInformationDisplayData, int> leveler;
			switch (DomainManager.Character.GetElement_Objects(characterId).GetBehaviorType())
			{
			case 1:
				source.SecretInformationDisplayDataList.RemoveAll(delegate(SecretInformationDisplayData d)
				{
					SecretInformationItem config = SecretInformation.Instance[d.SecretInformationTemplateId];
					return config.ValueType != ESecretInformationValueType.Positive && config.ValueType > ESecretInformationValueType.Normal;
				});
				leveler = delegate(SecretInformationDisplayData d)
				{
					bool flag = (d.FilterMask & 4) > 0;
					int result;
					if (flag)
					{
						result = 0;
					}
					else
					{
						bool flag2 = (d.FilterMask & 2) > 0;
						if (flag2)
						{
							result = 1;
						}
						else
						{
							result = 3;
						}
					}
					return result;
				};
				break;
			case 2:
				leveler = delegate(SecretInformationDisplayData d)
				{
					bool flag = (d.FilterMask & 4) > 0;
					int result;
					if (flag)
					{
						result = 0;
					}
					else
					{
						result = 3;
					}
					return result;
				};
				break;
			case 3:
				source.SecretInformationDisplayDataList.RemoveAll(delegate(SecretInformationDisplayData d)
				{
					SecretInformationItem config = SecretInformation.Instance[d.SecretInformationTemplateId];
					return config.ValueType != ESecretInformationValueType.Negative && config.ValueType > ESecretInformationValueType.Normal;
				});
				leveler = delegate(SecretInformationDisplayData d)
				{
					bool flag = (d.FilterMask & 4) > 0;
					int result;
					if (flag)
					{
						result = 0;
					}
					else
					{
						bool flag2 = (d.FilterMask & 1) > 0;
						if (flag2)
						{
							result = 1;
						}
						else
						{
							result = 3;
						}
					}
					return result;
				};
				break;
			case 4:
				source.SecretInformationDisplayDataList.RemoveAll(delegate(SecretInformationDisplayData d)
				{
					SecretInformationItem config = SecretInformation.Instance[d.SecretInformationTemplateId];
					return config.ValueType != ESecretInformationValueType.Negative && config.ValueType != ESecretInformationValueType.Positive;
				});
				leveler = delegate(SecretInformationDisplayData d)
				{
					bool flag = (d.FilterMask & 4) > 0;
					int result;
					if (flag)
					{
						result = 0;
					}
					else
					{
						bool flag2 = (d.FilterMask & 1) > 0;
						if (flag2)
						{
							result = 1;
						}
						else
						{
							result = 3;
						}
					}
					return result;
				};
				break;
			default:
				leveler = ((SecretInformationDisplayData _) => 3);
				break;
			}
			source.SecretInformationDisplayDataList.RemoveAll((SecretInformationDisplayData d) => leveler(d) >= 3);
			source.SecretInformationDisplayDataList.Sort((SecretInformationDisplayData a, SecretInformationDisplayData b) => leveler(a).CompareTo(leveler(b)));
			while (source.SecretInformationDisplayDataList.Count > 0)
			{
				source.SecretInformationDisplayDataList.RemoveAt(source.SecretInformationDisplayDataList.Count - 1);
			}
			return source;
		}

		// Token: 0x06001169 RID: 4457 RVA: 0x00115E5C File Offset: 0x0011405C
		[DomainMethod]
		public ItemDisplayData PickLifeSkillCombatCharacterUseItem(DataContext context, int characterId)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(characterId);
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			OrganizationItem orgConfig = Organization.Instance[character.GetOrganizationInfo().OrgTemplateId];
			bool isSect = orgConfig.IsSect;
			if (isSect)
			{
				int totalItemTypeWeight = orgConfig.LifeSkillCombatBriberyItemTypeWeight.Sum((LifeSkillCombatBriberyItemTypeWeight t) => (int)t.Weight);
				int totalItemSubTypeWeight = orgConfig.LifeSkillCombatBriberyItemSubTypeWeight.Sum((LifeSkillCombatBriberyItemSubTypeWeight t) => (int)t.Weight);
				bool flag = totalItemTypeWeight + totalItemSubTypeWeight == 0;
				if (flag)
				{
					return null;
				}
			}
			sbyte behaviorType = character.GetBehaviorType();
			sbyte b = behaviorType;
			ItemDisplayData result;
			if (b - 2 > 2)
			{
				result = null;
			}
			else
			{
				List<ItemDisplayData> items = DomainManager.Character.GetAllInventoryItems(characterId);
				sbyte taiwuLevel = taiwuChar.GetConsummateLevel();
				sbyte charLevel = character.GetConsummateLevel();
				sbyte charGrade = character.GetOrganizationInfo().Grade;
				bool flag2 = taiwuLevel >= charLevel;
				int minGrade;
				int maxGrade;
				if (flag2)
				{
					minGrade = Math.Clamp((int)(charGrade - 2), 0, 8);
					maxGrade = (int)Math.Clamp(charGrade, 0, 8);
				}
				else
				{
					minGrade = Math.Clamp((int)(taiwuLevel / 2 - 2), 0, 8);
					maxGrade = Math.Clamp((int)(taiwuLevel / 2), 0, 8);
				}
				items.RemoveAll(delegate(ItemDisplayData itemData)
				{
					List<ItemKey> keyList = itemData.GetAllItemKeysFromPool();
					foreach (ItemKey itemKey in keyList)
					{
						bool flag7 = itemKey.Equals(this._lockedItemKey);
						if (flag7)
						{
							return true;
						}
						sbyte grade = ItemTemplateHelper.GetGrade(itemKey.ItemType, itemKey.TemplateId);
						bool flag8 = (int)grade < minGrade || (int)grade > maxGrade;
						if (flag8)
						{
							return true;
						}
					}
					ItemDisplayData.ReturnItemKeyListToPool(keyList);
					return false;
				});
				ItemDisplayData picked = null;
				bool isSect2 = orgConfig.IsSect;
				if (isSect2)
				{
					Dictionary<int, ValueTuple<short, int, List<ItemDisplayData>>> itemTypeDict = (from p in orgConfig.LifeSkillCombatBriberyItemTypeWeight
					where p.Weight > 0
					select p).ToDictionary((LifeSkillCombatBriberyItemTypeWeight p) => (int)p.ItemType, (LifeSkillCombatBriberyItemTypeWeight p) => new ValueTuple<short, int, List<ItemDisplayData>>(p.Weight, 0, new List<ItemDisplayData>()));
					Dictionary<int, ValueTuple<short, int, List<ItemDisplayData>>> itemSubTypeDict = (from p in orgConfig.LifeSkillCombatBriberyItemSubTypeWeight
					where p.Weight > 0
					select p).ToDictionary((LifeSkillCombatBriberyItemSubTypeWeight p) => (int)p.ItemSubType, (LifeSkillCombatBriberyItemSubTypeWeight p) => new ValueTuple<short, int, List<ItemDisplayData>>(p.Weight, 0, new List<ItemDisplayData>()));
					foreach (ItemDisplayData itemData2 in items)
					{
						sbyte itemType = itemData2.RealKey.ItemType;
						ValueTuple<short, int, List<ItemDisplayData>> itemTypeTuple;
						bool flag3 = itemTypeDict.TryGetValue((int)itemType, out itemTypeTuple);
						if (flag3)
						{
							itemTypeTuple.Item3.Add(itemData2);
						}
						else
						{
							short itemSubType = ItemTemplateHelper.GetItemSubType(itemType, itemData2.RealKey.TemplateId);
							ValueTuple<short, int, List<ItemDisplayData>> itemSubTypeTuple;
							bool flag4 = itemSubTypeDict.TryGetValue((int)itemSubType, out itemSubTypeTuple);
							if (flag4)
							{
								itemSubTypeTuple.Item3.Add(itemData2);
							}
						}
					}
					this.HandleBriberyWeightDict(itemTypeDict);
					this.HandleBriberyWeightDict(itemSubTypeDict);
					int totalItemTypeWeight2 = itemTypeDict.Sum(([TupleElementNames(new string[]
					{
						"Weight",
						null,
						null
					})] KeyValuePair<int, ValueTuple<short, int, List<ItemDisplayData>>> p) => (int)p.Value.Item1);
					int totalItemSubTypeWeight2 = itemSubTypeDict.Sum(([TupleElementNames(new string[]
					{
						"Weight",
						null,
						null
					})] KeyValuePair<int, ValueTuple<short, int, List<ItemDisplayData>>> p) => (int)p.Value.Item1);
					int totalWeight = totalItemTypeWeight2 + totalItemSubTypeWeight2;
					bool flag5 = totalWeight > 0;
					if (flag5)
					{
						int random = context.Random.Next(totalWeight);
						bool flag6 = random < totalItemTypeWeight2;
						if (flag6)
						{
							random = context.Random.Next(totalItemTypeWeight2);
							ValueTuple<short, int, List<ItemDisplayData>> tuple = (from p in itemTypeDict.Values
							where p.Item2 > random
							select p).MinBy(([TupleElementNames(new string[]
							{
								"Weight",
								null,
								null
							})] ValueTuple<short, int, List<ItemDisplayData>> p) => p.Item2);
							picked = tuple.Item3.GetRandom(context.Random);
						}
						else
						{
							random = context.Random.Next(totalItemSubTypeWeight2);
							ValueTuple<short, int, List<ItemDisplayData>> tuple2 = (from p in itemSubTypeDict.Values
							where p.Item2 > random
							select p).MinBy(([TupleElementNames(new string[]
							{
								"Weight",
								null,
								null
							})] ValueTuple<short, int, List<ItemDisplayData>> p) => p.Item2);
							picked = tuple2.Item3.GetRandom(context.Random);
						}
					}
				}
				else
				{
					picked = items.GetRandom(context.Random);
				}
				Match lifeSkillCombat = this._lifeSkillCombat;
				if (lifeSkillCombat != null)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(8, 2);
					defaultInterpolatedStringHandler.AppendFormatted("PickLifeSkillCombatCharacterUseItem");
					defaultInterpolatedStringHandler.AppendLiteral(" picked ");
					defaultInterpolatedStringHandler.AppendFormatted<ItemDisplayData>(picked);
					lifeSkillCombat.RecordLine(defaultInterpolatedStringHandler.ToStringAndClear(), 0);
				}
				result = picked;
			}
			return result;
		}

		// Token: 0x0600116A RID: 4458 RVA: 0x00116350 File Offset: 0x00114550
		private void HandleBriberyWeightDict([TupleElementNames(new string[]
		{
			"weight",
			"curWeight",
			"list"
		})] Dictionary<int, ValueTuple<short, int, List<ItemDisplayData>>> dict)
		{
			foreach (int key in dict.Keys)
			{
				List<ItemDisplayData> item = dict[key].Item3;
				bool flag = item == null || item.Count <= 0;
				if (flag)
				{
					dict.Remove(key);
				}
			}
			int curWeight = 0;
			foreach (int key2 in dict.Keys)
			{
				ValueTuple<short, int, List<ItemDisplayData>> tuple = dict[key2];
				curWeight += (int)tuple.Item1;
				tuple.Item2 = curWeight;
				dict[key2] = tuple;
			}
		}

		// Token: 0x0600116B RID: 4459 RVA: 0x0011643C File Offset: 0x0011463C
		public void SetLifeSkillCombatLockItem(DataContext dataContext, ItemKey itemKey)
		{
			this._lockedItemKey = itemKey;
		}

		// Token: 0x0600116C RID: 4460 RVA: 0x00116448 File Offset: 0x00114648
		public void OnCurrentPlayerUseForceSilent(sbyte type, bool result)
		{
			Player player = this._lifeSkillCombat.GetPlayer(this._lifeSkillCombat.CurrentPlayerId);
			player.SetForceSilentRemainingCount(player.ForceSilentRemainingCount - 1);
			this._lifeSkillCombat.PlayerForcedSecretInformation[player.Id] = type;
			if (result)
			{
				this._lifeSkillCombat.AcceptSilentPlayerId = Player.PredefinedId.GetTheOtherSide(player.Id);
			}
		}

		// Token: 0x0600116D RID: 4461 RVA: 0x001164B0 File Offset: 0x001146B0
		public sbyte GetLifeSkillCombatCharacterBehaviorType()
		{
			return DomainManager.Character.GetElement_Objects(this._lifeSkillCombat.GetPlayerCharacterId(1)).GetBehaviorType();
		}

		// Token: 0x0600116E RID: 4462 RVA: 0x001164E0 File Offset: 0x001146E0
		[DomainMethod]
		public void SetReferenceCombatSkillAt(DataContext context, int index, short combatSkillTemplateId)
		{
			bool flag = !this.IsReferenceSkillSlotUnlocked(index);
			if (flag)
			{
				throw new InvalidOperationException("Reference skill slot is locked.");
			}
			List<short> referenceSkillList = DomainManager.Extra.GetReferenceSkillList() ?? new List<short>();
			while (referenceSkillList.Count < 3)
			{
				referenceSkillList.Add(-1);
			}
			List<short> referenceSkillList2 = referenceSkillList;
			referenceSkillList2[index] = combatSkillTemplateId;
			DomainManager.Extra.SetReferenceSkillList(referenceSkillList2, context);
			short loopingNeigong = this._taiwuChar.GetLoopingNeigong();
			this.TryRemoveLoopingEvent(context, loopingNeigong);
		}

		// Token: 0x0600116F RID: 4463 RVA: 0x00116564 File Offset: 0x00114764
		[DomainMethod]
		public void SetTaiwuLoopingNeigong(DataContext context, short combatSkillTemplateId)
		{
			short loopingNeigong = this._taiwuChar.GetLoopingNeigong();
			bool flag = combatSkillTemplateId == loopingNeigong;
			if (!flag)
			{
				this.TryRemoveLoopingEvent(context, loopingNeigong);
				this._taiwuChar.SetLoopingNeigong(combatSkillTemplateId, context);
			}
		}

		// Token: 0x06001170 RID: 4464 RVA: 0x001165A0 File Offset: 0x001147A0
		private void TryRemoveLoopingEvent(DataContext context, short loopingNeigong)
		{
			List<short> hasEventSkillIdList = DomainManager.Extra.GetLoopingEventSkillIdList();
			bool flag = hasEventSkillIdList.Contains(loopingNeigong);
			if (flag)
			{
				hasEventSkillIdList.Remove(loopingNeigong);
				DomainManager.Extra.SetLoopingEventSkillIdList(hasEventSkillIdList, context);
			}
		}

		// Token: 0x06001171 RID: 4465 RVA: 0x001165DC File Offset: 0x001147DC
		public bool IsReferenceSkillSlotUnlocked(int slotIndex)
		{
			byte referenceSkillSlotUnlockStates = this.GetReferenceSkillSlotUnlockStates();
			return ((int)referenceSkillSlotUnlockStates & 1 << slotIndex) != 0;
		}

		// Token: 0x06001172 RID: 4466 RVA: 0x00116600 File Offset: 0x00114800
		public void ResetLoopInCombatCounts(DataContext context)
		{
			DomainManager.Extra.SetLoopInCombatCount(1, context);
			DomainManager.Extra.SetLoopInLifeSkillCombatCount(1, context);
		}

		// Token: 0x06001173 RID: 4467 RVA: 0x00116620 File Offset: 0x00114820
		public void TryRemoveReferenceSkillAtLockedSlot(DataContext context)
		{
			List<short> referenceSkillList = DomainManager.Extra.GetReferenceSkillList();
			for (int i = 0; i < referenceSkillList.Count; i++)
			{
				bool flag = referenceSkillList[i] != -1 && !this.IsReferenceSkillSlotUnlocked(i);
				if (flag)
				{
					referenceSkillList[i] = -1;
				}
			}
			DomainManager.Extra.SetReferenceSkillList(referenceSkillList, context);
		}

		// Token: 0x06001174 RID: 4468 RVA: 0x00116683 File Offset: 0x00114883
		[DomainMethod]
		public void SetAutoAllocateNeiliToMax(bool value)
		{
			TaiwuDomain._autoAllocateNeiliToMax = value;
		}

		// Token: 0x06001175 RID: 4469 RVA: 0x0011668C File Offset: 0x0011488C
		public void UpdateTaiwuNeiliAllocation(DataContext context, bool isInCombat = false)
		{
			bool flag = !TaiwuDomain._autoAllocateNeiliToMax;
			if (!flag)
			{
				NeiliAllocation taiwuMaxNeiliAllocation = DomainManager.Extra.GetTaiwuMaxNeiliAllocation();
				this.UpdateTaiwuNeiliAllocation(context, taiwuMaxNeiliAllocation, isInCombat);
			}
		}

		// Token: 0x06001176 RID: 4470 RVA: 0x001166C0 File Offset: 0x001148C0
		public void UpdateTaiwuNeiliAllocation(DataContext context, NeiliAllocation targetAllocation, bool isInCombat = false)
		{
			bool flag = !TaiwuDomain._autoAllocateNeiliToMax;
			if (!flag)
			{
				GameData.Domains.Character.Character taiwu = DomainManager.Taiwu.GetTaiwu();
				NeiliAllocation currNeiliAllocation = taiwu.GetBaseNeiliAllocation();
				int currNeili = taiwu.GetCurrNeili();
				int maxNeili = taiwu.GetMaxNeili();
				short maxTotalAllocation = CombatHelper.GetMaxTotalNeiliAllocationConsideringFeature(taiwu.GetConsummateLevel(), taiwu.GetFeatureIds());
				if (isInCombat)
				{
					short disorderOfQi = taiwu.GetDisorderOfQi();
					sbyte disorderLevel = DisorderLevelOfQi.GetDisorderLevelOfQi(disorderOfQi);
					sbyte neiliCostPercentage = QiDisorderEffect.Instance[disorderLevel].NeiliCostInCombat;
					CombatHelper.TryAllocateToTargetAllocation(targetAllocation, ref currNeiliAllocation, maxNeili, ref currNeili, (int)maxTotalAllocation, (int)neiliCostPercentage);
				}
				else
				{
					CombatHelper.TryAllocateToTargetAllocation(targetAllocation, ref currNeiliAllocation, maxNeili, ref currNeili, (int)maxTotalAllocation, 100);
				}
				taiwu.SetBaseNeiliAllocation(currNeiliAllocation, context);
				taiwu.SpecifyCurrNeili(context, currNeili);
			}
		}

		// Token: 0x06001177 RID: 4471 RVA: 0x00116778 File Offset: 0x00114978
		[DomainMethod]
		public unsafe void ActiveNeigongLoopingOnce(DataContext context)
		{
			int dayCost = (int)GlobalConfig.Instance.ActiveNeigongLoopingTimeCost;
			MainAttributes mainAttributes = this._taiwuChar.GetCurrMainAttributes();
			short concentrationCost = GlobalConfig.Instance.ActiveNeigongLoopingAttributeCost;
			short curInt = *(ref mainAttributes.Items.FixedElementField + (IntPtr)2 * 2);
			bool flag = DomainManager.World.GetLeftDaysInCurrMonth() < dayCost;
			if (flag)
			{
				TaiwuDomain.Logger.Warn("You don't have enough days in this month");
			}
			else
			{
				bool flag2 = concentrationCost > curInt;
				if (flag2)
				{
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(60, 2);
					defaultInterpolatedStringHandler.AppendLiteral("You don't have enough intelligence: ");
					defaultInterpolatedStringHandler.AppendFormatted<short>(concentrationCost);
					defaultInterpolatedStringHandler.AppendLiteral(" needed, current int is ");
					defaultInterpolatedStringHandler.AppendFormatted<short>(curInt);
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				else
				{
					DomainManager.World.AdvanceDaysInMonth(context, dayCost);
					bool flag3 = concentrationCost > 0;
					if (flag3)
					{
						ref short ptr = ref mainAttributes[2];
						ptr -= concentrationCost;
						this._taiwuChar.SetCurrMainAttributes(mainAttributes, context);
					}
					short maxProgress = GlobalConfig.Instance.MaxActiveNeigongLoopingProgress;
					short oldProgress = DomainManager.Extra.GetActiveLoopingProgress();
					int newProgress = (int)(oldProgress + 1);
					bool flag4 = newProgress > (int)maxProgress;
					if (!flag4)
					{
						DomainManager.Extra.SetActiveLoopingProgress((short)newProgress, context);
						bool isTen = newProgress % 10 == 0;
						int efficiency = (int)GlobalConfig.Instance.ActiveLoopProgressAffectedEfficiency[(int)(oldProgress / 10)];
						bool flag5 = isTen;
						if (flag5)
						{
							this.ApplyNeigongLoopingImprovementOnce(context, efficiency);
						}
					}
				}
			}
		}

		// Token: 0x06001178 RID: 4472 RVA: 0x001168DC File Offset: 0x00114ADC
		public void ApplyNeigongLoopingImprovementOnce(DataContext context, int efficiency = 100)
		{
			short neili;
			short qiDisorder;
			int[] extraNeiliAllocationProgress;
			bool flag = this._taiwuChar.GenerateNeigongLoopingImprovementForTaiwu(context, out neili, out qiDisorder, out extraNeiliAllocationProgress);
			if (flag)
			{
				neili = (short)((int)neili * efficiency / 100);
				qiDisorder = (short)((int)qiDisorder * efficiency / 100);
				for (int i = 0; i < extraNeiliAllocationProgress.Length; i++)
				{
					extraNeiliAllocationProgress[i] = extraNeiliAllocationProgress[i] * efficiency / 100;
				}
				DomainManager.CombatSkill.ApplyNeigongLoopingEffect(context, this._taiwuChar, this._taiwuChar.GetLoopingNeigong(), neili, extraNeiliAllocationProgress);
				bool flag2 = qiDisorder != 0;
				if (flag2)
				{
					this._taiwuChar.ChangeDisorderOfQiRandomRecovery(context, (int)qiDisorder);
				}
				DomainManager.World.UpdateBaihuaLifeLinkNeiliType(context);
			}
		}

		// Token: 0x06001179 RID: 4473 RVA: 0x0011697C File Offset: 0x00114B7C
		[DomainMethod]
		public void GmCmd_TaiwuActiveLoopingApply(DataContext context)
		{
			this.ApplyNeigongLoopingImprovementOnce(context, 100);
		}

		// Token: 0x0600117A RID: 4474 RVA: 0x0011698C File Offset: 0x00114B8C
		public void ClearActiveNeigongLoopingProgressOnMonthChange(DataContext context)
		{
			short nowProgress = DomainManager.Extra.GetActiveLoopingProgress();
			int newProgress = (int)(nowProgress % 10);
			DomainManager.Extra.SetActiveLoopingProgress((short)newProgress, context);
		}

		// Token: 0x0600117B RID: 4475 RVA: 0x001169B8 File Offset: 0x00114BB8
		[DomainMethod]
		public ProfessionTipDisplayData GetProfessionTipDisplayData(int professionId)
		{
			TaiwuDomain.<>c__DisplayClass592_0 CS$<>8__locals1;
			CS$<>8__locals1.professionId = professionId;
			CS$<>8__locals1.<>4__this = this;
			ValueTuple<sbyte, int> valueTuple = this.<GetProfessionTipDisplayData>g__GetWorkingSkillTypeAndBonus|592_0(ref CS$<>8__locals1);
			sbyte workingSkillType = valueTuple.Item1;
			int attainmentBonus = valueTuple.Item2;
			return new ProfessionTipDisplayData
			{
				ProfessionId = CS$<>8__locals1.professionId,
				WorkingSkillType = workingSkillType,
				AttainmentBonus = attainmentBonus,
				ProfessionUpgrade = (int)DomainManager.Extra.GetProfessionUpgrade(),
				ProfessionUpgradeBonus = (int)ExtraDomain.GetWorldProfessionUpgradePercent(),
				IsWearingBonusClothing = this.<GetProfessionTipDisplayData>g__IsWearingBonusClothing|592_1(ref CS$<>8__locals1)
			};
		}

		// Token: 0x0600117C RID: 4476 RVA: 0x00116A3C File Offset: 0x00114C3C
		[DomainMethod]
		public void SetQiArtStrategy(DataContext context, int index, sbyte templateId)
		{
			bool flag = index >= (int)GlobalConfig.Instance.MaxQiArtStrategyCount;
			if (flag)
			{
				throw new ArgumentOutOfRangeException("index", index, "index should be less than MaxQiArtStrategyCount");
			}
			bool flag2 = templateId < 0;
			if (flag2)
			{
				throw new ArgumentOutOfRangeException("templateId", templateId, "templateId should be greater than or equal to 0");
			}
			QiArtStrategyItem config = QiArtStrategy.Instance[templateId];
			bool flag3 = !this.TryCost(context, config);
			if (flag3)
			{
				throw new ArgumentException("Concentration or Neili not enough", "templateId");
			}
			short loopingNeigong = this._taiwuChar.GetLoopingNeigong();
			bool flag4 = loopingNeigong < 0;
			if (flag4)
			{
				throw new Exception("should have looping neigong");
			}
			SByteList qiArtStrategyList = DomainManager.Extra.GetOrInitQiArtStrategies(context, loopingNeigong);
			while (index >= qiArtStrategyList.Items.Count)
			{
				qiArtStrategyList.Items.Add(-1);
			}
			IntList expireList = DomainManager.Extra.GetOrInitQiArtStrategyExpireTimeList(context, loopingNeigong);
			while (index >= expireList.Items.Count)
			{
				expireList.Items.Add(-1);
			}
			this.PreProcessInstantQiArtStrategy(context, config, qiArtStrategyList);
			qiArtStrategyList.Items[index] = templateId;
			expireList.Items[index] = (int)config.Duration + DomainManager.World.GetCurrDate();
			this.RemoveOtherEffectInSameGroup(qiArtStrategyList.Items, expireList.Items, index);
			this.RemoveOtherEffectByConfig(qiArtStrategyList.Items, expireList.Items, index);
			this.ProcessInstantQiArtStrategy(context, config);
			DomainManager.Extra.SetQiArtStrategies(context, loopingNeigong, qiArtStrategyList);
			DomainManager.Extra.SetQiArtStrategyExpireTimeList(context, loopingNeigong, expireList);
			short concentrationCost = config.ConcentrationCost;
			this._currentLoopingEventCostedConcentration += (int)concentrationCost;
		}

		// Token: 0x0600117D RID: 4477 RVA: 0x00116BEC File Offset: 0x00114DEC
		[DomainMethod]
		public SByteList GetLoopingNeigongQiArtStrategies(DataContext context)
		{
			short loopingNeigong = this._taiwuChar.GetLoopingNeigong();
			bool flag = loopingNeigong < 0;
			if (flag)
			{
				throw new Exception("should have looping neigong");
			}
			return DomainManager.Extra.GetOrInitQiArtStrategies(context, loopingNeigong);
		}

		// Token: 0x0600117E RID: 4478 RVA: 0x00116C2C File Offset: 0x00114E2C
		[DomainMethod]
		public List<QiArtStrategyDisplayData> GetLoopingNeigongQiArtStrategyDisplayDatas(DataContext context)
		{
			short loopingNeigong = this._taiwuChar.GetLoopingNeigong();
			bool flag = loopingNeigong < 0;
			if (flag)
			{
				throw new Exception("should have looping neigong");
			}
			SByteList qiArtStrategyList = DomainManager.Extra.GetOrInitQiArtStrategies(context, loopingNeigong);
			IntList qiArtExpireList = DomainManager.Extra.GetOrInitQiArtStrategyExpireTimeList(context, loopingNeigong);
			List<QiArtStrategyDisplayData> result = new List<QiArtStrategyDisplayData>();
			for (int i = 0; i < qiArtExpireList.Items.Count; i++)
			{
				result.Add(new QiArtStrategyDisplayData
				{
					TemplateId = qiArtStrategyList.Items[i],
					ExpireTime = qiArtExpireList.Items[i]
				});
			}
			return result;
		}

		// Token: 0x0600117F RID: 4479 RVA: 0x00116CD8 File Offset: 0x00114ED8
		[DomainMethod]
		public SByteList GetLoopingNeigongAvailableQiArtStrategies(DataContext context)
		{
			short loopingNeigong = this._taiwuChar.GetLoopingNeigong();
			bool flag = loopingNeigong < 0;
			if (flag)
			{
				throw new Exception("should have looping neigong");
			}
			return DomainManager.Extra.GetElement_AvailableQiArtStrategyMap(loopingNeigong);
		}

		// Token: 0x06001180 RID: 4480 RVA: 0x00116D18 File Offset: 0x00114F18
		private void RemoveOtherEffectInSameGroup(List<sbyte> qiArtStrategyList, List<int> expireList, int index)
		{
			QiArtStrategyItem config = QiArtStrategy.Instance[qiArtStrategyList[index]];
			short group = config.ActiveGroup;
			bool flag = group == -1;
			if (!flag)
			{
				for (int i = 0; i < qiArtStrategyList.Count; i++)
				{
					bool flag2 = i == index;
					if (!flag2)
					{
						sbyte strategy = qiArtStrategyList[i];
						bool flag3 = strategy == -1;
						if (!flag3)
						{
							QiArtStrategyItem otherConfig = QiArtStrategy.Instance[strategy];
							bool flag4 = otherConfig.ActiveGroup == group;
							if (flag4)
							{
								qiArtStrategyList[i] = -1;
								expireList[i] = -1;
							}
						}
					}
				}
			}
		}

		// Token: 0x06001181 RID: 4481 RVA: 0x00116DB8 File Offset: 0x00114FB8
		private void RemoveOtherEffectByConfig(List<sbyte> qiArtStrategyList, List<int> expireList, int index)
		{
			QiArtStrategyItem config = QiArtStrategy.Instance[qiArtStrategyList[index]];
			bool flag = !config.ClearOtherEffect;
			if (!flag)
			{
				for (int i = 0; i < qiArtStrategyList.Count; i++)
				{
					bool flag2 = i == index;
					if (!flag2)
					{
						qiArtStrategyList[i] = -1;
						expireList[i] = -1;
					}
				}
			}
		}

		// Token: 0x06001182 RID: 4482 RVA: 0x00116E1C File Offset: 0x0011501C
		private unsafe bool TryCost(DataContext context, QiArtStrategyItem config)
		{
			short concentrationCost = config.ConcentrationCost;
			bool flag = concentrationCost > 0;
			if (flag)
			{
				bool flag2 = *this._taiwuChar.GetCurrMainAttributes()[2] < concentrationCost;
				if (flag2)
				{
					return false;
				}
			}
			short neiliCost = config.NeiliCost;
			bool flag3 = neiliCost > 0;
			if (flag3)
			{
				int neili = this._taiwuChar.GetCurrNeili();
				bool flag4 = neili < (int)neiliCost;
				if (flag4)
				{
					return false;
				}
			}
			bool flag5 = concentrationCost > 0;
			if (flag5)
			{
				MainAttributes mainAttributes = this._taiwuChar.GetCurrMainAttributes();
				ref short ptr = ref mainAttributes[2];
				ptr -= concentrationCost;
				this._taiwuChar.SetCurrMainAttributes(mainAttributes, context);
			}
			bool flag6 = neiliCost > 0;
			if (flag6)
			{
				int neili2 = this._taiwuChar.GetCurrNeili();
				this._taiwuChar.SetCurrNeili(neili2 - (int)neiliCost, context);
			}
			return true;
		}

		// Token: 0x06001183 RID: 4483 RVA: 0x00116EF8 File Offset: 0x001150F8
		private void PreProcessInstantQiArtStrategy(DataContext context, QiArtStrategyItem config, SByteList qiArtStrategyList)
		{
			this.TryGainConcentrationInstantly(context, config, qiArtStrategyList);
		}

		// Token: 0x06001184 RID: 4484 RVA: 0x00116F08 File Offset: 0x00115108
		private void ProcessInstantQiArtStrategy(DataContext context, QiArtStrategyItem config)
		{
			short neili;
			short num;
			int[] extraNeiliAllocationProgress;
			bool haveLoopingNeigong = this._taiwuChar.GenerateNeigongLoopingImprovementForTaiwu(context, out neili, out num, out extraNeiliAllocationProgress);
			this.TryGainNeiliInstantly(context, config, haveLoopingNeigong, neili);
			this.TryGainFiveElementsInstantly(context, config);
			this.TryGainExtraNeiliAllocationProgressInstantly(context, config, extraNeiliAllocationProgress);
		}

		// Token: 0x06001185 RID: 4485 RVA: 0x00116F48 File Offset: 0x00115148
		private void TryGainExtraNeiliAllocationProgressInstantly(DataContext context, QiArtStrategyItem config, int[] extraNeiliAllocationProgress)
		{
			bool flag = config.MinGainNeiliAllocation > 0 && config.MaxGainNeiliAllocation > 0 && extraNeiliAllocationProgress != null;
			if (flag)
			{
				int percent = TaiwuDomain.GetRandomBetween(context.Random, (int)config.MinGainNeiliAllocation, (int)config.MaxGainNeiliAllocation);
				for (int i = 0; i < extraNeiliAllocationProgress.Length; i++)
				{
					extraNeiliAllocationProgress[i] = extraNeiliAllocationProgress[i] * percent / 100;
				}
				DomainManager.CombatSkill.ApplyLoopingExtraNeiliAllocationProgressModify(context, this._taiwuChar, extraNeiliAllocationProgress);
			}
		}

		// Token: 0x06001186 RID: 4486 RVA: 0x00116FC0 File Offset: 0x001151C0
		private void TryGainFiveElementsInstantly(DataContext context, QiArtStrategyItem config)
		{
			bool flag = config.MinGainFiveElements > 0 && config.MaxGainFiveElements > 0;
			if (flag)
			{
				int percent = TaiwuDomain.GetRandomBetween(context.Random, (int)config.MinGainFiveElements, (int)config.MaxGainFiveElements);
				ValueTuple<sbyte, sbyte, sbyte> loopingTransferNeiliProportionOfFiveElementsDataForTaiwu = DomainManager.CombatSkill.GetLoopingTransferNeiliProportionOfFiveElementsDataForTaiwu(context, this._taiwuChar);
				sbyte destinationType = loopingTransferNeiliProportionOfFiveElementsDataForTaiwu.Item1;
				sbyte transferType = loopingTransferNeiliProportionOfFiveElementsDataForTaiwu.Item2;
				sbyte amount = loopingTransferNeiliProportionOfFiveElementsDataForTaiwu.Item3;
				amount = (sbyte)((int)amount * percent / 100);
				bool flag2 = amount > 0 && destinationType != -1 && transferType != -1;
				if (flag2)
				{
					this._taiwuChar.TransferNeiliProportionOfFiveElements(context, destinationType, transferType, (int)amount);
				}
			}
		}

		// Token: 0x06001187 RID: 4487 RVA: 0x0011705C File Offset: 0x0011525C
		private void TryGainNeiliInstantly(DataContext context, QiArtStrategyItem config, bool haveLoopingNeigong, short originDeltaNeili)
		{
			bool flag = config.MinGainNeili > 0 && config.MaxGainNeili > 0;
			if (flag)
			{
				int percent = TaiwuDomain.GetRandomBetween(context.Random, (int)config.MinGainNeili, (int)config.MaxGainNeili);
				if (haveLoopingNeigong)
				{
					short deltaNeili = (short)((int)originDeltaNeili * percent / 100);
					DomainManager.CombatSkill.ApplyLoopingNeiliModifyForTaiwu(context, this._taiwuChar, deltaNeili);
				}
			}
		}

		// Token: 0x06001188 RID: 4488 RVA: 0x001170C0 File Offset: 0x001152C0
		private void TryGainConcentrationInstantly(DataContext context, QiArtStrategyItem config, SByteList qiArtStrategyList)
		{
			bool flag = config.TemplateId != 39;
			if (!flag)
			{
				int concentrationGain = 0;
				foreach (sbyte otherStrategy in qiArtStrategyList.Items)
				{
					bool flag2 = otherStrategy < 0;
					if (!flag2)
					{
						QiArtStrategyItem otherConfig = QiArtStrategy.Instance[otherStrategy];
						concentrationGain += (int)(otherConfig.ConcentrationCost / 2);
					}
				}
				this._taiwuChar.ChangeCurrMainAttribute(context, 2, concentrationGain);
			}
		}

		// Token: 0x06001189 RID: 4489 RVA: 0x0011715C File Offset: 0x0011535C
		public short GetAnchoredFiveElements()
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			if (flag)
			{
				foreach (sbyte id in qiArtStrategyList.Items)
				{
					bool flag2 = id == -1;
					if (!flag2)
					{
						QiArtStrategyItem config = QiArtStrategy.Instance[id];
						bool flag3 = config.AnchorFiveElements != -1;
						if (flag3)
						{
							return config.AnchorFiveElements;
						}
					}
				}
			}
			return -1;
		}

		// Token: 0x0600118A RID: 4490 RVA: 0x00117218 File Offset: 0x00115418
		[return: TupleElementNames(new string[]
		{
			"destinationType",
			"transferType"
		})]
		public ValueTuple<sbyte, sbyte> GetOverrideFiveElementTransferInfo()
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			if (flag)
			{
				foreach (sbyte id in qiArtStrategyList.Items)
				{
					bool flag2 = id == -1;
					if (!flag2)
					{
						QiArtStrategyItem config = QiArtStrategy.Instance[id];
						bool flag3 = config.TransferToFiveElements > -1 && config.FiveElementsTransferType > -1;
						if (flag3)
						{
							return new ValueTuple<sbyte, sbyte>(config.TransferToFiveElements, config.FiveElementsTransferType);
						}
					}
				}
			}
			return new ValueTuple<sbyte, sbyte>(-1, -1);
		}

		// Token: 0x0600118B RID: 4491 RVA: 0x001172F0 File Offset: 0x001154F0
		public int GetQiArtStrategyDeltaNeiliBonus(IRandomSource random)
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			int result;
			if (flag)
			{
				bool flag2 = qiArtStrategyList.Items.Count == 0;
				if (flag2)
				{
					result = 0;
				}
				else
				{
					int bonus = 0;
					foreach (sbyte id in qiArtStrategyList.Items)
					{
						bool flag3 = id == -1;
						if (!flag3)
						{
							QiArtStrategyItem config = QiArtStrategy.Instance[id];
							bonus += TaiwuDomain.GetRandomBetween(random, (int)config.MinExtraNeili, (int)config.MaxExtraNeili);
						}
					}
					result = bonus;
				}
			}
			else
			{
				result = 0;
			}
			return result;
		}

		// Token: 0x0600118C RID: 4492 RVA: 0x001173C8 File Offset: 0x001155C8
		[return: TupleElementNames(new string[]
		{
			"min",
			"max"
		})]
		public ValueTuple<int, int> GetQiArtStrategyDeltaNeiliBonusRange()
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			ValueTuple<int, int> result;
			if (flag)
			{
				bool flag2 = qiArtStrategyList.Items.Count == 0;
				if (flag2)
				{
					result = new ValueTuple<int, int>(0, 0);
				}
				else
				{
					int minBonus = 0;
					int maxBonus = 0;
					foreach (sbyte id in qiArtStrategyList.Items)
					{
						bool flag3 = id == -1;
						if (!flag3)
						{
							QiArtStrategyItem config = QiArtStrategy.Instance[id];
							minBonus += (int)config.MinExtraNeili;
							maxBonus += (int)config.MaxExtraNeili;
						}
					}
					result = new ValueTuple<int, int>(minBonus, maxBonus);
				}
			}
			else
			{
				result = new ValueTuple<int, int>(0, 0);
			}
			return result;
		}

		// Token: 0x0600118D RID: 4493 RVA: 0x001174B8 File Offset: 0x001156B8
		public int GetQiArtStrategyFiveElementTransferAmountBonus(IRandomSource random)
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			int result;
			if (flag)
			{
				bool flag2 = qiArtStrategyList.Items.Count == 0;
				if (flag2)
				{
					result = 0;
				}
				else
				{
					int bonus = 0;
					foreach (sbyte id in qiArtStrategyList.Items)
					{
						bool flag3 = id == -1;
						if (!flag3)
						{
							QiArtStrategyItem config = QiArtStrategy.Instance[id];
							bonus += TaiwuDomain.GetRandomBetween(random, (int)config.MinExtraFiveElements, (int)config.MaxExtraFiveElements);
						}
					}
					result = bonus;
				}
			}
			else
			{
				result = 0;
			}
			return result;
		}

		// Token: 0x0600118E RID: 4494 RVA: 0x00117590 File Offset: 0x00115790
		public int GetQiArtStrategyExtraNeiliAllocationBonus(IRandomSource random)
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			int result;
			if (flag)
			{
				bool flag2 = qiArtStrategyList.Items.Count == 0;
				if (flag2)
				{
					result = 0;
				}
				else
				{
					int bonus = 0;
					foreach (sbyte id in qiArtStrategyList.Items)
					{
						bool flag3 = id == -1;
						if (!flag3)
						{
							QiArtStrategyItem config = QiArtStrategy.Instance[id];
							bonus += TaiwuDomain.GetRandomBetween(random, (int)config.MinExtraNeiliAllocation, (int)config.MaxExtraNeiliAllocation);
						}
					}
					result = bonus;
				}
			}
			else
			{
				result = 0;
			}
			return result;
		}

		// Token: 0x0600118F RID: 4495 RVA: 0x00117668 File Offset: 0x00115868
		[return: TupleElementNames(new string[]
		{
			"min",
			"max"
		})]
		public ValueTuple<int, int> GetQiArtStrategyExtraNeiliAllocationBonusRange()
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			SByteList qiArtStrategyList;
			bool flag = DomainManager.Extra.TryGetElement_QiArtStrategyMap(loopingNeigongTemplateId, out qiArtStrategyList);
			ValueTuple<int, int> result;
			if (flag)
			{
				bool flag2 = qiArtStrategyList.Items.Count == 0;
				if (flag2)
				{
					result = new ValueTuple<int, int>(0, 0);
				}
				else
				{
					int min = 0;
					int max = 0;
					foreach (sbyte id in qiArtStrategyList.Items)
					{
						bool flag3 = id == -1;
						if (!flag3)
						{
							QiArtStrategyItem config = QiArtStrategy.Instance[id];
							min += (int)config.MinExtraNeiliAllocation;
							max += (int)config.MaxExtraNeiliAllocation;
						}
					}
					result = new ValueTuple<int, int>(min, max);
				}
			}
			else
			{
				result = new ValueTuple<int, int>(0, 0);
			}
			return result;
		}

		// Token: 0x06001190 RID: 4496 RVA: 0x00117758 File Offset: 0x00115958
		public void ClearExpiredQiArtStrategies(DataContext context)
		{
			foreach (KeyValuePair<short, SByteList> keyValuePair in DomainManager.Extra.GetQiArtStrategyMapEnumerable())
			{
				short num;
				SByteList sbyteList;
				keyValuePair.Deconstruct(out num, out sbyteList);
				short combatSkillTid = num;
				SByteList qiArtStrategyList = sbyteList;
				IntList expireList = DomainManager.Extra.GetElement_QiArtStrategyExpireTimeMap(combatSkillTid);
				int currentDate = DomainManager.World.GetCurrDate();
				for (int i = 0; i < expireList.Items.Count; i++)
				{
					sbyte id = qiArtStrategyList.Items[i];
					bool flag = id == -1;
					if (!flag)
					{
						bool flag2 = currentDate >= expireList.Items[i];
						if (flag2)
						{
							qiArtStrategyList.Items[i] = -1;
							expireList.Items[i] = -1;
						}
					}
				}
				DomainManager.Extra.SetQiArtStrategyExpireTimeList(context, combatSkillTid, expireList);
				DomainManager.Extra.SetQiArtStrategies(context, combatSkillTid, qiArtStrategyList);
			}
		}

		// Token: 0x06001191 RID: 4497 RVA: 0x00117870 File Offset: 0x00115A70
		public bool TryAddLoopingEvent(DataContext context, int basePercentProb)
		{
			int finalProb = basePercentProb;
			List<short> referenceSkills = DomainManager.Extra.GetReferenceSkillList();
			bool flag = referenceSkills != null && referenceSkills.Count > 0;
			if (flag)
			{
				foreach (short referenceSkillId in referenceSkills)
				{
					bool flag2 = referenceSkillId == -1;
					if (!flag2)
					{
						CombatSkillItem config = Config.CombatSkill.Instance[referenceSkillId];
						finalProb += (int)config.QiArtStrategyGenerateProbability;
					}
				}
			}
			bool flag3 = !context.Random.CheckPercentProb(finalProb);
			return !flag3 && this.AddLoopingEvent(context);
		}

		// Token: 0x06001192 RID: 4498 RVA: 0x0011792C File Offset: 0x00115B2C
		public bool AddLoopingEvent(DataContext context)
		{
			this._currentLoopingEventCostedConcentration = 0;
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			bool flag = loopingNeigongTemplateId < 0;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				List<short> qiArtStrategySkillIdList = DomainManager.Extra.GetLoopingEventSkillIdList();
				bool flag2 = qiArtStrategySkillIdList.Contains(loopingNeigongTemplateId);
				if (flag2)
				{
					result = false;
				}
				else
				{
					qiArtStrategySkillIdList.Add(loopingNeigongTemplateId);
					DomainManager.Extra.SetLoopingEventSkillIdList(qiArtStrategySkillIdList, context);
					this.GenerateAvailableQiArtStrategies(context, loopingNeigongTemplateId);
					result = true;
				}
			}
			return result;
		}

		// Token: 0x06001193 RID: 4499 RVA: 0x001179A4 File Offset: 0x00115BA4
		private void GenerateAvailableQiArtStrategies(DataContext context, short loopingNeigongTemplateId)
		{
			QiArtStrategy qiArtConfig = QiArtStrategy.Instance;
			List<List<sbyte>> groupedResult = new List<List<sbyte>>();
			for (int i = 0; i < 2; i++)
			{
				groupedResult.Add(new List<sbyte>());
			}
			sbyte loopingNeigongProvidedStrategy = this.DrawOneByNeigong(loopingNeigongTemplateId, context.Random);
			bool flag = loopingNeigongProvidedStrategy != -1;
			if (flag)
			{
				groupedResult[(int)(qiArtConfig[loopingNeigongProvidedStrategy].ExtractGroup - 1)].Add(loopingNeigongProvidedStrategy);
			}
			List<short> referenceSkillList = DomainManager.Extra.GetReferenceSkillList();
			bool flag2 = referenceSkillList != null && referenceSkillList.Count > 0;
			if (flag2)
			{
				foreach (short refSkill in referenceSkillList)
				{
					bool flag3 = refSkill == -1;
					if (!flag3)
					{
						sbyte refSkillProvidedStrategy = this.DrawOneByNeigong(refSkill, context.Random);
						bool flag4 = refSkillProvidedStrategy == -1;
						if (!flag4)
						{
							List<sbyte> targetResultGroup = groupedResult[(int)(qiArtConfig[refSkillProvidedStrategy].ExtractGroup - 1)];
							bool flag5 = targetResultGroup.Count < 3;
							if (flag5)
							{
								targetResultGroup.Add(refSkillProvidedStrategy);
							}
						}
					}
				}
			}
			List<sbyte> validConfigGroup = new List<sbyte>();
			List<short> weightList = new List<short>();
			for (int j = 0; j < 2; j++)
			{
				validConfigGroup.Clear();
				weightList.Clear();
				foreach (QiArtStrategyItem config in ((IEnumerable<QiArtStrategyItem>)qiArtConfig))
				{
					sbyte id = config.TemplateId;
					bool flag6 = (int)(config.ExtractGroup - 1) == j && this.CanDrawStrategy(id, -1);
					if (flag6)
					{
						validConfigGroup.Add(id);
						weightList.Add(config.ExtractWeight);
					}
				}
				while (groupedResult[j].Count < 3)
				{
					int randIndex = RandomUtils.GetRandomIndex(weightList, context.Random);
					sbyte drawnConfigIndex = validConfigGroup[randIndex];
					groupedResult[j].Add(drawnConfigIndex);
				}
			}
			List<sbyte> result = new List<sbyte>();
			foreach (List<sbyte> group in groupedResult)
			{
				result.AddRange(group);
			}
			bool isEquipedTargetSkill = DomainManager.Extra.IsProfessionalSkillUnlocked(3, 1);
			bool flag7 = isEquipedTargetSkill;
			if (flag7)
			{
				int seniority = DomainManager.Extra.GetProfessionData(3).Seniority;
				int extraCount = ProfessionData.SeniorityToExtraReadingLoopingStrategyCount(seniority);
				for (int k = 0; k < extraCount; k++)
				{
					int strategyTid = context.Random.Next(QiArtStrategy.Instance.Count);
					result.Add((sbyte)strategyTid);
				}
			}
			DomainManager.Extra.SetAvailableQiArtStrategiesForNeigong(context, loopingNeigongTemplateId, new SByteList(result));
		}

		// Token: 0x06001194 RID: 4500 RVA: 0x00117CA4 File Offset: 0x00115EA4
		private sbyte DrawOneByNeigong(short sourceNeigongTemplateId, IRandomSource randomSource)
		{
			CombatSkillItem skillConfig = Config.CombatSkill.Instance[sourceNeigongTemplateId];
			List<sbyte> configPossibleStrategies = skillConfig.PossibleQiArtStrategyList;
			List<sbyte> possibleStrategies = new List<sbyte>();
			List<short> weights = new List<short>();
			foreach (sbyte s in configPossibleStrategies)
			{
				bool flag = this.CanDrawStrategy(s, sourceNeigongTemplateId);
				if (flag)
				{
					possibleStrategies.Add(s);
					weights.Add(QiArtStrategy.Instance[s].ExtractWeight);
				}
			}
			bool flag2 = weights.Count == 0;
			sbyte result;
			if (flag2)
			{
				result = -1;
			}
			else
			{
				int index = RandomUtils.GetRandomIndex(weights, randomSource);
				result = possibleStrategies[index];
			}
			return result;
		}

		// Token: 0x06001195 RID: 4501 RVA: 0x00117D70 File Offset: 0x00115F70
		private bool CanDrawStrategy(sbyte qiArtStrategyTemplateId, short sourceNeigongTemplateId)
		{
			QiArtStrategyItem config = QiArtStrategy.Instance[qiArtStrategyTemplateId];
			bool flag = TaiwuDomain.UseDrawConditionCanObtainNeiliIdList.Contains(qiArtStrategyTemplateId);
			bool result;
			if (flag)
			{
				result = this.DrawConditionCanObtainNeili();
			}
			else
			{
				bool flag2 = TaiwuDomain.UseDrawConditionNeiliAllocationLessThanIdList.Contains(qiArtStrategyTemplateId);
				if (flag2)
				{
					result = this.DrawConditionCanObtainNeiliAllocation();
				}
				else
				{
					bool flag3 = qiArtStrategyTemplateId >= 18 && qiArtStrategyTemplateId <= 23;
					if (flag3)
					{
						result = this.DrawConditionIsReferenceSkill(sourceNeigongTemplateId);
					}
					else
					{
						bool flag4 = qiArtStrategyTemplateId >= 24 && qiArtStrategyTemplateId <= 38;
						result = (!flag4 || this.DrawConditionIsDifferenceFiveElementTransfer(config));
					}
				}
			}
			return result;
		}

		// Token: 0x06001196 RID: 4502 RVA: 0x00117E00 File Offset: 0x00116000
		private bool DrawConditionIsDifferenceFiveElementTransfer(QiArtStrategyItem config)
		{
			sbyte transferTo = config.TransferToFiveElements;
			sbyte transferType = config.FiveElementsTransferType;
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			CombatSkillItem skillConfig = Config.CombatSkill.Instance[loopingNeigongTemplateId];
			sbyte skillTransferTo = skillConfig.DestTypeWhileLooping;
			sbyte skillTransferType = skillConfig.TransferTypeWhileLooping;
			return skillTransferTo != transferTo || transferType != skillTransferType;
		}

		// Token: 0x06001197 RID: 4503 RVA: 0x00117E64 File Offset: 0x00116064
		private bool DrawConditionIsReferenceSkill(short sourceNeigongTemplateId)
		{
			List<short> referenceSkillList = DomainManager.Extra.GetReferenceSkillList();
			bool flag = referenceSkillList == null;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				bool flag2 = referenceSkillList.Count == 0;
				result = (!flag2 && referenceSkillList.Contains(sourceNeigongTemplateId));
			}
			return result;
		}

		// Token: 0x06001198 RID: 4504 RVA: 0x00117EA8 File Offset: 0x001160A8
		private bool DrawConditionCanObtainNeiliAllocation()
		{
			int maxProgress = CombatSkillDomain.GetNeiliAllocationMaxProgress();
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			IntList currentProgress;
			bool flag = !DomainManager.Extra.TryGetExtraNeiliAllocationProgress(taiwuChar.GetId(), out currentProgress);
			bool result;
			if (flag)
			{
				result = true;
			}
			else
			{
				for (int i = 0; i < 4; i++)
				{
					bool flag2 = currentProgress.Items[i] < maxProgress;
					if (flag2)
					{
						return true;
					}
				}
				result = false;
			}
			return result;
		}

		// Token: 0x06001199 RID: 4505 RVA: 0x00117F20 File Offset: 0x00116120
		private bool DrawConditionCanObtainNeili()
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			CombatSkillKey skillKey = new CombatSkillKey(taiwuChar.GetId(), loopingNeigongTemplateId);
			GameData.Domains.CombatSkill.CombatSkill skill = DomainManager.CombatSkill.GetElement_CombatSkills(skillKey);
			short totalNeili = skill.GetTotalObtainableNeili();
			short currentNeili = skill.GetObtainedNeili();
			return currentNeili < totalNeili;
		}

		// Token: 0x0600119A RID: 4506 RVA: 0x00117F78 File Offset: 0x00116178
		[DomainMethod]
		public void ClearCurrentLoopingNeigongEvent(DataContext context)
		{
			GameData.Domains.Character.Character taiwuChar = DomainManager.Taiwu.GetTaiwu();
			short loopingNeigongTemplateId = taiwuChar.GetLoopingNeigong();
			bool flag = this._currentLoopingEventCostedConcentration > 0;
			if (flag)
			{
				sbyte grade = Config.CombatSkill.Instance[loopingNeigongTemplateId].Grade;
				int addSeniority = ProfessionFormulaImpl.Calculate(28, this._currentLoopingEventCostedConcentration, (int)grade);
				DomainManager.Extra.ChangeProfessionSeniority(context, 3, addSeniority, true, false);
			}
			this._currentLoopingEventCostedConcentration = 0;
			List<short> qiArtStrategySkillIdList = DomainManager.Extra.GetLoopingEventSkillIdList();
			bool flag2 = !qiArtStrategySkillIdList.Contains(loopingNeigongTemplateId);
			if (!flag2)
			{
				qiArtStrategySkillIdList.Remove(loopingNeigongTemplateId);
				DomainManager.Extra.SetLoopingEventSkillIdList(qiArtStrategySkillIdList, context);
			}
		}

		// Token: 0x0600119B RID: 4507 RVA: 0x00118014 File Offset: 0x00116214
		private static int GetRandomBetween(IRandomSource random, int a, int b)
		{
			bool flag = a.Equals(b);
			int result;
			if (flag)
			{
				result = a;
			}
			else
			{
				result = random.Next(a, b);
			}
			return result;
		}

		// Token: 0x17000028 RID: 40
		// (get) Token: 0x0600119C RID: 4508 RVA: 0x00118040 File Offset: 0x00116240
		// (set) Token: 0x0600119D RID: 4509 RVA: 0x00118048 File Offset: 0x00116248
		public int CurrentReadingEventCostedIntelligence
		{
			get
			{
				return this._currentReadingEventCostedIntelligence;
			}
			set
			{
				this._currentReadingEventCostedIntelligence = value;
			}
		}

		// Token: 0x0600119E RID: 4510 RVA: 0x00118054 File Offset: 0x00116254
		[DomainMethod]
		public void SetReferenceBook(DataContext context, sbyte index, ItemKey bookItemKey)
		{
			bool flag = bookItemKey.IsValid();
			if (flag)
			{
				bool flag2 = !this.IsReferenceBookSlotUnlocked((int)index);
				if (flag2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(30, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Reference book slot ");
					defaultInterpolatedStringHandler.AppendFormatted<sbyte>(index);
					defaultInterpolatedStringHandler.AppendLiteral(" is locked");
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool flag3 = this._curReadingBook.Id == bookItemKey.Id;
				if (flag3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(36, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Book with Id ");
					defaultInterpolatedStringHandler.AppendFormatted<int>(bookItemKey.Id);
					defaultInterpolatedStringHandler.AppendLiteral(" is already being read.");
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				for (int i = 0; i < this._referenceBooks.Length; i++)
				{
					bool flag4 = i == (int)index || bookItemKey.Id != this._referenceBooks[i].Id;
					if (!flag4)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(58, 2);
						defaultInterpolatedStringHandler.AppendLiteral("Book with templateId ");
						defaultInterpolatedStringHandler.AppendFormatted<int>(bookItemKey.Id);
						defaultInterpolatedStringHandler.AppendLiteral(" is already being referenced at slot ");
						defaultInterpolatedStringHandler.AppendFormatted<int>(i);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
				}
			}
			this._referenceBooks[(int)index] = bookItemKey;
			this.SetReferenceBooks(this._referenceBooks, context);
		}

		// Token: 0x0600119F RID: 4511 RVA: 0x001181C4 File Offset: 0x001163C4
		[DomainMethod]
		public void SetReadingBook(DataContext context, ItemKey bookItemKey)
		{
			bool flag = bookItemKey.IsValid();
			if (flag)
			{
				for (int i = 0; i < this._referenceBooks.Length; i++)
				{
					bool flag2 = bookItemKey.Id != this._referenceBooks[i].Id;
					if (!flag2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(58, 2);
						defaultInterpolatedStringHandler.AppendLiteral("Book with templateId ");
						defaultInterpolatedStringHandler.AppendFormatted<short>(bookItemKey.TemplateId);
						defaultInterpolatedStringHandler.AppendLiteral(" is already being referenced at slot ");
						defaultInterpolatedStringHandler.AppendFormatted<int>(i);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
				}
				bool flag3 = !this._readingBooks.ContainsKey(bookItemKey);
				if (flag3)
				{
					ReadingBookStrategies readingBookStrats = default(ReadingBookStrategies);
					readingBookStrats.Initialize();
					this.AddElement_ReadingBooks(bookItemKey, ref readingBookStrats, context);
				}
			}
			else
			{
				bool changed = false;
				for (int j = 0; j < this._referenceBooks.Length; j++)
				{
					bool flag4 = !this._referenceBooks[j].IsValid();
					if (!flag4)
					{
						this._referenceBooks[j] = ItemKey.Invalid;
						changed = true;
					}
				}
				bool flag5 = changed;
				if (flag5)
				{
					this.SetReferenceBooks(this._referenceBooks, context);
				}
			}
			this.SetCurReadingBook(bookItemKey, context);
		}

		// Token: 0x060011A0 RID: 4512 RVA: 0x00118310 File Offset: 0x00116510
		[DomainMethod]
		public ReadingBookStrategies GetCurReadingStrategies()
		{
			ReadingBookStrategies strategies;
			bool flag = !this._readingBooks.TryGetValue(this._curReadingBook, out strategies);
			if (flag)
			{
				strategies.Initialize();
			}
			return strategies;
		}

		// Token: 0x060011A1 RID: 4513 RVA: 0x00118348 File Offset: 0x00116548
		[DomainMethod]
		public unsafe void SetReadingStrategy(DataContext context, byte pageIndex, int strategyIndex, sbyte strategyId)
		{
			bool flag = !this._curReadingBook.IsValid();
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(30, 1);
				defaultInterpolatedStringHandler.AppendLiteral("CurrentReadingBook is invalid ");
				defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(this._curReadingBook);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
			short bookSubType = ItemTemplateHelper.GetItemSubType(this._curReadingBook.ItemType, this._curReadingBook.TemplateId);
			int pageCount = (bookSubType == 1001) ? 6 : 5;
			bool flag2 = (int)pageIndex >= pageCount;
			if (flag2)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("the given page index ");
				defaultInterpolatedStringHandler.AppendFormatted<byte>(pageIndex);
				defaultInterpolatedStringHandler.AppendLiteral(" is illegal.");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			bool flag3 = strategyIndex < 0 || strategyIndex >= 3;
			if (flag3)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("The given strategy slot index ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(strategyIndex);
				defaultInterpolatedStringHandler.AppendLiteral(" is illegal.");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			ReadingStrategyItem strategyCfg = ReadingStrategy.Instance[strategyId];
			ReadingBookStrategies strategies;
			bool flag4 = !this._readingBooks.TryGetValue(this._curReadingBook, out strategies);
			if (flag4)
			{
				strategies.Initialize();
				this.AddElement_ReadingBooks(this._curReadingBook, ref strategies, context);
			}
			MainAttributes mainAttributes = this._taiwuChar.GetCurrMainAttributes();
			int buildingEffectFactor = DomainManager.Building.GetSutraReadingRoomBuffValue();
			int intCost = (int)strategyCfg.IntelligenceCost * buildingEffectFactor / 100 + (int)strategies.GetPageIntCostChange(pageIndex);
			short curInt = *(ref mainAttributes.Items.FixedElementField + (IntPtr)5 * 2);
			bool flag5 = intCost > (int)curInt;
			if (flag5)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(60, 2);
				defaultInterpolatedStringHandler.AppendLiteral("You don't have enough intelligence: ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(intCost);
				defaultInterpolatedStringHandler.AppendLiteral(" needed, current int is ");
				defaultInterpolatedStringHandler.AppendFormatted<short>(curInt);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			bool flag6 = intCost > 0;
			if (flag6)
			{
				this._taiwuChar.ChangeCurrMainAttribute(context, 5, -intCost);
			}
			bool flag7 = strategyCfg.DurabilityCost > 0;
			if (flag7)
			{
				book.SetCurrDurability(book.GetCurrDurability() - strategyCfg.DurabilityCost, context);
			}
			bool flag8 = book.IsCombatSkillBook();
			if (flag8)
			{
				this.ApplyImmediateReadingStrategyEffectForCombatSkill(context, book, pageIndex, ref strategies, strategyId);
			}
			else
			{
				this.ApplyImmediateReadingStrategyEffectForLifeSkill(context, book, pageIndex, ref strategies, strategyId);
			}
			bool clearPageStrategies = strategyCfg.ClearPageStrategies;
			if (clearPageStrategies)
			{
				strategies.ClearPageStrategies(pageIndex);
				DomainManager.Extra.ClearReadingStrategiesExpireTimeForPage(context, this._curReadingBook, pageIndex);
			}
			sbyte efficiencyBonus = (sbyte)((strategyCfg.MaxCurrPageEfficiencyChange > strategyCfg.MinCurrPageEfficiencyChange) ? context.Random.Next((int)strategyCfg.MinCurrPageEfficiencyChange, (int)(strategyCfg.MaxCurrPageEfficiencyChange + 1)) : ((int)strategyCfg.MaxCurrPageEfficiencyChange));
			strategies.SetPageStrategy(pageIndex, strategyIndex, strategyId, efficiencyBonus);
			this.SetElement_ReadingBooks(this._curReadingBook, ref strategies, context);
			DomainManager.Extra.SetReadingStrategiesExpireTime(context, this._curReadingBook, pageIndex, strategyIndex, strategyId);
			bool flag9 = book.GetCurrDurability() <= 0;
			if (flag9)
			{
				this._taiwuChar.RemoveInventoryItem(context, this._curReadingBook, 1, true, false);
				this.SetReadingBook(context, ItemKey.Invalid);
			}
			this._currentReadingEventCostedIntelligence += intCost;
		}

		// Token: 0x060011A2 RID: 4514 RVA: 0x0011868C File Offset: 0x0011688C
		private sbyte GetStrategyProgressAddValue(IRandomSource random, ReadingStrategyItem strategyCfg)
		{
			return (sbyte)((strategyCfg.MaxProgressAddValue > strategyCfg.MinProgressAddValue) ? random.Next((int)strategyCfg.MinProgressAddValue, (int)(strategyCfg.MaxProgressAddValue + 1)) : ((int)strategyCfg.MaxProgressAddValue));
		}

		// Token: 0x060011A3 RID: 4515 RVA: 0x001186CC File Offset: 0x001168CC
		private void ApplyImmediateReadingStrategyEffectForCombatSkill(DataContext context, GameData.Domains.Item.SkillBook book, byte pageIndex, ref ReadingBookStrategies strategies, sbyte strategyId)
		{
			short skillTemplateId = book.GetCombatSkillTemplateId();
			TaiwuCombatSkill taiwuCombatSkill = this.GetTaiwuCombatSkill(skillTemplateId);
			byte pageTypes = book.GetPageTypes();
			sbyte outlinePageType = SkillBookStateHelper.GetOutlinePageType(pageTypes);
			byte pageInternalIndex = CombatSkillStateHelper.GetPageInternalIndex(outlinePageType, SkillBookStateHelper.GetNormalPageType(pageTypes, pageIndex), pageIndex);
			ReadingStrategyItem strategyCfg = ReadingStrategy.Instance[strategyId];
			ushort incompleteState = book.GetPageIncompleteState();
			bool flag = strategyCfg.MaxProgressAddValue != 0;
			if (flag)
			{
				sbyte currPageAddValue = this.GetStrategyProgressAddValue(context.Random, strategyCfg);
				bool readingFinished = this.OfflineAddReadingProgress(taiwuCombatSkill, pageInternalIndex, (int)currPageAddValue);
				this.SetTaiwuCombatSkill(context, skillTemplateId, taiwuCombatSkill);
				bool flag2 = readingFinished;
				if (flag2)
				{
					this.SetCombatSkillPageComplete(context, book, pageInternalIndex);
				}
			}
			this.ApplyNextPageProgressAddValueEffectForCombatSkill(context, book, pageIndex, strategyCfg, taiwuCombatSkill, pageInternalIndex);
			bool flag3 = strategyId == 4;
			if (flag3)
			{
				this.ApplyDoubleCurrentPageStrategyAddValues(context, book, taiwuCombatSkill, ref strategies, pageIndex, pageInternalIndex);
			}
			bool flag4 = strategyId == 5;
			if (flag4)
			{
				this.ApplyDoubleCurrentPageStrategyEfficiencyChange(context, book.GetItemKey(), ref strategies, pageIndex);
			}
			bool flag5 = strategyId == 14;
			if (flag5)
			{
				this.ApplyIntGainAccordingToStrategies(context, strategies, pageIndex);
			}
		}

		// Token: 0x060011A4 RID: 4516 RVA: 0x001187CC File Offset: 0x001169CC
		private void ApplyNextPageProgressAddValueEffectForCombatSkill(DataContext context, GameData.Domains.Item.SkillBook book, byte pageIndex, ReadingStrategyItem strategyCfg, TaiwuCombatSkill taiwuCombatSkill, byte pageInternalIndex)
		{
			byte pageTypes = book.GetPageTypes();
			ushort incompleteState = book.GetPageIncompleteState();
			short skillTemplateId = book.GetCombatSkillTemplateId();
			bool flag = strategyCfg.NextPageProgressAddValue != 0 && taiwuCombatSkill.GetBookPageReadingProgress(pageInternalIndex) == 100;
			if (flag)
			{
				for (byte index = pageIndex + 1; index < 6; index += 1)
				{
					sbyte normalPageType = SkillBookStateHelper.GetNormalPageType(pageTypes, index);
					byte internalIndex = CombatSkillStateHelper.GetNormalPageInternalIndex(normalPageType, index);
					int state = DomainManager.Item.GetPageIncompleteState(incompleteState, index, this._referenceBooks, this._curReadingBook);
					bool flag2 = taiwuCombatSkill.GetBookPageReadingProgress(internalIndex) < 100 && state != 2;
					if (flag2)
					{
						bool readingFinished = this.OfflineAddReadingProgress(taiwuCombatSkill, internalIndex, (int)strategyCfg.NextPageProgressAddValue);
						this.SetTaiwuCombatSkill(context, skillTemplateId, taiwuCombatSkill);
						bool flag3 = readingFinished;
						if (flag3)
						{
							this.SetCombatSkillPageComplete(context, book, internalIndex);
						}
						break;
					}
				}
			}
		}

		// Token: 0x060011A5 RID: 4517 RVA: 0x001188B8 File Offset: 0x00116AB8
		private void ApplyImmediateReadingStrategyEffectForLifeSkill(DataContext context, GameData.Domains.Item.SkillBook book, byte pageIndex, ref ReadingBookStrategies strategies, sbyte strategyId)
		{
			short skillTemplateId = book.GetLifeSkillTemplateId();
			TaiwuLifeSkill taiwuLifeSkill = this.GetTaiwuLifeSkill(skillTemplateId);
			ReadingStrategyItem strategyCfg = ReadingStrategy.Instance[strategyId];
			ushort incompleteState = book.GetPageIncompleteState();
			bool flag = strategyCfg.MaxProgressAddValue != 0;
			if (flag)
			{
				sbyte currPageAddValue = (sbyte)((strategyCfg.MaxProgressAddValue > strategyCfg.MinProgressAddValue) ? context.Random.Next((int)strategyCfg.MinProgressAddValue, (int)(strategyCfg.MaxProgressAddValue + 1)) : ((int)strategyCfg.MaxProgressAddValue));
				bool readingFinished = this.OfflineAddReadingProgress(taiwuLifeSkill, pageIndex, (int)currPageAddValue);
				this.SetTaiwuLifeSkill(context, skillTemplateId, taiwuLifeSkill);
				bool flag2 = readingFinished;
				if (flag2)
				{
					this.SetLifeSkillPageComplete(context, book, pageIndex);
				}
			}
			this.ApplyNextPageProgressAddValueEffectForLifeSkill(context, book, pageIndex, strategyCfg, taiwuLifeSkill);
			bool flag3 = strategyId == 4;
			if (flag3)
			{
				this.ApplyDoubleCurrentPageStrategyAddValues(context, book, taiwuLifeSkill, ref strategies, pageIndex);
			}
			bool flag4 = strategyId == 5;
			if (flag4)
			{
				this.ApplyDoubleCurrentPageStrategyEfficiencyChange(context, book.GetItemKey(), ref strategies, pageIndex);
			}
			bool flag5 = strategyId == 14;
			if (flag5)
			{
				this.ApplyIntGainAccordingToStrategies(context, strategies, pageIndex);
			}
		}

		// Token: 0x060011A6 RID: 4518 RVA: 0x001189B0 File Offset: 0x00116BB0
		private void ApplyNextPageProgressAddValueEffectForLifeSkill(DataContext context, GameData.Domains.Item.SkillBook book, byte startPageIndex, ReadingStrategyItem strategyCfg, TaiwuLifeSkill taiwuLifeSkill)
		{
			bool flag = strategyCfg.NextPageProgressAddValue != 0 && taiwuLifeSkill.GetBookPageReadingProgress(startPageIndex) == 100;
			if (flag)
			{
				ushort incompleteState = book.GetPageIncompleteState();
				short skillTemplateId = book.GetLifeSkillTemplateId();
				for (byte index = startPageIndex + 1; index < 5; index += 1)
				{
					int state = DomainManager.Item.GetPageIncompleteState(incompleteState, index, this._referenceBooks, this._curReadingBook);
					bool flag2 = taiwuLifeSkill.GetBookPageReadingProgress(index) < 100 && state != 2;
					if (flag2)
					{
						bool readingFinished = this.OfflineAddReadingProgress(taiwuLifeSkill, index, (int)strategyCfg.NextPageProgressAddValue);
						this.SetTaiwuLifeSkill(context, skillTemplateId, taiwuLifeSkill);
						bool flag3 = readingFinished;
						if (flag3)
						{
							this.SetLifeSkillPageComplete(context, book, index);
						}
						break;
					}
				}
			}
		}

		// Token: 0x060011A7 RID: 4519 RVA: 0x00118A70 File Offset: 0x00116C70
		private void ApplyDoubleCurrentPageStrategyAddValues(DataContext context, GameData.Domains.Item.SkillBook book, TaiwuCombatSkill taiwuCombatSkill, ref ReadingBookStrategies strategies, byte pageIndex, byte pageInternalIndex)
		{
			bool readingFinished = false;
			int i = 0;
			while (i < 3 && !readingFinished)
			{
				sbyte currStrategyId = strategies.GetPageStrategy(pageIndex, i);
				bool flag = currStrategyId < 0;
				if (!flag)
				{
					ReadingStrategyItem currStrategyCfg = ReadingStrategy.Instance[currStrategyId];
					bool flag2 = currStrategyCfg.MaxProgressAddValue != 0;
					if (flag2)
					{
						sbyte currPageAddValue = this.GetStrategyProgressAddValue(context.Random, currStrategyCfg);
						readingFinished = this.OfflineAddReadingProgress(taiwuCombatSkill, pageInternalIndex, (int)currPageAddValue);
					}
					bool flag3 = currStrategyCfg.NextPageProgressAddValue != 0;
					if (flag3)
					{
						this.ApplyNextPageProgressAddValueEffectForCombatSkill(context, book, pageIndex, currStrategyCfg, taiwuCombatSkill, pageInternalIndex);
					}
				}
				i++;
			}
			this.SetTaiwuCombatSkill(context, book.GetCombatSkillTemplateId(), taiwuCombatSkill);
			bool flag4 = readingFinished;
			if (flag4)
			{
				this.SetCombatSkillPageComplete(context, book, pageInternalIndex);
			}
		}

		// Token: 0x060011A8 RID: 4520 RVA: 0x00118B30 File Offset: 0x00116D30
		private void ApplyDoubleCurrentPageStrategyAddValues(DataContext context, GameData.Domains.Item.SkillBook book, TaiwuLifeSkill taiwuLifeSkill, ref ReadingBookStrategies strategies, byte pageIndex)
		{
			bool readingFinished = false;
			int i = 0;
			while (i < 3 && !readingFinished)
			{
				sbyte currStrategyId = strategies.GetPageStrategy(pageIndex, i);
				bool flag = currStrategyId < 0;
				if (!flag)
				{
					ReadingStrategyItem currStrategyCfg = ReadingStrategy.Instance[currStrategyId];
					bool flag2 = currStrategyCfg.MaxProgressAddValue != 0;
					if (flag2)
					{
						sbyte currPageAddValue = this.GetStrategyProgressAddValue(context.Random, currStrategyCfg);
						readingFinished = this.OfflineAddReadingProgress(taiwuLifeSkill, pageIndex, (int)currPageAddValue);
					}
					bool flag3 = currStrategyCfg.NextPageProgressAddValue != 0;
					if (flag3)
					{
						this.ApplyNextPageProgressAddValueEffectForLifeSkill(context, book, pageIndex, currStrategyCfg, taiwuLifeSkill);
					}
				}
				i++;
			}
			this.SetTaiwuLifeSkill(context, book.GetLifeSkillTemplateId(), taiwuLifeSkill);
			bool flag4 = readingFinished;
			if (flag4)
			{
				this.SetLifeSkillPageComplete(context, book, pageIndex);
			}
		}

		// Token: 0x060011A9 RID: 4521 RVA: 0x00118BEC File Offset: 0x00116DEC
		private unsafe void ApplyDoubleCurrentPageStrategyEfficiencyChange(DataContext context, ItemKey bookItemKey, ref ReadingBookStrategies strategies, byte pageIndex)
		{
			for (int i = 0; i < 3; i++)
			{
				int value = (int)(*(ref strategies.Bonus.FixedElementField + ((int)(pageIndex * 3) + i)) * 2);
				*(ref strategies.Bonus.FixedElementField + ((int)(pageIndex * 3) + i)) = (sbyte)Math.Clamp(value, 0, 100);
			}
			this.SetElement_ReadingBooks(bookItemKey, ref strategies, context);
		}

		// Token: 0x060011AA RID: 4522 RVA: 0x00118C4C File Offset: 0x00116E4C
		private void ApplyIntGainAccordingToStrategies(DataContext context, ReadingBookStrategies strategies, byte pageIndex)
		{
			int intGain = 0;
			for (int i = 0; i < 3; i++)
			{
				sbyte currStrategyId = strategies.GetPageStrategy(pageIndex, i);
				bool flag = currStrategyId < 0;
				if (!flag)
				{
					ReadingStrategyItem currStrategyCfg = ReadingStrategy.Instance[currStrategyId];
					bool flag2 = currStrategyCfg.IntelligenceCost > 0;
					if (flag2)
					{
						intGain += (int)(currStrategyCfg.IntelligenceCost / 2);
					}
				}
			}
			this._taiwuChar.ChangeCurrMainAttribute(context, 5, intGain);
		}

		// Token: 0x060011AB RID: 4523 RVA: 0x00118CBC File Offset: 0x00116EBC
		[DomainMethod]
		public void ClearPageStrategy(DataContext context, byte pageIndex)
		{
			bool flag = !this._curReadingBook.IsValid();
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(30, 1);
				defaultInterpolatedStringHandler.AppendLiteral("CurrentReadingBook is invalid ");
				defaultInterpolatedStringHandler.AppendFormatted<ItemKey>(this._curReadingBook);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			short bookSubType = ItemTemplateHelper.GetItemSubType(this._curReadingBook.ItemType, this._curReadingBook.TemplateId);
			int pageCount = (bookSubType == 1001) ? 6 : 5;
			bool flag2 = pageIndex < 0 || (int)pageIndex >= pageCount;
			if (flag2)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("the given page index ");
				defaultInterpolatedStringHandler.AppendFormatted<byte>(pageIndex);
				defaultInterpolatedStringHandler.AppendLiteral(" is illegal.");
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			ReadingBookStrategies strategies = this._readingBooks[this._curReadingBook];
			strategies.ClearPageStrategies(pageIndex);
			this.SetElement_ReadingBooks(this._curReadingBook, ref strategies, context);
			DomainManager.Extra.ClearReadingStrategiesExpireTimeForPage(context, this._curReadingBook, pageIndex);
		}

		// Token: 0x060011AC RID: 4524 RVA: 0x00118DC4 File Offset: 0x00116FC4
		[DomainMethod]
		[Obsolete]
		public List<byte> GetRandomSelectableStrategies(DataContext context, byte pageIndex)
		{
			return null;
		}

		// Token: 0x060011AD RID: 4525 RVA: 0x00118DD8 File Offset: 0x00116FD8
		public bool IsCombatSkillBookPageRead(GameData.Domains.Item.SkillBook book, byte curReadingPage)
		{
			short skillTemplateId = book.GetCombatSkillTemplateId();
			byte pageTypes = book.GetPageTypes();
			sbyte behaviorType = SkillBookStateHelper.GetOutlinePageType(pageTypes);
			byte readingInternalIndex = CombatSkillStateHelper.GetPageInternalIndex(behaviorType, SkillBookStateHelper.GetNormalPageType(pageTypes, curReadingPage), curReadingPage);
			bool flag = !this._taiwuChar.GetLearnedCombatSkills().Contains(skillTemplateId);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				GameData.Domains.CombatSkill.CombatSkill skillItem = DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillTemplateId));
				ushort readingState = skillItem.GetReadingState();
				result = CombatSkillStateHelper.IsPageRead(readingState, readingInternalIndex);
			}
			return result;
		}

		// Token: 0x060011AE RID: 4526 RVA: 0x00118E58 File Offset: 0x00117058
		public bool IsLifeSkillBookPageRead(GameData.Domains.Item.SkillBook book, byte curReadingPage)
		{
			short skillTemplateId = book.GetLifeSkillTemplateId();
			List<GameData.Domains.Character.LifeSkillItem> learnedLifeSkills = this._taiwuChar.GetLearnedLifeSkills();
			int learnedIndex = this._taiwuChar.FindLearnedLifeSkillIndex(skillTemplateId);
			bool flag = learnedIndex < 0;
			return !flag && learnedLifeSkills[learnedIndex].IsPageRead(curReadingPage);
		}

		// Token: 0x060011AF RID: 4527 RVA: 0x00118EAC File Offset: 0x001170AC
		public sbyte GetBaseReadingSpeed(byte curReadingPage)
		{
			GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
			int incompleteState = DomainManager.Item.GetPageIncompleteState(book.GetPageIncompleteState(), curReadingPage, this._referenceBooks, this._curReadingBook);
			return SkillBookPageIncompleteState.BaseReadingSpeed[incompleteState];
		}

		// Token: 0x060011B0 RID: 4528 RVA: 0x00118EFC File Offset: 0x001170FC
		public int GetReadingSpeedBonus(byte curReadingPage, bool isInBattle = false, int tempPageReadStatus = 0, short skillAttainment = 0)
		{
			bool flag = !this._curReadingBook.IsValid();
			int result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				ReadingBookStrategies strategies;
				bool flag2 = !this._readingBooks.TryGetValue(this._curReadingBook, out strategies);
				if (flag2)
				{
					strategies.Initialize();
				}
				int notReadPrePageCount = 0;
				int featBonusSpeed = 0;
				int sectApprovalFactor = 0;
				int buildingBonusSpeed = 0;
				bool flag3 = SkillGroup.FromItemSubType(book.GetItemSubType()) == 0;
				int strategyBonus;
				if (flag3)
				{
					short skillTemplateId = book.GetLifeSkillTemplateId();
					sbyte lifeSkillType = book.GetLifeSkillType();
					List<GameData.Domains.Character.LifeSkillItem> learnedLifeSkills = this._taiwuChar.GetLearnedLifeSkills();
					int learnedIndex = this._taiwuChar.FindLearnedLifeSkillIndex(skillTemplateId);
					bool flag4 = learnedIndex >= 0;
					if (flag4)
					{
						GameData.Domains.Character.LifeSkillItem skillItem = learnedLifeSkills[learnedIndex];
						for (byte i = 0; i < curReadingPage; i += 1)
						{
							bool flag5 = !skillItem.IsPageRead(i) && (tempPageReadStatus & 1 << (int)i) == 0;
							if (flag5)
							{
								notReadPrePageCount++;
							}
						}
					}
					else
					{
						for (byte j = 0; j < curReadingPage; j += 1)
						{
							bool flag6 = (tempPageReadStatus & 1 << (int)j) == 0;
							if (flag6)
							{
								notReadPrePageCount++;
							}
						}
					}
					bool flag7 = skillAttainment <= 0;
					if (flag7)
					{
						skillAttainment = this._taiwuChar.GetLifeSkillAttainment(lifeSkillType);
					}
					foreach (short featureId in this._taiwuChar.GetFeatureIds())
					{
						CharacterFeatureItem featureCfg = CharacterFeature.Instance[featureId];
						featBonusSpeed += featureCfg.LifeSkillBookReadEfficiency;
					}
					strategyBonus = strategies.GetPageReadingEfficiencyBonus(curReadingPage);
					Location location = this._taiwuChar.GetLocation();
					buildingBonusSpeed += DomainManager.Building.GetBuildingBlockEffect(location, EBuildingScaleEffect.LifeSkillReadingSpeedBonusFactor, (int)lifeSkillType);
				}
				else
				{
					short skillTemplateId2 = book.GetCombatSkillTemplateId();
					CombatSkillItem skillConfig = Config.CombatSkill.Instance[skillTemplateId2];
					byte pageTypes = book.GetPageTypes();
					sbyte behaviorType = SkillBookStateHelper.GetOutlinePageType(pageTypes);
					sbyte direction = SkillBookStateHelper.GetNormalPageType(pageTypes, curReadingPage);
					byte readingInternalIndex = CombatSkillStateHelper.GetPageInternalIndex(behaviorType, direction, curReadingPage);
					bool flag8 = this._taiwuChar.GetLearnedCombatSkills().Contains(skillTemplateId2);
					if (flag8)
					{
						GameData.Domains.CombatSkill.CombatSkill skillItem2 = DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillTemplateId2));
						ushort readingState = skillItem2.GetReadingState();
						for (byte k = 0; k < curReadingPage; k += 1)
						{
							byte internalIndex = CombatSkillStateHelper.GetPageInternalIndex(behaviorType, SkillBookStateHelper.GetNormalPageType(pageTypes, k), k);
							bool flag9 = !CombatSkillStateHelper.IsPageRead(readingState, internalIndex) && (tempPageReadStatus & 1 << (int)k) == 0;
							if (flag9)
							{
								notReadPrePageCount++;
							}
						}
					}
					else
					{
						for (byte l = 0; l < curReadingPage; l += 1)
						{
							bool flag10 = (tempPageReadStatus & 1 << (int)l) == 0;
							if (flag10)
							{
								notReadPrePageCount++;
							}
						}
					}
					skillAttainment = this._taiwuChar.GetCombatSkillAttainment(book.GetCombatSkillType());
					short requiredAttainment = SkillGradeData.Instance[book.GetGrade()].ReadingAttainmentRequirement;
					skillAttainment = this.GetAttainmentWithSectApprovalBonus(skillConfig.SectId, skillAttainment, requiredAttainment);
					foreach (short featureId2 in this._taiwuChar.GetFeatureIds())
					{
						CharacterFeatureItem featureCfg2 = CharacterFeature.Instance[featureId2];
						featBonusSpeed += featureCfg2.CombatSkillBookReadEfficiency;
					}
					strategyBonus = strategies.GetPageReadingEfficiencyBonus(curReadingPage);
					sbyte sectId = Config.CombatSkill.Instance[book.GetCombatSkillTemplateId()].SectId;
					sectApprovalFactor = this.CalcReadingSpeedSectApprovalFactor(sectId, (curReadingPage == 0) ? SkillBookStateHelper.GetOutlinePageType(pageTypes) : direction, (sbyte)curReadingPage, isInBattle);
					Location location2 = this._taiwuChar.GetLocation();
					buildingBonusSpeed += DomainManager.Building.GetBuildingBlockEffect(location2, EBuildingScaleEffect.CombatSkillReadingSpeedBonusFactor, (int)skillConfig.Type);
				}
				int readingSpeedAttainmentFactor = TaiwuDomain.CalcReadingSpeedAttainmentFactor(skillAttainment, book.GetGrade());
				int refBookBonusSpeed = this.CalcReferenceBooksBonusSpeedPercent();
				byte difficulty = DomainManager.Extra.GetReadingDifficulty();
				short difficultyBonus = WorldCreation.Instance[8].InfluenceFactors[(int)difficulty];
				int professionBonus = 0;
				bool isEquipedTargetSkill = DomainManager.Extra.IsProfessionalSkillUnlocked(4, 1);
				bool flag11 = isEquipedTargetSkill;
				if (flag11)
				{
					int seniority = DomainManager.Extra.GetProfessionData(4).Seniority;
					int maxSeniority = 3000000;
					professionBonus = 30 + 30 * seniority / maxSeniority;
				}
				int speedMultiplier = 100 + featBonusSpeed + buildingBonusSpeed + refBookBonusSpeed + strategyBonus + professionBonus;
				speedMultiplier = speedMultiplier * (100 + readingSpeedAttainmentFactor) / 100;
				speedMultiplier = speedMultiplier * (100 + sectApprovalFactor) / 100;
				speedMultiplier = speedMultiplier * (int)difficultyBonus / 100;
				for (int m = 0; m < notReadPrePageCount; m++)
				{
					speedMultiplier /= 2;
				}
				result = Math.Max(speedMultiplier, 0);
			}
			return result;
		}

		// Token: 0x060011B1 RID: 4529 RVA: 0x001193C0 File Offset: 0x001175C0
		public static int CalcReadingSpeedAttainmentFactor(short attainment, sbyte grade)
		{
			return Math.Clamp((int)(100 * attainment / SkillGradeData.Instance[grade].ReadingAttainmentRequirement), 10, 1000);
		}

		// Token: 0x060011B2 RID: 4530 RVA: 0x001193F4 File Offset: 0x001175F4
		private int CalcReferenceBooksBonusSpeedPercent()
		{
			int refBonusSpeed = 0;
			foreach (ItemKey refBookKey in this._referenceBooks)
			{
				bool flag = !refBookKey.IsValid();
				if (!flag)
				{
					refBonusSpeed += this.GetRefBonusSpeed(refBookKey);
				}
			}
			return Math.Max(0, refBonusSpeed);
		}

		// Token: 0x060011B3 RID: 4531 RVA: 0x00119450 File Offset: 0x00117650
		[DomainMethod]
		public int GetRefBonusSpeed(ItemKey refBookKey)
		{
			bool flag = !this._curReadingBook.IsValid();
			int result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				sbyte bookSkillType = (book.GetItemSubType() == 1000) ? book.GetLifeSkillType() : book.GetCombatSkillType();
				GameData.Domains.Item.SkillBook refBook = DomainManager.Item.GetElement_SkillBooks(refBookKey.Id);
				sbyte refBookGrade = refBook.GetGrade();
				int factor = 15;
				bool flag2 = this.CheckRefBonusSpeedIsSpecial(refBookKey);
				if (flag2)
				{
					factor = 30;
				}
				sbyte refBookSkillType = (refBook.GetItemSubType() == 1000) ? refBook.GetLifeSkillType() : refBook.GetCombatSkillType();
				bool flag3 = refBook.GetItemSubType() == book.GetItemSubType() && refBookSkillType == bookSkillType;
				if (flag3)
				{
					factor = 30;
				}
				int refBonusSpeed = GlobalConfig.Instance.BaseRefBonusSpeed + (int)(refBookGrade + 1) * factor;
				result = refBonusSpeed;
			}
			return result;
		}

		// Token: 0x060011B4 RID: 4532 RVA: 0x00119538 File Offset: 0x00117738
		private bool CheckRefBonusSpeedIsSpecial(ItemKey refBookKey)
		{
			bool flag = !this._curReadingBook.IsValid();
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				List<short> bonusRefBookIds = book.GetReferenceBooksWithBonus();
				result = (bonusRefBookIds != null && bonusRefBookIds.Contains(refBookKey.TemplateId));
			}
			return result;
		}

		// Token: 0x060011B5 RID: 4533 RVA: 0x00119590 File Offset: 0x00117790
		[DomainMethod]
		public void CheckNotInInventoryBooks(DataContext context)
		{
			Inventory inventory = this._taiwuChar.GetInventory();
			sbyte i = 0;
			while ((int)i < this._referenceBooks.Length)
			{
				bool flag = this._referenceBooks[(int)i].IsValid() && !inventory.Items.ContainsKey(this._referenceBooks[(int)i]);
				if (flag)
				{
					this.SetReferenceBook(context, i, ItemKey.Invalid);
				}
				else
				{
					bool flag2 = !this.IsReferenceBookSlotUnlocked((int)i);
					if (flag2)
					{
						this.SetReferenceBook(context, i, ItemKey.Invalid);
					}
				}
				i += 1;
			}
			bool flag3 = this._curReadingBook.IsValid() && !inventory.Items.ContainsKey(this._curReadingBook);
			if (flag3)
			{
				this.SetReadingBook(context, ItemKey.Invalid);
			}
		}

		// Token: 0x060011B6 RID: 4534 RVA: 0x00119660 File Offset: 0x00117860
		public bool IsReferenceBookSlotUnlocked(int index)
		{
			byte unlockState = this.GetReferenceBookSlotUnlockStates();
			return (unlockState >> index & 1) == 1;
		}

		// Token: 0x060011B7 RID: 4535 RVA: 0x00119684 File Offset: 0x00117884
		public bool UpdateReadingProgressOnce(DataContext context, bool isInCombat, bool addInstantNotification = true)
		{
			this.CheckNotInInventoryBooks(context);
			bool flag = !this._curReadingBook.IsValid();
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				ReadingBookStrategies strategies = this.GetCurReadingStrategies();
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				ItemKey bookKey = book.GetItemKey();
				InstantNotificationCollection collection = DomainManager.World.GetInstantNotificationCollection();
				if (isInCombat)
				{
					Events.RegisterHandler_CombatEnd(new Events.OnCombatEnd(this.OnCombatEndTryAttachPoisonByReadInCombat));
				}
				else
				{
					this.ApplyAttachedPoisonForReading(context);
				}
				bool flag2 = SkillGroup.FromItemSubType(book.GetItemSubType()) == 0;
				if (flag2)
				{
					int progress = this.UpdateLifeSkillBookReadingProgress(context, book, strategies, isInCombat, 100);
					sbyte count = DomainManager.Extra.GetReadInLifeSkillCombatCount();
					if (addInstantNotification)
					{
						bool flag3 = count <= 0;
						if (flag3)
						{
							collection.AddReadInLifeSkillCombatNoChance(bookKey.ItemType, bookKey.TemplateId, progress);
						}
						else
						{
							collection.AddReadInLifeSkillCombat(bookKey.ItemType, bookKey.TemplateId, progress, (int)count);
						}
					}
				}
				else
				{
					int progress2 = this.UpdateCombatSkillBookReadingProgress(context, book, strategies, isInCombat, 100);
					sbyte count2 = DomainManager.Taiwu.GetReadInCombatCount();
					if (addInstantNotification)
					{
						bool flag4 = count2 <= 0;
						if (flag4)
						{
							collection.AddReadInCombatNoChance(bookKey.ItemType, bookKey.TemplateId, progress2);
						}
						else
						{
							collection.AddReadInCombat(bookKey.ItemType, bookKey.TemplateId, progress2, (int)count2);
						}
					}
				}
				int readingEventTotalRate = 20;
				if (isInCombat)
				{
					Location location = DomainManager.Taiwu.GetTaiwu().GetLocation();
					bool flag5 = location.IsValid();
					if (flag5)
					{
						AreaAdventureData adventuresInArea = DomainManager.Adventure.GetAdventuresInArea(location.AreaId);
						AdventureSiteData site;
						bool flag6 = adventuresInArea.AdventureSites.TryGetValue(location.BlockId, out site) && site.SiteState >= 2 && site.TemplateId == 38;
						if (flag6)
						{
							readingEventTotalRate += 20;
						}
					}
				}
				for (int i = 0; i < this._referenceBooks.Length; i++)
				{
					bool flag7 = !this._referenceBooks[i].IsValid();
					if (!flag7)
					{
						GameData.Domains.Item.SkillBook referenceBook = DomainManager.Item.GetElement_SkillBooks(this._referenceBooks[i].Id);
						bool flag8 = SkillGroup.FromItemSubType(referenceBook.GetItemSubType()) == 0;
						if (flag8)
						{
							readingEventTotalRate += LifeSkill.Instance[referenceBook.GetLifeSkillTemplateId()].ReadingEventBonusRate;
						}
					}
				}
				bool flag9 = this._curReadingBook.IsValid() && (readingEventTotalRate >= 100 || context.Random.CheckProb(readingEventTotalRate, 100));
				result = flag9;
			}
			return result;
		}

		// Token: 0x060011B8 RID: 4536 RVA: 0x00119928 File Offset: 0x00117B28
		public bool UpdateReadingProgressInCombat(DataContext context)
		{
			return this.UpdateReadingProgressOnce(context, true, true);
		}

		// Token: 0x060011B9 RID: 4537 RVA: 0x00119943 File Offset: 0x00117B43
		private void OnCombatEndTryAttachPoisonByReadInCombat(DataContext context)
		{
			this.ApplyAttachedPoisonForReading(context);
			Events.UnRegisterHandler_CombatEnd(new Events.OnCombatEnd(this.OnCombatEndTryAttachPoisonByReadInCombat));
		}

		// Token: 0x060011BA RID: 4538 RVA: 0x00119960 File Offset: 0x00117B60
		private void ApplyAttachedPoisonForReading(DataContext context)
		{
			bool flag = !this._curReadingBook.IsValid();
			if (!flag)
			{
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				this._taiwuChar.TryApplyAttachedPoison(context, book.GetItemKey());
			}
		}

		// Token: 0x060011BB RID: 4539 RVA: 0x001199AC File Offset: 0x00117BAC
		public void UpdateReadingProgressOnMonthChange(DataContext context)
		{
			this.SetReadInCombatCount(1, context);
			DomainManager.Extra.SetReadInLifeSkillCombatCount(1, context);
			short readingEventTotalRate = this.GetCurrReadingEventBonusRate();
			this.MakeReadingProgressActuallyWork(context, 100);
			List<int> readingEventBookList = DomainManager.Extra.GetReadingEventBookIdList();
			readingEventBookList.Clear();
			DomainManager.Extra.SetReadingEventBookIdList(readingEventBookList, context);
			bool flag = this._curReadingBook.IsValid() && (readingEventTotalRate >= 100 || context.Random.CheckProb((int)readingEventTotalRate, 100));
			if (flag)
			{
				DomainManager.World.GetMonthlyNotificationCollection().AddReadingEvent((ulong)this._curReadingBook);
				DomainManager.Extra.AddReadingEventBookId(context, this._curReadingBook.Id);
			}
		}

		// Token: 0x060011BC RID: 4540 RVA: 0x00119A60 File Offset: 0x00117C60
		public void MakeReadingProgressActuallyWork(DataContext context, int activeReadProgressAffectedEfficiency = 100)
		{
			this.CheckNotInInventoryBooks(context);
			bool flag = !this._curReadingBook.IsValid();
			if (!flag)
			{
				bool flag2 = !DomainManager.SpecialEffect.ModifyData(this._taiwuCharId, -1, 260, true, -1, -1, -1);
				if (!flag2)
				{
					ReadingBookStrategies strategies = this.GetCurReadingStrategies();
					GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
					this._taiwuChar.TryApplyAttachedPoison(context, book.GetItemKey());
					bool flag3 = SkillGroup.FromItemSubType(book.GetItemSubType()) == 0;
					if (flag3)
					{
						this.UpdateLifeSkillBookReadingProgress(context, book, strategies, false, activeReadProgressAffectedEfficiency);
					}
					else
					{
						this.UpdateCombatSkillBookReadingProgress(context, book, strategies, false, activeReadProgressAffectedEfficiency);
					}
					short readingEventTotalRate = this.GetCurrReadingEventBonusRate();
					for (int i = 0; i < this._referenceBooks.Length; i++)
					{
						bool flag4 = !this._referenceBooks[i].IsValid();
						if (!flag4)
						{
							GameData.Domains.Item.SkillBook referenceBook = DomainManager.Item.GetElement_SkillBooks(this._referenceBooks[i].Id);
							this._taiwuChar.TryApplyAttachedPoison(context, referenceBook.GetItemKey());
							referenceBook.SetCurrDurability(referenceBook.GetCurrDurability() - 1, context);
							bool flag5 = referenceBook.GetCurrDurability() <= 0;
							if (flag5)
							{
								this._taiwuChar.RemoveInventoryItem(context, this._referenceBooks[i], 1, true, false);
								this._referenceBooks[i] = ItemKey.Invalid;
							}
						}
					}
					this.SetReferenceBooks(this._referenceBooks, context);
					book.SetCurrDurability(book.GetCurrDurability() - 1, context);
					bool flag6 = book.GetCurrDurability() <= 0;
					if (flag6)
					{
						this._taiwuChar.RemoveInventoryItem(context, this._curReadingBook, 1, true, false);
						this.SetReadingBook(context, ItemKey.Invalid);
					}
				}
			}
		}

		// Token: 0x060011BD RID: 4541 RVA: 0x00119C40 File Offset: 0x00117E40
		public void ClearReadingStrategy(DataContext context, ItemKey book, byte pageIndex, int strategyIndex)
		{
			ReadingBookStrategies strategies;
			bool flag = !this._readingBooks.TryGetValue(book, out strategies);
			if (!flag)
			{
				strategies.SetPageStrategy(pageIndex, strategyIndex, -1, 0);
				this.SetElement_ReadingBooks(book, ref strategies, context);
			}
		}

		// Token: 0x060011BE RID: 4542 RVA: 0x00119C80 File Offset: 0x00117E80
		private TaiwuLifeSkill GetTaiwuLifeSkill(short skillTemplateId)
		{
			TaiwuLifeSkill lifeSkill;
			bool flag = this.TryGetElement_LifeSkills(skillTemplateId, out lifeSkill);
			TaiwuLifeSkill result;
			if (flag)
			{
				result = lifeSkill;
			}
			else
			{
				bool flag2 = this.TryGetElement_NotLearnLifeSkillReadingProgress(skillTemplateId, out lifeSkill);
				if (flag2)
				{
					result = lifeSkill;
				}
				else
				{
					result = new TaiwuLifeSkill();
				}
			}
			return result;
		}

		// Token: 0x060011BF RID: 4543 RVA: 0x00119CBC File Offset: 0x00117EBC
		private void SetTaiwuLifeSkill(DataContext context, short skillTemplateId, TaiwuLifeSkill taiwuLifeSkill)
		{
			bool flag = this._lifeSkills.ContainsKey(skillTemplateId);
			if (flag)
			{
				this.SetElement_LifeSkills(skillTemplateId, taiwuLifeSkill, context);
			}
			else
			{
				bool flag2 = this._notLearnLifeSkillReadingProgress.ContainsKey(skillTemplateId);
				if (flag2)
				{
					this.SetElement_NotLearnLifeSkillReadingProgress(skillTemplateId, taiwuLifeSkill, context);
				}
				else
				{
					this.AddElement_NotLearnLifeSkillReadingProgress(skillTemplateId, taiwuLifeSkill, context);
				}
			}
		}

		// Token: 0x060011C0 RID: 4544 RVA: 0x00119D0C File Offset: 0x00117F0C
		private TaiwuCombatSkill GetTaiwuCombatSkill(short skillTemplateId)
		{
			TaiwuCombatSkill combatSkill;
			bool flag = this.TryGetElement_CombatSkills(skillTemplateId, out combatSkill);
			TaiwuCombatSkill result;
			if (flag)
			{
				result = combatSkill;
			}
			else
			{
				bool flag2 = this.TryGetElement_NotLearnCombatSkillReadingProgress(skillTemplateId, out combatSkill);
				if (flag2)
				{
					result = combatSkill;
				}
				else
				{
					result = new TaiwuCombatSkill();
				}
			}
			return result;
		}

		// Token: 0x060011C1 RID: 4545 RVA: 0x00119D48 File Offset: 0x00117F48
		private void SetTaiwuCombatSkill(DataContext context, short skillTemplateId, TaiwuCombatSkill taiwuCombatSkill)
		{
			bool flag = this._combatSkills.ContainsKey(skillTemplateId);
			if (flag)
			{
				this.SetElement_CombatSkills(skillTemplateId, taiwuCombatSkill, context);
			}
			else
			{
				bool flag2 = this._notLearnCombatSkillReadingProgress.ContainsKey(skillTemplateId);
				if (flag2)
				{
					this.SetElement_NotLearnCombatSkillReadingProgress(skillTemplateId, taiwuCombatSkill, context);
				}
				else
				{
					this.AddElement_NotLearnCombatSkillReadingProgress(skillTemplateId, taiwuCombatSkill, context);
				}
			}
		}

		// Token: 0x060011C2 RID: 4546 RVA: 0x00119D98 File Offset: 0x00117F98
		private int UpdateLifeSkillBookReadingProgress(DataContext context, GameData.Domains.Item.SkillBook book, ReadingBookStrategies strategies, bool isInBattle = false, int activeReadProgressAffectedEfficiency = 100)
		{
			short skillTemplateId = book.GetLifeSkillTemplateId();
			TaiwuLifeSkill lifeSkill = this.GetTaiwuLifeSkill(skillTemplateId);
			byte readingPage = this.GetCurrentReadingPage(book, strategies, lifeSkill);
			int totalAddProgress = 0;
			int remainingSpeedPercent = 100;
			SkillBookItem skillBookItem = Config.SkillBook.Instance[skillTemplateId];
			sbyte lifeSkillType = skillBookItem.LifeSkillType;
			sbyte bookGrade = skillBookItem.Grade;
			while (remainingSpeedPercent > 0 && readingPage < 5)
			{
				bool flag = this.IsLifeSkillBookPageRead(book, readingPage) || strategies.GetSkipPage(readingPage);
				if (flag)
				{
					readingPage += 1;
				}
				else
				{
					int combatBonus = isInBattle ? DomainManager.Taiwu.CalcReadingBonusRateFactorInCombat(DomainManager.Taiwu.GetCurReadingBook()) : 100;
					int readingSpeed = (int)this.GetBaseReadingSpeed(readingPage) * this.GetReadingSpeedBonus(readingPage, isInBattle, 0, 0) / 100;
					readingSpeed = readingSpeed * activeReadProgressAffectedEfficiency / 100;
					readingSpeed = readingSpeed * combatBonus / 100;
					bool flag2 = readingSpeed == 0;
					if (flag2)
					{
						break;
					}
					ValueTuple<bool, int> valueTuple = this.ReadSkillBookPage(context, book, readingPage, readingSpeed, false, ref remainingSpeedPercent, ref readingPage);
					bool readingFinished = valueTuple.Item1;
					int addedProgress = valueTuple.Item2;
					totalAddProgress += addedProgress;
					bool flag3 = readingFinished;
					if (flag3)
					{
						bool flag4 = lifeSkillType == 13;
						if (flag4)
						{
							int addSeniority = ProfessionFormulaImpl.Calculate(42, (int)bookGrade);
							DomainManager.Extra.ChangeProfessionSeniority(context, 6, addSeniority, true, false);
						}
						else
						{
							bool flag5 = lifeSkillType == 12;
							if (flag5)
							{
								int addSeniority2 = ProfessionFormulaImpl.Calculate(36, (int)bookGrade);
								DomainManager.Extra.ChangeProfessionSeniority(context, 5, addSeniority2, true, false);
							}
						}
					}
					bool flag6 = !readingFinished;
					if (flag6)
					{
						break;
					}
				}
			}
			bool flag7 = readingPage == 5;
			if (flag7)
			{
				int pageCount = this.GetReadPageCountByRereading(isInBattle, remainingSpeedPercent, null, 0, 0);
				this._taiwuChar.ChangeExp(context, this.GetExpByRereading(bookGrade, pageCount));
				bool flag8 = lifeSkillType == 13;
				if (flag8)
				{
					int addSeniority3 = ProfessionFormulaImpl.Calculate(43, (int)bookGrade) * pageCount;
					DomainManager.Extra.ChangeProfessionSeniority(context, 6, addSeniority3, true, false);
				}
				else
				{
					bool flag9 = lifeSkillType == 12;
					if (flag9)
					{
						int addSeniority4 = ProfessionFormulaImpl.Calculate(37, (int)bookGrade) * pageCount;
						DomainManager.Extra.ChangeProfessionSeniority(context, 5, addSeniority4, true, false);
					}
				}
			}
			return totalAddProgress;
		}

		// Token: 0x060011C3 RID: 4547 RVA: 0x00119FAC File Offset: 0x001181AC
		private int UpdateCombatSkillBookReadingProgress(DataContext context, GameData.Domains.Item.SkillBook book, ReadingBookStrategies strategies, bool isInBattle = false, int activeReadProgressAffectedEfficiency = 100)
		{
			short skillTemplateId = book.GetCombatSkillTemplateId();
			byte pageTypes = book.GetPageTypes();
			TaiwuCombatSkill combatSkill = this.GetTaiwuCombatSkill(skillTemplateId);
			byte readingPage = this.GetCurrentReadingPage(book, strategies, combatSkill);
			int totalAddProgress = 0;
			int remainingSpeedPercent = 100;
			while (remainingSpeedPercent > 0 && readingPage < 6)
			{
				bool flag = this.IsCombatSkillBookPageRead(book, readingPage) || strategies.GetSkipPage(readingPage);
				if (flag)
				{
					readingPage += 1;
				}
				else
				{
					int combatBonus = isInBattle ? DomainManager.Taiwu.CalcReadingBonusRateFactorInCombat(DomainManager.Taiwu.GetCurReadingBook()) : 100;
					int readingSpeed = (int)this.GetBaseReadingSpeed(readingPage) * this.GetReadingSpeedBonus(readingPage, isInBattle, 0, 0) / 100;
					readingSpeed = readingSpeed * activeReadProgressAffectedEfficiency / 100;
					readingSpeed = readingSpeed * combatBonus / 100;
					bool flag2 = readingSpeed == 0;
					if (flag2)
					{
						break;
					}
					byte pageInternalIndex = CombatSkillStateHelper.GetPageInternalIndex(SkillBookStateHelper.GetOutlinePageType(pageTypes), SkillBookStateHelper.GetNormalPageType(pageTypes, readingPage), readingPage);
					ValueTuple<bool, int> valueTuple = this.ReadSkillBookPage(context, book, pageInternalIndex, readingSpeed, true, ref remainingSpeedPercent, ref readingPage);
					bool readingFinished = valueTuple.Item1;
					int addedProgress = valueTuple.Item2;
					totalAddProgress += addedProgress;
					bool flag3 = !readingFinished;
					if (flag3)
					{
						break;
					}
				}
			}
			bool flag4 = readingPage == 6;
			if (flag4)
			{
				this._taiwuChar.ChangeExp(context, this.GetExpByRereading(isInBattle, remainingSpeedPercent));
			}
			return totalAddProgress;
		}

		// Token: 0x060011C4 RID: 4548 RVA: 0x0011A0EC File Offset: 0x001182EC
		[DomainMethod]
		public int GetExpByRereading(bool isInBattle, int remainingSpeedPercent)
		{
			return (!this._curReadingBook.IsValid()) ? 0 : this.GetExpByRereading(DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id).GetGrade(), this.GetReadPageCountByRereading(isInBattle, remainingSpeedPercent, null, 0, 0));
		}

		// Token: 0x060011C5 RID: 4549 RVA: 0x0011A13C File Offset: 0x0011833C
		public int GetExpByRereading(sbyte grade, int pageCount)
		{
			return (int)(SkillGradeData.Instance[grade].ReadingExpGainPerPage * (short)GlobalConfig.Instance.ReadingFinishedBookExpGainPercent * (short)(grade + 1) / 100) * pageCount;
		}

		// Token: 0x060011C6 RID: 4550 RVA: 0x0011A174 File Offset: 0x00118374
		private int GetReadPageCountByRereading(bool isInBattle, int remainingSpeedPercent, int[] progress = null, int tempPageReadStatus = 0, short skillAttainment = 0)
		{
			bool flag = !this._curReadingBook.IsValid();
			int result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				byte limit = book.GetPageCount();
				ReadingBookStrategies strategies = this.GetCurReadingStrategies();
				int readPageCount = 0;
				for (byte readingPage = 0; readingPage < limit; readingPage += 1)
				{
					bool skipPage = strategies.GetSkipPage(readingPage);
					if (!skipPage)
					{
						int combatBonus = isInBattle ? DomainManager.Taiwu.CalcReadingBonusRateFactorInCombat(book.GetItemKey()) : 100;
						int readingSpeed = (int)SkillBookPageIncompleteState.BaseReadingSpeed[0] * this.GetReadingSpeedBonus(readingPage, isInBattle, tempPageReadStatus, skillAttainment) * combatBonus / 10000;
						int addingProgress = readingSpeed * remainingSpeedPercent / 100;
						bool flag2 = progress != null;
						if (flag2)
						{
							progress[(int)readingPage] += Math.Min(addingProgress, 100);
						}
						bool flag3 = addingProgress >= 100;
						if (!flag3)
						{
							break;
						}
						readPageCount++;
						remainingSpeedPercent -= 10000 / readingSpeed;
					}
				}
				result = readPageCount;
			}
			return result;
		}

		// Token: 0x060011C7 RID: 4551 RVA: 0x0011A288 File Offset: 0x00118488
		[DomainMethod]
		public int[] GetReadingResult()
		{
			int[] progress = new int[6];
			bool flag = !this._curReadingBook.IsValid() || this.GetCurrReadingBanByWug();
			int[] result;
			if (flag)
			{
				result = progress;
			}
			else
			{
				int readPageCount = 0;
				int tempPageReadStatus = 0;
				int remainingSpeedPercent = 100;
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
				byte limit = book.GetPageCount();
				ReadingBookStrategies strategies = this.GetCurReadingStrategies();
				bool isCombatSkill = book.IsCombatSkillBook();
				byte pageTypes = book.GetPageTypes();
				short skillAttainment = 0;
				bool flag2 = isCombatSkill;
				byte readingPage;
				TaiwuSkill skill;
				if (flag2)
				{
					short skillTemplateId = book.GetCombatSkillTemplateId();
					TaiwuCombatSkill combatSkill = this.GetTaiwuCombatSkill(skillTemplateId);
					readingPage = this.GetCurrentReadingPage(book, strategies, combatSkill);
					skill = combatSkill;
				}
				else
				{
					short skillTemplateId2 = book.GetLifeSkillTemplateId();
					TaiwuLifeSkill lifeSkill = this.GetTaiwuLifeSkill(skillTemplateId2);
					readingPage = this.GetCurrentReadingPage(book, strategies, lifeSkill);
					skill = lifeSkill;
				}
				while (readingPage < limit)
				{
					sbyte readingProgress = isCombatSkill ? skill.GetBookPageReadingProgress(CombatSkillStateHelper.GetPageInternalIndex(SkillBookStateHelper.GetOutlinePageType(pageTypes), SkillBookStateHelper.GetNormalPageType(pageTypes, readingPage), readingPage)) : skill.GetBookPageReadingProgress(readingPage);
					bool flag3 = readingProgress == 100;
					if (flag3)
					{
						tempPageReadStatus |= 1 << (int)readingPage;
						readPageCount++;
					}
					else
					{
						bool skipPage = strategies.GetSkipPage(readingPage);
						if (!skipPage)
						{
							bool flag4 = !isCombatSkill;
							if (flag4)
							{
								skillAttainment = this._taiwuChar.GetPredictLifeSkillAttainment((short)book.GetLifeSkillType(), book.GetLifeSkillTemplateId(), readPageCount);
							}
							int readingSpeed = (int)this.GetBaseReadingSpeed(readingPage) * this.GetReadingSpeedBonus(readingPage, false, tempPageReadStatus, skillAttainment) / 100;
							int addingProgress = readingSpeed * remainingSpeedPercent / 100;
							int addedProgress = Math.Min(100, addingProgress + (int)readingProgress) - (int)readingProgress;
							bool flag5 = readingSpeed == 0;
							if (flag5)
							{
								break;
							}
							remainingSpeedPercent -= addedProgress * 100 / readingSpeed;
							progress[(int)readingPage] = (int)((sbyte)addedProgress);
							bool flag6 = addingProgress + (int)readingProgress < 100;
							if (flag6)
							{
								break;
							}
							tempPageReadStatus |= 1 << (int)readingPage;
							readPageCount++;
						}
					}
					readingPage += 1;
				}
				bool flag7 = readingPage == limit;
				if (flag7)
				{
					skillAttainment = (isCombatSkill ? 0 : this._taiwuChar.GetPredictLifeSkillAttainment((short)book.GetLifeSkillType(), book.GetLifeSkillTemplateId(), readPageCount));
					this.GetReadPageCountByRereading(false, remainingSpeedPercent, progress, tempPageReadStatus, skillAttainment);
				}
				result = progress;
			}
			return result;
		}

		// Token: 0x060011C8 RID: 4552 RVA: 0x0011A4BC File Offset: 0x001186BC
		public void ReadSkillBookPageAndSetComplete(DataContext context, GameData.Domains.Item.SkillBook book, byte readingPage)
		{
			bool flag = book.IsCombatSkillBook();
			if (flag)
			{
				short skillTemplateId = book.GetCombatSkillTemplateId();
				TaiwuCombatSkill taiwuCombatSkill = this.GetTaiwuCombatSkill(skillTemplateId);
				byte pageTypes = book.GetPageTypes();
				sbyte behaviorType = SkillBookStateHelper.GetOutlinePageType(pageTypes);
				sbyte direction = SkillBookStateHelper.GetNormalPageType(pageTypes, readingPage);
				byte internalIndex = CombatSkillStateHelper.GetPageInternalIndex(behaviorType, direction, readingPage);
				taiwuCombatSkill.SetBookPageReadingProgress(internalIndex, 100);
				this.SetTaiwuCombatSkill(context, skillTemplateId, taiwuCombatSkill);
				this.SetCombatSkillPageComplete(context, book, internalIndex);
			}
			else
			{
				short skillTemplateId2 = book.GetLifeSkillTemplateId();
				TaiwuLifeSkill taiwuLifeSkill = this.GetTaiwuLifeSkill(skillTemplateId2);
				taiwuLifeSkill.SetBookPageReadingProgress(readingPage, 100);
				this.SetTaiwuLifeSkill(context, skillTemplateId2, taiwuLifeSkill);
				this.SetLifeSkillPageComplete(context, book, readingPage);
			}
		}

		// Token: 0x060011C9 RID: 4553 RVA: 0x0011A560 File Offset: 0x00118760
		private void SetLifeSkillPageComplete(DataContext context, GameData.Domains.Item.SkillBook book, byte readingPage)
		{
			ReadingBookStrategies strategies;
			bool flag = !this._readingBooks.TryGetValue(book.GetItemKey(), out strategies) || !strategies.PageContainsStrategy(readingPage, 12);
			if (flag)
			{
				short expGain = SkillGradeData.Instance[book.GetGrade()].ReadingExpGainPerPage;
				this._taiwuChar.ChangeExp(context, (int)expGain);
			}
			short skillTemplateId = book.GetLifeSkillTemplateId();
			bool flag2 = this._notLearnLifeSkillReadingProgress.ContainsKey(skillTemplateId);
			if (flag2)
			{
				this.TaiwuLearnLifeSkill(context, skillTemplateId, (byte)(1 << (int)readingPage));
			}
			else
			{
				int index = this._taiwuChar.FindLearnedLifeSkillIndex(skillTemplateId);
				GameData.Domains.Character.LifeSkillItem oldLearnedLifeSkill = this._taiwuChar.GetLearnedLifeSkills()[index];
				short strategyTemplateId;
				sbyte b;
				this._taiwuChar.CheckLearnedBookHasUnlockedDebateStrategy(oldLearnedLifeSkill, out strategyTemplateId, out b);
				DebateStrategyItem strategyConfig = DebateStrategy.Instance[strategyTemplateId];
				Dictionary<sbyte, int> oldDict = this._taiwuChar.GetHasUnlockedDebateStrategyLearnedBookCountDict((int)strategyConfig.Level);
				this._taiwuChar.ReadLifeSkillPage(context, index, readingPage);
				GameData.Domains.Character.LifeSkillItem learnedLifeSkill = this._taiwuChar.GetLearnedLifeSkills()[index];
				sbyte pageIncompleteState = SkillBookStateHelper.GetPageIncompleteState(book.GetPageIncompleteState(), readingPage);
				bool flag3 = pageIncompleteState == 0;
				if (flag3)
				{
					DomainManager.Taiwu.AddLegacyPoint(context, 15, 100);
				}
				else
				{
					DomainManager.Taiwu.AddLegacyPoint(context, 16, 100);
				}
				bool flag4 = learnedLifeSkill.IsAllPagesRead();
				if (flag4)
				{
					DomainManager.Taiwu.AddLegacyPoint(context, 17, 100);
					short unlockedDebateStrategy = this._taiwuChar.GetUnlockedDebateStrategy(learnedLifeSkill, oldDict);
					bool flag5 = unlockedDebateStrategy >= 0 && !this._unlockedDebateStrategyList.Contains(unlockedDebateStrategy);
					if (flag5)
					{
						this._unlockedDebateStrategyList.Add(unlockedDebateStrategy);
						GameDataBridge.AddDisplayEvent(DisplayEventType.UnlockLifeSkillCombatStrategy);
					}
				}
			}
		}

		// Token: 0x060011CA RID: 4554 RVA: 0x0011A70C File Offset: 0x0011890C
		private void SetCombatSkillPageComplete(DataContext context, GameData.Domains.Item.SkillBook book, byte internalIndex)
		{
			byte readingPage = CombatSkillStateHelper.GetPageId(internalIndex);
			ReadingBookStrategies strategies;
			bool flag = !this._readingBooks.TryGetValue(book.GetItemKey(), out strategies) || !strategies.PageContainsStrategy(readingPage, 12);
			if (flag)
			{
				short expGain = SkillGradeData.Instance[book.GetGrade()].ReadingExpGainPerPage;
				this._taiwuChar.ChangeExp(context, (int)expGain);
			}
			short skillTemplateId = book.GetCombatSkillTemplateId();
			bool flag2 = this._notLearnCombatSkillReadingProgress.ContainsKey(skillTemplateId);
			if (flag2)
			{
				ushort readingState = CombatSkillStateHelper.SetPageRead(0, internalIndex);
				this.TaiwuLearnCombatSkill(context, skillTemplateId, readingState);
			}
			else
			{
				GameData.Domains.CombatSkill.CombatSkill skillItem = DomainManager.CombatSkill.GetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillTemplateId));
				skillItem.SetReadingState(CombatSkillStateHelper.SetPageRead(skillItem.GetReadingState(), internalIndex), context);
				sbyte pageIncompleteState = SkillBookStateHelper.GetPageIncompleteState(book.GetPageIncompleteState(), readingPage);
				bool flag3 = pageIncompleteState == 0;
				if (flag3)
				{
					DomainManager.Taiwu.AddLegacyPoint(context, 21, 100);
				}
				else
				{
					DomainManager.Taiwu.AddLegacyPoint(context, 22, 100);
				}
			}
			DomainManager.CombatSkill.TryActivateCombatSkillBookPageWhenSetReadingState(context, this._taiwuCharId, skillTemplateId, internalIndex);
		}

		// Token: 0x060011CB RID: 4555 RVA: 0x0011A824 File Offset: 0x00118A24
		private bool CheckIsCombatSkillBookFinished(GameData.Domains.Item.SkillBook book, GameData.Domains.CombatSkill.CombatSkill combatSkill)
		{
			ushort readingState = combatSkill.GetReadingState();
			byte pageTypes = book.GetPageTypes();
			sbyte behaviorType = SkillBookStateHelper.GetOutlinePageType(pageTypes);
			for (byte pageId = 0; pageId < 6; pageId += 1)
			{
				sbyte direction = SkillBookStateHelper.GetNormalPageType(pageTypes, pageId);
				byte internalIndex = CombatSkillStateHelper.GetPageInternalIndex(behaviorType, direction, pageId);
				bool flag = !CombatSkillStateHelper.IsPageRead(readingState, internalIndex);
				if (flag)
				{
					return false;
				}
			}
			return true;
		}

		// Token: 0x060011CC RID: 4556 RVA: 0x0011A890 File Offset: 0x00118A90
		private bool OfflineAddReadingProgress(TaiwuSkill skill, byte readingPage, int delta)
		{
			sbyte progress = skill.GetBookPageReadingProgress(readingPage);
			progress = (sbyte)Math.Min(100, (int)progress + delta);
			skill.SetBookPageReadingProgress(readingPage, progress);
			return progress == 100;
		}

		// Token: 0x060011CD RID: 4557 RVA: 0x0011A8C4 File Offset: 0x00118AC4
		public byte GetCurrentReadingPage(GameData.Domains.Item.SkillBook book, ReadingBookStrategies strategies, TaiwuCombatSkill combatSkill)
		{
			sbyte[] readingProgress = combatSkill.GetAllBookPageReadingProgress();
			byte bookPageTypes = book.GetPageTypes();
			sbyte pageType = SkillBookStateHelper.GetOutlinePageType(bookPageTypes);
			byte pageInternalIndex = CombatSkillStateHelper.GetOutlinePageInternalIndex(pageType);
			bool flag = readingProgress[(int)pageInternalIndex] < 100 && !strategies.GetSkipPage(0);
			byte result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				for (byte page = 1; page < 6; page += 1)
				{
					pageType = SkillBookStateHelper.GetNormalPageType(bookPageTypes, page);
					pageInternalIndex = CombatSkillStateHelper.GetNormalPageInternalIndex(pageType, page);
					bool flag2 = readingProgress[(int)pageInternalIndex] >= 100;
					if (!flag2)
					{
						bool skipPage = strategies.GetSkipPage(page);
						bool flag3 = skipPage;
						if (!flag3)
						{
							return page;
						}
					}
				}
				result = 6;
			}
			return result;
		}

		// Token: 0x060011CE RID: 4558 RVA: 0x0011A968 File Offset: 0x00118B68
		public byte GetCurrentReadingPage(GameData.Domains.Item.SkillBook book, ReadingBookStrategies strategies, TaiwuLifeSkill lifeSkill)
		{
			sbyte[] readingProgress = lifeSkill.GetAllBookPageReadingProgress();
			bool flag = readingProgress[0] < 100 && !strategies.GetSkipPage(0);
			byte result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				byte page = 1;
				while ((int)page < readingProgress.Length)
				{
					bool flag2 = readingProgress[(int)page] >= 100;
					if (!flag2)
					{
						bool skipPage = strategies.GetSkipPage(page);
						bool flag3 = skipPage;
						if (!flag3)
						{
							return page;
						}
					}
					page += 1;
				}
				result = 5;
			}
			return result;
		}

		// Token: 0x060011CF RID: 4559 RVA: 0x0011A9E0 File Offset: 0x00118BE0
		[DomainMethod]
		public sbyte GetTotalReadingProgress(int bookItemId)
		{
			GameData.Domains.Item.SkillBook book;
			bool flag = !DomainManager.Item.TryGetElement_SkillBooks(bookItemId, out book);
			sbyte result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				bool flag2 = SkillGroup.FromItemSubType(book.GetItemSubType()) == 0;
				sbyte[] pageProgress;
				if (flag2)
				{
					short skillTemplateId = book.GetLifeSkillTemplateId();
					TaiwuLifeSkill lifeSkill;
					bool flag3 = DomainManager.Taiwu.TryGetElement_LifeSkills(skillTemplateId, out lifeSkill);
					if (flag3)
					{
						pageProgress = lifeSkill.GetAllBookPageReadingProgress();
					}
					else
					{
						TaiwuLifeSkill notLearnLifeSkill;
						bool flag4 = DomainManager.Taiwu.TryGetElement_NotLearnLifeSkillReadingProgress(skillTemplateId, out notLearnLifeSkill);
						if (flag4)
						{
							pageProgress = notLearnLifeSkill.GetAllBookPageReadingProgress();
						}
						else
						{
							pageProgress = new sbyte[5];
						}
					}
				}
				else
				{
					byte pageTypes = book.GetPageTypes();
					sbyte behaviorType = SkillBookStateHelper.GetOutlinePageType(pageTypes);
					short skillTemplateId = book.GetCombatSkillTemplateId();
					sbyte[] readingProgress = null;
					TaiwuCombatSkill combatSkill;
					bool flag5 = DomainManager.Taiwu.TryGetElement_CombatSkills(skillTemplateId, out combatSkill);
					if (flag5)
					{
						readingProgress = combatSkill.GetAllBookPageReadingProgress();
					}
					else
					{
						TaiwuCombatSkill notLearnCombatSkill;
						bool flag6 = DomainManager.Taiwu.TryGetElement_NotLearnCombatSkillReadingProgress(skillTemplateId, out notLearnCombatSkill);
						if (flag6)
						{
							readingProgress = notLearnCombatSkill.GetAllBookPageReadingProgress();
						}
					}
					pageProgress = new sbyte[6];
					bool flag7 = readingProgress != null;
					if (flag7)
					{
						for (byte i = 0; i < 6; i += 1)
						{
							sbyte direction = SkillBookStateHelper.GetNormalPageType(pageTypes, i);
							pageProgress[(int)i] = readingProgress[(int)CombatSkillStateHelper.GetPageInternalIndex(behaviorType, direction, i)];
						}
					}
				}
				result = (sbyte)(pageProgress.Sum() / pageProgress.Length);
			}
			return result;
		}

		// Token: 0x060011D0 RID: 4560 RVA: 0x0011AB20 File Offset: 0x00118D20
		[DomainMethod]
		public List<sbyte> GetTotalReadingProgressList(List<int> bookItemIdList)
		{
			bool flag = bookItemIdList == null || bookItemIdList.Count == 0;
			List<sbyte> result;
			if (flag)
			{
				result = new List<sbyte>();
			}
			else
			{
				List<sbyte> readingProgressList = new List<sbyte>();
				foreach (int id in bookItemIdList)
				{
					readingProgressList.Add(this.GetTotalReadingProgress(id));
				}
				result = readingProgressList;
			}
			return result;
		}

		// Token: 0x060011D1 RID: 4561 RVA: 0x0011ABA4 File Offset: 0x00118DA4
		[DomainMethod]
		public bool GetCurrReadingBanByWug()
		{
			return !DomainManager.SpecialEffect.ModifyData(this._taiwuCharId, -1, 260, true, -1, -1, -1);
		}

		// Token: 0x060011D2 RID: 4562 RVA: 0x0011ABD4 File Offset: 0x00118DD4
		[DomainMethod]
		public short GetCurrReadingEventBonusRate()
		{
			bool currReadingBanByWug = this.GetCurrReadingBanByWug();
			short result;
			if (currReadingBanByWug)
			{
				result = 0;
			}
			else
			{
				bool flag = !this._curReadingBook.IsValid();
				if (flag)
				{
					result = 0;
				}
				else
				{
					bool inGuiding = DomainManager.TutorialChapter.InGuiding;
					int readingEventTotalRate;
					if (inGuiding)
					{
						bool flag2 = DomainManager.TutorialChapter.GetTutorialChapter() == 6;
						if (flag2)
						{
							bool flag3 = this._curReadingBook.TemplateId == 870;
							if (flag3)
							{
								readingEventTotalRate = ((this.GetTotalReadingProgress(this._curReadingBook.Id) < 100) ? 100 : 0);
								return (short)readingEventTotalRate;
							}
						}
					}
					readingEventTotalRate = 20;
					GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
					Location location = DomainManager.Taiwu.GetTaiwu().GetLocation();
					bool flag4 = location.IsValid();
					if (flag4)
					{
						AreaAdventureData adventuresInArea = DomainManager.Adventure.GetAdventuresInArea(location.AreaId);
						AdventureSiteData site;
						bool flag5 = adventuresInArea.AdventureSites.TryGetValue(location.BlockId, out site) && site.SiteState >= 2 && site.TemplateId == 38;
						if (flag5)
						{
							readingEventTotalRate += 20;
						}
					}
					for (int i = 0; i < this._referenceBooks.Length; i++)
					{
						bool flag6 = !this._referenceBooks[i].IsValid();
						if (!flag6)
						{
							GameData.Domains.Item.SkillBook referenceBook = DomainManager.Item.GetElement_SkillBooks(this._referenceBooks[i].Id);
							bool flag7 = SkillGroup.FromItemSubType(referenceBook.GetItemSubType()) == 0;
							if (flag7)
							{
								readingEventTotalRate += LifeSkill.Instance[referenceBook.GetLifeSkillTemplateId()].ReadingEventBonusRate;
							}
						}
					}
					result = (short)MathF.Min(100f, (float)readingEventTotalRate);
				}
			}
			return result;
		}

		// Token: 0x060011D3 RID: 4563 RVA: 0x0011AD98 File Offset: 0x00118F98
		[DomainMethod]
		public short GetCurrReadingEfficiency(DataContext context)
		{
			bool currReadingBanByWug = this.GetCurrReadingBanByWug();
			short result;
			if (currReadingBanByWug)
			{
				result = 0;
			}
			else
			{
				bool flag = !this._curReadingBook.IsValid();
				if (flag)
				{
					result = 0;
				}
				else
				{
					bool flag2 = !this._readingBooks.ContainsKey(this._curReadingBook);
					if (flag2)
					{
						ReadingBookStrategies readingBookStrats = default(ReadingBookStrategies);
						readingBookStrats.Initialize();
						this.AddElement_ReadingBooks(this._curReadingBook, ref readingBookStrats, context);
					}
					ReadingBookStrategies strategies = this._readingBooks[this._curReadingBook];
					GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(this._curReadingBook.Id);
					bool flag3 = book.IsCombatSkillBook();
					byte readingPage;
					if (flag3)
					{
						short skillTemplateId = book.GetCombatSkillTemplateId();
						TaiwuCombatSkill combatSkill = this.GetTaiwuCombatSkill(skillTemplateId);
						readingPage = this.GetCurrentReadingPage(book, strategies, combatSkill);
						bool flag4 = readingPage >= 6;
						if (flag4)
						{
							readingPage = 0;
						}
					}
					else
					{
						short skillTemplateId = book.GetLifeSkillTemplateId();
						TaiwuLifeSkill lifeSkill = this.GetTaiwuLifeSkill(skillTemplateId);
						readingPage = this.GetCurrentReadingPage(book, strategies, lifeSkill);
						bool flag5 = readingPage >= 5;
						if (flag5)
						{
							readingPage = 0;
						}
					}
					int readingSpeed = (int)this.GetBaseReadingSpeed(readingPage) * this.GetReadingSpeedBonus(readingPage, false, 0, 0) / 100;
					result = (short)readingSpeed;
				}
			}
			return result;
		}

		// Token: 0x060011D4 RID: 4564 RVA: 0x0011AEC4 File Offset: 0x001190C4
		[DomainMethod]
		public unsafe void ActiveReadOnce(DataContext context)
		{
			int dayCost = (int)GlobalConfig.Instance.ActiveReadingTimeCost;
			MainAttributes mainAttributes = this._taiwuChar.GetCurrMainAttributes();
			short intelligenceCost = GlobalConfig.Instance.ActiveReadingAttributeCost;
			short curInt = *(ref mainAttributes.Items.FixedElementField + (IntPtr)5 * 2);
			bool flag = DomainManager.World.GetLeftDaysInCurrMonth() < dayCost;
			if (flag)
			{
				TaiwuDomain.Logger.Warn("You don't have enough days in this month");
			}
			else
			{
				bool flag2 = intelligenceCost > curInt;
				if (flag2)
				{
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(60, 2);
					defaultInterpolatedStringHandler.AppendLiteral("You don't have enough intelligence: ");
					defaultInterpolatedStringHandler.AppendFormatted<short>(intelligenceCost);
					defaultInterpolatedStringHandler.AppendLiteral(" needed, current int is ");
					defaultInterpolatedStringHandler.AppendFormatted<short>(curInt);
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				else
				{
					DomainManager.World.AdvanceDaysInMonth(context, dayCost);
					bool flag3 = intelligenceCost > 0;
					if (flag3)
					{
						ref short ptr = ref mainAttributes[5];
						ptr -= intelligenceCost;
						this._taiwuChar.SetCurrMainAttributes(mainAttributes, context);
					}
					short maxProgress = GlobalConfig.Instance.MaxActiveReadingProgress;
					short oldProgress = DomainManager.Extra.GetActiveReadingProgress();
					int newProgress = (int)(oldProgress + 1);
					bool flag4 = newProgress > (int)maxProgress;
					if (!flag4)
					{
						DomainManager.Extra.SetActiveReadingProgress((short)newProgress, context);
						int efficiency = (int)GlobalConfig.Instance.ActiveReadProgressAffectedEfficiency[(int)(oldProgress / 10)];
						bool isTen = newProgress % 10 == 0;
						bool flag5 = isTen;
						if (flag5)
						{
							this.MakeReadingProgressActuallyWork(context, efficiency);
						}
					}
				}
			}
		}

		// Token: 0x060011D5 RID: 4565 RVA: 0x0011B028 File Offset: 0x00119228
		public void ClearActiveReadingProgressOnMonthChange(DataContext context)
		{
			short nowProgress = DomainManager.Extra.GetActiveReadingProgress();
			int newProgress = (int)(nowProgress % 10);
			DomainManager.Extra.SetActiveReadingProgress((short)newProgress, context);
		}

		// Token: 0x060011D6 RID: 4566 RVA: 0x0011B054 File Offset: 0x00119254
		public void GenerateAvailableReadingStrategies(DataContext context)
		{
			bool flag = !this._curReadingBook.IsValid();
			if (!flag)
			{
				SByteList result = SByteList.Create();
				bool flag2 = DomainManager.TutorialChapter.InGuiding && DomainManager.TutorialChapter.GetTutorialChapter() == 6;
				if (flag2)
				{
					bool flag3 = this._curReadingBook.TemplateId == 870;
					if (flag3)
					{
						for (int i = 0; i < 9; i++)
						{
							result.Items.Add(18);
						}
						DomainManager.Extra.SetAvailableReadingStrategies(context, this._curReadingBook.Id, result);
						return;
					}
				}
				List<List<sbyte>> groupedResult = new List<List<sbyte>>();
				for (int j = 0; j < 3; j++)
				{
					groupedResult.Add(new List<sbyte>());
				}
				ItemKey[] referenceBooks = this._referenceBooks;
				bool flag4 = referenceBooks != null && referenceBooks.Length != 0;
				if (flag4)
				{
					foreach (ItemKey referenceBookItemKey in referenceBooks)
					{
						bool flag5 = !referenceBookItemKey.IsValid();
						if (!flag5)
						{
							short lifeSkillTid = Config.SkillBook.Instance[referenceBookItemKey.TemplateId].LifeSkillTemplateId;
							bool flag6 = lifeSkillTid < 0;
							if (!flag6)
							{
								sbyte strategyTid = this.DrawOneStrategyByBook(context.Random, lifeSkillTid);
								bool flag7 = strategyTid == -1;
								if (!flag7)
								{
									groupedResult[(int)(ReadingStrategy.Instance[strategyTid].ExtractGroup - 1)].Add(strategyTid);
								}
							}
						}
					}
				}
				List<sbyte> configGroup = new List<sbyte>();
				List<short> weightList = new List<short>();
				for (int k = 0; k < 3; k++)
				{
					configGroup.Clear();
					weightList.Clear();
					foreach (ReadingStrategyItem config in ((IEnumerable<ReadingStrategyItem>)ReadingStrategy.Instance))
					{
						sbyte id = config.TemplateId;
						bool flag8 = (int)(config.ExtractGroup - 1) == k;
						if (flag8)
						{
							configGroup.Add(id);
							weightList.Add(config.ExtractWeight);
						}
					}
					while (groupedResult[k].Count < 3)
					{
						int randIndex = RandomUtils.GetRandomIndex(weightList, context.Random);
						sbyte drawnConfigIndex = configGroup[randIndex];
						groupedResult[k].Add(drawnConfigIndex);
					}
				}
				foreach (List<sbyte> group in groupedResult)
				{
					result.Items.AddRange(group);
				}
				bool isEquipedTargetSkill = DomainManager.Extra.IsProfessionalSkillUnlocked(4, 1);
				bool flag9 = isEquipedTargetSkill;
				if (flag9)
				{
					int seniority = DomainManager.Extra.GetProfessionData(4).Seniority;
					int extraCount = ProfessionData.SeniorityToExtraReadingLoopingStrategyCount(seniority);
					for (int l = 0; l < extraCount; l++)
					{
						int strategyTid2 = context.Random.Next(ReadingStrategy.Instance.Count - 1);
						result.Items.Add((sbyte)strategyTid2);
					}
				}
				DomainManager.Extra.SetAvailableReadingStrategies(context, this._curReadingBook.Id, result);
			}
		}

		// Token: 0x060011D7 RID: 4567 RVA: 0x0011B3B4 File Offset: 0x001195B4
		private sbyte DrawOneStrategyByBook(IRandomSource randomSource, short lifeSkillTid)
		{
			Config.LifeSkillItem config = LifeSkill.Instance[lifeSkillTid];
			List<byte> configPossibleStrategies = config.ProvidedReadingStrategies;
			bool flag = configPossibleStrategies == null || configPossibleStrategies.Count == 0;
			sbyte result;
			if (flag)
			{
				result = -1;
			}
			else
			{
				List<short> weights = new List<short>();
				foreach (byte strategyTid in configPossibleStrategies)
				{
					weights.Add(ReadingStrategy.Instance[(int)strategyTid].ExtractWeight);
				}
				int index = RandomUtils.GetRandomIndex(weights, randomSource);
				result = (sbyte)configPossibleStrategies[index];
			}
			return result;
		}

		// Token: 0x060011D8 RID: 4568 RVA: 0x0011B464 File Offset: 0x00119664
		[DomainMethod]
		public List<sbyte> GetCurrentBookAvailableReadingStrategies(DataContext context)
		{
			return DomainManager.Extra.GetElement_AvailableReadingStrategyMap(this._curReadingBook.Id).Items;
		}

		// Token: 0x060011D9 RID: 4569 RVA: 0x0011B490 File Offset: 0x00119690
		public IEnumerable<KeyValuePair<ItemKey, ReadingBookStrategies>> GetAllReadingBooks()
		{
			return this._readingBooks;
		}

		// Token: 0x060011DA RID: 4570 RVA: 0x0011B4A8 File Offset: 0x001196A8
		public ValueTuple<bool, int> ReadSkillBookPage(DataContext context, GameData.Domains.Item.SkillBook book, byte combatSkillBookInternalIndex, int speed, bool isCombatSkill, ref int remainingSpeedPercent, ref byte readingPage)
		{
			short skillTemplateId = isCombatSkill ? book.GetCombatSkillTemplateId() : book.GetLifeSkillTemplateId();
			TaiwuCombatSkill combatSkill = this.GetTaiwuCombatSkill(skillTemplateId);
			TaiwuLifeSkill lifeSkill = this.GetTaiwuLifeSkill(skillTemplateId);
			TaiwuSkill taiwuSkill2;
			if (!isCombatSkill)
			{
				TaiwuSkill taiwuSkill = lifeSkill;
				taiwuSkill2 = taiwuSkill;
			}
			else
			{
				TaiwuSkill taiwuSkill = combatSkill;
				taiwuSkill2 = taiwuSkill;
			}
			TaiwuSkill skill = taiwuSkill2;
			sbyte readingProgress = skill.GetBookPageReadingProgress(combatSkillBookInternalIndex);
			int addingProgress = speed * remainingSpeedPercent / 100;
			bool pageComplete = this.OfflineAddReadingProgress(skill, combatSkillBookInternalIndex, addingProgress);
			int addedProgress = (int)(skill.GetBookPageReadingProgress(combatSkillBookInternalIndex) - readingProgress);
			if (isCombatSkill)
			{
				this.SetTaiwuCombatSkill(context, skillTemplateId, combatSkill);
				bool flag = pageComplete;
				if (flag)
				{
					this.SetCombatSkillPageComplete(context, book, combatSkillBookInternalIndex);
				}
			}
			else
			{
				this.SetTaiwuLifeSkill(context, skillTemplateId, lifeSkill);
				bool flag2 = pageComplete;
				if (flag2)
				{
					this.SetLifeSkillPageComplete(context, book, combatSkillBookInternalIndex);
				}
			}
			remainingSpeedPercent -= addedProgress * 100 / speed;
			readingPage += 1;
			return new ValueTuple<bool, int>(pageComplete, addedProgress);
		}

		// Token: 0x060011DB RID: 4571 RVA: 0x0011B584 File Offset: 0x00119784
		[DomainMethod]
		public List<short> GetNewUnlockedDebateStrategyList()
		{
			bool flag = this._unlockedDebateStrategyList.Count <= 0;
			List<short> result;
			if (flag)
			{
				result = null;
			}
			else
			{
				List<short> list = new List<short>(this._unlockedDebateStrategyList);
				this._unlockedDebateStrategyList.Clear();
				result = list;
			}
			return result;
		}

		// Token: 0x060011DC RID: 4572 RVA: 0x0011B5C8 File Offset: 0x001197C8
		[DomainMethod]
		public void GmCmd_ShowUnlockedDebateStrategy(short start, short end)
		{
			bool flag = start < 0;
			if (!flag)
			{
				bool flag2 = end > start;
				if (flag2)
				{
					for (short i = start; i <= end; i += 1)
					{
						bool flag3 = (int)i >= DebateStrategy.Instance.Count;
						if (!flag3)
						{
							bool flag4 = !this._unlockedDebateStrategyList.Contains(i);
							if (flag4)
							{
								this._unlockedDebateStrategyList.Add(i);
							}
						}
					}
				}
				else
				{
					bool flag5 = !this._unlockedDebateStrategyList.Contains(start);
					if (flag5)
					{
						this._unlockedDebateStrategyList.Add(start);
					}
				}
				GameDataBridge.AddDisplayEvent(DisplayEventType.UnlockLifeSkillCombatStrategy);
			}
		}

		// Token: 0x060011DD RID: 4573 RVA: 0x0011B66B File Offset: 0x0011986B
		public void SetNeiliAllocationTypeRestriction(DataContext context, byte allocationType, bool isRestricted)
		{
			this._neiliAllocationTypeRestriction = (byte)(isRestricted ? ((int)this._neiliAllocationTypeRestriction | 1 << (int)allocationType) : ((int)this._neiliAllocationTypeRestriction & ~(1 << (int)allocationType)));
			this.SetNeiliAllocationTypeRestriction(this._neiliAllocationTypeRestriction, context);
		}

		// Token: 0x060011DE RID: 4574 RVA: 0x0011B6A4 File Offset: 0x001198A4
		public bool IsNeiliAllocationTypeRestricted(byte allocationType)
		{
			return (this._neiliAllocationTypeRestriction >> (int)allocationType & 1) == 1;
		}

		// Token: 0x060011DF RID: 4575 RVA: 0x0011B6C6 File Offset: 0x001198C6
		public void ClearAllTemporaryRestrictions(DataContext context)
		{
			this.SetNeiliAllocationTypeRestriction(0, context);
			this.SetHealingInnerInjuryRestriction(false, context);
			this.SetHealingOuterInjuryRestriction(false, context);
		}

		// Token: 0x060011E0 RID: 4576 RVA: 0x0011B6E4 File Offset: 0x001198E4
		public unsafe short GetAttainmentWithSectApprovalBonus(sbyte orgTemplateId, short currAttainment, short requiredAttainment)
		{
			bool flag = orgTemplateId == 0;
			short result;
			if (flag)
			{
				result = currAttainment;
			}
			else
			{
				SectApprovingEffectItem config = SectApprovingEffect.Instance[(int)(orgTemplateId - 1)];
				LifeSkillShorts attainments = *this._taiwuChar.GetLifeSkillAttainments();
				short maxAttainment = currAttainment;
				foreach (sbyte lifeSkillType in config.RequirementSubstitutions)
				{
					bool flag2 = maxAttainment < *(ref attainments.Items.FixedElementField + (IntPtr)lifeSkillType * 2);
					if (flag2)
					{
						maxAttainment = *(ref attainments.Items.FixedElementField + (IntPtr)lifeSkillType * 2);
					}
				}
				result = maxAttainment;
			}
			return result;
		}

		// Token: 0x060011E1 RID: 4577 RVA: 0x0011B7A0 File Offset: 0x001199A0
		public unsafe short GetQualificationWithSectApprovalBonus(sbyte orgTemplateId, short currQualification, short requiredQualification)
		{
			sbyte b;
			return GameData.Domains.Taiwu.SharedMethods.GetQualificationWithSectApprovalBonus(orgTemplateId, currQualification, *this._taiwuChar.GetLifeSkillQualifications(), out b);
		}

		// Token: 0x060011E2 RID: 4578 RVA: 0x0011B7C8 File Offset: 0x001199C8
		public unsafe short GetAttainmentWithSectApprovalBonus(sbyte orgTemplateId, short currAttainment)
		{
			bool flag = orgTemplateId == 0;
			short result;
			if (flag)
			{
				result = currAttainment;
			}
			else
			{
				SectApprovingEffectItem config = SectApprovingEffect.Instance[(int)(orgTemplateId - 1)];
				LifeSkillShorts attainments = *this._taiwuChar.GetLifeSkillAttainments();
				short maxAttainment = currAttainment;
				foreach (sbyte lifeSkillType in config.RequirementSubstitutions)
				{
					bool flag2 = maxAttainment < *(ref attainments.Items.FixedElementField + (IntPtr)lifeSkillType * 2);
					if (flag2)
					{
						maxAttainment = *(ref attainments.Items.FixedElementField + (IntPtr)lifeSkillType * 2);
					}
				}
				result = maxAttainment;
			}
			return result;
		}

		// Token: 0x060011E3 RID: 4579 RVA: 0x0011B884 File Offset: 0x00119A84
		public int CalcReadingSpeedSectApprovalFactor(sbyte orgTemplateId, sbyte combatSkillDirection, sbyte pageId, bool isInBattle)
		{
			bool flag = orgTemplateId == 0;
			int result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				short settlementId = DomainManager.Organization.GetSettlementIdByOrgTemplateId(orgTemplateId);
				short sectApprovingRate = DomainManager.Organization.GetElement_Sects(settlementId).CalcApprovingRate();
				SectApprovingEffectItem config = SectApprovingEffect.Instance[(int)(orgTemplateId - 1)];
				short behaviorTypeBonus = config.BehaviorTypeBonuses[(int)this._taiwuChar.GetBehaviorType()];
				int directionBonus = (int)((pageId >= 1) ? config.CombatSkillDirectionBonuses[(int)combatSkillDirection] : 100);
				int genderBonus = (int)((pageId >= 1 && !isInBattle) ? ((this._taiwuChar.GetGender() == 1) ? config.PageBonusesOfMale[(int)(pageId - 1)] : config.PageBonusesOfFemale[(int)(pageId - 1)]) : 100);
				int totalFactor = (int)behaviorTypeBonus * directionBonus * genderBonus / 10000;
				bool flag2 = sectApprovingRate >= 400;
				if (flag2)
				{
					totalFactor += 25;
				}
				result = totalFactor - 100;
			}
			return result;
		}

		// Token: 0x060011E4 RID: 4580 RVA: 0x0011B958 File Offset: 0x00119B58
		public int CalcReadingBonusRateFactorInCombat(ItemKey itemKey)
		{
			SkillBookItem bookCfg = Config.SkillBook.Instance[itemKey.TemplateId];
			bool flag = bookCfg == null || bookCfg.ItemSubType != 1001;
			int result;
			if (flag)
			{
				result = 100;
			}
			else
			{
				sbyte sectId = Config.CombatSkill.Instance[bookCfg.CombatSkillTemplateId].SectId;
				TaiwuCombatSkill combatSkill = this.GetTaiwuCombatSkill(bookCfg.CombatSkillTemplateId);
				GameData.Domains.Item.SkillBook book = DomainManager.Item.GetElement_SkillBooks(itemKey.Id);
				ReadingBookStrategies strategies = this.GetCurReadingStrategies();
				byte curReadingPage = DomainManager.Taiwu.GetCurrentReadingPage(book, strategies, combatSkill);
				sbyte direction = (curReadingPage == 0) ? SkillBookStateHelper.GetOutlinePageType(book.GetPageTypes()) : SkillBookStateHelper.GetNormalPageType(book.GetPageTypes(), curReadingPage);
				result = this.CalcReadingBonusRateFactorInCombat(sectId, direction, curReadingPage);
			}
			return result;
		}

		// Token: 0x060011E5 RID: 4581 RVA: 0x0011BA18 File Offset: 0x00119C18
		public int CalcReadingBonusRateFactorInCombat(sbyte orgTemplateId, sbyte combatSkillDirection, byte pageId)
		{
			bool flag = orgTemplateId == 0;
			int result;
			if (flag)
			{
				result = 100;
			}
			else
			{
				short settlementId = DomainManager.Organization.GetSettlementIdByOrgTemplateId(orgTemplateId);
				short sectApprovingRate = DomainManager.Organization.GetElement_Sects(settlementId).CalcApprovingRate();
				SectApprovingEffectItem config = SectApprovingEffect.Instance[(int)(orgTemplateId - 1)];
				int totalFactor = (int)((pageId >= 1) ? ((this._taiwuChar.GetGender() == 1) ? config.ActualCombatBonusOfMale : config.ActualCombatBonusOfFemale) : 100);
				result = totalFactor;
			}
			return result;
		}

		// Token: 0x060011E6 RID: 4582 RVA: 0x0011BA90 File Offset: 0x00119C90
		public short GetSpiritualDebtFinalCost(short targetSettlementId, short baseCost)
		{
			bool flag = targetSettlementId < 0;
			short result;
			if (flag)
			{
				result = baseCost;
			}
			else
			{
				Settlement settlement = DomainManager.Organization.GetSettlement(targetSettlementId);
				Sect sect = settlement as Sect;
				bool flag2 = sect != null;
				if (flag2)
				{
					short approvingRate = sect.CalcApprovingRate();
					bool flag3 = approvingRate >= 800;
					if (flag3)
					{
						return baseCost / 2;
					}
				}
				result = baseCost;
			}
			return result;
		}

		// Token: 0x060011E7 RID: 4583 RVA: 0x0011BAF0 File Offset: 0x00119CF0
		[DomainMethod]
		public List<SettlementDisplayData> GetAllVisitedSettlements()
		{
			List<SettlementDisplayData> ret = new List<SettlementDisplayData>();
			foreach (short one in this._visitedSettlements)
			{
				ret.Add(DomainManager.Organization.GetDisplayData(one));
			}
			return ret;
		}

		// Token: 0x060011E8 RID: 4584 RVA: 0x0011BB60 File Offset: 0x00119D60
		public void TryAddVisitedSettlement(short settlementId, DataContext context)
		{
			bool flag = this._visitedSettlements.Contains(settlementId);
			if (!flag)
			{
				this._visitedSettlements.Add(settlementId);
				this.SetVisitedSettlements(this._visitedSettlements, context);
				Location settlementLocation = DomainManager.Organization.GetSettlement(settlementId).GetLocation();
				EMapBlockType settlementType = DomainManager.Map.GetBlock(settlementLocation).GetConfig().Type;
				bool flag2 = settlementType <= EMapBlockType.Sect;
				int formulaId = flag2 ? 74 : 75;
				int addSeniority = ProfessionFormula.Instance[formulaId].Calculate();
				DomainManager.Extra.ChangeProfessionSeniority(context, 11, addSeniority, true, false);
			}
		}

		// Token: 0x060011E9 RID: 4585 RVA: 0x0011BC00 File Offset: 0x00119E00
		public SettlementTreasury GetTaiwuTreasury()
		{
			SettlementTreasury treasury;
			return DomainManager.Extra.TryGetElement_SettlementTreasuries(this._taiwuVillageSettlementId, out treasury) ? treasury : new SettlementTreasury();
		}

		// Token: 0x060011EA RID: 4586 RVA: 0x0011BC2E File Offset: 0x00119E2E
		public void SetTaiwuTreasury(DataContext context, SettlementTreasury treasury)
		{
			DomainManager.Extra.SetSettlementTreasuries(context, this._taiwuVillageSettlementId, treasury);
		}

		// Token: 0x060011EB RID: 4587 RVA: 0x0011BC44 File Offset: 0x00119E44
		public void StoreItemInTreasury(DataContext context, ItemKey itemKey, int amount, bool offLine = false)
		{
			Tester.Assert(itemKey.IsValid(), "");
			Tester.Assert(amount > 0, "");
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			treasury.Inventory.OfflineAdd(itemKey, amount);
			DomainManager.Item.SetOwner(itemKey, ItemOwnerType.Treasury, (int)this._taiwuVillageSettlementId);
			bool flag = !offLine;
			if (flag)
			{
				this.SetTaiwuTreasury(context, treasury);
			}
			Events.RaiseTaiwuItemModified(context, itemKey);
		}

		// Token: 0x060011EC RID: 4588 RVA: 0x0011BCB8 File Offset: 0x00119EB8
		public void TakeItemFromTreasury(DataContext context, ItemKey itemKey, int amount, bool deleteItem, bool offLine = false)
		{
			Tester.Assert(itemKey.IsValid(), "");
			Tester.Assert(amount > 0, "");
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			treasury.Inventory.OfflineRemove(itemKey, amount);
			DomainManager.Item.RemoveOwner(itemKey, ItemOwnerType.Treasury, (int)this._taiwuVillageSettlementId);
			bool flag = !offLine;
			if (flag)
			{
				this.SetTaiwuTreasury(context, treasury);
			}
			if (deleteItem)
			{
				DomainManager.Item.RemoveItem(context, itemKey);
			}
		}

		// Token: 0x060011ED RID: 4589 RVA: 0x0011BD38 File Offset: 0x00119F38
		public void StoreResourceInTreasury(DataContext context, sbyte resourceType, int amount)
		{
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			treasury.Resources.Add(resourceType, amount);
			this.SetTaiwuTreasury(context, treasury);
		}

		// Token: 0x060011EE RID: 4590 RVA: 0x0011BD64 File Offset: 0x00119F64
		public void TakeResourceFromTreasury(DataContext context, sbyte resourceType, int amount)
		{
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			treasury.Resources.Subtract(resourceType, amount);
			this.SetTaiwuTreasury(context, treasury);
		}

		// Token: 0x060011EF RID: 4591 RVA: 0x0011BD90 File Offset: 0x00119F90
		public int GetTreasuryItemCount(ItemKey itemKey)
		{
			SettlementTreasury settlementTreasury = this.GetTaiwuTreasury();
			int amount;
			settlementTreasury.Inventory.Items.TryGetValue(itemKey, out amount);
			return amount;
		}

		// Token: 0x060011F0 RID: 4592 RVA: 0x0011BDC0 File Offset: 0x00119FC0
		public void VillagerStoreItemInTreasury(DataContext context, GameData.Domains.Character.Character character, ItemKey itemKey, int amount, bool addLifeSkillRecord = true)
		{
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			ItemBase item = DomainManager.Item.GetBaseItem(itemKey);
			int worth = treasury.CalcAdjustedWorth(item.GetItemSubType(), item.GetValue()) * amount;
			item.SetOwner(ItemOwnerType.Treasury, (int)this._taiwuVillageSettlementId);
			treasury.Inventory.OfflineAdd(itemKey, amount);
			treasury.OfflineChangeContribution(character, worth);
			LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
			int charId = character.GetId();
			int currDate = DomainManager.World.GetCurrDate();
			bool flag = worth > 0 && addLifeSkillRecord;
			if (flag)
			{
				lifeRecordCollection.AddTaiwuVillagerStorageItem(charId, currDate, itemKey.ItemType, itemKey.TemplateId);
			}
			TaiwuVillageStoragesRecordCollection collection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			collection.AddStorageItem(currDate, TaiwuVillageStorageType.Treasury, charId, itemKey.ItemType, itemKey.TemplateId);
			this.SetTaiwuTreasury(context, treasury);
			DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, collection);
			Events.RaiseTaiwuItemModified(context, itemKey);
		}

		// Token: 0x060011F1 RID: 4593 RVA: 0x0011BEA8 File Offset: 0x0011A0A8
		public void VillagerTakeItemFromTreasury(DataContext context, GameData.Domains.Character.Character character, ItemKey itemKey, int amount)
		{
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			ItemBase item = DomainManager.Item.GetBaseItem(itemKey);
			int worth = treasury.CalcAdjustedWorth(item.GetItemSubType(), item.GetValue()) * amount;
			item.RemoveOwner(ItemOwnerType.Treasury, (int)this._taiwuVillageSettlementId);
			treasury.Inventory.OfflineRemove(itemKey, amount);
			treasury.OfflineChangeContribution(character, -worth);
			LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
			int charId = character.GetId();
			int currDate = DomainManager.World.GetCurrDate();
			bool flag = worth > 0;
			if (flag)
			{
				lifeRecordCollection.AddTaiwuVillagerTakeItem(charId, currDate, itemKey.ItemType, itemKey.TemplateId);
			}
			TaiwuVillageStoragesRecordCollection collection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			collection.AddTakeItem(currDate, TaiwuVillageStorageType.Treasury, charId, itemKey.ItemType, itemKey.TemplateId);
			this.SetTaiwuTreasury(context, treasury);
			DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, collection);
		}

		// Token: 0x060011F2 RID: 4594 RVA: 0x0011BF84 File Offset: 0x0011A184
		public void VillagerStoreResourceInTreasury(DataContext context, GameData.Domains.Character.Character character, sbyte resourceType, int amount)
		{
			int worth = DomainManager.Organization.CalcResourceContribution(16, resourceType, amount);
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			treasury.Resources.Add(resourceType, amount);
			treasury.OfflineChangeContribution(character, worth);
			this.SetTaiwuTreasury(context, treasury);
			LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
			int charId = character.GetId();
			int currDate = DomainManager.World.GetCurrDate();
			bool flag = worth > 0;
			if (flag)
			{
				lifeRecordCollection.AddTaiwuVillagerStorageResources(charId, currDate, amount, resourceType);
			}
			TaiwuVillageStoragesRecordCollection recordCollection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			recordCollection.AddStorageResources(currDate, TaiwuVillageStorageType.Treasury, charId, amount, resourceType);
			DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, recordCollection);
		}

		// Token: 0x060011F3 RID: 4595 RVA: 0x0011C028 File Offset: 0x0011A228
		public void VillagerTakeResourceFromTreasury(DataContext context, GameData.Domains.Character.Character character, sbyte resourceType, int amount)
		{
			int worth = DomainManager.Organization.CalcResourceContribution(16, resourceType, amount);
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			treasury.Resources.Subtract(resourceType, amount);
			treasury.OfflineChangeContribution(character, -worth);
			this.SetTaiwuTreasury(context, treasury);
			LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
			int charId = character.GetId();
			int currDate = DomainManager.World.GetCurrDate();
			bool flag = worth > 0;
			if (flag)
			{
				lifeRecordCollection.AddTaiwuVillagerTakeResources(charId, currDate, amount, resourceType);
			}
			TaiwuVillageStoragesRecordCollection villageRecordCollection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			villageRecordCollection.AddTakeResources(currDate, TaiwuVillageStorageType.Treasury, charId, amount, resourceType);
			DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, villageRecordCollection);
		}

		// Token: 0x060011F4 RID: 4596 RVA: 0x0011C0D0 File Offset: 0x0011A2D0
		public int CalcItemContribution(ItemKey itemKey, int amount)
		{
			short itemSubType = ItemTemplateHelper.GetItemSubType(itemKey.ItemType, itemKey.TemplateId);
			int value = DomainManager.Item.GetValue(itemKey);
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			return treasury.CalcAdjustedWorth(itemSubType, value) * amount * GlobalConfig.Instance.ItemContributionPercent / 100;
		}

		// Token: 0x060011F5 RID: 4597 RVA: 0x0011C120 File Offset: 0x0011A320
		public void UpdateTaiwuTreasury(DataContext context)
		{
			int currDate = DomainManager.World.GetCurrDate();
			TaiwuVillageStoragesRecordCollection collection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			collection.Clear();
			for (sbyte i = 0; i < 5; i += 1)
			{
				collection.AddClearRecord(currDate, (TaiwuVillageStorageType)i);
			}
			collection.AddClearRecord(currDate, TaiwuVillageStorageType.Warehouse);
			DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, collection);
		}

		// Token: 0x060011F6 RID: 4598 RVA: 0x0011C17C File Offset: 0x0011A37C
		public void ChangeVillagerWorkBuildingBlockIndex(int charId, short buildingBlockIndex, DataContext context)
		{
			this._villagerWork[charId].BuildingBlockIndex = buildingBlockIndex;
			this.SetElement_VillagerWork(charId, this._villagerWork[charId], context);
		}

		// Token: 0x060011F7 RID: 4599 RVA: 0x0011C1A8 File Offset: 0x0011A3A8
		private void InitializeVillagerWorkLocations()
		{
			foreach (VillagerWorkData workData in this._villagerWork.Values)
			{
				bool flag = VillagerWorkType.IsWorkOnMap(workData.WorkType);
				if (flag)
				{
					this._villagerWorkLocations.Add(new Location(workData.AreaId, workData.BlockId), default(VoidValue));
				}
			}
		}

		// Token: 0x060011F8 RID: 4600 RVA: 0x0011C234 File Offset: 0x0011A434
		[DomainMethod]
		public bool SetVillagerCollectResourceWork(DataContext context, int charId, short areaId, short blockId, sbyte resourceType)
		{
			this.StopVillagerWorkOptional(context, areaId, blockId, -1, false);
			this.SetVillagerWork(context, charId, new VillagerWorkData(charId, 10, areaId, blockId)
			{
				ResourceType = resourceType
			}, false);
			return true;
		}

		// Token: 0x060011F9 RID: 4601 RVA: 0x0011C274 File Offset: 0x0011A474
		[DomainMethod]
		public sbyte GetVillagerCollectStorageType(DataContext context, int charId)
		{
			VillagerWorkData workData;
			this._villagerWork.TryGetValue(charId, out workData);
			VillagerRoleFarmer farmer = workData.GetVillagerRole() as VillagerRoleFarmer;
			bool flag = farmer != null;
			sbyte result;
			if (flag)
			{
				result = farmer.FarmerStorageTypes[(int)workData.ResourceType];
			}
			else
			{
				result = -1;
			}
			return result;
		}

		// Token: 0x060011FA RID: 4602 RVA: 0x0011C2BC File Offset: 0x0011A4BC
		[DomainMethod]
		public bool SetVillagerCollectStorageType(DataContext context, int charId, sbyte villagerRoleStorageType)
		{
			VillagerWorkData workData;
			this._villagerWork.TryGetValue(charId, out workData);
			VillagerRoleFarmer farmer = workData.GetVillagerRole() as VillagerRoleFarmer;
			bool flag = farmer != null;
			if (flag)
			{
				farmer.FarmerStorageTypes[(int)workData.ResourceType] = villagerRoleStorageType;
				DomainManager.Extra.SetVillagerRole(context, charId);
			}
			return true;
		}

		// Token: 0x060011FB RID: 4603 RVA: 0x0011C310 File Offset: 0x0011A510
		[DomainMethod]
		public bool SetVillagerCollectTributeWork(DataContext context, int charId, short areaId, short blockId)
		{
			this.StopVillagerWorkOptional(context, areaId, blockId, 11, false);
			VillagerWorkData workData = new VillagerWorkData(charId, 11, areaId, blockId);
			this.SetVillagerWork(context, charId, workData, false);
			return true;
		}

		// Token: 0x060011FC RID: 4604 RVA: 0x0011C348 File Offset: 0x0011A548
		[DomainMethod]
		public bool SetVillagerKeepGraveWork(DataContext context, int charId, short areaId, short blockId, int graveId)
		{
			this.StopVillagerWorkOptional(context, areaId, blockId, 12, false);
			this.SetVillagerWork(context, charId, new VillagerWorkData(charId, 12, areaId, blockId)
			{
				GraveId = graveId
			}, false);
			return true;
		}

		// Token: 0x060011FD RID: 4605 RVA: 0x0011C388 File Offset: 0x0011A588
		[DomainMethod]
		public bool SetVillagerIdleWork(DataContext context, int charId, short areaId, short blockId)
		{
			this.StopVillagerWorkOptional(context, areaId, blockId, 13, false);
			VillagerWorkData workData = new VillagerWorkData(charId, 13, areaId, blockId);
			this.SetVillagerWork(context, charId, workData, false);
			return true;
		}

		// Token: 0x060011FE RID: 4606 RVA: 0x0011C3C0 File Offset: 0x0011A5C0
		[DomainMethod]
		public bool SetVillagerMigrateWork(DataContext context, int charId, short areaId, short blockId, sbyte resourceType)
		{
			this.StopVillagerWorkOptional(context, areaId, blockId, 14, false);
			VillagerWorkData workData = new VillagerWorkData(charId, 14, areaId, blockId);
			workData.ResourceType = resourceType;
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(charId);
			bool flag = villagerRole == null;
			bool result;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("character ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(charId);
				defaultInterpolatedStringHandler.AppendLiteral(" is not assigned as any villager role.");
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				result = false;
			}
			else
			{
				this.SetVillagerWork(context, charId, workData, false);
				result = true;
			}
			return result;
		}

		// Token: 0x060011FF RID: 4607 RVA: 0x0011C45C File Offset: 0x0011A65C
		[DomainMethod]
		public bool SetVillagerDevelopWork(DataContext context, int charId, short areaId, short blockId, sbyte resourceType, short index)
		{
			this.StopVillagerWorkOptional(context, areaId, blockId, -1, false);
			return true;
		}

		// Token: 0x06001200 RID: 4608 RVA: 0x0011C47C File Offset: 0x0011A67C
		[DomainMethod]
		[Obsolete("使用StopVillagerWorkOptional代替")]
		public bool StopVillagerWork(DataContext context, short areaId, short blockId, sbyte workType)
		{
			return this.StopVillagerWorkOptional(context, areaId, blockId, workType, true);
		}

		// Token: 0x06001201 RID: 4609 RVA: 0x0011C49C File Offset: 0x0011A69C
		[DomainMethod]
		public bool StopVillagerWorkOptional(DataContext context, short areaId, short blockId, sbyte workType, bool removeUnlockedState)
		{
			foreach (KeyValuePair<int, VillagerWorkData> work in this._villagerWork)
			{
				bool flag = (work.Value.WorkType == workType || workType == -1) && work.Value.AreaId == areaId && work.Value.BlockId == blockId;
				if (flag)
				{
					this.RemoveVillagerWork(context, work.Key, removeUnlockedState);
					return true;
				}
			}
			return false;
		}

		// Token: 0x06001202 RID: 4610 RVA: 0x0011C544 File Offset: 0x0011A744
		[DomainMethod]
		[Obsolete("使用StopVillagerWorkOptional代替")]
		public bool StopVillagerCollectResourceWork(DataContext context, short areaId, short blockId)
		{
			foreach (KeyValuePair<int, VillagerWorkData> work in this._villagerWork)
			{
				bool flag = work.Value.WorkType == 10 && work.Value.AreaId == areaId && work.Value.BlockId == blockId;
				if (flag)
				{
					this.RemoveVillagerWork(context, work.Key, false);
					return true;
				}
			}
			return false;
		}

		// Token: 0x06001203 RID: 4611 RVA: 0x0011C5E4 File Offset: 0x0011A7E4
		public VillagerWorkData GetVillagerMapWorkData(short areaId, short blockId, sbyte workType)
		{
			Tester.Assert(VillagerWorkType.IsWorkOnMap(workType), "");
			bool flag = !this._villagerWorkLocations.ContainsKey(new Location(areaId, blockId));
			VillagerWorkData result;
			if (flag)
			{
				result = null;
			}
			else
			{
				foreach (VillagerWorkData workData in this._villagerWork.Values)
				{
					bool flag2 = workData.WorkType == workType && workData.AreaId == areaId && workData.BlockId == blockId;
					if (flag2)
					{
						return workData;
					}
				}
				result = null;
			}
			return result;
		}

		// Token: 0x06001204 RID: 4612 RVA: 0x0011C698 File Offset: 0x0011A898
		[DomainMethod]
		public List<VillagerWorkData> GetCollectResourceWorkDataList(List<Location> locationList)
		{
			List<VillagerWorkData> dataList = new List<VillagerWorkData>();
			foreach (VillagerWorkData workData in this._villagerWork.Values)
			{
				bool flag = workData.WorkType == 10 && locationList.Contains(new Location(workData.AreaId, workData.BlockId));
				if (flag)
				{
					dataList.Add(workData);
				}
			}
			return dataList;
		}

		// Token: 0x06001205 RID: 4613 RVA: 0x0011C72C File Offset: 0x0011A92C
		public void GetKeptGraves(HashSet<int> keptGraveSet)
		{
			keptGraveSet.Clear();
			foreach (VillagerWorkData workData in this._villagerWork.Values)
			{
				bool flag = workData.WorkType == 12;
				if (flag)
				{
					keptGraveSet.Add(workData.GraveId);
				}
			}
		}

		// Token: 0x06001206 RID: 4614 RVA: 0x0011C7A4 File Offset: 0x0011A9A4
		[DomainMethod]
		public void ExpelVillager(DataContext context, int charId)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			bool flag = character.GetAgeGroup() == 0;
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(25, 1);
				defaultInterpolatedStringHandler.AppendLiteral("You cannot expel a baby ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(charId);
				defaultInterpolatedStringHandler.AppendLiteral(".");
				throw new ArgumentException(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			bool flag2 = this.IsInGroup(charId);
			if (flag2)
			{
				this.LeaveGroup(context, charId, true, true, true);
			}
			DomainManager.Organization.JoinNearbyVillageTownAsBeggar(context, character, -1);
			Location characterLocation = character.GetLocation();
			bool flag3 = characterLocation.IsValid();
			if (flag3)
			{
				MapBlockData blockData = DomainManager.Map.GetBlock(characterLocation);
				DomainManager.Map.SetBlockData(context, blockData);
			}
			LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
			int currDate = DomainManager.World.GetCurrDate();
			lifeRecordCollection.AddExpelVillager(this._taiwuCharId, currDate, charId, this._taiwuChar.GetLocation());
			sbyte behaviorType = character.GetBehaviorType();
			bool flag4 = behaviorType == 0 || behaviorType - 3 <= 1;
			bool flag5 = flag4;
			if (flag5)
			{
				GameData.Domains.Character.Character.ApplyAddRelation_Enemy(context, character, this._taiwuChar, true, 0);
			}
			EventHelper.ChangeFavorabilityOptional(character, this._taiwuChar, GlobalConfig.Instance.FavorabilityChangeOnExpel[(int)behaviorType], 4);
			InstantNotificationCollection instantNotifications = DomainManager.World.GetInstantNotificationCollection();
			instantNotifications.AddLeaveTaiwuVillage(charId);
		}

		// Token: 0x06001207 RID: 4615 RVA: 0x0011C8F8 File Offset: 0x0011AAF8
		public Location GetTaiwuVillageLocation()
		{
			return DomainManager.Building.GetTaiwuBuildingAreas()[0];
		}

		// Token: 0x06001208 RID: 4616 RVA: 0x0011C91C File Offset: 0x0011AB1C
		[DomainMethod]
		public MapBlockData GetTaiwuVillagerMapBlockData()
		{
			Location location = this.GetTaiwuVillageLocation();
			return DomainManager.Map.GetBlock(location);
		}

		// Token: 0x06001209 RID: 4617 RVA: 0x0011C940 File Offset: 0x0011AB40
		public bool VillagerHasWork(int charId)
		{
			return this._villagerWork.ContainsKey(charId);
		}

		// Token: 0x0600120A RID: 4618 RVA: 0x0011C960 File Offset: 0x0011AB60
		public void MakeVillagerWorkSettlementsVisited(DataContext context)
		{
			MapDomain mapDomain = DomainManager.Map;
			CharacterDomain characterDomain = DomainManager.Character;
			foreach (KeyValuePair<int, VillagerWorkData> workPair in this._villagerWork)
			{
				GameData.Domains.Character.Character workCharacter;
				bool flag = characterDomain.TryGetElement_Objects(workPair.Key, out workCharacter);
				if (flag)
				{
					Location characterLocation = workCharacter.GetLocation();
					bool flag2 = characterLocation.AreaId == workPair.Value.AreaId && characterLocation.BlockId == workPair.Value.BlockId;
					if (flag2)
					{
						MapBlockData currentRootBlock = mapDomain.GetBlock(characterLocation).GetRootBlock();
						MapAreaData areaData = mapDomain.GetElement_Areas((int)characterLocation.AreaId);
						foreach (SettlementInfo settlementInfo in areaData.SettlementInfos)
						{
							bool flag3 = settlementInfo.BlockId == currentRootBlock.BlockId;
							if (flag3)
							{
								this.TryAddVisitedSettlement(settlementInfo.SettlementId, context);
							}
						}
					}
				}
			}
		}

		// Token: 0x0600120B RID: 4619 RVA: 0x0011CA8C File Offset: 0x0011AC8C
		public void SetVillagerWork(DataContext context, int charId, VillagerWorkData workData, bool allowChild = false)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			bool isTutorial = DomainManager.TutorialChapter.InGuiding && DomainManager.TutorialChapter.GetTutorialChapter() == 2;
			bool flag = !allowChild && character.GetPhysiologicalAge() < 16 && !isTutorial;
			if (flag)
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(29, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Cannot send a child to work: ");
				defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(character);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			VillagerWorkData prevWork;
			bool flag2 = this._villagerWork.TryGetValue(charId, out prevWork);
			if (flag2)
			{
				bool flag3 = prevWork.GetVillagerRole() != null && workData.GetVillagerRole() == null;
				if (flag3)
				{
					prevWork.GetVillagerRole().ArrangementTemplateId = -1;
					prevWork.GetVillagerRole().WorkData = null;
					DomainManager.Extra.SetVillagerRole(context, charId);
				}
				this.RemoveVillagerWork(context, charId, true);
			}
			this.AddElement_VillagerWork(charId, workData, context);
			VillagerRoleBase role = DomainManager.Extra.GetVillagerRole(charId);
			bool flag4 = role != null;
			if (flag4)
			{
				role.WorkData = workData;
			}
			switch (workData.WorkType)
			{
			case 0:
				DomainManager.Building.SetBuildingOperator(context, new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), (int)workData.WorkerIndex, charId);
				break;
			case 1:
				DomainManager.Building.SetShopBuildingManager(context, new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), (int)workData.WorkerIndex, charId, true);
				break;
			case 2:
			{
				bool flag5 = workData.GetVillagerRole() == null || workData.GetVillagerRole().ArrangementTemplateId < 0;
				if (flag5)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(27, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Need a role to work a job: ");
					defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(character);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				break;
			}
			default:
				this.AddElement_VillagerWorkLocations(new Location(workData.AreaId, workData.BlockId), default(VoidValue), context);
				break;
			}
			bool flag6 = VillagerWorkType.IsWorkOnMap(workData.WorkType);
			if (flag6)
			{
				DomainManager.Extra.AddLocationMark(context, new Location(workData.AreaId, workData.BlockId));
			}
			character.ActiveExternalRelationState(context, 1);
			bool flag7 = VillagerWorkType.IsWorkOnMap(workData.WorkType) && DomainManager.Extra.IsExtraTaskInProgress(23);
			if (flag7)
			{
				DomainManager.Extra.FinishTriggeredExtraTask(context, 14, 23);
			}
		}

		// Token: 0x0600120C RID: 4620 RVA: 0x0011CCF4 File Offset: 0x0011AEF4
		public void RemoveVillagerWork(DataContext context, int charId, bool removeUnlockedState = true)
		{
			VillagerWorkData oldWorkData;
			bool flag = this._villagerWork.TryGetValue(charId, out oldWorkData);
			if (flag)
			{
				bool flag2 = oldWorkData.GetVillagerRole() != null;
				if (flag2)
				{
					oldWorkData.GetVillagerRole().WorkData = null;
					bool flag3 = oldWorkData.GetVillagerRole().ArrangementTemplateId >= 0;
					if (flag3)
					{
						oldWorkData.GetVillagerRole().ArrangementTemplateId = -1;
						DomainManager.Extra.SetVillagerRole(context, charId);
					}
				}
				sbyte workType = oldWorkData.WorkType;
				sbyte b = workType;
				switch (b)
				{
				case 0:
					DomainManager.Building.SetBuildingOperator(context, new BuildingBlockKey(oldWorkData.AreaId, oldWorkData.BlockId, oldWorkData.BuildingBlockIndex), (int)oldWorkData.WorkerIndex, -1);
					break;
				case 1:
					DomainManager.Building.SetShopBuildingManager(context, new BuildingBlockKey(oldWorkData.AreaId, oldWorkData.BlockId, oldWorkData.BuildingBlockIndex), (int)oldWorkData.WorkerIndex, -1, true);
					break;
				case 2:
					break;
				default:
					if (b != 14)
					{
						this.RemoveElement_VillagerWorkLocations(new Location(oldWorkData.AreaId, oldWorkData.BlockId), context);
					}
					else
					{
						VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(charId);
						VillagerRoleFarmer farmer = villagerRole as VillagerRoleFarmer;
						bool flag4 = farmer != null;
						if (flag4)
						{
							farmer.ResetFailureAccumulation();
							DomainManager.Extra.SetVillagerRole(context, charId);
						}
						this.RemoveElement_VillagerWorkLocations(new Location(oldWorkData.AreaId, oldWorkData.BlockId), context);
					}
					break;
				}
				GameData.Domains.Character.Character character;
				bool flag5 = DomainManager.Character.TryGetElement_Objects(charId, out character);
				if (flag5)
				{
					character.DeactivateExternalRelationState(context, 1);
				}
				this.RemoveElement_VillagerWork(charId, context);
				if (removeUnlockedState)
				{
					DomainManager.Building.TryRemoveUnlockedWorkingVillager(context, charId);
				}
			}
		}

		// Token: 0x0600120D RID: 4621 RVA: 0x0011CE98 File Offset: 0x0011B098
		public Dictionary<int, VillagerWorkData> GetVillagerWorkDict()
		{
			return this._villagerWork;
		}

		// Token: 0x0600120E RID: 4622 RVA: 0x0011CEB0 File Offset: 0x0011B0B0
		public short GetWorkingVillagerCount()
		{
			return (short)this._villagerWork.Count;
		}

		// Token: 0x0600120F RID: 4623 RVA: 0x0011CED0 File Offset: 0x0011B0D0
		public byte GetVillagerWorkStatus(GameData.Domains.Character.Character character)
		{
			int charId = character.GetId();
			byte workStatus = 0;
			bool flag = this._villagerWork.ContainsKey(charId);
			if (flag)
			{
				workStatus = 2;
			}
			bool flag2 = character.GetPhysiologicalAge() < 16;
			if (flag2)
			{
				workStatus = 3;
			}
			bool flag3 = this.IsInGroup(charId);
			if (flag3)
			{
				workStatus = 1;
			}
			bool flag4 = character.IsCompletelyInfected();
			if (flag4)
			{
				workStatus = 4;
			}
			bool flag5 = character.GetKidnapperId() >= 0;
			if (flag5)
			{
				workStatus = 6;
			}
			else
			{
				bool flag6 = character.IsActiveExternalRelationState(4);
				if (flag6)
				{
					bool flag7 = character.GetKidnappingEnemyNestAdventure() != -1;
					if (flag7)
					{
						workStatus = 6;
					}
				}
			}
			Location location;
			bool flag8 = DomainManager.TaiwuEvent.GetGlobalEventArgumentBox().Get<Location>("MainStoryLine_SpiritualWanderPlace_TaiwuVillagersCenter", out location);
			if (flag8)
			{
				workStatus = 5;
			}
			return workStatus;
		}

		// Token: 0x06001210 RID: 4624 RVA: 0x0011CF88 File Offset: 0x0011B188
		[DomainMethod]
		public unsafe List<VillagerStatusDisplayData> GetVillagerStatusDisplayDataList(List<int> charIds)
		{
			bool flag = charIds == null;
			List<VillagerStatusDisplayData> result;
			if (flag)
			{
				result = null;
			}
			else
			{
				List<VillagerStatusDisplayData> villagers = new List<VillagerStatusDisplayData>(charIds.Count);
				foreach (int charId in charIds)
				{
					GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
					byte livingStatus = DomainManager.Building.GetLivingStatus(charId);
					byte workStatus = 0;
					bool flag2 = this._villagerWork.ContainsKey(charId);
					if (flag2)
					{
						workStatus = 2;
					}
					bool flag3 = character.GetPhysiologicalAge() < 16;
					if (flag3)
					{
						workStatus = 3;
					}
					bool flag4 = this.IsInGroup(charId);
					if (flag4)
					{
						workStatus = 1;
					}
					bool flag5 = character.IsCompletelyInfected();
					if (flag5)
					{
						workStatus = 4;
						livingStatus = 3;
					}
					bool flag6 = character.GetKidnapperId() >= 0;
					if (flag6)
					{
						workStatus = 6;
					}
					else
					{
						bool flag7 = character.IsActiveExternalRelationState(4);
						if (flag7)
						{
							bool flag8 = character.GetKidnappingEnemyNestAdventure() != -1;
							if (flag8)
							{
								workStatus = 6;
							}
						}
					}
					Location location;
					bool flag9 = DomainManager.TaiwuEvent.GetGlobalEventArgumentBox().Get<Location>("MainStoryLine_SpiritualWanderPlace_TaiwuVillagersCenter", out location);
					if (flag9)
					{
						workStatus = 5;
					}
					OrganizationInfo orgInfo = character.GetOrganizationInfo();
					AvatarData avatarData = character.GetAvatar();
					VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(charId);
					VillagerRoleArrangementDisplayDataWrapper arrangementDisplayData = null;
					bool flag10 = villagerRole != null;
					if (flag10)
					{
						arrangementDisplayData = new VillagerRoleArrangementDisplayDataWrapper();
						arrangementDisplayData.ArrangementTemplateId = villagerRole.ArrangementTemplateId;
						bool flag11 = villagerRole.WorkData != null;
						if (flag11)
						{
							arrangementDisplayData.AreaId = villagerRole.WorkData.Location.AreaId;
						}
						arrangementDisplayData.ArrangementDataId = (int)TaiwuDomain.CalcVillagerRoleDefaultArrangementId(villagerRole.RoleTemplateId);
						arrangementDisplayData.ArrangementData = villagerRole.GetArrangementDisplayData();
					}
					short trappedAreaId = -1;
					bool flag12 = workStatus == 6;
					if (flag12)
					{
						bool flag13 = character.GetKidnapperId() >= 0;
						if (flag13)
						{
							GameData.Domains.Character.Character kidnapper;
							bool flag14 = DomainManager.Character.TryGetElement_Objects(character.GetKidnapperId(), out kidnapper);
							if (flag14)
							{
								trappedAreaId = kidnapper.GetLocation().AreaId;
							}
						}
						else
						{
							trappedAreaId = character.GetLocation().AreaId;
						}
					}
					short favorabilityToTaiwu = DomainManager.Character.IsInteractedWithTaiwu(character.GetId()) ? DomainManager.Character.GetFavorability(character.GetId(), DomainManager.Taiwu.GetTaiwuCharId()) : short.MinValue;
					villagers.Add(new VillagerStatusDisplayData
					{
						CharacterId = charId,
						Name = new NameRelatedData
						{
							CharTemplateId = character.GetTemplateId(),
							Gender = character.GetGender(),
							MonkType = character.GetMonkType(),
							FullName = character.GetFullName(),
							OrgTemplateId = orgInfo.OrgTemplateId,
							OrgGrade = orgInfo.Grade,
							MonasticTitle = character.GetMonasticTitle(),
							NickNameId = DomainManager.Taiwu.GetFollowingNpcNickNameId(character.GetId()),
							CustomDisplayNameId = DomainManager.Extra.GetCharacterCustomDisplayName(charId)
						},
						CurrAge = character.GetCurrAge(),
						Health = character.GetHealth(),
						MaxLeftHealth = character.GetLeftMaxHealth(false),
						Gender = character.GetGender(),
						BehaviorType = character.GetBehaviorType(),
						Happiness = (short)character.GetHappiness(),
						FavorabilityToTaiwu = favorabilityToTaiwu,
						Fame = character.GetFame(),
						WorkStatus = workStatus,
						LivingStatus = livingStatus,
						PhysiologicalAge = character.GetPhysiologicalAge(),
						ClothDisplayId = character.GetClothingDisplayId(),
						FaceVisible = (!avatarData.ShowVeil && !avatarData.ShowMask(character.GetClothingDisplayId())),
						CreatingType = character.GetCreatingType(),
						BirthDate = character.GetBirthDate(),
						DefeatMarkCount = (sbyte)CombatDomain.GetDefeatMarksCountOutOfCombat(character),
						Charm = character.GetAttraction(),
						PreexistenceCharCount = (short)character.GetPreexistenceCharIds().Count,
						AttackMedal = character.GetFeatureMedalValue(0),
						DefenceMedal = character.GetFeatureMedalValue(1),
						WisdomMedal = character.GetFeatureMedalValue(2),
						MaxMainAttributes = character.GetMaxMainAttributes(),
						Penetrations = character.GetPenetrations(),
						PenetrationResists = character.GetPenetrationResists(),
						HitValues = character.GetHitValues(),
						AvoidValues = character.GetAvoidValues(),
						DisorderOfQi = character.GetDisorderOfQi(),
						LifeSkillQualifications = *character.GetLifeSkillQualifications(),
						LifeSkillAttainment = *character.GetLifeSkillAttainments(),
						LifeSkillGrowthType = character.GetLifeSkillQualificationGrowthType(),
						CombatSkillQualifications = *character.GetCombatSkillQualifications(),
						CombatSkillGrowthType = character.GetCombatSkillQualificationGrowthType(),
						Personalities = character.GetPersonalities(),
						Resources = *character.GetResources(),
						CurrInventoryLoad = character.GetCurrInventoryLoad(),
						MaxInventoryLoad = character.GetMaxInventoryLoad(),
						KidnapCount = (sbyte)DomainManager.Character.GetKidnappedCharacterCount(charId),
						OrgInfo = orgInfo,
						RoleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(charId),
						ArrangementDisplayData = arrangementDisplayData,
						TrappedAreaId = trappedAreaId
					});
				}
				result = villagers;
			}
			return result;
		}

		// Token: 0x06001211 RID: 4625 RVA: 0x0011D518 File Offset: 0x0011B718
		[DomainMethod]
		public List<VillagerStatusDisplayData> GetAllVillagersStatus()
		{
			List<int> memberList = new List<int>();
			DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
			memberList.Remove(this._taiwuCharId);
			return this.GetVillagerStatusDisplayDataList(memberList);
		}

		// Token: 0x06001212 RID: 4626 RVA: 0x0011D560 File Offset: 0x0011B760
		[DomainMethod]
		public List<int> GetAllVillagersAvailableForWork(bool actuallyNotOccupiedOnly = false)
		{
			List<int> memberList = new List<int>();
			Location location;
			bool flag = DomainManager.TaiwuEvent.GetGlobalEventArgumentBox().Get<Location>("MainStoryLine_SpiritualWanderPlace_TaiwuVillagersCenter", out location);
			List<int> result;
			if (flag)
			{
				result = memberList;
			}
			else
			{
				DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
				for (int i = memberList.Count - 1; i >= 0; i--)
				{
					bool flag2 = !this.IsVillagerAvailableForWork(memberList[i], actuallyNotOccupiedOnly);
					if (flag2)
					{
						memberList.RemoveAt(i);
					}
				}
				result = memberList;
			}
			return result;
		}

		// Token: 0x06001213 RID: 4627 RVA: 0x0011D5F8 File Offset: 0x0011B7F8
		[DomainMethod]
		public List<int> GetAllChildAvailableForWork(bool actuallyNotOccupiedOnly = false)
		{
			List<int> memberList = new List<int>();
			DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
			for (int i = memberList.Count - 1; i >= 0; i--)
			{
				bool flag = !this.IsVillagerChildAvailableForWork(memberList[i], actuallyNotOccupiedOnly);
				if (flag)
				{
					memberList.RemoveAt(i);
				}
			}
			return memberList;
		}

		// Token: 0x06001214 RID: 4628 RVA: 0x0011D66C File Offset: 0x0011B86C
		[DomainMethod]
		public List<int> GetVillagersAvailableForVillagerRole(bool removeTaiwuGroup = true)
		{
			List<int> memberList = new List<int>();
			HashSet<int> groupCharIds = DomainManager.Taiwu.GetGroupCharIds().GetCollection();
			int taiwuCharId = DomainManager.Taiwu.GetTaiwuCharId();
			DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers().GetAllMembers(memberList);
			for (int i = memberList.Count - 1; i >= 0; i--)
			{
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(memberList[i]);
				bool isAvailable = character.GetPhysiologicalAge() >= 16 && character.GetKidnapperId() < 0;
				bool flag = !isAvailable || memberList[i] == taiwuCharId || (removeTaiwuGroup && groupCharIds.Contains(memberList[i]));
				if (flag)
				{
					memberList.RemoveAt(i);
				}
			}
			return memberList;
		}

		// Token: 0x06001215 RID: 4629 RVA: 0x0011D748 File Offset: 0x0011B948
		[DomainMethod]
		public List<sbyte> GetVillagerRoleExecuteFixedActionFailReasons(DataContext context, short villagerRoleTemplateId, sbyte fixedActionType)
		{
			Tester.Assert(villagerRoleTemplateId >= 0 && villagerRoleTemplateId <= 2, "");
			List<sbyte> failReasonsTotal = new List<sbyte>();
			List<sbyte> failReasons = ObjectPool<List<sbyte>>.Instance.Get();
			IReadOnlySet<int> villagerRoleList = DomainManager.Taiwu.GetVillagerRoleSet(villagerRoleTemplateId);
			bool anyOneSuccess = false;
			foreach (int villagerRoleId in villagerRoleList)
			{
				VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(villagerRoleId);
				failReasons.Clear();
				bool executeFixedActionFailReasons = villagerRole.GetExecuteFixedActionFailReasons(context, fixedActionType, ref failReasons);
				if (executeFixedActionFailReasons)
				{
					anyOneSuccess = true;
				}
				for (int i = 0; i < failReasons.Count; i++)
				{
					bool flag = !failReasonsTotal.Contains(failReasons[i]);
					if (flag)
					{
						failReasonsTotal.Add(failReasons[i]);
					}
				}
			}
			ObjectPool<List<sbyte>>.Instance.Return(failReasons);
			bool flag2 = anyOneSuccess;
			if (flag2)
			{
				failReasonsTotal.Clear();
			}
			return failReasonsTotal;
		}

		// Token: 0x06001216 RID: 4630 RVA: 0x0011D858 File Offset: 0x0011BA58
		[DomainMethod]
		public List<int> GetVillagersForWork(bool includeUnlockedWorkingVillagers = false, bool farmerFirst = false)
		{
			Location location;
			bool flag = DomainManager.TaiwuEvent.GetGlobalEventArgumentBox().Get<Location>("MainStoryLine_SpiritualWanderPlace_TaiwuVillagersCenter", out location);
			List<int> result;
			if (flag)
			{
				result = new List<int>();
			}
			else
			{
				List<int> memberList = this.GetAllVillagersAvailableForWork(true);
				if (includeUnlockedWorkingVillagers)
				{
					List<int> unlockedWorkingVillagers = DomainManager.Extra.GetUnlockedWorkingVillagers();
					foreach (int charId2 in unlockedWorkingVillagers)
					{
						bool flag2 = this.IsVillagerAvailableForWork(charId2, false);
						if (flag2)
						{
							memberList.Add(charId2);
						}
					}
				}
				bool flag3 = !farmerFirst;
				if (flag3)
				{
					result = memberList;
				}
				else
				{
					HashSet<int> farmerSet = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId).GetMembers().GetMembers(1);
					result = (from charId in memberList
					orderby !farmerSet.Contains(charId)
					select charId).ToList<int>();
				}
			}
			return result;
		}

		// Token: 0x06001217 RID: 4631 RVA: 0x0011D954 File Offset: 0x0011BB54
		public bool IsVillagerAvailableForWork(int charId, bool actuallyNotOccupiedOnly = false)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			bool flag = !CharacterMatcher.DefValue.VillagerAvailableForWork.Match(character);
			return !flag && (!actuallyNotOccupiedOnly || !this._villagerWork.ContainsKey(charId));
		}

		// Token: 0x06001218 RID: 4632 RVA: 0x0011D9A0 File Offset: 0x0011BBA0
		public bool IsVillagerChildAvailableForWork(int charId, bool actuallyNotOccupiedOnly = false)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			bool flag = !CharacterMatcher.DefValue.ChildVillagerAvailableForWork.Match(character);
			return !flag && (!actuallyNotOccupiedOnly || !this._villagerWork.ContainsKey(charId));
		}

		// Token: 0x06001219 RID: 4633 RVA: 0x0011D9EC File Offset: 0x0011BBEC
		public bool CanWork(int charId)
		{
			bool flag = this._villagerWork.ContainsKey(charId);
			if (flag)
			{
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
				return CharacterMatcher.DefValue.CanWork.Match(character);
			}
			DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
			defaultInterpolatedStringHandler.AppendLiteral("Villager with character id ");
			defaultInterpolatedStringHandler.AppendFormatted<int>(charId);
			defaultInterpolatedStringHandler.AppendLiteral(" is not working");
			throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
		}

		// Token: 0x0600121A RID: 4634 RVA: 0x0011DA64 File Offset: 0x0011BC64
		public void MoveVillagersToWorkLocation(DataContext context)
		{
			MonthlyNotificationCollection monthlyNotifications = DomainManager.World.GetMonthlyNotificationCollection();
			this._moveToWorkLocationCharList.Clear();
			foreach (KeyValuePair<int, VillagerWorkData> entry in this._villagerWork)
			{
				VillagerWorkData workData = entry.Value;
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(workData.CharacterId);
				Location srcLocation = character.GetLocation();
				Location location = new Location(workData.AreaId, workData.BlockId);
				bool flag = !location.IsValid() || workData.WorkType == 2;
				if (!flag)
				{
					sbyte workType = workData.WorkType;
					bool flag2 = workType <= 1;
					bool flag3 = flag2;
					if (flag3)
					{
						bool flag4 = !DomainManager.Map.IsLocationInSettlementInfluenceRange(srcLocation, this._taiwuVillageSettlementId);
						if (flag4)
						{
							List<short> blocks = new List<short>();
							DomainManager.Map.GetSettlementBlocksAndAffiliatedBlocks(location.AreaId, location.BlockId, blocks);
							int randomDestIndex = context.Random.Next(blocks.Count);
							Location destLocation = new Location(location.AreaId, blocks[randomDestIndex]);
							DomainManager.Character.LeaveGroup(context, character, true);
							DomainManager.Character.GroupMove(context, character, destLocation);
							this._moveToWorkLocationCharList.Add(workData.CharacterId);
						}
						else
						{
							Location destLocation2 = srcLocation;
							DomainManager.Character.LeaveGroup(context, character, true);
							DomainManager.Character.GroupMove(context, character, destLocation2);
						}
					}
					else
					{
						bool flag5 = srcLocation.AreaId != workData.AreaId || srcLocation.BlockId != workData.BlockId;
						if (flag5)
						{
							Location destLocation3 = location;
							DomainManager.Character.LeaveGroup(context, character, true);
							DomainManager.Character.GroupMove(context, character, destLocation3);
							this._moveToWorkLocationCharList.Add(workData.CharacterId);
						}
					}
				}
			}
		}

		// Token: 0x0600121B RID: 4635 RVA: 0x0011DC84 File Offset: 0x0011BE84
		public void CalcVillagerWorkOnMap(DataContext context)
		{
			foreach (KeyValuePair<int, VillagerWorkData> entry in this._villagerWork)
			{
				VillagerWorkData workData = entry.Value;
				bool flag = !this.CanWork(workData.CharacterId);
				if (!flag)
				{
					switch (workData.WorkType)
					{
					case 10:
						this.VillagerWorkCollectResource(context, workData);
						break;
					case 11:
						DomainManager.Adventure.CollectTribute(context, workData.CharacterId, workData.AreaId, workData.BlockId);
						break;
					case 14:
						this.VillagerWorkMigrateResource(context, workData);
						break;
					}
				}
			}
		}

		// Token: 0x0600121C RID: 4636 RVA: 0x0011DD5C File Offset: 0x0011BF5C
		public void ClearAdvanceMonthData()
		{
			this._moveToWorkLocationCharList.Clear();
			this.ResourceRecoverSpeedUpDict.Clear();
		}

		// Token: 0x0600121D RID: 4637 RVA: 0x0011DD77 File Offset: 0x0011BF77
		public void AddTaiwuVillageResident(DataContext context, int charId)
		{
			DomainManager.Building.AddTaiwuResident(context, charId, true);
		}

		// Token: 0x0600121E RID: 4638 RVA: 0x0011DD88 File Offset: 0x0011BF88
		public void TryRemoveTaiwuVillageResident(DataContext context, int charId)
		{
			this.RemoveVillagerWork(context, charId, true);
			DomainManager.Building.RemoveTaiwuResident(context, charId, true);
		}

		// Token: 0x0600121F RID: 4639 RVA: 0x0011DDA4 File Offset: 0x0011BFA4
		[DomainMethod]
		public int[] CalcResourceChangeByVillageWork(DataContext context)
		{
			int[] value = new int[8];
			bool flag = !DomainManager.World.GetWorldFunctionsStatus(10);
			int[] result;
			if (flag)
			{
				for (sbyte resourceType = 0; resourceType < 8; resourceType += 1)
				{
					value[(int)resourceType] = 0;
				}
				result = value;
			}
			else
			{
				foreach (KeyValuePair<int, VillagerWorkData> entry in this._villagerWork)
				{
					VillagerWorkData workData = entry.Value;
					bool flag2 = workData.WorkType == 10 && this.CanWork(workData.CharacterId);
					if (flag2)
					{
						value[(int)workData.ResourceType] += workData.GetCollectResourceIncome();
					}
				}
				result = value;
			}
			return result;
		}

		// Token: 0x06001220 RID: 4640 RVA: 0x0011DE78 File Offset: 0x0011C078
		[DomainMethod]
		public int[] CalcResourceChangeByBuildingEarn(DataContext context)
		{
			int[] value = new int[8];
			bool flag = !DomainManager.World.GetWorldFunctionsStatus(10);
			int[] result;
			if (flag)
			{
				for (sbyte resourceType = 0; resourceType < 8; resourceType += 1)
				{
					value[(int)resourceType] = 0;
				}
				result = value;
			}
			else
			{
				this.CalcResourceBlockIncomeEffectValues(ref value);
				List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
				for (int i = 0; i < taiwuBuildingList.Count; i++)
				{
					Location location = taiwuBuildingList[i];
					BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
					for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
					{
						BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
						BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
						bool flag2 = blockData.RootBlockIndex >= 0;
						if (!flag2)
						{
							BuildingBlockItem configData = BuildingBlock.Instance[blockData.TemplateId];
							bool isCollectResourceBuilding = configData.IsCollectResourceBuilding;
							if (isCollectResourceBuilding)
							{
								sbyte resourceType2 = DomainManager.Building.GetCollectBuildingResourceType(blockKey);
								sbyte getResourceType = (resourceType2 < 6) ? resourceType2 : 5;
								value[(int)getResourceType] += DomainManager.Building.CalcResourceOutputCount(blockKey, getResourceType);
							}
							bool flag3 = blockData.TemplateId == 45 && blockData.CanUse();
							if (flag3)
							{
								value[7] += DomainManager.Building.CalculateGainAuthorityByShrinePerMonth(blockKey);
							}
						}
					}
				}
				result = value;
			}
			return result;
		}

		// Token: 0x06001221 RID: 4641 RVA: 0x0011E00C File Offset: 0x0011C20C
		[DomainMethod]
		public int[] CalcResourceChangeByBuildingMaintain(DataContext context)
		{
			int[] value = new int[8];
			bool flag = !DomainManager.World.GetWorldFunctionsStatus(10);
			int[] result;
			if (flag)
			{
				for (sbyte resourceType = 0; resourceType < 8; resourceType += 1)
				{
					value[(int)resourceType] = 0;
				}
				result = value;
			}
			else
			{
				List<Location> taiwuBuildingList = DomainManager.Building.GetTaiwuBuildingAreas();
				for (int i = 0; i < taiwuBuildingList.Count; i++)
				{
					Location location = taiwuBuildingList[i];
					BuildingAreaData areaData = DomainManager.Building.GetElement_BuildingAreas(location);
					for (short index = 0; index < (short)(areaData.Width * areaData.Width); index += 1)
					{
						BuildingBlockKey blockKey = new BuildingBlockKey(location.AreaId, location.BlockId, index);
						BuildingBlockData blockData = DomainManager.Building.GetElement_BuildingBlocks(blockKey);
						BuildingBlockDataEx blockDataEx;
						bool flag2 = blockData.RootBlockIndex >= 0 || !DomainManager.Extra.TryGetElement_BuildingBlockDataEx((ulong)blockKey, out blockDataEx);
						if (!flag2)
						{
							BuildingBlockItem configData = BuildingBlock.Instance[blockData.TemplateId];
							sbyte level = blockDataEx.CalcUnlockedLevelCount();
							bool flag3 = blockData.NeedMaintenanceCost();
							if (flag3)
							{
								int[] maintenanceCost = GameData.Domains.Building.SharedMethods.GetFinalMaintenanceCost(configData);
								for (int j = 0; j < maintenanceCost.Length; j++)
								{
									value[j] -= maintenanceCost[j];
								}
							}
							bool flag4 = blockData.Durability == 0 && configData.DestoryType == 1 && level == 1;
							if (flag4)
							{
								value[7] -= (int)configData.MaxDurability;
							}
						}
					}
				}
				result = value;
			}
			return result;
		}

		// Token: 0x06001222 RID: 4642 RVA: 0x0011E1B8 File Offset: 0x0011C3B8
		[Obsolete]
		[DomainMethod]
		public int[] CalcResourceChangeByAutoExpand(DataContext context)
		{
			return new int[8];
		}

		// Token: 0x06001223 RID: 4643 RVA: 0x0011E1D0 File Offset: 0x0011C3D0
		[Obsolete]
		[DomainMethod]
		public int CalcAutoExpandNotSatisfyIndex(DataContext context)
		{
			return 0;
		}

		// Token: 0x06001224 RID: 4644 RVA: 0x0011E1E4 File Offset: 0x0011C3E4
		public void CheckAboutToDieVillagersAndTaiwuPeople(DataContext context)
		{
			HashSet<int> charSet = context.AdvanceMonthRelatedData.BlockCharSet.Occupy();
			DomainManager.Character.GetTaiwuPeople(charSet);
			OrgMemberCollection members = DomainManager.Organization.GetElement_CivilianSettlements(this._taiwuVillageSettlementId).GetMembers();
			for (sbyte grade = 0; grade < 9; grade += 1)
			{
				charSet.UnionWith(members.GetMembers(grade));
			}
			MonthlyNotificationCollection monthlyNotifications = DomainManager.World.GetMonthlyNotificationCollection();
			foreach (int charId in charSet)
			{
				GameData.Domains.Character.Character character;
				bool flag = DomainManager.Character.TryGetElement_Objects(charId, out character) && character.GetLeftMaxHealth(false) == 6;
				if (flag)
				{
					monthlyNotifications.AddAboutToDie(charId);
				}
			}
			context.AdvanceMonthRelatedData.BlockCharSet.Release(ref charSet);
		}

		// Token: 0x06001225 RID: 4645 RVA: 0x0011E2D4 File Offset: 0x0011C4D4
		[return: TupleElementNames(new string[]
		{
			"qualifications",
			"attianments"
		})]
		public unsafe ValueTuple<int[], int[]> GetVillagerAverageLifeSkillInfo()
		{
			List<int> memberList = new List<int>();
			Settlement settlement = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId);
			settlement.GetMembers().GetAllMembers(memberList);
			memberList.Remove(this._taiwuCharId);
			int[] qualifications = new int[16];
			int[] attainments = new int[16];
			foreach (int charId in memberList)
			{
				GameData.Domains.Character.Character character;
				bool flag = !DomainManager.Character.TryGetElement_Objects(charId, out character);
				if (!flag)
				{
					LifeSkillShorts skillQualifications = *character.GetLifeSkillQualifications();
					LifeSkillShorts skillAttainments = *character.GetLifeSkillAttainments();
					for (int i = 0; i < 16; i++)
					{
						qualifications[i] += (int)(*(ref skillQualifications.Items.FixedElementField + (IntPtr)i * 2));
						attainments[i] += (int)(*(ref skillAttainments.Items.FixedElementField + (IntPtr)i * 2));
					}
				}
			}
			for (int j = 0; j < 16; j++)
			{
				qualifications[j] = Convert.ToInt32((float)qualifications[j] / (float)memberList.Count);
				attainments[j] = Convert.ToInt32((float)attainments[j] / (float)memberList.Count);
			}
			return new ValueTuple<int[], int[]>(qualifications, attainments);
		}

		// Token: 0x06001226 RID: 4646 RVA: 0x0011E448 File Offset: 0x0011C648
		[return: TupleElementNames(new string[]
		{
			"qualifications",
			"attianments"
		})]
		public unsafe ValueTuple<int[], int[]> GetVillagerAverageCombatSkillInfo()
		{
			List<int> memberList = new List<int>();
			Settlement settlement = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId);
			settlement.GetMembers().GetAllMembers(memberList);
			memberList.Remove(this._taiwuCharId);
			int[] qualifications = new int[14];
			int[] attainments = new int[14];
			foreach (int charId in memberList)
			{
				GameData.Domains.Character.Character character;
				bool flag = !DomainManager.Character.TryGetElement_Objects(charId, out character);
				if (!flag)
				{
					CombatSkillShorts skillQualifications = *character.GetCombatSkillQualifications();
					CombatSkillShorts skillAttainments = *character.GetCombatSkillAttainments();
					for (int i = 0; i < 14; i++)
					{
						qualifications[i] += (int)(*(ref skillQualifications.Items.FixedElementField + (IntPtr)i * 2));
						attainments[i] += (int)(*(ref skillAttainments.Items.FixedElementField + (IntPtr)i * 2));
					}
				}
			}
			for (int j = 0; j < 14; j++)
			{
				qualifications[j] = Convert.ToInt32((float)qualifications[j] / (float)memberList.Count);
				attainments[j] = Convert.ToInt32((float)attainments[j] / (float)memberList.Count);
			}
			return new ValueTuple<int[], int[]>(qualifications, attainments);
		}

		// Token: 0x06001227 RID: 4647 RVA: 0x0011E5BC File Offset: 0x0011C7BC
		internal void CommitTaiwuSettlementTreasury(DataContext context)
		{
			bool flag = !this._needCommitTaiwuSettlementTreasury;
			if (!flag)
			{
				this._needCommitTaiwuSettlementTreasury = false;
				this.SetTaiwuTreasury(context, this.GetTaiwuTreasury());
			}
		}

		// Token: 0x06001228 RID: 4648 RVA: 0x0011E5EE File Offset: 0x0011C7EE
		public void SetNeedCommitSettlementTreasury(bool needCommit)
		{
			this._needCommitTaiwuSettlementTreasury = needCommit;
			this.GetTaiwuTreasury().DetectAndFixInvalidData();
		}

		// Token: 0x06001229 RID: 4649 RVA: 0x0011E604 File Offset: 0x0011C804
		public void UpdateVillagerRoleFixedActionSuccessArray(DataContext context, bool isPreAdvance)
		{
			List<sbyte> failReasons = ObjectPool<List<sbyte>>.Instance.Get();
			for (short villagerRoleTemplateId = 0; villagerRoleTemplateId < 3; villagerRoleTemplateId += 1)
			{
				int actionTypeCount = this.GetVillagerRoleFixedActionTypeCount(villagerRoleTemplateId);
				bool[] successArray = this.GetVillagerRoleFixedActionSuccessArray(villagerRoleTemplateId, isPreAdvance);
				IReadOnlySet<int> villagerRoleList = DomainManager.Taiwu.GetVillagerRoleSet(villagerRoleTemplateId);
				sbyte actionType = 0;
				while ((int)actionType < actionTypeCount)
				{
					bool anyOneSuccess = false;
					foreach (int villagerRoleId in villagerRoleList)
					{
						VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(villagerRoleId);
						failReasons.Clear();
						bool executeFixedActionFailReasons = villagerRole.GetExecuteFixedActionFailReasons(context, actionType, ref failReasons);
						if (executeFixedActionFailReasons)
						{
							anyOneSuccess = true;
						}
					}
					successArray[(int)actionType] = anyOneSuccess;
					actionType += 1;
				}
			}
			ObjectPool<List<sbyte>>.Instance.Return(failReasons);
		}

		// Token: 0x0600122A RID: 4650 RVA: 0x0011E6F0 File Offset: 0x0011C8F0
		private int GetVillagerRoleFixedActionTypeCount(short villagerRoleTemplateId)
		{
			Tester.Assert(villagerRoleTemplateId >= 0 && villagerRoleTemplateId <= 2, "");
			if (!true)
			{
			}
			sbyte result;
			switch (villagerRoleTemplateId)
			{
			case 0:
				result = 1;
				break;
			case 1:
				result = 4;
				break;
			case 2:
				result = 3;
				break;
			default:
				throw new ArgumentOutOfRangeException("villagerRoleTemplateId", villagerRoleTemplateId, null);
			}
			if (!true)
			{
			}
			return (int)result;
		}

		// Token: 0x0600122B RID: 4651 RVA: 0x0011E758 File Offset: 0x0011C958
		private bool[] GetVillagerRoleFixedActionSuccessArray(short villagerRoleTemplateId, bool isPreAdvance)
		{
			Tester.Assert(villagerRoleTemplateId >= 0 && villagerRoleTemplateId <= 2, "");
			if (!true)
			{
			}
			bool[] result;
			switch (villagerRoleTemplateId)
			{
			case 0:
				result = (isPreAdvance ? this._preAdvanceVillagerRoleFarmerFixedActionSuccessArray : this._periAdvanceVillagerRoleFarmerFixedActionSuccessArray);
				break;
			case 1:
				result = (isPreAdvance ? this._preAdvanceVillagerRoleCraftsmanFixedActionSuccessArray : this._periAdvanceVillagerRoleCraftsmanFixedActionSuccessArray);
				break;
			case 2:
				result = (isPreAdvance ? this._preAdvanceVillagerRoleDoctorFixedActionSuccessArray : this._periAdvanceVillagerRoleDoctorFixedActionSuccessArray);
				break;
			default:
				throw new ArgumentOutOfRangeException("villagerRoleTemplateId", villagerRoleTemplateId, null);
			}
			if (!true)
			{
			}
			return result;
		}

		// Token: 0x0600122C RID: 4652 RVA: 0x0011E7F0 File Offset: 0x0011C9F0
		public bool IsVillagerRoleFixedActionAddFailLifeRecord(short villagerRoleTemplateId, sbyte fixedActionType)
		{
			bool[] preSuccessArray = this.GetVillagerRoleFixedActionSuccessArray(villagerRoleTemplateId, true);
			bool[] periSuccessArray = this.GetVillagerRoleFixedActionSuccessArray(villagerRoleTemplateId, false);
			return preSuccessArray[(int)fixedActionType] && !periSuccessArray[(int)fixedActionType];
		}

		// Token: 0x0600122D RID: 4653 RVA: 0x0011E82C File Offset: 0x0011CA2C
		internal static short CalcVillagerRoleDefaultArrangementId(short roleId)
		{
			VillagerRoleArrangementItem item2 = VillagerRoleArrangement.Instance.FirstOrDefault((VillagerRoleArrangementItem item) => !item.InvisibleInGui && item.VillagerRole == roleId);
			return (item2 != null) ? item2.TemplateId : -1;
		}

		// Token: 0x0600122E RID: 4654 RVA: 0x0011E870 File Offset: 0x0011CA70
		public void UpdateVillagerTreasuryNeed(DataContext context)
		{
			this.CalcVillagerClasses();
			List<int> memberList = this.GetTaiwuVillagerMemberList();
			Settlement settlement = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId);
			this.RemoveAllInvalidVillagerNeed(memberList, settlement);
			foreach (int charId in memberList)
			{
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
				bool flag = this.IsMeetWorkStatus(character, settlement);
				if (flag)
				{
					character.VillagerReturnNotReadableBooks(context);
					character.ReturnVillagerRoleClothing(context, true);
				}
			}
			foreach (List<int> charList in this._villagerListClassArray)
			{
				bool flag2 = charList == null || charList.Count <= 0;
				if (!flag2)
				{
					this._timeMeetTreasuryNeedDict.Clear();
					foreach (int charId2 in charList)
					{
						this.UpdateVillagerTreasuryNeed(charId2);
					}
					bool flag3 = this._timeMeetTreasuryNeedDict.Count <= 0;
					if (!flag3)
					{
						List<int> keyList = this._timeMeetTreasuryNeedDict.Keys.ToList<int>();
						CollectionUtils.Shuffle<int>(context.Random, keyList);
						foreach (int charId3 in keyList)
						{
							List<GameData.Domains.Character.Ai.PersonalNeed> needs = this._timeMeetTreasuryNeedDict[charId3];
							foreach (GameData.Domains.Character.Ai.PersonalNeed need in needs)
							{
								this.HandleVillagerTreasuryNeed(context, charId3, settlement, need.ItemType, need.ItemTemplateId);
							}
						}
					}
				}
			}
			this.RemoveAllInvalidVillagerNeed(memberList, settlement);
			DomainManager.Extra.ClearVillagerLastInfluencePowerGrades(context);
			for (int i = 0; i < this._villagerListClassArray.Length; i++)
			{
				List<int> list = this._villagerListClassArray[i];
				bool flag4 = list == null || list.Count <= 0;
				if (!flag4)
				{
					foreach (int charId4 in list)
					{
						GameData.Domains.Character.Character character2 = DomainManager.Character.GetElement_Objects(charId4);
						bool flag5 = character2.GetAgeGroup() == 0;
						if (!flag5)
						{
							bool isMeetWorkStatus = this.IsMeetWorkStatus(character2, settlement);
							bool flag6 = isMeetWorkStatus;
							if (flag6)
							{
								this.HandleVillagerPersonalNeed(context, character2, settlement);
								this.HandleVillagerNoNeed(context, character2, settlement);
							}
						}
					}
					sbyte charClass = Convert.ToSByte(8 - i);
					foreach (int charId5 in list)
					{
						DomainManager.Extra.SetVillagerLastInfluencePowerGrade(context, charId5, charClass);
					}
				}
			}
			this._treasuryNeededItemDict.Clear();
			foreach (int charId6 in memberList)
			{
				GameData.Domains.Character.Character character3 = DomainManager.Character.GetElement_Objects(charId6);
				character3.SetPersonalNeeds(character3.GetPersonalNeeds(), context);
				VillagerTreasuryNeed villagerTreasuryNeed;
				bool flag7 = DomainManager.Extra.TryGetVillagerTreasuryNeed(charId6, out villagerTreasuryNeed);
				if (flag7)
				{
					DomainManager.Extra.SetVillagerTreasuryNeed(context, charId6, villagerTreasuryNeed);
					foreach (GameData.Domains.Character.Ai.PersonalNeed personal in villagerTreasuryNeed.PersonalNeeds)
					{
						this.AddNeededItem(personal, charId6);
					}
				}
			}
			foreach (int charId7 in memberList)
			{
				GameData.Domains.Character.Character character4 = DomainManager.Character.GetElement_Objects(charId7);
				bool flag8 = this.IsMeetWorkStatus(character4, settlement);
				if (flag8)
				{
					character4.ReturnVillagerRoleClothing(context, true);
				}
			}
		}

		// Token: 0x0600122F RID: 4655 RVA: 0x0011ED10 File Offset: 0x0011CF10
		private void RemoveAllInvalidVillagerNeed(List<int> memberList, Settlement settlement)
		{
			foreach (int charId in memberList)
			{
				GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
				this.RemoveInvalidVillagerTreasuryNeed(character, this.GetTaiwuTreasury());
				this.RemoveInvalidVillagerPersonalNeed(character);
			}
		}

		// Token: 0x06001230 RID: 4656 RVA: 0x0011ED80 File Offset: 0x0011CF80
		private void UpdateVillagerTreasuryNeed(int charId)
		{
			VillagerTreasuryNeed villagerTreasuryNeed;
			bool flag = !DomainManager.Extra.TryGetVillagerTreasuryNeed(charId, out villagerTreasuryNeed);
			if (!flag)
			{
				List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds2 = villagerTreasuryNeed.PersonalNeeds;
				bool flag2 = personalNeeds2 == null || personalNeeds2.Count <= 0;
				if (!flag2)
				{
					sbyte charClass;
					bool flag3 = !this._villagerClassDict.TryGetValue(charId, out charClass);
					if (!flag3)
					{
						for (int index = 0; index < villagerTreasuryNeed.PersonalNeeds.Count; index++)
						{
							GameData.Domains.Character.Ai.PersonalNeed personalNeed = villagerTreasuryNeed.PersonalNeeds[index];
							bool flag4 = personalNeed.RemainingMonths > 0;
							if (flag4)
							{
								personalNeed.RemainingMonths -= 1;
								sbyte lastCharClass;
								bool flag5 = DomainManager.Extra.TryGetVillagerLastInfluencePowerGrade(charId, out lastCharClass);
								if (flag5)
								{
									sbyte itemGrade = ItemTemplateHelper.GetGrade(personalNeed.ItemType, personalNeed.ItemTemplateId);
									sbyte lastTime = TaiwuDomain.CalcVillagerTreasuryNeedWaitTime(lastCharClass, itemGrade);
									sbyte curTime = TaiwuDomain.CalcVillagerTreasuryNeedWaitTime(charClass, itemGrade);
									personalNeed.RemainingMonths += Convert.ToSByte((int)(curTime - lastTime));
								}
								villagerTreasuryNeed.PersonalNeeds[index] = personalNeed;
							}
							bool flag6 = personalNeed.RemainingMonths <= 0;
							if (flag6)
							{
								List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds;
								bool flag7 = !this._timeMeetTreasuryNeedDict.TryGetValue(charId, out personalNeeds);
								if (flag7)
								{
									personalNeeds = new List<GameData.Domains.Character.Ai.PersonalNeed>();
									this._timeMeetTreasuryNeedDict[charId] = personalNeeds;
								}
								personalNeeds.Add(personalNeed);
							}
						}
					}
				}
			}
		}

		// Token: 0x06001231 RID: 4657 RVA: 0x0011EEF4 File Offset: 0x0011D0F4
		private static sbyte CalcVillagerTreasuryNeedWaitTime(sbyte charClass, sbyte itemGrade)
		{
			return (sbyte)Math.Max(0, (int)(itemGrade - charClass));
		}

		// Token: 0x06001232 RID: 4658 RVA: 0x0011EF10 File Offset: 0x0011D110
		private void HandleVillagerTreasuryNeed(DataContext context, int charId, Settlement settlement, sbyte itemType, short templateId)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			List<ItemKey> selectionList = ObjectPool<List<ItemKey>>.Instance.Get();
			this.GetTaiwuTreasury().Inventory.GetInventoryItemKeyList(itemType, templateId, selectionList);
			bool flag = selectionList.Count == 0;
			if (flag)
			{
				ObjectPool<List<ItemKey>>.Instance.Return(selectionList);
			}
			else
			{
				selectionList.RemoveAll((ItemKey k) => !this.IsMeetInventoryLoad(character, k) || !this.ShouldTakeEquipment(character, k, true));
				bool flag2 = selectionList.Count == 0;
				if (flag2)
				{
					ObjectPool<List<ItemKey>>.Instance.Return(selectionList);
				}
				else
				{
					ItemKey targetItemKey = selectionList.GetRandom(context.Random);
					this.VillagerTakeItemFromTreasury(context, character, targetItemKey, 1);
					character.AddInventoryItem(context, targetItemKey, 1, false);
					this.HandleVillagerGainTreasuryItem(context, targetItemKey, character);
					ObjectPool<List<ItemKey>>.Instance.Return(selectionList);
				}
			}
		}

		// Token: 0x06001233 RID: 4659 RVA: 0x0011EFF4 File Offset: 0x0011D1F4
		private void RemoveInvalidVillagerTreasuryNeed(GameData.Domains.Character.Character selfChar, SettlementTreasury settlementTreasury)
		{
			VillagerTreasuryNeed villagerTreasuryNeed;
			bool flag = !DomainManager.Extra.TryGetVillagerTreasuryNeed(selfChar.GetId(), out villagerTreasuryNeed);
			if (!flag)
			{
				List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds = villagerTreasuryNeed.PersonalNeeds;
				bool flag2 = personalNeeds == null || personalNeeds.Count <= 0;
				if (!flag2)
				{
					List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds2 = villagerTreasuryNeed.PersonalNeeds;
					if (personalNeeds2 != null)
					{
						Predicate<ItemKey> <>9__1;
						personalNeeds2.RemoveAll(delegate(GameData.Domains.Character.Ai.PersonalNeed personalNeed)
						{
							List<ItemKey> selectionList = ObjectPool<List<ItemKey>>.Instance.Get();
							settlementTreasury.Inventory.GetInventoryItemKeyList(personalNeed.ItemType, personalNeed.ItemTemplateId, selectionList);
							bool flag3 = selectionList.Count == 0;
							bool result;
							if (flag3)
							{
								ObjectPool<List<ItemKey>>.Instance.Return(selectionList);
								result = true;
							}
							else
							{
								List<ItemKey> list = selectionList;
								Predicate<ItemKey> match;
								if ((match = <>9__1) == null)
								{
									match = (<>9__1 = ((ItemKey k) => !this.ShouldTakeEquipment(selfChar, k, false)));
								}
								list.RemoveAll(match);
								bool flag4 = selectionList.Count == 0;
								if (flag4)
								{
									ObjectPool<List<ItemKey>>.Instance.Return(selectionList);
									result = true;
								}
								else
								{
									ObjectPool<List<ItemKey>>.Instance.Return(selectionList);
									bool flag5 = selfChar.GetInventory().GetInventoryItemKey(personalNeed.ItemType, personalNeed.ItemTemplateId).IsValid();
									if (flag5)
									{
										result = true;
									}
									else
									{
										bool exist = selfChar.GetEquipment().Exist((ItemKey k) => k.ItemType == personalNeed.ItemType && k.TemplateId == personalNeed.ItemTemplateId);
										bool flag6 = exist;
										result = flag6;
									}
								}
							}
							return result;
						});
					}
				}
			}
		}

		// Token: 0x06001234 RID: 4660 RVA: 0x0011F080 File Offset: 0x0011D280
		private void HandleVillagerPersonalNeed(DataContext context, GameData.Domains.Character.Character character, Settlement settlement)
		{
			this._villagerGainedItemTypeSet.Clear();
			this._villagerItems.Clear();
			foreach (KeyValuePair<ItemKey, int> keyValuePair in character.GetInventory().Items)
			{
				ItemKey itemKey3;
				int num;
				keyValuePair.Deconstruct(out itemKey3, out num);
				ItemKey itemKey = itemKey3;
				int amount = num;
				this._villagerItems[itemKey] = amount;
			}
			foreach (KeyValuePair<ItemKey, int> keyValuePair in this.GetTaiwuTreasury().Inventory.Items)
			{
				ItemKey itemKey3;
				int num;
				keyValuePair.Deconstruct(out itemKey3, out num);
				ItemKey itemKey2 = itemKey3;
				int amount2 = num;
				int oldAmount;
				this._villagerItems.TryGetValue(itemKey2, out oldAmount);
				this._villagerItems[itemKey2] = oldAmount + amount2;
			}
			this.CategorizedRegenItems(this._villagerItems);
			List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds = character.GetPersonalNeeds();
			for (int index = 0; index < personalNeeds.Count; index++)
			{
				GameData.Domains.Character.Ai.PersonalNeed personalNeed = personalNeeds[index];
				switch (personalNeed.TemplateId)
				{
				case 0:
					this.HandleVillagerPersonalNeedForHappiness(context, character, settlement, personalNeed);
					break;
				case 1:
					this.HandleVillagerPersonalNeedForHeath(context, character, settlement, personalNeed);
					break;
				case 2:
				case 4:
				case 5:
					this.HandleVillagerPersonalNeedForHealingAndDetox(context, character, settlement, personalNeed);
					break;
				case 3:
					this.HandleVillagerPersonalNeedForNeili(context, character, settlement, personalNeed);
					break;
				case 6:
					this.HandleVillagerPersonalNeedForMainAttributes(context, character, settlement, personalNeed);
					break;
				case 7:
					this.HandleVillagerPersonalNeedForWug(context, character, settlement, personalNeed);
					break;
				case 8:
					this.HandleVillagerPersonalNeedForGainResource(context, character, settlement, personalNeed, index);
					break;
				case 10:
					this.HandleVillagerPersonalNeedForGainItem(context, character, settlement, personalNeed);
					break;
				case 12:
				{
					bool success = this.HandleVillagerPersonalNeedForAddPoisonToItem(context, character, settlement, personalNeed);
					sbyte duration = Config.PersonalNeed.Instance[personalNeed.TemplateId].Duration;
					bool flag = success && personalNeed.RemainingMonths < duration;
					if (flag)
					{
						personalNeed.RemainingMonths = duration;
						personalNeeds[index] = personalNeed;
					}
					break;
				}
				}
			}
		}

		// Token: 0x06001235 RID: 4661 RVA: 0x0011F2F4 File Offset: 0x0011D4F4
		private void HandleVillagerNoNeed(DataContext context, GameData.Domains.Character.Character character, Settlement settlement)
		{
			short roleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(character.GetId());
			VillagerRoleItem roleCfg = (roleTemplateId >= 0) ? VillagerRole.Instance[roleTemplateId] : null;
			sbyte charClass = this._villagerClassDict[character.GetId()];
			HashSet<sbyte> lifeSkillTypeSet = TaiwuDomain.VillagerRoleNeedLifeSkillBooks[roleTemplateId];
			bool canChangeEquipment = !this._villagerGainedItemTypeSet.Any(new Func<sbyte, bool>(ItemType.IsEquipmentItemType)) && !DomainManager.Extra.GetManualChangeEquipGroupCharIds().Contains(character.GetId());
			bool canGainBook = !this._villagerGainedItemTypeSet.Contains(10) && !character.HasReadableBook() && roleCfg != null;
			bool canGainTool = !this._villagerGainedItemTypeSet.Contains(6) && lifeSkillTypeSet != null && lifeSkillTypeSet.Count > 0;
			bool flag = canGainTool;
			if (flag)
			{
				Func<sbyte, bool> <>9__1;
				bool hasTool = character.GetInventory().Items.Keys.Any(delegate(ItemKey k)
				{
					bool result;
					if (k.ItemType == 6)
					{
						IEnumerable<sbyte> requiredLifeSkillTypes2 = Config.CraftTool.Instance[k.TemplateId].RequiredLifeSkillTypes;
						Func<sbyte, bool> predicate3;
						if ((predicate3 = <>9__1) == null)
						{
							predicate3 = (<>9__1 = ((sbyte t) => lifeSkillTypeSet.Contains(t)));
						}
						result = requiredLifeSkillTypes2.Any(predicate3);
					}
					else
					{
						result = false;
					}
					return result;
				});
				bool flag2 = hasTool;
				if (flag2)
				{
					canGainTool = false;
				}
			}
			bool canGainMisc = !this._villagerGainedItemTypeSet.Contains(12) && context.Random.NextFloat() >= this._gainItemActionRate;
			bool canGainMaterial = !this._villagerGainedItemTypeSet.Contains(5) && context.Random.NextFloat() >= this._gainItemActionRate;
			bool anyAccess = canChangeEquipment || canGainBook || canGainTool || canGainMisc || canGainMaterial;
			bool flag3 = !anyAccess;
			if (!flag3)
			{
				HashSet<sbyte> resourceTypeSet = this._villagerRoleNeedMaterials[roleTemplateId];
				ItemKey[] equipments = character.GetEquipment();
				SettlementTreasury treasury = this.GetTaiwuTreasury();
				Func<sbyte, bool> <>9__3;
				foreach (KeyValuePair<ItemKey, int> keyValuePair in treasury.Inventory.Items)
				{
					ItemKey itemKey2;
					int num;
					keyValuePair.Deconstruct(out itemKey2, out num);
					ItemKey itemKey = itemKey2;
					bool addToList = false;
					List<ValueTuple<ItemKey, int>> selectableItemList;
					bool flag4 = !this._villagerSelectableItemKeys.TryGetValue((short)itemKey.ItemType, out selectableItemList);
					if (flag4)
					{
						selectableItemList = ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Get();
						this._villagerSelectableItemKeys[(short)itemKey.ItemType] = selectableItemList;
					}
					bool flag5 = ItemType.IsEquipmentItemType(itemKey.ItemType);
					if (flag5)
					{
						bool flag6 = !canChangeEquipment;
						if (flag6)
						{
							continue;
						}
						short itemSubType = ItemTemplateHelper.GetItemSubType(itemKey.ItemType, itemKey.TemplateId);
						sbyte slot = 0;
						Func<VillagerRoleItem, bool> <>9__2;
						while ((int)slot < equipments.Length)
						{
							ItemKey equipment = equipments[(int)slot];
							bool flag7 = itemKey.ItemType != EquipmentSlotHelper.GetSlotItemType(slot);
							if (!flag7)
							{
								bool flag8 = itemKey.ItemType == 3;
								if (flag8)
								{
									IEnumerable<VillagerRoleItem> instance = VillagerRole.Instance;
									Func<VillagerRoleItem, bool> predicate;
									if ((predicate = <>9__2) == null)
									{
										predicate = (<>9__2 = ((VillagerRoleItem r) => r.Clothing == itemKey.TemplateId));
									}
									bool isRoleClothing = instance.Any(predicate);
									bool flag9 = isRoleClothing;
									if (flag9)
									{
										goto IL_377;
									}
									bool flag10 = character.GetAgeGroup() != 2;
									if (flag10)
									{
										goto IL_377;
									}
								}
								bool flag11 = equipment.IsValid();
								if (flag11)
								{
									bool flag12 = itemKey.ItemType == 1 && itemSubType != ItemTemplateHelper.GetItemSubType(equipment.ItemType, equipment.TemplateId);
									if (!flag12)
									{
										bool targetHasMoreScore = this.CompareVillagerSelectableEquipments(equipment, itemKey, character);
										bool flag13 = targetHasMoreScore;
										if (flag13)
										{
											addToList = true;
										}
									}
								}
								else
								{
									addToList = true;
								}
							}
							IL_377:
							slot += 1;
						}
					}
					else
					{
						bool flag14 = itemKey.ItemType == 12;
						if (flag14)
						{
							bool flag15 = !canGainMisc;
							if (flag15)
							{
								continue;
							}
							addToList = true;
						}
						else
						{
							bool flag16 = itemKey.ItemType == 5;
							if (flag16)
							{
								bool flag17 = !canGainMaterial;
								if (flag17)
								{
									continue;
								}
								sbyte resourceType = ItemTemplateHelper.GetResourceType(itemKey.ItemType, itemKey.TemplateId);
								bool flag18 = resourceTypeSet == null || resourceTypeSet.Contains(resourceType);
								if (flag18)
								{
									addToList = true;
								}
							}
							else
							{
								bool flag19 = itemKey.ItemType == 10;
								if (flag19)
								{
									bool flag20 = !canGainBook;
									if (flag20)
									{
										continue;
									}
									bool flag21 = !character.BookIsReadable(itemKey);
									if (flag21)
									{
										continue;
									}
									SkillBookItem skillBookItem = Config.SkillBook.Instance[itemKey.TemplateId];
									bool flag22 = skillBookItem.ItemSubType == 1001;
									if (flag22)
									{
										bool flag23 = !roleCfg.LearnableCombatSkillTypes.Contains(skillBookItem.CombatSkillType);
										if (flag23)
										{
											continue;
										}
										CombatSkillKey combatSkillKey = new CombatSkillKey(character.GetId(), skillBookItem.CombatSkillTemplateId);
										GameData.Domains.CombatSkill.CombatSkill combatSkill;
										bool flag24 = DomainManager.CombatSkill.TryGetElement_CombatSkills(combatSkillKey, out combatSkill);
										if (flag24)
										{
											bool flag25 = !CombatSkillStateHelper.IsBrokenOut(combatSkill.GetActivationState()) && !combatSkill.CanBreakout();
											if (flag25)
											{
												addToList = true;
											}
										}
										else
										{
											addToList = true;
										}
									}
									else
									{
										bool flag26 = !roleCfg.LearnableLifeSkillTypes.Contains(skillBookItem.LifeSkillType);
										if (flag26)
										{
											continue;
										}
										addToList = true;
									}
								}
								else
								{
									bool flag27 = itemKey.ItemType == 6;
									if (flag27)
									{
										bool flag28 = !canGainTool;
										if (flag28)
										{
											continue;
										}
										bool flag29 = lifeSkillTypeSet != null;
										if (flag29)
										{
											CraftToolItem toolItem = Config.CraftTool.Instance[itemKey.TemplateId];
											IEnumerable<sbyte> requiredLifeSkillTypes = toolItem.RequiredLifeSkillTypes;
											Func<sbyte, bool> predicate2;
											if ((predicate2 = <>9__3) == null)
											{
												predicate2 = (<>9__3 = ((sbyte t) => lifeSkillTypeSet.Contains(t)));
											}
											bool flag30 = requiredLifeSkillTypes.Any(predicate2);
											if (flag30)
											{
												addToList = true;
											}
										}
									}
								}
							}
						}
					}
					bool flag31 = addToList;
					if (flag31)
					{
						selectableItemList.Add(new ValueTuple<ItemKey, int>(itemKey, 0));
					}
				}
				foreach (KeyValuePair<short, List<ValueTuple<ItemKey, int>>> keyValuePair2 in this._villagerSelectableItemKeys)
				{
					short num2;
					List<ValueTuple<ItemKey, int>> list3;
					keyValuePair2.Deconstruct(out num2, out list3);
					List<ValueTuple<ItemKey, int>> list = list3;
					TaiwuDomain.SortVillagerSelectableItemsByGrade(list);
				}
				bool flag32 = canChangeEquipment;
				if (flag32)
				{
					sbyte slot2 = 0;
					while ((int)slot2 < equipments.Length)
					{
						sbyte itemType = EquipmentSlotHelper.GetSlotItemType(slot2);
						List<ValueTuple<ItemKey, int>> items;
						bool flag33 = this._villagerSelectableItemKeys.TryGetValue((short)itemType, out items) && items.Count > 0;
						if (flag33)
						{
							this.SortVillagerSelectableEquipments(items, character);
							this.TakeHighestScoreVillagerSelectableItem(context, character, settlement, charClass, itemType, slot2);
						}
						slot2 += 1;
					}
				}
				bool flag34 = canGainBook;
				if (flag34)
				{
					List<ValueTuple<ItemKey, int>> items2;
					bool flag35 = this._villagerSelectableItemKeys.TryGetValue(10, out items2);
					if (flag35)
					{
						this.SortVillagerSelectableBooks(items2, character);
						this.TakeHighestScoreVillagerSelectableItem(context, character, settlement, charClass, 10, -1);
					}
				}
				bool flag36 = canGainTool;
				if (flag36)
				{
					this.TakeHighestScoreVillagerSelectableItem(context, character, settlement, charClass, 6, -1);
				}
				bool flag37 = canGainMisc;
				if (flag37)
				{
					this.TakeHighestScoreVillagerSelectableItem(context, character, settlement, charClass, 12, -1);
				}
				bool flag38 = canGainMaterial;
				if (flag38)
				{
					this.TakeHighestScoreVillagerSelectableItem(context, character, settlement, charClass, 5, -1);
				}
				foreach (KeyValuePair<short, List<ValueTuple<ItemKey, int>>> keyValuePair2 in this._villagerSelectableItemKeys)
				{
					short num2;
					List<ValueTuple<ItemKey, int>> list3;
					keyValuePair2.Deconstruct(out num2, out list3);
					List<ValueTuple<ItemKey, int>> list2 = list3;
					List<ItemKey> tempList = ObjectPool<List<ItemKey>>.Instance.Get();
					foreach (ValueTuple<ItemKey, int> valueTuple in list2)
					{
						ItemKey itemKey3 = valueTuple.Item1;
						int score = valueTuple.Item2;
						tempList.Add(itemKey3);
					}
					this.UpdateVillagerTreasuryNeed(context, character, settlement, tempList, true);
					ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Return(list2);
					ObjectPool<List<ItemKey>>.Instance.Return(tempList);
				}
				this._villagerSelectableItemKeys.Clear();
			}
		}

		// Token: 0x06001236 RID: 4662 RVA: 0x0011FB68 File Offset: 0x0011DD68
		private void TakeHighestScoreVillagerSelectableItem(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, sbyte charClass, sbyte itemType, sbyte slot = -1)
		{
			List<ValueTuple<ItemKey, int>> list;
			bool flag = !this._villagerSelectableItemKeys.TryGetValue((short)itemType, out list);
			if (!flag)
			{
				bool flag2 = list == null || list.Count <= 0;
				if (!flag2)
				{
					ItemKey equippedItem = (slot >= 0) ? character.GetEquipment()[(int)slot] : ItemKey.Invalid;
					short idealClothingTemplateId = character.GetIdealClothingTemplateId();
					VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(character.GetId());
					VillagerWorkData workData = (villagerRole != null) ? villagerRole.WorkData : null;
					BuildingBlockData blockData = null;
					bool flag3;
					if (itemType == 10)
					{
						sbyte? b = (workData != null) ? new sbyte?(workData.WorkType) : null;
						int? num = (b != null) ? new int?((int)b.GetValueOrDefault()) : null;
						int num2 = 1;
						flag3 = (num.GetValueOrDefault() == num2 & num != null);
					}
					else
					{
						flag3 = false;
					}
					bool flag4 = flag3;
					if (flag4)
					{
						DomainManager.Building.TryGetElement_BuildingBlocks(new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), out blockData);
					}
					bool waitingForBook = false;
					bool takeBook = false;
					for (int i = list.Count - 1; i >= 0; i--)
					{
						ValueTuple<ItemKey, int> tuple = list[i];
						sbyte itemGrade = ItemTemplateHelper.GetGrade(tuple.Item1.ItemType, tuple.Item1.TemplateId);
						bool notCheckClass = itemType == 3 && idealClothingTemplateId == tuple.Item1.TemplateId;
						bool flag5 = itemType == 10;
						if (flag5)
						{
							bool flag6 = DomainManager.Extra.GetVillagerRoleTemplateId(character.GetId()) == 5;
							if (flag6)
							{
								sbyte? b = (blockData != null) ? new sbyte?(blockData.ConfigData.RequireCombatSkillType) : null;
								int? num = (b != null) ? new int?((int)b.GetValueOrDefault()) : null;
								int num2 = 0;
								bool flag7;
								if (num.GetValueOrDefault() >= num2 & num != null)
								{
									int combatSkillType = (int)Config.SkillBook.Instance[tuple.Item1.TemplateId].CombatSkillType;
									b = ((blockData != null) ? new sbyte?(blockData.ConfigData.RequireCombatSkillType) : null);
									num = ((b != null) ? new int?((int)b.GetValueOrDefault()) : null);
									flag7 = (combatSkillType == num.GetValueOrDefault() & num != null);
								}
								else
								{
									flag7 = false;
								}
								bool flag8;
								takeBook = (flag8 = flag7);
								if (flag8)
								{
									waitingForBook = true;
								}
							}
							else
							{
								sbyte? b = (blockData != null) ? new sbyte?(blockData.ConfigData.RequireLifeSkillType) : null;
								int? num = (b != null) ? new int?((int)b.GetValueOrDefault()) : null;
								int num2 = 0;
								bool flag9;
								if (num.GetValueOrDefault() >= num2 & num != null)
								{
									int lifeSkillType = (int)Config.SkillBook.Instance[tuple.Item1.TemplateId].LifeSkillType;
									b = ((blockData != null) ? new sbyte?(blockData.ConfigData.RequireLifeSkillType) : null);
									num = ((b != null) ? new int?((int)b.GetValueOrDefault()) : null);
									flag9 = (lifeSkillType == num.GetValueOrDefault() & num != null);
								}
								else
								{
									flag9 = false;
								}
								bool flag10;
								takeBook = (flag10 = flag9);
								if (flag10)
								{
									waitingForBook = true;
								}
							}
						}
						bool classIsMeet = notCheckClass || charClass >= itemGrade;
						bool flag11 = !classIsMeet;
						if (!flag11)
						{
							bool flag12 = !this.IsMeetInventoryLoad(character, tuple.Item1);
							if (!flag12)
							{
								bool flag13 = ItemType.IsEquipmentItemType(tuple.Item1.ItemType);
								if (flag13)
								{
									bool flag14 = !EquipmentSlotHelper.IsItemMeetSlot(slot, tuple.Item1);
									if (flag14)
									{
										goto IL_43B;
									}
									bool shouldTake = this.ShouldTakeEquipment(character, equippedItem, tuple.Item1, true);
									bool flag15 = !shouldTake;
									if (flag15)
									{
										goto IL_43B;
									}
								}
								bool flag16 = itemType == 10 && waitingForBook && !takeBook;
								if (!flag16)
								{
									this.VillagerTakeItemFromTreasury(context, character, tuple.Item1, 1);
									character.AddInventoryItem(context, tuple.Item1, 1, false);
									this.HandleVillagerGainTreasuryItem(context, tuple.Item1, character);
									list.RemoveAt(i);
									break;
								}
							}
						}
						IL_43B:;
					}
				}
			}
		}

		// Token: 0x06001237 RID: 4663 RVA: 0x0011FFC8 File Offset: 0x0011E1C8
		private void RemoveInvalidVillagerPersonalNeed(GameData.Domains.Character.Character selfChar)
		{
			List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds = selfChar.GetPersonalNeeds();
			for (int i = personalNeeds.Count - 1; i >= 0; i--)
			{
				GameData.Domains.Character.Ai.PersonalNeed need = personalNeeds[i];
				bool flag = !need.CheckValid(selfChar);
				if (flag)
				{
					CollectionUtils.SwapAndRemove<GameData.Domains.Character.Ai.PersonalNeed>(personalNeeds, i);
				}
			}
		}

		// Token: 0x06001238 RID: 4664 RVA: 0x0012001C File Offset: 0x0011E21C
		private void HandleVillagerGainTreasuryItem(DataContext context, ItemKey itemKey, GameData.Domains.Character.Character character)
		{
			sbyte itemType = itemKey.ItemType;
			sbyte b = itemType;
			if (b <= 4)
			{
				this.HandleVillagerGainTreasuryEquipment(context, itemKey, character);
			}
		}

		// Token: 0x06001239 RID: 4665 RVA: 0x00120048 File Offset: 0x0011E248
		private void HandleVillagerGainTreasuryEquipment(DataContext context, ItemKey itemKey, GameData.Domains.Character.Character character)
		{
			Settlement settlement = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId);
			ItemKey[] equipment = character.GetEquipment();
			short idealClothingTemplateId = character.GetIdealClothingTemplateId();
			IReadOnlyDictionary<ItemKey, int> taiwuGiftItems = DomainManager.Taiwu.IsInGroup(character.GetId()) ? DomainManager.Extra.GetTaiwuGiftItems(character.GetId()) : Inventory.Empty;
			sbyte slot = 0;
			while ((int)slot < equipment.Length)
			{
				bool flag = !EquipmentSlotHelper.IsItemMeetSlot(slot, itemKey);
				if (!flag)
				{
					ItemKey equippedItem = equipment[(int)slot];
					bool flag2 = equippedItem.IsValid();
					if (!flag2)
					{
						bool isMeetEquipmentLoad = this.IsMeetEquipmentLoad(character, equippedItem, itemKey);
						bool flag3 = !isMeetEquipmentLoad;
						if (!flag3)
						{
							character.ChangeEquipment(context, -1, slot, itemKey);
							return;
						}
					}
				}
				slot += 1;
			}
			sbyte slot2 = 0;
			while ((int)slot2 < equipment.Length)
			{
				bool flag4 = !EquipmentSlotHelper.IsItemMeetSlot(slot2, itemKey);
				if (!flag4)
				{
					ItemKey equippedItem2 = equipment[(int)slot2];
					bool isMeetEquipmentLoad2 = this.IsMeetEquipmentLoad(character, equippedItem2, itemKey);
					bool flag5 = !isMeetEquipmentLoad2;
					if (!flag5)
					{
						bool flag6 = !equippedItem2.IsValid();
						if (!flag6)
						{
							bool shouldChange = this.CompareEquipmentScore(equippedItem2, itemKey, character);
							bool flag7 = shouldChange;
							if (flag7)
							{
								character.ChangeEquipment(context, slot2, -1, equippedItem2);
								character.ChangeEquipment(context, -1, slot2, itemKey);
								bool shouldNotStore = itemKey.ItemType == 3 && itemKey.TemplateId == idealClothingTemplateId && equippedItem2.TemplateId != idealClothingTemplateId;
								bool flag8 = taiwuGiftItems.ContainsKey(itemKey);
								if (flag8)
								{
									shouldNotStore = true;
								}
								bool flag9 = !shouldNotStore;
								if (flag9)
								{
									character.RemoveInventoryItem(context, equippedItem2, 1, false, false);
									DomainManager.Taiwu.VillagerStoreItemInTreasury(context, character, equippedItem2, 1, true);
								}
								break;
							}
						}
					}
				}
				slot2 += 1;
			}
		}

		// Token: 0x0600123A RID: 4666 RVA: 0x00120214 File Offset: 0x0011E414
		private ItemKey RemovePersonalNeedSelectedItem<T>(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, [TupleElementNames(new string[]
		{
			"item",
			"amount"
		})] List<ValueTuple<T, int>> items, List<ItemKey> selections) where T : ItemBase
		{
			ItemKey itemKey = this.InternalRemovePersonalNeedSelectedItem(context, character, settlement, selections);
			bool hasMeetItem = itemKey.IsValid();
			bool flag = hasMeetItem;
			if (flag)
			{
				int finalSelectedIndex = items.FindIndex(([TupleElementNames(new string[]
				{
					"item",
					"amount"
				})] ValueTuple<T, int> i) => i.Item1.GetItemKey() == itemKey);
				bool flag2 = finalSelectedIndex >= 0;
				if (flag2)
				{
					ValueTuple<T, int> valueTuple = items[finalSelectedIndex];
					T item = valueTuple.Item1;
					int amount = valueTuple.Item2;
					bool flag3 = amount > 1;
					if (flag3)
					{
						items[finalSelectedIndex] = new ValueTuple<T, int>(item, amount - 1);
					}
					else
					{
						items.RemoveAt(finalSelectedIndex);
					}
				}
			}
			return itemKey;
		}

		// Token: 0x0600123B RID: 4667 RVA: 0x001202BC File Offset: 0x0011E4BC
		private ItemKey InternalRemovePersonalNeedSelectedItem(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, List<ItemKey> itemKeyList)
		{
			sbyte charClass = this._villagerClassDict[character.GetId()];
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			int index = itemKeyList.Count - 1;
			while (index >= 0)
			{
				ItemKey itemKey = itemKeyList[index];
				sbyte itemGrade = ItemTemplateHelper.GetGrade(itemKey.ItemType, itemKey.TemplateId);
				int treasuryAmount = treasury.Inventory.GetInventoryItemCount(itemKey);
				bool flag = treasuryAmount > 0 && charClass >= itemGrade;
				ItemKey result;
				if (flag)
				{
					this.VillagerTakeItemFromTreasury(context, character, itemKey, 1);
					itemKeyList.RemoveAt(index);
					result = itemKey;
				}
				else
				{
					int inventoryAmount = character.GetInventory().GetInventoryItemCount(itemKey);
					bool flag2 = inventoryAmount > 0;
					if (!flag2)
					{
						index--;
						continue;
					}
					character.RemoveInventoryItem(context, itemKey, 1, true, false);
					itemKeyList.RemoveAt(index);
					result = itemKey;
				}
				return result;
			}
			return ItemKey.Invalid;
		}

		// Token: 0x0600123C RID: 4668 RVA: 0x001203A4 File Offset: 0x0011E5A4
		private void UpdateVillagerTreasuryNeed(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, List<ItemKey> itemKeyList, bool listIsFromTreasuryOnly)
		{
			sbyte charClass = this._villagerClassDict[character.GetId()];
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			ItemKey targetItemKey = ItemKey.Invalid;
			int i = itemKeyList.Count - 1;
			while (i >= 0)
			{
				ItemKey itemKey = itemKeyList[i];
				bool flag = !listIsFromTreasuryOnly;
				if (!flag)
				{
					goto IL_70;
				}
				int treasuryAmount = treasury.Inventory.GetInventoryItemCount(itemKey);
				bool flag2 = treasuryAmount <= 0;
				if (!flag2)
				{
					goto IL_70;
				}
				IL_94:
				i--;
				continue;
				IL_70:
				bool canNeedTreasuryItem = this.CanNeedTreasuryItem(character, settlement, itemKey, (int)charClass);
				bool flag3 = !canNeedTreasuryItem;
				if (flag3)
				{
					goto IL_94;
				}
				targetItemKey = itemKey;
				break;
			}
			bool flag4 = !targetItemKey.IsValid();
			if (!flag4)
			{
				VillagerTreasuryNeed villagerTreasuryNeed;
				bool flag5 = !DomainManager.Extra.TryGetVillagerTreasuryNeed(character.GetId(), out villagerTreasuryNeed);
				if (flag5)
				{
					villagerTreasuryNeed = new VillagerTreasuryNeed();
					villagerTreasuryNeed.PersonalNeeds = new List<GameData.Domains.Character.Ai.PersonalNeed>();
				}
				int findIndex = villagerTreasuryNeed.PersonalNeeds.FindIndex((GameData.Domains.Character.Ai.PersonalNeed n) => n.ItemType == targetItemKey.ItemType);
				bool flag6 = findIndex >= 0;
				GameData.Domains.Character.Ai.PersonalNeed personalNeed;
				if (flag6)
				{
					personalNeed = villagerTreasuryNeed.PersonalNeeds[findIndex];
					ItemKey oldKey = new ItemKey(personalNeed.ItemType, 0, personalNeed.ItemTemplateId, -1);
					targetItemKey.Id = -1;
					bool hasMoreScore = this.CompareVillagerSelectableItems(oldKey, targetItemKey, character);
					bool flag7 = !hasMoreScore;
					if (flag7)
					{
						return;
					}
					sbyte itemGrade = ItemTemplateHelper.GetGrade(targetItemKey.ItemType, targetItemKey.TemplateId);
					sbyte waitTime = TaiwuDomain.CalcVillagerTreasuryNeedWaitTime(charClass, itemGrade);
					personalNeed.RemainingMonths = waitTime;
					personalNeed.ItemTemplateId = targetItemKey.TemplateId;
					villagerTreasuryNeed.PersonalNeeds[findIndex] = personalNeed;
				}
				else
				{
					sbyte itemGrade2 = ItemTemplateHelper.GetGrade(targetItemKey.ItemType, targetItemKey.TemplateId);
					sbyte waitTime2 = TaiwuDomain.CalcVillagerTreasuryNeedWaitTime(charClass, itemGrade2);
					personalNeed = GameData.Domains.Character.Ai.PersonalNeed.CreatePersonalNeed(10, targetItemKey.ItemType, targetItemKey.TemplateId);
					personalNeed.RemainingMonths = waitTime2;
					villagerTreasuryNeed.PersonalNeeds.Add(personalNeed);
					DomainManager.Extra.SetVillagerTreasuryNeed(context, character.GetId(), villagerTreasuryNeed);
				}
				this.AddNeededItem(personalNeed, character.GetId());
			}
		}

		// Token: 0x0600123D RID: 4669 RVA: 0x001205F4 File Offset: 0x0011E7F4
		private bool CanNeedTreasuryItem(GameData.Domains.Character.Character character, Settlement settlement, ItemKey itemKey, int charClass)
		{
			SettlementCharacter settlementCharacter = DomainManager.Organization.GetSettlementCharacter(character.GetId());
			short curInfluencePower = settlementCharacter.GetInfluencePower();
			sbyte itemGrade = ItemTemplateHelper.GetGrade(itemKey.ItemType, itemKey.TemplateId);
			bool flag = (int)itemGrade <= charClass;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				ItemKey tempKey = ItemKey.Invalid;
				tempKey.ItemType = itemKey.ItemType;
				tempKey.TemplateId = itemKey.TemplateId;
				Dictionary<int, sbyte> dict;
				bool flag2 = !this._treasuryNeededItemDict.TryGetValue(tempKey, out dict);
				if (flag2)
				{
					result = true;
				}
				else
				{
					int itemCount = this.GetTaiwuTreasury().Inventory.GetInventoryItemCount(tempKey.ItemType, tempKey.TemplateId);
					bool flag3 = itemCount > dict.Count;
					if (flag3)
					{
						result = true;
					}
					else
					{
						bool curIsHigher = dict.Keys.All(delegate(int charId)
						{
							bool flag4 = DomainManager.Organization.TryGetSettlementCharacter(charId, out settlementCharacter);
							bool result2;
							if (flag4)
							{
								short influencePower = settlementCharacter.GetInfluencePower();
								result2 = (curInfluencePower > influencePower);
							}
							else
							{
								result2 = true;
							}
							return result2;
						});
						result = curIsHigher;
					}
				}
			}
			return result;
		}

		// Token: 0x0600123E RID: 4670 RVA: 0x001206E8 File Offset: 0x0011E8E8
		public bool IsMeetWorkStatus(GameData.Domains.Character.Character character, Settlement settlement)
		{
			byte workStatus = this.GetVillagerWorkStatus(character);
			bool isNotWorking = workStatus != 2;
			sbyte memberGrade = character.GetOrganizationInfo().Grade;
			bool hasNoneRole = memberGrade == 0;
			bool flag = isNotWorking && hasNoneRole;
			if (flag)
			{
				Location settlementLocation = settlement.GetLocation();
				bool flag2 = settlementLocation.AreaId != character.GetLocation().AreaId;
				if (flag2)
				{
					return false;
				}
				bool flag3 = !DomainManager.Map.IsLocationInSettlementInfluenceRange(character.GetLocation(), this._taiwuVillageSettlementId);
				if (flag3)
				{
					return false;
				}
			}
			return true;
		}

		// Token: 0x0600123F RID: 4671 RVA: 0x00120778 File Offset: 0x0011E978
		private bool IsMeetInventoryLoad(GameData.Domains.Character.Character character, ItemKey itemKey)
		{
			int weight = DomainManager.Item.GetBaseItem(itemKey).GetWeight();
			bool flag = weight == 0;
			bool result;
			if (flag)
			{
				result = true;
			}
			else
			{
				int curLoad = character.GetCurrInventoryLoad();
				int maxLoad = character.GetMaxInventoryLoad();
				result = (curLoad + weight <= maxLoad);
			}
			return result;
		}

		// Token: 0x06001240 RID: 4672 RVA: 0x001207C4 File Offset: 0x0011E9C4
		private bool IsMeetEquipmentLoad(GameData.Domains.Character.Character character, ItemKey oldItemKey, ItemKey newItemKey)
		{
			int newWeight = oldItemKey.IsValid() ? DomainManager.Item.GetBaseItem(newItemKey).GetWeight() : 0;
			bool flag = newWeight == 0;
			bool result;
			if (flag)
			{
				result = true;
			}
			else
			{
				int oldWeight = oldItemKey.IsValid() ? DomainManager.Item.GetBaseItem(oldItemKey).GetWeight() : 0;
				int curLoad = character.GetCurrEquipmentLoad();
				int maxLoad = character.GetMaxEquipmentLoad();
				result = (curLoad - oldWeight + newWeight <= maxLoad);
			}
			return result;
		}

		// Token: 0x06001241 RID: 4673 RVA: 0x0012083C File Offset: 0x0011EA3C
		private bool ShouldTakeEquipment(GameData.Domains.Character.Character character, ItemKey equippedItem, ItemKey itemKey, bool checkEquipmentLoad)
		{
			bool isMeetEquipmentLoad = !checkEquipmentLoad || this.IsMeetEquipmentLoad(character, equippedItem, itemKey);
			bool flag = !isMeetEquipmentLoad;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				bool flag2 = itemKey.ItemType == 0;
				if (flag2)
				{
					short itemSubType = ItemTemplateHelper.GetItemSubType(itemKey.ItemType, itemKey.TemplateId);
					bool hasSame = character.GetEquipment().Exist((ItemKey e) => e.IsValid() && itemSubType == ItemTemplateHelper.GetItemSubType(e.ItemType, e.TemplateId));
					bool flag3 = hasSame;
					if (flag3)
					{
						return false;
					}
				}
				bool flag4 = equippedItem.IsValid();
				if (flag4)
				{
					bool shouldChange = this.CompareEquipmentScore(equippedItem, itemKey, character);
					result = shouldChange;
				}
				else
				{
					result = true;
				}
			}
			return result;
		}

		// Token: 0x06001242 RID: 4674 RVA: 0x001208E0 File Offset: 0x0011EAE0
		private bool ShouldTakeEquipment(GameData.Domains.Character.Character character, ItemKey targetItemKey, bool checkEquipmentLoad)
		{
			bool flag = !ItemType.IsEquipmentItemType(targetItemKey.ItemType);
			bool result;
			if (flag)
			{
				result = true;
			}
			else
			{
				ItemKey[] equipment = character.GetEquipment();
				sbyte slot = 0;
				while ((int)slot < equipment.Length)
				{
					bool flag2 = !EquipmentSlotHelper.IsItemMeetSlot(slot, targetItemKey);
					if (!flag2)
					{
						ItemKey equippedItem = equipment[(int)slot];
						bool shouldTake = this.ShouldTakeEquipment(character, equippedItem, targetItemKey, checkEquipmentLoad);
						bool flag3 = shouldTake;
						if (flag3)
						{
							return true;
						}
					}
					slot += 1;
				}
				result = false;
			}
			return result;
		}

		// Token: 0x06001243 RID: 4675 RVA: 0x0012095C File Offset: 0x0011EB5C
		private bool CompareEquipmentScore(ItemKey selfKey, ItemKey targetKey, GameData.Domains.Character.Character character)
		{
			bool flag = !ItemType.IsEquipmentItemType(selfKey.ItemType);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				bool flag2 = selfKey.ItemType == 0;
				if (flag2)
				{
					this._availableWeapons.Clear();
					this._suitableWeapons.Clear();
					this._availableWeapons.Add(new ValueTuple<ItemKey, int>(selfKey, 0));
					this._availableWeapons.Add(new ValueTuple<ItemKey, int>(targetKey, 0));
					Equipping.GetWeaponScores(character, this._availableWeapons, this._suitableWeapons, this._fixedBestWeapons);
					result = (this._availableWeapons[1].Item2 > this._availableWeapons[0].Item2);
				}
				else
				{
					bool flag3 = selfKey.ItemType == 3;
					if (flag3)
					{
						short idealClothingTemplateId = character.GetIdealClothingTemplateId();
						bool flag4 = selfKey.TemplateId == idealClothingTemplateId;
						if (flag4)
						{
							result = false;
						}
						else
						{
							bool flag5 = targetKey.TemplateId == idealClothingTemplateId;
							if (flag5)
							{
								result = true;
							}
							else
							{
								bool selfIsRoleClothing = VillagerRole.Instance.Any((VillagerRoleItem r) => r.Clothing == selfKey.TemplateId);
								bool targetIsRoleClothing = VillagerRole.Instance.Any((VillagerRoleItem r) => r.Clothing == targetKey.TemplateId);
								bool flag6 = selfIsRoleClothing != targetIsRoleClothing;
								if (flag6)
								{
									result = !targetIsRoleClothing;
								}
								else
								{
									ValueTuple<int, bool> selfScore = Equipping.CalcEquipmentScore(selfKey, -1);
									ValueTuple<int, bool> targetScore = Equipping.CalcEquipmentScore(targetKey, -1);
									result = (targetScore.Item1 > selfScore.Item1);
								}
							}
						}
					}
					else
					{
						ValueTuple<int, bool> selfScore2 = Equipping.CalcEquipmentScore(selfKey, -1);
						ValueTuple<int, bool> targetScore2 = Equipping.CalcEquipmentScore(targetKey, -1);
						result = (targetScore2.Item1 > selfScore2.Item1);
					}
				}
			}
			return result;
		}

		// Token: 0x06001244 RID: 4676 RVA: 0x00120B3C File Offset: 0x0011ED3C
		private unsafe void CategorizedRegenItems(IReadOnlyDictionary<ItemKey, int> inventoryItems)
		{
			foreach (List<ValueTuple<GameData.Domains.Item.Medicine, int>> list in this._categorizedMedicines)
			{
				list.Clear();
			}
			foreach (List<ValueTuple<GameData.Domains.Item.Food, int>> list2 in this._foodsForMainAttributes)
			{
				list2.Clear();
			}
			this._teaWinesForHappiness.Clear();
			this._itemsForNeili.Clear();
			foreach (KeyValuePair<ItemKey, int> keyValuePair in inventoryItems)
			{
				ItemKey itemKey2;
				int num;
				keyValuePair.Deconstruct(out itemKey2, out num);
				ItemKey itemKey = itemKey2;
				int amount = num;
				switch (itemKey.ItemType)
				{
				case 7:
				{
					FoodItem config = Config.Food.Instance[itemKey.TemplateId];
					for (sbyte attrType = 0; attrType < 6; attrType += 1)
					{
						bool flag = *(ref config.MainAttributesRegen.Items.FixedElementField + (IntPtr)attrType * 2) <= 0;
						if (!flag)
						{
							GameData.Domains.Item.Food item = DomainManager.Item.GetElement_Foods(itemKey.Id);
							this._foodsForMainAttributes[(int)attrType].Add(new ValueTuple<GameData.Domains.Item.Food, int>(item, amount));
							break;
						}
					}
					break;
				}
				case 8:
				{
					MedicineItem config2 = Config.Medicine.Instance[itemKey.TemplateId];
					bool flag2 = config2.EffectType == EMedicineEffectType.Invalid;
					if (!flag2)
					{
						GameData.Domains.Item.Medicine item2 = DomainManager.Item.GetElement_Medicines(itemKey.Id);
						this._categorizedMedicines[(int)config2.EffectType].Add(new ValueTuple<GameData.Domains.Item.Medicine, int>(item2, amount));
					}
					break;
				}
				case 9:
				{
					bool flag3 = DomainManager.Item.GetBaseItem(itemKey).GetHappinessChange() <= 0;
					if (!flag3)
					{
						GameData.Domains.Item.TeaWine item3 = DomainManager.Item.GetElement_TeaWines(itemKey.Id);
						this._teaWinesForHappiness.Add(new ValueTuple<GameData.Domains.Item.TeaWine, int>(item3, amount));
					}
					break;
				}
				case 12:
				{
					MiscItem config3 = Config.Misc.Instance[itemKey.TemplateId];
					GameData.Domains.Item.Misc item4 = DomainManager.Item.GetElement_Misc(itemKey.Id);
					bool flag4 = config3.Neili > 0;
					if (flag4)
					{
						this._itemsForNeili.Add(new ValueTuple<GameData.Domains.Item.Misc, int>(item4, amount));
					}
					break;
				}
				}
			}
		}

		// Token: 0x06001245 RID: 4677 RVA: 0x00120DBC File Offset: 0x0011EFBC
		private void AddNeededItem(GameData.Domains.Character.Ai.PersonalNeed personalNeed, int charId)
		{
			ItemKey tempKey = ItemKey.Invalid;
			tempKey.ItemType = personalNeed.ItemType;
			tempKey.TemplateId = personalNeed.ItemTemplateId;
			Dictionary<int, sbyte> charDict;
			bool flag = !this._treasuryNeededItemDict.TryGetValue(tempKey, out charDict);
			if (flag)
			{
				charDict = new Dictionary<int, sbyte>();
				this._treasuryNeededItemDict[tempKey] = charDict;
			}
			charDict[charId] = personalNeed.RemainingMonths;
		}

		// Token: 0x06001246 RID: 4678 RVA: 0x00120E24 File Offset: 0x0011F024
		private unsafe void HandleVillagerPersonalNeedForHealingAndDetox(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			sbyte currMaxEatingSlotsCount = character.GetCurrMaxEatingSlotsCount();
			int availableEatingSlotsCount = character.GetEatingItems().GetAvailableEatingSlotsCount(currMaxEatingSlotsCount);
			PoisonInts poisonResists = *character.GetPoisonResists();
			MainAttributes currMainAttributes = character.GetCurrMainAttributes();
			Injuries injuries = character.GetInjuries();
			PoisonInts poisoned = *character.GetPoisoned();
			short disorderOfQi = character.GetDisorderOfQi();
			List<ValueTuple<GameData.Domains.Item.Medicine, int>>[] categorizedMedicines = this._categorizedMedicines;
			List<ValueTuple<GameData.Domains.Item.Medicine, int>> outerMedicines = categorizedMedicines[0];
			List<ValueTuple<GameData.Domains.Item.Medicine, int>> innerMedicines = categorizedMedicines[1];
			outerMedicines.Sort(EatingItemComparer.MedicineInjury);
			innerMedicines.Sort(EatingItemComparer.MedicineInjury);
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			for (sbyte bodyPart = 0; bodyPart < 7; bodyPart += 1)
			{
				ValueTuple<sbyte, sbyte> valueTuple = injuries.Get(bodyPart);
				sbyte outer = valueTuple.Item1;
				sbyte inner = valueTuple.Item2;
				bool flag = outer > 2 && outerMedicines.Count > 0;
				if (flag)
				{
					int selectedIndex = character.SelectTopicalMedicineIndex(outerMedicines, outer, ref currMainAttributes, selections);
					bool flag2 = selectedIndex >= 0;
					if (flag2)
					{
						ItemKey itemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, outerMedicines, selections);
						bool flag3 = itemKey.IsValid();
						if (flag3)
						{
							DomainManager.Item.RemoveItem(context, itemKey);
							character.ApplyTopicalMedicine(context, itemKey);
							bool flag4 = personalNeed.CheckValid(character);
							if (flag4)
							{
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
						}
						else
						{
							this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
						}
					}
				}
				bool flag5 = inner > 2 && innerMedicines.Count > 0;
				if (flag5)
				{
					int selectedIndex2 = character.SelectTopicalMedicineIndex(innerMedicines, inner, ref currMainAttributes, selections);
					bool flag6 = selectedIndex2 >= 0;
					if (flag6)
					{
						ItemKey itemKey2 = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, innerMedicines, selections);
						bool flag7 = itemKey2.IsValid();
						if (flag7)
						{
							DomainManager.Item.RemoveItem(context, itemKey2);
							character.ApplyTopicalMedicine(context, itemKey2);
							bool flag8 = personalNeed.CheckValid(character);
							if (flag8)
							{
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
						}
					}
					else
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
					}
				}
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
			categorizedMedicines[3].Sort(EatingItemComparer.MedicineQiDisorder);
			int* healthChanges = stackalloc int[(UIntPtr)12];
			while (availableEatingSlotsCount > 1)
			{
				*healthChanges = GameData.Domains.Character.Character.GetHealthChangeDueToInjuries(ref injuries) << 8;
				healthChanges[1] = (GameData.Domains.Character.Character.GetHealthChangeDueToPoisons(ref poisoned, ref poisonResists) << 8) + 1;
				healthChanges[2] = (character.GetHealthChangeDueToDisorderOfQi(disorderOfQi) << 8) + 2;
				CollectionUtils.Sort(healthChanges, 3);
				bool flag9 = *healthChanges >> 8 >= 0;
				if (flag9)
				{
					break;
				}
				bool flag10 = !this.HandleVillagerPersonalNeedForHealingAndDetoxHelper(context, healthChanges, character, settlement, personalNeed);
				if (flag10)
				{
					break;
				}
				availableEatingSlotsCount--;
			}
		}

		// Token: 0x06001247 RID: 4679 RVA: 0x001210C0 File Offset: 0x0011F2C0
		private unsafe bool HandleVillagerPersonalNeedForHealingAndDetoxHelper(DataContext context, int* healthChanges, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			PoisonInts poisonResists = *character.GetPoisonResists();
			Injuries injuries = character.GetInjuries();
			PoisonInts poisoned = *character.GetPoisoned();
			short disorderOfQi = character.GetDisorderOfQi();
			List<ValueTuple<GameData.Domains.Item.Medicine, int>>[] categorizedMedicines = this._categorizedMedicines;
			int* poisonLevels = stackalloc int[(UIntPtr)24];
			int i = 0;
			while (i < 3)
			{
				int type = healthChanges[i] & 255;
				int deltaHealth = healthChanges[i] >> 8;
				bool flag = deltaHealth >= 0;
				if (flag)
				{
					break;
				}
				switch (type)
				{
				case 0:
				{
					List<ValueTuple<GameData.Domains.Item.Medicine, int>> outerMedicines = categorizedMedicines[0];
					List<ValueTuple<GameData.Domains.Item.Medicine, int>> innerMedicines = categorizedMedicines[1];
					sbyte innerInjuryMinLevel = sbyte.MaxValue;
					sbyte outerInjuryMinLevel = sbyte.MaxValue;
					sbyte outerInjuryTotalLevel = 0;
					sbyte innerInjuryTotalLevel = 0;
					for (sbyte bodyPart = 0; bodyPart < 7; bodyPart += 1)
					{
						ValueTuple<sbyte, sbyte> valueTuple = injuries.Get(bodyPart);
						sbyte outer = valueTuple.Item1;
						sbyte inner = valueTuple.Item2;
						outerInjuryTotalLevel += outer;
						innerInjuryTotalLevel += inner;
						bool flag2 = outer > 0 && outer < outerInjuryMinLevel;
						if (flag2)
						{
							outerInjuryMinLevel = outer;
						}
						bool flag3 = inner > 0 && inner < innerInjuryMinLevel;
						if (flag3)
						{
							innerInjuryMinLevel = inner;
						}
					}
					bool flag4 = outerMedicines.Count > 0 && outerInjuryMinLevel > innerInjuryMinLevel && outerInjuryMinLevel <= 6;
					if (flag4)
					{
						int medicineIndex = character.SelectMedicineIndexForInjury(outerMedicines, outerInjuryMinLevel, outerInjuryTotalLevel, selections);
						bool flag5 = medicineIndex >= 0;
						if (flag5)
						{
							ItemKey itemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, outerMedicines, selections);
							bool flag6 = itemKey.IsValid();
							if (flag6)
							{
								character.AddEatingItem(context, itemKey, null);
								bool flag7 = personalNeed.CheckValid(character);
								if (flag7)
								{
									this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
								}
								return true;
							}
							this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
						}
					}
					bool flag8 = innerMedicines.Count > 0 && innerInjuryMinLevel <= 6;
					if (flag8)
					{
						int medicineIndex = character.SelectMedicineIndexForInjury(innerMedicines, innerInjuryMinLevel, innerInjuryTotalLevel, selections);
						bool flag9 = medicineIndex >= 0;
						if (flag9)
						{
							ItemKey itemKey2 = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, innerMedicines, selections);
							bool flag10 = itemKey2.IsValid();
							if (flag10)
							{
								character.AddEatingItem(context, itemKey2, null);
								bool flag11 = personalNeed.CheckValid(character);
								if (flag11)
								{
									this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
								}
								return true;
							}
							this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
						}
					}
					break;
				}
				case 1:
				{
					List<ValueTuple<GameData.Domains.Item.Medicine, int>> detoxMedicines = this._categorizedMedicines[4];
					bool flag12 = detoxMedicines.Count <= 0;
					if (!flag12)
					{
						detoxMedicines.Sort(new Comparison<ValueTuple<GameData.Domains.Item.Medicine, int>>(character.CompareDetoxPoisonMedicines));
						for (sbyte poisonType = 0; poisonType < 6; poisonType += 1)
						{
							int level = (int)((*(ref poisonResists.Items.FixedElementField + (IntPtr)poisonType * 4) >= 1000) ? 0 : PoisonsAndLevels.CalcPoisonedLevel(*(ref poisoned.Items.FixedElementField + (IntPtr)poisonType * 4)));
							poisonLevels[poisonType] = (level << 8) + (int)poisonType;
						}
						CollectionUtils.Sort(poisonLevels, 6);
						for (sbyte index = 5; index >= 0; index -= 1)
						{
							sbyte poisonType2 = (sbyte)(poisonLevels[index] & 255);
							sbyte level2 = (sbyte)(poisonLevels[index] >> 8);
							bool flag13 = level2 <= 0;
							if (flag13)
							{
								break;
							}
							int medicineIndex2 = character.SelectMedicineIndexForDetoxPoison(detoxMedicines, poisonType2, level2, *(ref poisoned.Items.FixedElementField + (IntPtr)poisonType2 * 4), selections);
							bool flag14 = medicineIndex2 < 0;
							if (!flag14)
							{
								ItemKey itemKey3 = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, detoxMedicines, selections);
								bool flag15 = itemKey3.IsValid();
								if (flag15)
								{
									character.AddEatingItem(context, itemKey3, null);
									bool flag16 = personalNeed.CheckValid(character);
									if (flag16)
									{
										this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
									}
									return true;
								}
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
						}
					}
					break;
				}
				case 2:
				{
					List<ValueTuple<GameData.Domains.Item.Medicine, int>> qiMedicines = this._categorizedMedicines[3];
					int selectedIndex = character.SelectMedicineIndexForQiDisorder(qiMedicines, disorderOfQi, selections);
					bool flag17 = selectedIndex >= 0;
					if (flag17)
					{
						ItemKey itemKey4 = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, qiMedicines, selections);
						bool flag18 = itemKey4.IsValid();
						if (flag18)
						{
							character.AddEatingItem(context, itemKey4, null);
							bool flag19 = personalNeed.CheckValid(character);
							if (flag19)
							{
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
							return true;
						}
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
					}
					break;
				}
				}
				IL_465:
				i++;
				continue;
				goto IL_465;
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
			return false;
		}

		// Token: 0x06001248 RID: 4680 RVA: 0x0012155C File Offset: 0x0011F75C
		private void HandleVillagerPersonalNeedForHeath(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			short health = character.GetHealth();
			short leftMaxHealth = character.GetLeftMaxHealth(false);
			sbyte currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
			sbyte eatingSlot = character.GetEatingItems().GetAvailableEatingSlot(currMaxEatingSlotCount);
			List<ValueTuple<GameData.Domains.Item.Medicine, int>> medicines = this._categorizedMedicines[2];
			bool flag = eatingSlot >= 0 && medicines.Count > 0;
			if (flag)
			{
				medicines.Sort(EatingItemComparer.MedicineEffect);
				while (eatingSlot >= 0 && health < leftMaxHealth)
				{
					int selectedIndex = character.SelectMedicineIndexForHealth(medicines, health, leftMaxHealth, selections);
					bool flag2 = selectedIndex < 0;
					if (flag2)
					{
						break;
					}
					ItemKey itemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, medicines, selections);
					bool flag3 = !itemKey.IsValid();
					if (flag3)
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
						break;
					}
					character.AddEatingItem(context, itemKey, null);
					bool flag4 = personalNeed.CheckValid(character);
					if (flag4)
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
					}
					health = character.GetHealth();
					leftMaxHealth = character.GetLeftMaxHealth(false);
					currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
					eatingSlot = character.GetEatingItems().GetAvailableEatingSlot(currMaxEatingSlotCount);
				}
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
		}

		// Token: 0x06001249 RID: 4681 RVA: 0x00121688 File Offset: 0x0011F888
		private unsafe void HandleVillagerPersonalNeedForWug(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			EatingItems eatingItems = *character.GetEatingItems();
			sbyte currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
			sbyte eatingSlot = eatingItems.GetAvailableEatingSlot(currMaxEatingSlotCount);
			List<ValueTuple<GameData.Domains.Item.Medicine, int>> medicines = this._categorizedMedicines[5];
			List<ValueTuple<GameData.Domains.Item.Medicine, int>> poisons = this._categorizedMedicines[6];
			bool flag = eatingSlot >= 0 && (medicines.Count > 0 || poisons.Count > 0);
			if (flag)
			{
				medicines.Sort(EatingItemComparer.MedicineGrade);
				poisons.Sort(EatingItemComparer.MedicineGrade);
				for (sbyte currSlot = 0; currSlot < 9; currSlot += 1)
				{
					ItemKey itemKey = (ItemKey)(*(ref eatingItems.ItemKeys.FixedElementField + (IntPtr)currSlot * 8));
					bool flag2 = !EatingItems.IsWug(itemKey) || itemKey.IsValid();
					if (!flag2)
					{
						MedicineItem wugConfig = Config.Medicine.Instance[itemKey.TemplateId];
						while (eatingSlot >= 0 && EatingItems.IsWug(eatingItems.Get((int)currSlot)) && !eatingItems.Get((int)currSlot).IsValid())
						{
							int selectedIndex = character.SelectMedicineIndexForWug(medicines, wugConfig.WugType, *(ref eatingItems.Durations.FixedElementField + (IntPtr)currSlot * 2), selections);
							bool flag3 = selectedIndex >= 0;
							if (flag3)
							{
								ItemKey usedItemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, medicines, selections);
								bool flag4 = itemKey.IsValid();
								if (flag4)
								{
									character.AddEatingItem(context, usedItemKey, null);
									bool flag5 = personalNeed.CheckValid(character);
									if (flag5)
									{
										this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
									}
									currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
									eatingItems = *character.GetEatingItems();
									eatingSlot = eatingItems.GetAvailableEatingSlot(currMaxEatingSlotCount);
									continue;
								}
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
							selectedIndex = GameData.Domains.Character.Character.SelectPoisonIndexForWug(poisons, wugConfig.WugType, *(ref eatingItems.Durations.FixedElementField + (IntPtr)currSlot * 2), selections);
							bool flag6 = selectedIndex >= 0;
							if (flag6)
							{
								ItemKey usedItemKey2 = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Medicine>(context, character, settlement, poisons, selections);
								bool flag7 = usedItemKey2.IsValid();
								if (flag7)
								{
									character.AddEatingItem(context, usedItemKey2, null);
									bool flag8 = personalNeed.CheckValid(character);
									if (flag8)
									{
										this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
									}
									currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
									eatingItems = *character.GetEatingItems();
									eatingSlot = eatingItems.GetAvailableEatingSlot(currMaxEatingSlotCount);
									continue;
								}
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
							break;
						}
					}
				}
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
		}

		// Token: 0x0600124A RID: 4682 RVA: 0x00121910 File Offset: 0x0011FB10
		private void HandleVillagerPersonalNeedForNeili(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			int currNeili = character.GetCurrNeili();
			int maxNeili = character.GetMaxNeili();
			List<ValueTuple<GameData.Domains.Item.Misc, int>> itemsForNeili = this._itemsForNeili;
			bool flag = itemsForNeili.Count > 0;
			if (flag)
			{
				itemsForNeili.Sort(EatingItemComparer.MiscNeili);
				while (currNeili < maxNeili)
				{
					int selectedIndex = character.SelectItemIndexForNeili(itemsForNeili, currNeili, maxNeili, selections);
					bool flag2 = selectedIndex < 0;
					if (flag2)
					{
						break;
					}
					ItemKey usedItemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Misc>(context, character, settlement, itemsForNeili, selections);
					bool flag3 = !usedItemKey.IsValid();
					if (flag3)
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
						break;
					}
					character.AddEatingItem(context, usedItemKey, null);
					bool flag4 = personalNeed.CheckValid(character);
					if (flag4)
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
					}
					currNeili = character.GetCurrNeili();
					maxNeili = character.GetMaxNeili();
				}
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
		}

		// Token: 0x0600124B RID: 4683 RVA: 0x001219F4 File Offset: 0x0011FBF4
		private unsafe void HandleVillagerPersonalNeedForMainAttributes(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			MainAttributes currMainAttributes = character.GetCurrMainAttributes();
			MainAttributes maxMainAttributes = character.GetMaxMainAttributes();
			sbyte currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
			sbyte eatingSlot = character.GetEatingItems().GetAvailableEatingSlot(currMaxEatingSlotCount);
			for (sbyte attrType = 0; attrType < 6; attrType += 1)
			{
				short maxMainAttr = *(ref maxMainAttributes.Items.FixedElementField + (IntPtr)attrType * 2);
				bool flag = *(ref currMainAttributes.Items.FixedElementField + (IntPtr)attrType * 2) * 2 >= maxMainAttr;
				if (!flag)
				{
					List<ValueTuple<GameData.Domains.Item.Food, int>> foods = this._foodsForMainAttributes[(int)attrType];
					bool flag2 = eatingSlot >= 0 && foods.Count > 0;
					if (flag2)
					{
						sbyte behaviorType = character.GetBehaviorType();
						sbyte eatForbiddenFoodChance = AiHelper.UpdateStatusConstants.EatForbiddenFoodChance[(int)behaviorType];
						bool isMeatForbidden = character.IsForbiddenToEatMeat();
						short rateAdjust = DomainManager.Extra.GetAiActionRateAdjust(character.GetId(), 6, -1);
						bool allowMeat = !isMeatForbidden || context.Random.CheckPercentProb((int)((short)eatForbiddenFoodChance + rateAdjust));
						foods.Sort(EatingItemComparer.FoodMainAttributes[(int)attrType]);
						while (eatingSlot >= 0 && *(ref currMainAttributes.Items.FixedElementField + (IntPtr)attrType * 2) < maxMainAttr)
						{
							int selectedIndex = character.SelectFoodIndexForMainAttributes(foods, attrType, *(ref currMainAttributes.Items.FixedElementField + (IntPtr)attrType * 2), maxMainAttr, allowMeat, selections);
							bool flag3 = selectedIndex < 0;
							if (flag3)
							{
								break;
							}
							ItemKey usedItemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.Food>(context, character, settlement, foods, selections);
							bool flag4 = !usedItemKey.IsValid();
							if (flag4)
							{
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
								break;
							}
							character.AddEatingItem(context, usedItemKey, null);
							bool flag5 = personalNeed.CheckValid(character);
							if (flag5)
							{
								this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
							}
							currMainAttributes = character.GetCurrMainAttributes();
							maxMainAttributes = character.GetMaxMainAttributes();
							currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
							eatingSlot = character.GetEatingItems().GetAvailableEatingSlot(currMaxEatingSlotCount);
						}
					}
				}
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
		}

		// Token: 0x0600124C RID: 4684 RVA: 0x00121BF0 File Offset: 0x0011FDF0
		private void HandleVillagerPersonalNeedForHappiness(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			List<ItemKey> selections = ObjectPool<List<ItemKey>>.Instance.Get();
			sbyte happinessThreshold = HappinessType.Ranges[3].Item1;
			sbyte happiness = character.GetHappiness();
			sbyte currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
			sbyte eatingSlot = character.GetEatingItems().GetAvailableEatingSlot(currMaxEatingSlotCount);
			List<ValueTuple<GameData.Domains.Item.TeaWine, int>> teaWines = this._teaWinesForHappiness;
			bool flag = eatingSlot >= 0 && teaWines.Count > 0;
			if (flag)
			{
				sbyte behaviorType = character.GetBehaviorType();
				short rateAdjust = DomainManager.Extra.GetAiActionRateAdjust(character.GetId(), 6, -1);
				sbyte eatForbiddenFoodChance = AiHelper.UpdateStatusConstants.EatForbiddenFoodChance[(int)behaviorType];
				bool isWineForbidden = character.IsForbiddenToDrinkingWines();
				bool allowWines = !isWineForbidden || context.Random.CheckPercentProb((int)((short)eatForbiddenFoodChance + rateAdjust));
				teaWines.Sort(EatingItemComparer.TeaWineHappiness);
				while (eatingSlot >= 0 && happiness < happinessThreshold)
				{
					int selectedIndex = character.SelectTeaWineForHappiness(teaWines, (int)happiness, (int)happinessThreshold, allowWines, selections);
					bool flag2 = selectedIndex < 0;
					if (flag2)
					{
						break;
					}
					ItemKey usedItemKey = this.RemovePersonalNeedSelectedItem<GameData.Domains.Item.TeaWine>(context, character, settlement, teaWines, selections);
					bool flag3 = !usedItemKey.IsValid();
					if (flag3)
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
						break;
					}
					character.AddEatingItem(context, usedItemKey, null);
					TeaWineItem config = Config.TeaWine.Instance[usedItemKey.TemplateId];
					happiness = (sbyte)Math.Clamp((int)(happiness + config.EatHappinessChange), -119, 119);
					bool flag4 = isWineForbidden && config.ItemSubType == 901;
					if (flag4)
					{
						sbyte happinessChange = AiHelper.UpdateStatusConstants.EatForbiddenFoodHappinessChange[(int)behaviorType];
						happiness = (sbyte)Math.Clamp((int)(happiness + happinessChange), -119, 119);
					}
					character.SetHappiness(happiness, context);
					bool flag5 = personalNeed.CheckValid(character);
					if (flag5)
					{
						this.UpdateVillagerTreasuryNeed(context, character, settlement, selections, false);
					}
					currMaxEatingSlotCount = character.GetCurrMaxEatingSlotsCount();
					eatingSlot = character.GetEatingItems().GetAvailableEatingSlot(currMaxEatingSlotCount);
				}
			}
			ObjectPool<List<ItemKey>>.Instance.Return(selections);
		}

		// Token: 0x0600124D RID: 4685 RVA: 0x00121DC8 File Offset: 0x0011FFC8
		private void HandleVillagerPersonalNeedForGainItem(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			bool flag = !this.IsMeetWorkStatus(character, settlement);
			if (!flag)
			{
				SettlementTreasury treasury = this.GetTaiwuTreasury();
				bool isRoleClothing = personalNeed.ItemType == 3 && VillagerRole.Instance.Any((VillagerRoleItem r) => r.Clothing == personalNeed.ItemTemplateId);
				int offset = isRoleClothing ? 0 : -2;
				ItemKey targetItemKey = treasury.Inventory.GetItemInSameGroup(personalNeed.ItemType, personalNeed.ItemTemplateId, offset);
				bool flag2 = !targetItemKey.IsValid();
				if (!flag2)
				{
					sbyte targetItemGrade = ItemTemplateHelper.GetGrade(targetItemKey.ItemType, targetItemKey.TemplateId);
					bool flag3 = !isRoleClothing;
					if (flag3)
					{
						short curGroupId = ItemTemplateHelper.GetGroupId(personalNeed.ItemType, personalNeed.ItemTemplateId);
						List<ItemKey> keyList = ObjectPool<List<ItemKey>>.Instance.Get();
						foreach (KeyValuePair<ItemKey, int> keyValuePair in treasury.Inventory.Items)
						{
							ItemKey itemKey;
							int num;
							keyValuePair.Deconstruct(out itemKey, out num);
							ItemKey key = itemKey;
							bool flag4 = key.ItemType != personalNeed.ItemType;
							if (!flag4)
							{
								short itemGroupId = ItemTemplateHelper.GetGroupId(key.ItemType, key.TemplateId);
								bool flag5 = curGroupId != itemGroupId;
								if (!flag5)
								{
									sbyte itemGrade = ItemTemplateHelper.GetGrade(key.ItemType, key.TemplateId);
									bool flag6 = itemGrade < targetItemGrade;
									if (!flag6)
									{
										bool flag7 = targetItemKey.ItemType == 11;
										if (flag7)
										{
											ItemBase cricket = DomainManager.Item.GetBaseItem(targetItemKey);
											bool flag8 = cricket.GetCurrDurability() <= 0;
											if (flag8)
											{
												continue;
											}
										}
										keyList.Add(key);
									}
								}
							}
						}
						bool flag9 = personalNeed.ItemType == 10;
						if (flag9)
						{
							sbyte bookType = -1;
							short roleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(character.GetId());
							bool flag10 = roleTemplateId < 0;
							if (flag10)
							{
								TaiwuDomain.SortVillagerSelectableItemsByGrade(keyList);
							}
							else
							{
								VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(character.GetId());
								VillagerWorkData workData = (villagerRole != null) ? villagerRole.WorkData : null;
								HashSet<sbyte> lifeSkillTypeSet = TaiwuDomain.VillagerRoleNeedLifeSkillBooks[roleTemplateId];
								bool flag11 = roleTemplateId == 5;
								if (flag11)
								{
									sbyte? b2 = (workData != null) ? new sbyte?(workData.WorkType) : null;
									int? num2 = (b2 != null) ? new int?((int)b2.GetValueOrDefault()) : null;
									int num = 1;
									BuildingBlockData blockData;
									bool flag12 = (num2.GetValueOrDefault() == num & num2 != null) && DomainManager.Building.TryGetElement_BuildingBlocks(new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), out blockData);
									if (flag12)
									{
										bookType = blockData.ConfigData.RequireCombatSkillType;
									}
									keyList.Sort((ItemKey a, ItemKey b) => TaiwuDomain.CompareCombatSkillBook(a, b, bookType));
								}
								else
								{
									bool flag13 = lifeSkillTypeSet != null && lifeSkillTypeSet.Count > 0;
									if (flag13)
									{
										sbyte? b2 = (workData != null) ? new sbyte?(workData.WorkType) : null;
										int? num2 = (b2 != null) ? new int?((int)b2.GetValueOrDefault()) : null;
										int num = 1;
										BuildingBlockData blockData2;
										bool flag14 = (num2.GetValueOrDefault() == num & num2 != null) && DomainManager.Building.TryGetElement_BuildingBlocks(new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), out blockData2);
										if (flag14)
										{
											bookType = blockData2.ConfigData.RequireLifeSkillType;
										}
										keyList.Sort((ItemKey a, ItemKey b) => TaiwuDomain.CompareLifeSkillBook(a, b, lifeSkillTypeSet, bookType));
									}
								}
							}
						}
						else
						{
							TaiwuDomain.SortVillagerSelectableItemsByGrade(keyList);
						}
						this.UpdateVillagerTreasuryNeed(context, character, settlement, keyList, true);
						ObjectPool<List<ItemKey>>.Instance.Return(keyList);
					}
					bool flag15 = targetItemKey.ItemType != 3;
					if (flag15)
					{
						sbyte charClass = this._villagerClassDict[character.GetId()];
						bool flag16 = charClass < targetItemGrade;
						if (flag16)
						{
							return;
						}
					}
					bool flag17 = targetItemKey.ItemType == 11;
					if (flag17)
					{
						ItemBase cricket2 = DomainManager.Item.GetBaseItem(targetItemKey);
						bool flag18 = cricket2.GetCurrDurability() <= 0;
						if (flag18)
						{
							return;
						}
					}
					bool flag19 = this.IsMeetInventoryLoad(character, targetItemKey);
					if (flag19)
					{
						this.VillagerTakeItemFromTreasury(context, character, targetItemKey, 1);
						character.AddInventoryItem(context, targetItemKey, 1, false);
						this.HandleVillagerGainTreasuryItem(context, targetItemKey, character);
						this._villagerGainedItemTypeSet.Add(targetItemKey.ItemType);
					}
				}
			}
		}

		// Token: 0x0600124E RID: 4686 RVA: 0x001222DC File Offset: 0x001204DC
		private void HandleVillagerPersonalNeedForGainResource(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed, int needIndex)
		{
			bool flag = !this.IsMeetWorkStatus(character, settlement);
			if (!flag)
			{
				SettlementTreasury treasury = this.GetTaiwuTreasury();
				int meetAmount = treasury.Resources.CheckIsMeet(personalNeed.ResourceType, personalNeed.Amount) ? personalNeed.Amount : treasury.Resources.Get((int)personalNeed.ResourceType);
				bool flag2 = meetAmount > 0;
				if (flag2)
				{
					this.VillagerTakeResourceFromTreasury(context, character, personalNeed.ResourceType, meetAmount);
					character.ChangeResource(context, personalNeed.ResourceType, meetAmount);
					personalNeed.Amount -= meetAmount;
					List<GameData.Domains.Character.Ai.PersonalNeed> personalNeeds = character.GetPersonalNeeds();
					personalNeeds[needIndex] = personalNeed;
				}
			}
		}

		// Token: 0x0600124F RID: 4687 RVA: 0x0012238C File Offset: 0x0012058C
		private bool HandleVillagerPersonalNeedForAddPoisonToItem(DataContext context, GameData.Domains.Character.Character character, Settlement settlement, GameData.Domains.Character.Ai.PersonalNeed personalNeed)
		{
			bool flag = !this.IsMeetWorkStatus(character, settlement);
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				SettlementTreasury treasury = this.GetTaiwuTreasury();
				short toxicologyAttainment = character.GetLifeSkillAttainment(9);
				sbyte poisonType = personalNeed.PoisonType;
				ItemKey targetItemKey = ItemKey.Invalid;
				foreach (KeyValuePair<ItemKey, int> keyValuePair in treasury.Inventory.Items)
				{
					ItemKey itemKey2;
					int num;
					keyValuePair.Deconstruct(out itemKey2, out num);
					ItemKey itemKey = itemKey2;
					bool flag2 = itemKey.ItemType != 8;
					if (!flag2)
					{
						MedicineItem config = Config.Medicine.Instance[itemKey.TemplateId];
						short attainmentRequired = GlobalConfig.Instance.PoisonAttainments[(int)config.Grade];
						bool flag3 = toxicologyAttainment < attainmentRequired;
						if (!flag3)
						{
							bool flag4 = config.ApplyPoisonType != poisonType;
							if (!flag4)
							{
								targetItemKey = itemKey;
								break;
							}
						}
					}
				}
				bool flag5 = !targetItemKey.IsValid();
				if (flag5)
				{
					result = false;
				}
				else
				{
					GameData.Domains.Character.Ai.PersonalNeed newNeed = GameData.Domains.Character.Ai.PersonalNeed.CreatePersonalNeed(10, targetItemKey.ItemType, targetItemKey.TemplateId);
					this.HandleVillagerPersonalNeedForGainItem(context, character, settlement, newNeed);
					result = true;
				}
			}
			return result;
		}

		// Token: 0x06001250 RID: 4688 RVA: 0x001224D0 File Offset: 0x001206D0
		private static void SortVillagerSelectableItemsByGrade([TupleElementNames(new string[]
		{
			"itemKey",
			"score"
		})] List<ValueTuple<ItemKey, int>> items)
		{
			items.Sort(delegate([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> a, [TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> b)
			{
				sbyte itemGradeA = ItemTemplateHelper.GetGrade(a.Item1.ItemType, a.Item1.TemplateId);
				sbyte itemGradeB = ItemTemplateHelper.GetGrade(b.Item1.ItemType, b.Item1.TemplateId);
				return itemGradeA.CompareTo(itemGradeB);
			});
		}

		// Token: 0x06001251 RID: 4689 RVA: 0x001224F9 File Offset: 0x001206F9
		private static void SortVillagerSelectableItemsByGrade(List<ItemKey> items)
		{
			items.Sort(delegate(ItemKey a, ItemKey b)
			{
				sbyte itemGradeA = ItemTemplateHelper.GetGrade(a.ItemType, a.TemplateId);
				sbyte itemGradeB = ItemTemplateHelper.GetGrade(b.ItemType, b.TemplateId);
				return itemGradeA.CompareTo(itemGradeB);
			});
		}

		// Token: 0x06001252 RID: 4690 RVA: 0x00122524 File Offset: 0x00120724
		private void SortVillagerSelectableBooks([TupleElementNames(new string[]
		{
			"itemKey",
			"score"
		})] List<ValueTuple<ItemKey, int>> items, GameData.Domains.Character.Character character)
		{
			short roleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(character.GetId());
			HashSet<sbyte> lifeSkillTypeSet = TaiwuDomain.VillagerRoleNeedLifeSkillBooks[roleTemplateId];
			Equipping.SortBooksByScore(items, character);
			sbyte bookType = -1;
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(character.GetId());
			VillagerWorkData workData = (villagerRole != null) ? villagerRole.WorkData : null;
			bool flag = roleTemplateId == 5;
			if (flag)
			{
				sbyte? b2 = (workData != null) ? new sbyte?(workData.WorkType) : null;
				int? num = (b2 != null) ? new int?((int)b2.GetValueOrDefault()) : null;
				int num2 = 1;
				BuildingBlockData blockData;
				bool flag2 = (num.GetValueOrDefault() == num2 & num != null) && DomainManager.Building.TryGetElement_BuildingBlocks(new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), out blockData);
				if (flag2)
				{
					bookType = blockData.ConfigData.RequireCombatSkillType;
				}
				items.Sort(([TupleElementNames(new string[]
				{
					"itemKey",
					"score"
				})] ValueTuple<ItemKey, int> a, [TupleElementNames(new string[]
				{
					"itemKey",
					"score"
				})] ValueTuple<ItemKey, int> b) => TaiwuDomain.CompareCombatSkillBook(a.Item1, b.Item1, bookType));
			}
			else
			{
				bool flag3 = lifeSkillTypeSet != null && lifeSkillTypeSet.Count > 0;
				if (flag3)
				{
					sbyte? b2 = (workData != null) ? new sbyte?(workData.WorkType) : null;
					int? num = (b2 != null) ? new int?((int)b2.GetValueOrDefault()) : null;
					int num2 = 1;
					BuildingBlockData blockData2;
					bool flag4 = (num.GetValueOrDefault() == num2 & num != null) && DomainManager.Building.TryGetElement_BuildingBlocks(new BuildingBlockKey(workData.AreaId, workData.BlockId, workData.BuildingBlockIndex), out blockData2);
					if (flag4)
					{
						bookType = blockData2.ConfigData.RequireLifeSkillType;
					}
					items.Sort(([TupleElementNames(new string[]
					{
						"itemKey",
						"score"
					})] ValueTuple<ItemKey, int> a, [TupleElementNames(new string[]
					{
						"itemKey",
						"score"
					})] ValueTuple<ItemKey, int> b) => TaiwuDomain.CompareLifeSkillBook(a.Item1, b.Item1, lifeSkillTypeSet, bookType));
				}
			}
		}

		// Token: 0x06001253 RID: 4691 RVA: 0x0012270C File Offset: 0x0012090C
		private static int CompareCombatSkillBook(ItemKey a, ItemKey b, sbyte bookType)
		{
			SkillBookItem skillBookItemA = Config.SkillBook.Instance[a.TemplateId];
			SkillBookItem skillBookItemB = Config.SkillBook.Instance[b.TemplateId];
			bool aIsBetter = skillBookItemA.ItemSubType == 1001 && skillBookItemB.CombatSkillType != bookType;
			bool bIsBetter = skillBookItemB.ItemSubType == 1001 && skillBookItemA.CombatSkillType != bookType;
			return aIsBetter.CompareTo(bIsBetter);
		}

		// Token: 0x06001254 RID: 4692 RVA: 0x00122784 File Offset: 0x00120984
		private static int CompareLifeSkillBook(ItemKey a, ItemKey b, HashSet<sbyte> lifeSkillTypeSet, sbyte bookType)
		{
			SkillBookItem skillBookItemA = Config.SkillBook.Instance[a.TemplateId];
			SkillBookItem skillBookItemB = Config.SkillBook.Instance[b.TemplateId];
			bool aIsBetter = lifeSkillTypeSet.Contains(skillBookItemA.LifeSkillType) && skillBookItemB.LifeSkillType != bookType;
			bool bIsBetter = lifeSkillTypeSet.Contains(skillBookItemB.LifeSkillType) && skillBookItemA.LifeSkillType != bookType;
			return aIsBetter.CompareTo(bIsBetter);
		}

		// Token: 0x06001255 RID: 4693 RVA: 0x00122800 File Offset: 0x00120A00
		private void SortVillagerSelectableEquipments([TupleElementNames(new string[]
		{
			"itemKey",
			"score"
		})] List<ValueTuple<ItemKey, int>> items, GameData.Domains.Character.Character character)
		{
			bool flag = items == null || items.Count <= 0;
			if (!flag)
			{
				short idealClothingTemplateId = character.GetIdealClothingTemplateId();
				items.Sort(delegate([TupleElementNames(new string[]
				{
					"itemKey",
					"score"
				})] ValueTuple<ItemKey, int> a, [TupleElementNames(new string[]
				{
					"itemKey",
					"score"
				})] ValueTuple<ItemKey, int> b)
				{
					sbyte itemType = items.First<ValueTuple<ItemKey, int>>().Item1.ItemType;
					bool flag2 = itemType == 0;
					int result;
					if (flag2)
					{
						this._availableWeapons.Clear();
						this._suitableWeapons.Clear();
						this._availableWeapons.Add(new ValueTuple<ItemKey, int>(a.Item1, 0));
						this._availableWeapons.Add(new ValueTuple<ItemKey, int>(b.Item1, 0));
						Equipping.GetWeaponScores(character, this._availableWeapons, this._suitableWeapons, this._fixedBestWeapons);
						bool flag3 = this._availableWeapons[0].Item1.Equals(a.Item1);
						if (flag3)
						{
							a.Item2 = this._availableWeapons[0].Item2;
							b.Item2 = this._availableWeapons[1].Item2;
						}
						else
						{
							a.Item2 = this._availableWeapons[1].Item2;
							b.Item2 = this._availableWeapons[0].Item2;
						}
						result = a.Item2.CompareTo(b.Item2);
					}
					else
					{
						bool flag4 = itemType == 3;
						if (flag4)
						{
							bool flag5 = a.Item1.TemplateId == idealClothingTemplateId;
							if (flag5)
							{
								result = 1;
							}
							else
							{
								bool flag6 = b.Item1.TemplateId == idealClothingTemplateId;
								if (flag6)
								{
									result = -1;
								}
								else
								{
									bool aIsRoleClothing = VillagerRole.Instance.Any((VillagerRoleItem r) => r.Clothing == a.Item1.TemplateId);
									bool bIsRoleClothing = VillagerRole.Instance.Any((VillagerRoleItem r) => r.Clothing == b.Item1.TemplateId);
									bool flag7 = aIsRoleClothing != bIsRoleClothing;
									if (flag7)
									{
										result = bIsRoleClothing.CompareTo(aIsRoleClothing);
									}
									else
									{
										ValueTuple<int, bool> aResult = Equipping.CalcEquipmentScore(a.Item1, -1);
										ValueTuple<int, bool> bResult = Equipping.CalcEquipmentScore(b.Item1, -1);
										a.Item2 = aResult.Item1;
										b.Item2 = bResult.Item1;
										result = a.Item2.CompareTo(b.Item2);
									}
								}
							}
						}
						else
						{
							ValueTuple<int, bool> aResult2 = Equipping.CalcEquipmentScore(a.Item1, -1);
							ValueTuple<int, bool> bResult2 = Equipping.CalcEquipmentScore(b.Item1, -1);
							a.Item2 = aResult2.Item1;
							b.Item2 = bResult2.Item1;
							result = a.Item2.CompareTo(b.Item2);
						}
					}
					return result;
				});
			}
		}

		// Token: 0x06001256 RID: 4694 RVA: 0x00122874 File Offset: 0x00120A74
		private bool CompareVillagerSelectableItems(ItemKey selfItemKey, ItemKey targetItemKey, GameData.Domains.Character.Character character)
		{
			List<ValueTuple<ItemKey, int>> items = ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Get();
			items.Add(new ValueTuple<ItemKey, int>(targetItemKey, 0));
			items.Add(new ValueTuple<ItemKey, int>(selfItemKey, 0));
			bool flag = ItemType.IsEquipmentItemType(selfItemKey.ItemType);
			if (flag)
			{
				this.SortVillagerSelectableEquipments(items, character);
			}
			else
			{
				bool flag2 = selfItemKey.ItemType == 10;
				if (flag2)
				{
					this.SortVillagerSelectableBooks(items, character);
				}
				else
				{
					TaiwuDomain.SortVillagerSelectableItemsByGrade(items);
				}
			}
			int selfIndex = items.FindIndex(([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> t) => t.Item1.Equals(selfItemKey));
			int targetIndex = items.FindIndex(([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> t) => t.Item1.Equals(targetItemKey));
			bool result = targetIndex > selfIndex;
			ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Return(items);
			return result;
		}

		// Token: 0x06001257 RID: 4695 RVA: 0x00122950 File Offset: 0x00120B50
		private bool CompareVillagerSelectableBooks(ItemKey selfItemKey, ItemKey targetItemKey, GameData.Domains.Character.Character character)
		{
			List<ValueTuple<ItemKey, int>> items = ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Get();
			items.Add(new ValueTuple<ItemKey, int>(targetItemKey, 0));
			items.Add(new ValueTuple<ItemKey, int>(selfItemKey, 0));
			this.SortVillagerSelectableBooks(items, character);
			int selfIndex = items.FindIndex(([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> t) => t.Item1.Equals(selfItemKey));
			int targetIndex = items.FindIndex(([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> t) => t.Item1.Equals(targetItemKey));
			bool result = targetIndex > selfIndex;
			ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Return(items);
			return result;
		}

		// Token: 0x06001258 RID: 4696 RVA: 0x001229EC File Offset: 0x00120BEC
		private bool CompareVillagerSelectableEquipments(ItemKey selfItemKey, ItemKey targetItemKey, GameData.Domains.Character.Character character)
		{
			List<ValueTuple<ItemKey, int>> items = ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Get();
			items.Add(new ValueTuple<ItemKey, int>(targetItemKey, 0));
			items.Add(new ValueTuple<ItemKey, int>(selfItemKey, 0));
			this.SortVillagerSelectableEquipments(items, character);
			int selfIndex = items.FindIndex(([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> t) => t.Item1.Equals(selfItemKey));
			int targetIndex = items.FindIndex(([TupleElementNames(new string[]
			{
				"itemKey",
				"score"
			})] ValueTuple<ItemKey, int> t) => t.Item1.Equals(targetItemKey));
			bool result = targetIndex > selfIndex;
			ObjectPool<List<ValueTuple<ItemKey, int>>>.Instance.Return(items);
			return result;
		}

		// Token: 0x06001259 RID: 4697 RVA: 0x00122A88 File Offset: 0x00120C88
		private List<int> GetTaiwuVillagerMemberList()
		{
			List<int> memberList = new List<int>();
			Settlement settlement = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId);
			settlement.GetMembers().GetAllMembers(memberList);
			memberList.Remove(this._taiwuCharId);
			memberList.Sort(delegate(int a, int b)
			{
				SettlementCharacter aSettlementCharacter = DomainManager.Organization.GetSettlementCharacter(a);
				SettlementCharacter bSettlementCharacter = DomainManager.Organization.GetSettlementCharacter(b);
				int result = bSettlementCharacter.GetInfluencePower().CompareTo(aSettlementCharacter.GetInfluencePower());
				bool flag = result == 0;
				int result2;
				if (flag)
				{
					sbyte aAgeGroup = DomainManager.Character.GetElement_Objects(a).GetAgeGroup();
					result2 = DomainManager.Character.GetElement_Objects(b).GetAgeGroup().CompareTo(aAgeGroup);
				}
				else
				{
					result2 = result;
				}
				return result2;
			});
			return memberList;
		}

		// Token: 0x0600125A RID: 4698 RVA: 0x00122AF4 File Offset: 0x00120CF4
		[DomainMethod]
		public List<int>[] GetVillagerListClassArray()
		{
			return this._villagerListClassArray;
		}

		// Token: 0x0600125B RID: 4699 RVA: 0x00122B0C File Offset: 0x00120D0C
		[DomainMethod]
		public Dictionary<int, sbyte> GetVillagerClassesDict()
		{
			return this._villagerClassDict;
		}

		// Token: 0x0600125C RID: 4700 RVA: 0x00122B24 File Offset: 0x00120D24
		public void InitVillagerTreasuryTempData()
		{
			this._villagerClassDict.Clear();
			foreach (List<int> list in this._villagerListClassArray)
			{
				if (list != null)
				{
					list.Clear();
				}
			}
			foreach (KeyValuePair<int, sbyte> keyValuePair in DomainManager.Extra.VillagerLastInfluencePowerGrade)
			{
				int num;
				sbyte b;
				keyValuePair.Deconstruct(out num, out b);
				int charId = num;
				sbyte grade = b;
				GameData.Domains.Character.Character character;
				bool flag = !DomainManager.Character.TryGetElement_Objects(charId, out character);
				if (!flag)
				{
					bool flag2 = character.GetOrganizationInfo().SettlementId != this._taiwuVillageSettlementId;
					if (!flag2)
					{
						this._villagerClassDict[charId] = grade;
						int index = (int)(8 - grade);
						List<int> list2 = this._villagerListClassArray[index];
						if (list2 == null)
						{
							list2 = new List<int>();
						}
						list2.Add(charId);
						this._villagerListClassArray[index] = list2;
					}
				}
			}
			this.RefreshTreasuryNeededItem();
		}

		// Token: 0x0600125D RID: 4701 RVA: 0x00122C48 File Offset: 0x00120E48
		private unsafe void CalcVillagerClasses()
		{
			List<int> memberList = this.GetTaiwuVillagerMemberList();
			int configLength = GlobalConfig.Instance.VillagerInfluencePowerRankingRatio.Length;
			int num = configLength;
			Span<short> span = new Span<short>(stackalloc byte[checked(unchecked((UIntPtr)num) * 2)], num);
			Span<short> villagerCountClassArray = span;
			int curMemberCount = 0;
			for (int i = 0; i < configLength; i++)
			{
				bool flag = i == configLength - 1;
				if (flag)
				{
					*villagerCountClassArray[i] = (short)(memberList.Count - curMemberCount);
					break;
				}
				float value = (float)GlobalConfig.Instance.VillagerInfluencePowerRankingRatio[i];
				short count = (short)Math.Max(1.0, Math.Round((double)(value * (float)memberList.Count / 100f)));
				*villagerCountClassArray[i] = count;
				curMemberCount += (int)count;
			}
			int classIndex = 0;
			int classMemberCount = 0;
			this._villagerClassDict.Clear();
			foreach (List<int> list in this._villagerListClassArray)
			{
				if (list != null)
				{
					list.Clear();
				}
			}
			foreach (int charId in memberList)
			{
				short classMemberMaxCount = *villagerCountClassArray[classIndex];
				List<int>[] villagerListClassArray2 = this._villagerListClassArray;
				int num2 = classIndex;
				if (villagerListClassArray2[num2] == null)
				{
					villagerListClassArray2[num2] = new List<int>((int)classMemberMaxCount);
				}
				this._villagerListClassArray[classIndex].Add(charId);
				sbyte charClass = Convert.ToSByte(8 - classIndex);
				this._villagerClassDict[charId] = charClass;
				classMemberCount++;
				bool flag2 = classMemberCount >= (int)classMemberMaxCount;
				if (flag2)
				{
					classIndex++;
					classMemberCount = 0;
				}
			}
		}

		// Token: 0x0600125E RID: 4702 RVA: 0x00122E08 File Offset: 0x00121008
		private Dictionary<ItemKey, Dictionary<int, sbyte>> GetTreasuryNeededItemDict()
		{
			return this._treasuryNeededItemDict;
		}

		// Token: 0x0600125F RID: 4703 RVA: 0x00122E20 File Offset: 0x00121020
		[DomainMethod]
		public Dictionary<int, sbyte> GetTreasuryItemNeededCharDict(ItemKey itemKey)
		{
			return this.GetTreasuryNeededItemDict().GetValueOrDefault(itemKey);
		}

		// Token: 0x06001260 RID: 4704 RVA: 0x00122E2E File Offset: 0x0012102E
		[DomainMethod]
		public List<ItemKey> GetTreasuryNeededItemList()
		{
			return this.GetTreasuryNeededItemDict().Keys.ToList<ItemKey>();
		}

		// Token: 0x06001261 RID: 4705 RVA: 0x00122E40 File Offset: 0x00121040
		private void RefreshTreasuryNeededItem()
		{
			this._treasuryNeededItemDict.Clear();
			List<int> memberList = new List<int>();
			Settlement settlement = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId);
			settlement.GetMembers().GetAllMembers(memberList);
			memberList.Remove(this._taiwuCharId);
			foreach (int charId in memberList)
			{
				VillagerTreasuryNeed villagerTreasuryNeed;
				bool flag = DomainManager.Extra.TryGetVillagerTreasuryNeed(charId, out villagerTreasuryNeed);
				if (flag)
				{
					foreach (GameData.Domains.Character.Ai.PersonalNeed personal in villagerTreasuryNeed.PersonalNeeds)
					{
						this.AddNeededItem(personal, charId);
					}
				}
			}
		}

		// Token: 0x06001262 RID: 4706 RVA: 0x00122F28 File Offset: 0x00121128
		[DomainMethod]
		public VillagerTreasuryNeed GetVillagerTreasuryNeed(int charId)
		{
			VillagerTreasuryNeed villagerTreasuryNeed;
			return DomainManager.Extra.TryGetVillagerTreasuryNeed(charId, out villagerTreasuryNeed) ? villagerTreasuryNeed : null;
		}

		// Token: 0x06001263 RID: 4707 RVA: 0x00122F48 File Offset: 0x00121148
		public sbyte GetVillagerNeedWaitTime(int charId, CharacterSortFilter characterSortFilter)
		{
			bool flag = characterSortFilter == null;
			sbyte result;
			if (flag)
			{
				result = 0;
			}
			else
			{
				bool flag2 = characterSortFilter.Settings.FilterType != 4;
				if (flag2)
				{
					result = 0;
				}
				else
				{
					Dictionary<int, sbyte> charDict = this._treasuryNeededItemDict[characterSortFilter.Settings.VillagerNeededItem];
					sbyte waitTime = charDict.GetValueOrDefault(charId, 0);
					waitTime = Math.Max(1, waitTime);
					result = waitTime;
				}
			}
			return result;
		}

		// Token: 0x06001264 RID: 4708 RVA: 0x00122FAC File Offset: 0x001211AC
		private void InitializeGradeRoles()
		{
			TaiwuDomain._gradeVillagerRoles = new short[9];
			Array.Fill<short>(TaiwuDomain._gradeVillagerRoles, -1);
			foreach (VillagerRoleItem villagerRoleCfg in ((IEnumerable<VillagerRoleItem>)VillagerRole.Instance))
			{
				OrganizationMemberItem memberCfg = OrganizationMember.Instance[villagerRoleCfg.OrganizationMember];
				TaiwuDomain._gradeVillagerRoles[(int)memberCfg.Grade] = villagerRoleCfg.TemplateId;
			}
		}

		// Token: 0x06001265 RID: 4709 RVA: 0x00123034 File Offset: 0x00121234
		public short GetGradeVillagerRole(sbyte grade)
		{
			return TaiwuDomain._gradeVillagerRoles[(int)grade];
		}

		// Token: 0x06001266 RID: 4710 RVA: 0x00123050 File Offset: 0x00121250
		[DomainMethod]
		public bool SetVillagerRole(DataContext context, int charId, short roleTemplateId)
		{
			GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(charId);
			VillagerRoleItem roleCfg = VillagerRole.Instance.GetItem(roleTemplateId);
			int roleCount = (roleCfg != null) ? this._villagerFeatureHolderSet.Count(delegate(int cId)
			{
				GameData.Domains.Character.Character tc;
				return DomainManager.Character.TryGetElement_Objects(cId, out tc) && tc.GetFeatureIds().Contains(roleCfg.FeatureId);
			}) : 0;
			foreach (short featureId in this.CalcVillagerRoleFeatureTemplateIds())
			{
				character.RemoveFeature(context, featureId);
			}
			this._villagerFeatureHolderSet.Remove(charId);
			ExtraDomain extraDomain = DomainManager.Extra;
			VillagerRoleRecords records = extraDomain.GetVillagerRoleRecordsData();
			short currentRoleId = DomainManager.Extra.GetVillagerRoleTemplateId(charId);
			bool shouldFixRecord = currentRoleId >= 0 && !records.History.Any((VillagerRoleRecordElement element) => element.CharacterId == charId && element.RoleTemplateId == currentRoleId);
			bool flag = shouldFixRecord;
			if (flag)
			{
				VillagerRoleRecordElement record = new VillagerRoleRecordElement();
				this.FillVillagerRoleRecordElement(character, record);
				records.History.Add(record);
			}
			bool flag2 = roleCfg == null;
			bool result;
			if (flag2)
			{
				DomainManager.Character.ChangeFavorabilityOptional(context, character, DomainManager.Taiwu.GetTaiwu(), -VillagerRoleFormula.DefValue.BaseFavorCostLostRole.Calculate((int)character.GetOrganizationInfo().Grade), 3);
				DomainManager.Organization.ChangeGrade(context, character, 0, true);
				bool flag3 = shouldFixRecord;
				if (flag3)
				{
					extraDomain.SetVillagerRoleRecordsData(context, records);
				}
				VillagerWorkData prevWork;
				bool flag4 = this._villagerWork.TryGetValue(charId, out prevWork);
				if (flag4)
				{
					sbyte workType = prevWork.WorkType;
					bool flag5 = workType == 10 || workType == 14;
					bool flag6 = flag5;
					if (flag6)
					{
						this.RemoveVillagerWork(context, charId, true);
						this.SetVillagerIdleWork(context, charId, prevWork.AreaId, prevWork.BlockId);
					}
				}
				result = true;
			}
			else
			{
				OrganizationMemberItem memberCfg = OrganizationMember.Instance[roleCfg.OrganizationMember];
				VillagerRoleFormulaItem formula = (memberCfg.Grade > character.GetOrganizationInfo().Grade) ? VillagerRoleFormula.DefValue.BaseFavorAddGainRole : VillagerRoleFormula.DefValue.BaseFavorCostLostRole;
				int factorBase = formula.Calculate((int)character.GetOrganizationInfo().Grade);
				DomainManager.Organization.ChangeGrade(context, character, memberCfg.Grade, true);
				DomainManager.Character.ChangeFavorabilityOptional(context, character, DomainManager.Taiwu.GetTaiwu(), formula.Calculate((int)memberCfg.Grade) - factorBase, 3);
				int cost = GameData.Domains.Taiwu.VillagerRole.SharedMethods.CalcSetVillagerRoleAuthorityCost(roleCount, roleTemplateId);
				this.GetTaiwu().ChangeResource(context, 7, -cost);
				character.AddFeature(context, roleCfg.FeatureId, true);
				this._villagerFeatureHolderSet.Add(charId);
				records.History.RemoveAll((VillagerRoleRecordElement element) => element.CharacterId == charId && element.RoleTemplateId == roleTemplateId);
				VillagerRoleRecordElement record2 = new VillagerRoleRecordElement();
				this.FillVillagerRoleRecordElement(character, record2);
				records.History.Add(record2);
				extraDomain.SetVillagerRoleRecordsData(context, records);
				result = true;
			}
			return result;
		}

		// Token: 0x06001267 RID: 4711 RVA: 0x00123388 File Offset: 0x00121588
		public void OnTaiwuVillagerGradeChanged(DataContext context, GameData.Domains.Character.Character character, sbyte targetGrade)
		{
			Tester.Assert(character.GetOrganizationInfo().OrgTemplateId == 16, "");
			int charId = character.GetId();
			VillagerRoleBase prevRole = DomainManager.Extra.GetVillagerRole(charId);
			bool flag = prevRole != null;
			if (flag)
			{
				DomainManager.Extra.UnregisterVillagerRole(context, charId);
				bool flag2 = prevRole.ArrangementTemplateId >= 0;
				if (flag2)
				{
					this.RemoveVillagerWork(context, charId, true);
				}
				else
				{
					VillagerWorkData prevWork;
					bool flag3 = this._villagerWork.TryGetValue(charId, out prevWork);
					if (flag3)
					{
						bool flag4 = prevWork.WorkType == 14;
						if (flag4)
						{
							this.RemoveVillagerWork(context, charId, true);
							this.SetVillagerIdleWork(context, charId, prevWork.AreaId, prevWork.BlockId);
						}
					}
				}
			}
			short roleTemplateId = this.GetGradeVillagerRole(targetGrade);
			bool flag5 = roleTemplateId >= 0;
			if (flag5)
			{
				DomainManager.Extra.RegisterVillagerRole(context, charId, roleTemplateId);
			}
			bool flag6 = roleTemplateId == 3;
			if (flag6)
			{
				this.SetMerchantType(context, charId, 7, false);
			}
		}

		// Token: 0x06001268 RID: 4712 RVA: 0x0012347C File Offset: 0x0012167C
		public IReadOnlySet<int> GetVillagerRoleSet(short roleTemplateId)
		{
			VillagerRoleItem roleCfg = VillagerRole.Instance[roleTemplateId];
			OrgMemberCollection members = DomainManager.Organization.GetSettlement(this._taiwuVillageSettlementId).GetMembers();
			sbyte grade = OrganizationMember.Instance[roleCfg.OrganizationMember].Grade;
			return members.GetMembers(grade);
		}

		// Token: 0x06001269 RID: 4713 RVA: 0x001234D0 File Offset: 0x001216D0
		public void UpdateVillagerFixedActions(DataContext context)
		{
			OrgMemberCollection members = this.TaiwuVillage.GetMembers();
			foreach (VillagerRoleItem roleCfg in ((IEnumerable<VillagerRoleItem>)VillagerRole.Instance))
			{
				OrganizationMemberItem orgMemberCfg = OrganizationMember.Instance[roleCfg.OrganizationMember];
				HashSet<int> gradeMembers = members.GetMembers(orgMemberCfg.Grade);
				foreach (int gradeMemberId in gradeMembers)
				{
					VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(gradeMemberId);
					bool flag = !villagerRole.Character.IsInteractableAsIntelligentCharacter() || !villagerRole.Character.GetLocation().IsValid() || villagerRole.Character.IsActiveAdvanceMonthStatus(4) || villagerRole.Character.GetLeaderId() == this._taiwuCharId;
					if (!flag)
					{
						DomainManager.Taiwu.UpdateVillagerRoleFixedActionSuccessArray(context, false);
						villagerRole.ExecuteFixedAction(context);
					}
				}
			}
			TaiwuVillageStoragesRecordCollection collection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
			DomainManager.Extra.SetTaiwuVillageStoragesRecordCollection(context, collection);
		}

		// Token: 0x0600126A RID: 4714 RVA: 0x00123620 File Offset: 0x00121820
		public void UpdateSwordTombKeepersOnXiangshuAvatarMoved(DataContext context, GameData.Domains.Character.Character character, Location location)
		{
			bool flag = character.GetXiangshuType() != 1;
			if (!flag)
			{
				bool flag2 = !location.IsValid();
				if (!flag2)
				{
					IReadOnlySet<int> swordTombKeepers = this.GetVillagerRoleSet(5);
					bool flag3 = swordTombKeepers.Count == 0;
					if (!flag3)
					{
						List<GameData.Domains.Character.Character> potentialTargets = ObjectPool<List<GameData.Domains.Character.Character>>.Instance.Get();
						potentialTargets.Clear();
						MapBlockData xiangshuAvatarBlock = DomainManager.Map.GetBlock(location).GetRootBlock();
						foreach (int swordTombKeeperId in swordTombKeepers)
						{
							VillagerRoleSwordTombKeeper villagerRole = (VillagerRoleSwordTombKeeper)DomainManager.Extra.GetVillagerRole(swordTombKeeperId);
							GameData.Domains.Character.Character villagerChar = DomainManager.Character.GetElement_Objects(swordTombKeeperId);
							bool flag4 = villagerRole.ArrangementTemplateId != 3;
							if (!flag4)
							{
								bool flag5 = !context.Random.CheckPercentProb(villagerRole.InjuredByXiangshuAvatarChance);
								if (!flag5)
								{
									bool flag6 = villagerChar.ReachFallenInCombat(CombatType.Die);
									if (!flag6)
									{
										Location villagerCharLocation = villagerChar.GetLocation();
										bool flag7 = !villagerCharLocation.IsValid();
										if (!flag7)
										{
											MapBlockData characterBlock = DomainManager.Map.GetBlock(villagerCharLocation).GetRootBlock();
											bool flag8 = xiangshuAvatarBlock != characterBlock;
											if (!flag8)
											{
												potentialTargets.Add(villagerChar);
											}
										}
									}
								}
							}
						}
						bool flag9 = potentialTargets.Count == 0;
						if (!flag9)
						{
							GameData.Domains.Character.Character target = potentialTargets.GetRandom(context.Random);
							int damageCount = VillagerRoleSwordTombKeeper.InjuryByXiangshuAvatarAmount;
							damageCount /= potentialTargets.Count;
							target.TakeRandomDamage(context, damageCount);
							int date = DomainManager.World.GetCurrDate();
							LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
							bool flag10 = damageCount > 0;
							if (flag10)
							{
								lifeRecordCollection.AddGuardingSwordTomb(target.GetId(), date, character.GetTemplateId());
							}
							else
							{
								lifeRecordCollection.AddGuardingSwordTombSucceed(target.GetId(), date, character.GetTemplateId());
							}
							ObjectPool<List<GameData.Domains.Character.Character>>.Instance.Return(potentialTargets);
						}
					}
				}
			}
		}

		// Token: 0x0600126B RID: 4715 RVA: 0x00123824 File Offset: 0x00121A24
		public void UpdateVillagerRoleNewClothing(DataContext context)
		{
			SettlementTreasury treasury = this.GetTaiwuTreasury();
			bool treasuryUpdated = false;
			MonthlyEventCollection monthlyEventCollection = DomainManager.World.GetMonthlyEventCollection();
			using (IEnumerator<VillagerRoleItem> enumerator = ((IEnumerable<VillagerRoleItem>)VillagerRole.Instance).GetEnumerator())
			{
				while (enumerator.MoveNext())
				{
					VillagerRoleItem roleCfg = enumerator.Current;
					IReadOnlySet<int> villagerRoleSet = this.GetVillagerRoleSet(roleCfg.TemplateId);
					bool flag = villagerRoleSet.Count <= 0;
					if (!flag)
					{
						bool flag2 = DomainManager.Extra.HasOwnedClothing(roleCfg.Clothing);
						if (!flag2)
						{
							bool flag3 = villagerRoleSet.Any((int charId) => DomainManager.Character.GetElement_Objects(charId).GetEquipment()[4].TemplateId == roleCfg.Clothing);
							if (!flag3)
							{
								OrganizationMemberItem memberCfg = OrganizationMember.Instance[roleCfg.OrganizationMember];
								monthlyEventCollection.AddTaiWuVillagerClothing(16, memberCfg.Grade, true, 1, 3, roleCfg.Clothing);
								treasuryUpdated = true;
								ItemKey itemKey = DomainManager.Item.CreateClothing(context, roleCfg.Clothing, -1);
								treasury.Inventory.OfflineAdd(itemKey, 1);
								DomainManager.Item.SetOwner(itemKey, ItemOwnerType.Treasury, (int)this._taiwuVillageSettlementId);
								Events.RaiseTaiwuItemModified(context, itemKey);
							}
						}
					}
				}
			}
			bool flag4 = treasuryUpdated;
			if (flag4)
			{
				this.SetTaiwuTreasury(context, treasury);
			}
		}

		// Token: 0x0600126C RID: 4716 RVA: 0x001239A0 File Offset: 0x00121BA0
		public static int CalcVillagerRoleMaxCount(int progress)
		{
			int i = 0;
			for (;;)
			{
				i++;
				progress -= i * 100;
				int num = progress;
				int num2 = num;
				if (num2 < 0)
				{
					break;
				}
				if (num2 == 0)
				{
					goto IL_23;
				}
			}
			return i - 1;
			IL_23:
			return i;
		}

		// Token: 0x0600126D RID: 4717 RVA: 0x001239DC File Offset: 0x00121BDC
		public static int CalcUsedCapacityBySeatCount(int seatCount)
		{
			return 50 * seatCount * (seatCount + 1);
		}

		// Token: 0x0600126E RID: 4718 RVA: 0x001239F8 File Offset: 0x00121BF8
		[DomainMethod]
		public VillagerRoleManageDisplayData GetVillagerRoleDisplayData(short roleTemplateId)
		{
			VillagerRoleItem roleCfg = VillagerRole.Instance[roleTemplateId];
			OrgMemberCollection members = this.TaiwuVillage.GetMembers();
			sbyte grade = OrganizationMember.Instance[roleCfg.OrganizationMember].Grade;
			return new VillagerRoleManageDisplayData
			{
				RoleTemplateId = roleTemplateId,
				CharacterIds = new List<int>(members.GetMembers(grade))
			};
		}

		// Token: 0x0600126F RID: 4719 RVA: 0x00123A58 File Offset: 0x00121C58
		[DomainMethod]
		public List<VillagerRoleManageDisplayData> GetAllVillagerRoleDisplayData()
		{
			List<VillagerRoleManageDisplayData> result = new List<VillagerRoleManageDisplayData>();
			foreach (VillagerRoleItem roleConfigItem in ((IEnumerable<VillagerRoleItem>)VillagerRole.Instance))
			{
				short roleTemplateId = roleConfigItem.TemplateId;
				VillagerRoleManageDisplayData displayData = this.GetVillagerRoleDisplayData(roleTemplateId);
				result.Add(displayData);
			}
			return result;
		}

		// Token: 0x06001270 RID: 4720 RVA: 0x00123AC8 File Offset: 0x00121CC8
		[DomainMethod]
		public unsafe VillagerRoleCharacterDisplayData GetVillagerRoleCharacterDisplayData(int characterId)
		{
			GameData.Domains.Character.Character character;
			bool flag = !DomainManager.Character.TryGetElement_Objects(characterId, out character);
			VillagerRoleCharacterDisplayData result;
			if (flag)
			{
				result = null;
			}
			else
			{
				sbyte readBookMaxGrade = 0;
				bool matchVillagerRole = false;
				sbyte leftPotentialCount = GlobalConfig.Instance.TaiwuVillagerMaxPotential;
				VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
				VillagerWorkData villagerWork;
				bool flag2 = this._villagerWork.TryGetValue(characterId, out villagerWork) && villagerWork.WorkType == 1;
				if (flag2)
				{
					BuildingBlockData buildingBlockData = DomainManager.Building.GetBuildingBlockData(new BuildingBlockKey(villagerWork.AreaId, villagerWork.BlockId, villagerWork.BuildingBlockIndex));
					BuildingBlockItem buildingConfig = BuildingBlock.Instance[buildingBlockData.TemplateId];
					readBookMaxGrade = ((buildingConfig.RequireLifeSkillType >= 0) ? character.GetLearnedLifeSkillMaxGradeByType(buildingConfig.RequireLifeSkillType) : character.GetLearnedCombatSkillMaxGradeByType(buildingConfig.RequireCombatSkillType));
					bool flag3 = villagerRole != null;
					if (flag3)
					{
						matchVillagerRole = buildingConfig.VillagerRoleTemplateIds.Contains(villagerRole.RoleTemplateId);
					}
					leftPotentialCount = this.GetTaiwuVillagerLeftPotentialCount(characterId);
				}
				VillagerWorkData workData;
				bool flag4 = !DomainManager.Taiwu.TryGetElement_VillagerWork(characterId, out workData);
				if (flag4)
				{
					workData = new VillagerWorkData();
				}
				VillagerRoleCharacterDisplayData displayData = new VillagerRoleCharacterDisplayData
				{
					Avatar = character.GenerateAvatarRelatedData(),
					CombatSkillAttainments = *character.GetCombatSkillAttainments(),
					LifeSkillAttainments = *character.GetLifeSkillAttainments(),
					CombatSkillQualifications = *character.GetCombatSkillQualifications(),
					LifeSkillQualifications = *character.GetLifeSkillQualifications(),
					Id = characterId,
					Personalities = character.GetPersonalities(),
					ArrangementDisplayData = new VillagerRoleArrangementDisplayDataWrapper(),
					VillagerWorkData = workData,
					AliveState = (DomainManager.Character.IsCharacterAlive(characterId) ? 0 : 1),
					ReadBookMaxGrade = readBookMaxGrade,
					MatchVillagerRole = matchVillagerRole,
					LeftPotentialCount = leftPotentialCount,
					Age = character.GetPhysiologicalAge()
				};
				CharacterDomain.GetNameRelatedData(character, ref displayData.Name);
				displayData.RoleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(characterId);
				bool flag5 = villagerRole != null;
				if (flag5)
				{
					displayData.ArrangementDisplayData.ArrangementTemplateId = villagerRole.ArrangementTemplateId;
					bool flag6 = villagerRole.WorkData != null;
					if (flag6)
					{
						displayData.ArrangementDisplayData.AreaId = villagerRole.WorkData.Location.AreaId;
						bool flag7 = villagerRole.WorkData.WorkerIndex == 0;
						if (flag7)
						{
							VillagerRoleCharacterDisplayData villagerRoleCharacterDisplayData = displayData;
							villagerRoleCharacterDisplayData.Flags |= 4;
						}
					}
					displayData.ArrangementDisplayData.ArrangementDataId = (int)TaiwuDomain.CalcVillagerRoleDefaultArrangementId(villagerRole.RoleTemplateId);
					displayData.ArrangementDisplayData.ArrangementData = villagerRole.GetArrangementDisplayData();
					VillagerRoleMerchant merchant = villagerRole as VillagerRoleMerchant;
					bool flag8 = merchant != null;
					if (flag8)
					{
						displayData.ItemTemplateKey = merchant.ItemTemplateKey;
					}
				}
				displayData.CollectResourceAmount = ((workData != null && workData.WorkType == 10) ? workData.GetCollectResourceIncome() : 0);
				result = displayData;
			}
			return result;
		}

		// Token: 0x06001271 RID: 4721 RVA: 0x00123DA0 File Offset: 0x00121FA0
		public sbyte GetTaiwuVillagerLeftPotentialCount(int charId)
		{
			sbyte leftPotentialCount = GlobalConfig.Instance.TaiwuVillagerMaxPotential;
			sbyte count;
			DomainManager.Extra.TryGetElement_TaiwuVillagerPotentialData(charId, out count);
			leftPotentialCount -= count;
			return (sbyte)MathF.Max(0f, (float)leftPotentialCount);
		}

		// Token: 0x06001272 RID: 4722 RVA: 0x00123DE0 File Offset: 0x00121FE0
		[DomainMethod]
		public VillagerRoleCharacterSlimDisplayData GetVillagerRoleCharacterSlimDisplayData(int characterId)
		{
			VillagerRoleCharacterSlimDisplayData displayData = new VillagerRoleCharacterSlimDisplayData
			{
				Id = characterId,
				RoleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(characterId),
				ArrangementTemplateId = -1
			};
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			bool flag = villagerRole != null;
			if (flag)
			{
				displayData.ArrangementTemplateId = (short)villagerRole.ArrangementTemplateId;
			}
			return displayData;
		}

		// Token: 0x06001273 RID: 4723 RVA: 0x00123E3C File Offset: 0x0012203C
		[DomainMethod]
		[return: TupleElementNames(new string[]
		{
			"successRateBonus",
			"chickenSuccess",
			"MigrateSpeedBonusFactor"
		})]
		public ValueTuple<int, int, int> GetVillagerFarmerMigrateResourceSuccessRateBonus(int characterId)
		{
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			VillagerRoleFarmer farmer = villagerRole as VillagerRoleFarmer;
			VillagerWorkData villagerWork;
			bool flag = farmer != null && this._villagerWork.TryGetValue(characterId, out villagerWork) && villagerWork.WorkType == 14;
			ValueTuple<int, int, int> result;
			if (flag)
			{
				int migrateSuccess = farmer.MigrateResourceSuccessRateBonus;
				int chickenSuccess = farmer.HasChickenUpgradeEffect ? farmer.UpgradeBuildingCoreRate : -1;
				short settlementId = DomainManager.Character.GetElement_Objects(characterId).GetOrganizationInfo().SettlementId;
				int buildingBonus = DomainManager.Building.GetBuildingBlockEffect(settlementId, EBuildingScaleEffect.MigrateSpeedBonusFactor, -1);
				result = new ValueTuple<int, int, int>(migrateSuccess, chickenSuccess, buildingBonus);
			}
			else
			{
				result = new ValueTuple<int, int, int>(-1, -1, -1);
			}
			return result;
		}

		// Token: 0x06001274 RID: 4724 RVA: 0x00123EE1 File Offset: 0x001220E1
		internal IEnumerable<short> CalcVillagerRoleFeatureTemplateIds()
		{
			foreach (VillagerRoleItem role in ((IEnumerable<VillagerRoleItem>)VillagerRole.Instance))
			{
				bool flag = role.FeatureId < 0;
				if (!flag)
				{
					yield return role.FeatureId;
					role = null;
				}
			}
			IEnumerator<VillagerRoleItem> enumerator = null;
			yield break;
			yield break;
		}

		// Token: 0x06001275 RID: 4725 RVA: 0x00123EF4 File Offset: 0x001220F4
		internal void ReCalcVillagerFeatureHolderSet()
		{
			HashSet<short> featureSet = new HashSet<short>(this.CalcVillagerRoleFeatureTemplateIds());
			List<GameData.Domains.Character.Character> characters = new List<GameData.Domains.Character.Character>();
			this._villagerFeatureHolderSet.Clear();
			DomainManager.Character.FindIntelligentCharacters((GameData.Domains.Character.Character ch) => featureSet.Overlaps(ch.GetFeatureIds()), characters);
			this._villagerFeatureHolderSet.UnionWith(from ch in characters
			select ch.GetId());
		}

		// Token: 0x06001276 RID: 4726 RVA: 0x00123F74 File Offset: 0x00122174
		internal unsafe void FillVillagerRoleRecordElement(GameData.Domains.Character.Character character, VillagerRoleRecordElement record)
		{
			record.CharacterId = character.GetId();
			record.CharacterTemplateId = character.GetTemplateId();
			record.Avatar = character.GenerateAvatarRelatedData();
			record.CombatSkillAttainments = *character.GetCombatSkillAttainments();
			record.LifeSkillAttainments = *character.GetLifeSkillAttainments();
			record.Personalities = character.GetPersonalities();
			record.RoleTemplateId = DomainManager.Extra.GetVillagerRoleTemplateId(character.GetId());
			record.Date = DomainManager.World.GetCurrDate();
			CharacterDomain.GetNameRelatedData(character, ref record.Name);
		}

		// Token: 0x06001277 RID: 4727 RVA: 0x00124008 File Offset: 0x00122208
		[DomainMethod]
		public List<VillagerRoleCharacterDisplayData> GetVillagerRoleCharacterDisplayDataOnPanel(DataContext ctx)
		{
			CharacterDomain charDomain = DomainManager.Character;
			ExtraDomain extraDomain = DomainManager.Extra;
			VillagerRoleRecords records = extraDomain.GetVillagerRoleRecordsData();
			List<VillagerRoleCharacterDisplayData> displayDataList = new List<VillagerRoleCharacterDisplayData>();
			bool needWriteRecords = false;
			HashSet<int> idSetCurrentVillager = new HashSet<int>(extraDomain.GetVillagerRoleCharacters());
			HashSet<int> idSetHasFeature = new HashSet<int>(this._villagerFeatureHolderSet);
			idSetHasFeature.ExceptWith(idSetCurrentVillager);
			foreach (VillagerRoleRecordElement record in records.History)
			{
				int charId = record.CharacterId;
				bool flag = idSetCurrentVillager.Contains(charId) && extraDomain.GetVillagerRoleTemplateId(charId) == record.RoleTemplateId;
				if (!flag)
				{
					GameData.Domains.Character.Character character;
					bool flag2 = charDomain.TryGetElement_Objects(charId, out character);
					if (flag2)
					{
						short template = record.RoleTemplateId;
						int date = record.Date;
						this.FillVillagerRoleRecordElement(character, record);
						record.RoleTemplateId = template;
						record.Date = date;
						needWriteRecords = true;
					}
					else
					{
						idSetHasFeature.Remove(charId);
					}
					VillagerRoleCharacterDisplayData displayData = new VillagerRoleCharacterDisplayData
					{
						Avatar = record.Avatar,
						CombatSkillAttainments = record.CombatSkillAttainments,
						LifeSkillAttainments = record.LifeSkillAttainments,
						Id = charId,
						Personalities = record.Personalities,
						Name = record.Name,
						ArrangementDisplayData = new VillagerRoleArrangementDisplayDataWrapper(),
						VillagerWorkData = new VillagerWorkData(),
						AliveState = (DomainManager.Character.IsCharacterAlive(charId) ? 0 : 1)
					};
					VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(charId);
					displayData.RoleTemplateId = record.RoleTemplateId;
					bool flag3 = villagerRole != null;
					if (flag3)
					{
						displayData.ArrangementDisplayData.ArrangementTemplateId = villagerRole.ArrangementTemplateId;
						bool flag4 = villagerRole.WorkData != null;
						if (flag4)
						{
							displayData.ArrangementDisplayData.AreaId = villagerRole.WorkData.Location.AreaId;
						}
						displayData.ArrangementDisplayData.ArrangementDataId = (int)TaiwuDomain.CalcVillagerRoleDefaultArrangementId(villagerRole.RoleTemplateId);
						displayData.ArrangementDisplayData.ArrangementData = villagerRole.GetArrangementDisplayData();
					}
					bool flag5 = idSetHasFeature.Contains(charId);
					if (flag5)
					{
						VillagerRoleCharacterDisplayData villagerRoleCharacterDisplayData = displayData;
						villagerRoleCharacterDisplayData.Flags |= 2;
					}
					displayDataList.Add(displayData);
				}
			}
			foreach (int charId2 in idSetCurrentVillager)
			{
				VillagerRoleCharacterDisplayData data = this.GetVillagerRoleCharacterDisplayData(charId2);
				bool flag6 = data == null;
				if (!flag6)
				{
					VillagerRoleCharacterDisplayData villagerRoleCharacterDisplayData2 = data;
					villagerRoleCharacterDisplayData2.Flags |= 1;
					displayDataList.Add(data);
				}
			}
			bool flag7 = needWriteRecords;
			if (flag7)
			{
				extraDomain.SetVillagerRoleRecordsData(ctx, records);
			}
			return displayDataList;
		}

		// Token: 0x06001278 RID: 4728 RVA: 0x00124300 File Offset: 0x00122500
		[DomainMethod]
		public List<VillagerRoleCharacterDisplayData> GetVillagerRoleCharacterDisplayDataList(List<int> characterIdList)
		{
			bool flag = characterIdList == null;
			List<VillagerRoleCharacterDisplayData> result;
			if (flag)
			{
				result = null;
			}
			else
			{
				List<VillagerRoleCharacterDisplayData> displayDataList = new List<VillagerRoleCharacterDisplayData>();
				foreach (int charId in characterIdList)
				{
					displayDataList.Add(this.GetVillagerRoleCharacterDisplayData(charId));
				}
				result = displayDataList;
			}
			return result;
		}

		// Token: 0x06001279 RID: 4729 RVA: 0x00124374 File Offset: 0x00122574
		[DomainMethod]
		public bool BatchSetVillagerRole(DataContext context, List<int> characterIdList, short roleTemplateId)
		{
			IReadOnlySet<int> currSet = this.GetVillagerRoleSet(roleTemplateId);
			HashSet<int> hashSet = ObjectPool<HashSet<int>>.Instance.Get();
			hashSet.Clear();
			hashSet.UnionWith(currSet);
			foreach (int charId in hashSet)
			{
				bool flag = characterIdList == null || !characterIdList.Contains(charId);
				if (flag)
				{
					this.SetVillagerRole(context, charId, -1);
				}
			}
			bool flag2 = characterIdList == null;
			bool result;
			if (flag2)
			{
				result = true;
			}
			else
			{
				foreach (int charId2 in characterIdList)
				{
					bool flag3 = !hashSet.Contains(charId2);
					if (flag3)
					{
						this.SetVillagerRole(context, charId2, roleTemplateId);
					}
				}
				result = true;
			}
			return result;
		}

		// Token: 0x0600127A RID: 4730 RVA: 0x00124470 File Offset: 0x00122670
		[DomainMethod]
		public bool DispatchVillagerArrangement(DataContext context, int characterId, short arrangementTemplateId, Location location)
		{
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			bool flag = villagerRole == null;
			bool result;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("character ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(characterId);
				defaultInterpolatedStringHandler.AppendLiteral(" is not assigned as any villager role.");
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				result = false;
			}
			else
			{
				this.RemoveVillagerWork(context, characterId, true);
				bool flag2 = arrangementTemplateId < 0;
				if (flag2)
				{
					result = true;
				}
				else
				{
					villagerRole.OfflineSetArrangement(arrangementTemplateId, location);
					DomainManager.Extra.SetVillagerRole(context, characterId);
					this.SetVillagerWork(context, characterId, villagerRole.WorkData, false);
					result = true;
				}
			}
			return result;
		}

		// Token: 0x0600127B RID: 4731 RVA: 0x0012451C File Offset: 0x0012271C
		[DomainMethod]
		public bool RecallVillager(DataContext context, int characterId)
		{
			this.RemoveVillagerWork(context, characterId, true);
			return true;
		}

		// Token: 0x0600127C RID: 4732 RVA: 0x0012453C File Offset: 0x0012273C
		[DomainMethod]
		public bool AssignTargetItem(DataContext context, int characterId, TemplateKey targetItem)
		{
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			VillagerRoleMerchant merchant = villagerRole as VillagerRoleMerchant;
			bool flag = merchant == null;
			bool result;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(41, 1);
				defaultInterpolatedStringHandler.AppendLiteral("character ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(characterId);
				defaultInterpolatedStringHandler.AppendLiteral(" is not assigned as a merchant.");
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
				result = false;
			}
			else
			{
				merchant.ItemTemplateKey = targetItem;
				merchant.BoughtInAmount = 0;
				DomainManager.Extra.SetVillagerRole(context, characterId);
				result = true;
			}
			return result;
		}

		// Token: 0x0600127D RID: 4733 RVA: 0x001245D0 File Offset: 0x001227D0
		[DomainMethod]
		public void SetMerchantType(DataContext context, int characterId, sbyte merchantType, bool immediate = false)
		{
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			VillagerRoleMerchant merchant = villagerRole as VillagerRoleMerchant;
			bool flag = merchant == null;
			if (flag)
			{
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(41, 1);
				defaultInterpolatedStringHandler.AppendLiteral("character ");
				defaultInterpolatedStringHandler.AppendFormatted<int>(characterId);
				defaultInterpolatedStringHandler.AppendLiteral(" is not assigned as a merchant.");
				logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			else
			{
				merchant.DesignatedMerchantType = merchantType;
				bool flag2 = !immediate;
				if (flag2)
				{
					bool flag3 = merchantType == 7;
					if (flag3)
					{
						merchant.SelfDecideMerchantType = (sbyte)context.Random.Next(7);
					}
					bool flag4 = merchant.CurrentMerchantType == 7;
					if (flag4)
					{
						GameData.Domains.Character.Character character = DomainManager.Character.GetElement_Objects(characterId);
						merchant.CurrentMerchantType = (sbyte)context.Random.Next(7);
						character.ChangeMerchantType(context, character.GetOrganizationInfo());
					}
				}
				else
				{
					GameData.Domains.Character.Character character2 = DomainManager.Character.GetElement_Objects(characterId);
					merchant.CurrentMerchantType = ((merchantType == 7) ? merchant.SelfDecideMerchantType : merchantType);
					character2.ChangeMerchantType(context, character2.GetOrganizationInfo());
				}
				DomainManager.Extra.SetVillagerRole(context, characterId);
			}
		}

		// Token: 0x0600127E RID: 4734 RVA: 0x001246F4 File Offset: 0x001228F4
		[DomainMethod]
		public sbyte GetMerchantType(int characterId)
		{
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			VillagerRoleMerchant merchant = villagerRole as VillagerRoleMerchant;
			return (merchant == null) ? 7 : merchant.DesignatedMerchantType;
		}

		// Token: 0x0600127F RID: 4735 RVA: 0x00124728 File Offset: 0x00122928
		[DomainMethod]
		public bool AssignArrangementIncreaseOrDecrease(DataContext context, int characterId, bool isIncrease)
		{
			VillagerRoleBase villagerRole = DomainManager.Extra.GetVillagerRole(characterId);
			VillagerRoleBase villagerRoleBase = villagerRole;
			VillagerRoleBase villagerRoleBase2 = villagerRoleBase;
			VillagerRoleLiterati literati = villagerRoleBase2 as VillagerRoleLiterati;
			if (literati == null)
			{
				VillagerRoleSwordTombKeeper swordTombKeeper = villagerRoleBase2 as VillagerRoleSwordTombKeeper;
				if (swordTombKeeper == null)
				{
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(69, 1);
					defaultInterpolatedStringHandler.AppendLiteral("character ");
					defaultInterpolatedStringHandler.AppendFormatted<int>(characterId);
					defaultInterpolatedStringHandler.AppendLiteral(" is neither assigned as a literati nor a sword tomb keeper.");
					logger.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
					return false;
				}
				swordTombKeeper.PositiveAction = isIncrease;
			}
			else
			{
				literati.PositiveAction = isIncrease;
			}
			DomainManager.Extra.SetVillagerRole(context, characterId);
			return true;
		}

		// Token: 0x06001280 RID: 4736 RVA: 0x001247CC File Offset: 0x001229CC
		[DomainMethod]
		public VillagerRoleTipsDisplayData GetVillagerRoleTipsDisplayData(DataContext context, short roleTemplateId)
		{
			VillagerRoleTipsDisplayData displayData = new VillagerRoleTipsDisplayData
			{
				RoleTemplateId = roleTemplateId,
				RelatedBuildingClassList = new List<int>(),
				DetailList = new List<IntPair>()
			};
			this.GetVillagerRoleCapacityRelatedBuildingClass(roleTemplateId, ref displayData.RelatedBuildingClassList);
			DomainManager.Building.GetVillagerRoleCapacitiesDetail(roleTemplateId, ref displayData.DetailList);
			return displayData;
		}

		// Token: 0x06001281 RID: 4737 RVA: 0x00124824 File Offset: 0x00122A24
		private void GetVillagerRoleCapacityRelatedBuildingClass(short roleTemplateId, ref List<int> relatedBuildingClassList)
		{
			foreach (BuildingScaleItem buildingScale in ((IEnumerable<BuildingScaleItem>)BuildingScale.Instance))
			{
				foreach (BuildingBlockItem buildingBlock in ((IEnumerable<BuildingBlockItem>)BuildingBlock.Instance))
				{
					bool flag = buildingBlock.VillagerRoleTemplateIds == null || !buildingBlock.VillagerRoleTemplateIds.Exist(roleTemplateId);
					if (!flag)
					{
						bool flag2 = buildingBlock.ExpandInfos == null;
						if (!flag2)
						{
							bool flag3 = !buildingBlock.ExpandInfos.Contains(buildingScale.TemplateId);
							if (!flag3)
							{
								bool flag4 = relatedBuildingClassList.Contains((int)buildingBlock.Class);
								if (!flag4)
								{
									relatedBuildingClassList.Add((int)buildingBlock.Class);
								}
							}
						}
					}
				}
			}
		}

		// Token: 0x06001282 RID: 4738 RVA: 0x00124924 File Offset: 0x00122B24
		[DomainMethod]
		public int SetVillagerRoleNickName(DataContext context, short roleTemplateId, string nickName)
		{
			return DomainManager.Extra.SetVillagerRoleNickName(context, roleTemplateId, nickName);
		}

		// Token: 0x06001283 RID: 4739 RVA: 0x00124944 File Offset: 0x00122B44
		[DomainMethod]
		public string GetVillagerRoleNpcNickName(short roleTemplateId)
		{
			int key;
			bool flag = DomainManager.Extra.TryGetElement_VillagerRoleNickNameMap(roleTemplateId, out key);
			string result;
			if (flag)
			{
				result = DomainManager.World.GetElement_CustomTexts(key);
			}
			else
			{
				result = null;
			}
			return result;
		}

		// Token: 0x06001284 RID: 4740 RVA: 0x00124978 File Offset: 0x00122B78
		[DomainMethod]
		public unsafe List<DispatchSwordTombDisplayData> GetAllSwordTombDisplayDataForDispatch()
		{
			List<DispatchSwordTombDisplayData> result = new List<DispatchSwordTombDisplayData>();
			AreaAdventureData adventuresInArea = DomainManager.Adventure.GetAdventuresInArea(EventArgBox.TaiwuVillageAreaId);
			sbyte[] xiangshuAvatarTasksInOrder = DomainManager.World.GetXiangshuAvatarTasksInOrder();
			for (int i = 0; i < xiangshuAvatarTasksInOrder.Length - 1; i++)
			{
				sbyte xiangshuAvatarId = xiangshuAvatarTasksInOrder[i];
				DispatchSwordTombDisplayData displayData = new DispatchSwordTombDisplayData
				{
					Id = xiangshuAvatarId,
					KeeperCount = 0
				};
				WorldStateData worldState = *DomainManager.World.GetWorldStateData();
				sbyte escapeState = 0;
				bool flag = worldState.IsXiangshuAvatarAwakening(xiangshuAvatarId);
				if (flag)
				{
					escapeState = 1;
				}
				bool flag2 = worldState.IsXiangshuAvatarAttacking(xiangshuAvatarId);
				if (flag2)
				{
					escapeState = 2;
				}
				displayData.EscapeState = escapeState;
				displayData.Location = DomainManager.Map.GetElement_SwordTombLocations(i);
				displayData.BlockData = DomainManager.Map.GetBlock(displayData.Location);
				bool flag3 = displayData.BlockData.RootBlockId >= 0;
				if (flag3)
				{
					displayData.RootBlockData = DomainManager.Map.GetBlockData(displayData.Location.AreaId, displayData.BlockData.RootBlockId);
				}
				VillagerRoleManageDisplayData keeperDisplayData = this.GetVillagerRoleDisplayData(5);
				foreach (int charId in keeperDisplayData.CharacterIds)
				{
					VillagerRoleSwordTombKeeper villagerRole = DomainManager.Extra.GetVillagerRole(charId) as VillagerRoleSwordTombKeeper;
					bool flag4 = villagerRole == null;
					if (!flag4)
					{
						bool flag5 = villagerRole.ArrangementTemplateId == 3 && villagerRole.XiangshuAvatarId == xiangshuAvatarId;
						if (flag5)
						{
							DispatchSwordTombDisplayData dispatchSwordTombDisplayData = displayData;
							dispatchSwordTombDisplayData.KeeperCount += 1;
						}
					}
				}
				bool foundAdventure = false;
				foreach (KeyValuePair<short, AdventureSiteData> pair in adventuresInArea.AdventureSites)
				{
					sbyte adventureXiangshuAvatarId = XiangshuAvatarIds.GetXiangshuAvatarIdBySwordTomb(pair.Value.TemplateId);
					bool flag6 = adventureXiangshuAvatarId == xiangshuAvatarId;
					if (flag6)
					{
						displayData.RemainingMonths = pair.Value.RemainingMonths;
						foundAdventure = true;
						break;
					}
				}
				bool flag7 = !foundAdventure;
				if (flag7)
				{
					displayData.EscapeState = 3;
				}
				result.Add(displayData);
			}
			return result;
		}

		// Token: 0x06001285 RID: 4741 RVA: 0x00124BCC File Offset: 0x00122DCC
		internal void UpdateVillagerRoleRecords(DataContext ctx)
		{
			ExtraDomain extraDomain = DomainManager.Extra;
			VillagerRoleRecords records = extraDomain.GetVillagerRoleRecordsData();
			int currDate = DomainManager.World.GetCurrDate();
			bool flag = records.History.RemoveAll((VillagerRoleRecordElement element) => currDate - element.Date > 36) > 0;
			if (flag)
			{
				extraDomain.SetVillagerRoleRecordsData(ctx, records);
			}
		}

		// Token: 0x06001286 RID: 4742 RVA: 0x00124C28 File Offset: 0x00122E28
		[DomainMethod]
		public int GetVillagerRoleHeadTotalAuthorityCost()
		{
			int value = 0;
			IReadOnlySet<int> villagerHeads = DomainManager.Taiwu.GetVillagerRoleSet(6);
			foreach (int headCharId in villagerHeads)
			{
				VillagerRoleHead head = DomainManager.Extra.GetVillagerRole(headCharId) as VillagerRoleHead;
				bool flag = head == null;
				if (!flag)
				{
					bool flag2;
					value -= head.GetAuthorityCost(false, out flag2);
				}
			}
			return value;
		}

		// Token: 0x06001287 RID: 4743 RVA: 0x00124CB4 File Offset: 0x00122EB4
		private void VillagerWorkCollectResource(DataContext context, VillagerWorkData workData)
		{
			bool flag = workData.ResourceType < 0;
			if (!flag)
			{
				VillagerRoleFarmer farmer = workData.GetVillagerRole() as VillagerRoleFarmer;
				bool flag2 = farmer != null;
				if (flag2)
				{
					Location blockKey = new Location(workData.AreaId, workData.BlockId);
					MapBlockData block = DomainManager.Map.GetBlock(blockKey);
					farmer.CollectResource(context, block, workData.ResourceType, false);
				}
				else
				{
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(67, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Non-farmer character ");
					defaultInterpolatedStringHandler.AppendFormatted<int>(workData.CharacterId);
					defaultInterpolatedStringHandler.AppendLiteral(" trying to collect resource for taiwu village.");
					logger.AppendWarning(defaultInterpolatedStringHandler.ToStringAndClear());
				}
			}
		}

		// Token: 0x06001288 RID: 4744 RVA: 0x00124D64 File Offset: 0x00122F64
		private void VillagerWorkMigrateResource(DataContext context, VillagerWorkData workData)
		{
			Location location = workData.Location;
			short settlementId = DomainManager.Character.GetElement_Objects(workData.CharacterId).GetOrganizationInfo().SettlementId;
			MapBlockData block = DomainManager.Map.GetBlock(location);
			VillagerRoleFarmer farmer;
			bool flag;
			if (workData.ResourceType >= 0)
			{
				farmer = (workData.GetVillagerRole() as VillagerRoleFarmer);
				flag = (farmer == null);
			}
			else
			{
				flag = true;
			}
			bool flag2 = flag;
			if (!flag2)
			{
				farmer.RefreshFailureAccumulation(workData.ResourceType);
				int successRate = farmer.MigrateResourceBaseSuccessRate;
				int buildingBonus = DomainManager.Building.GetBuildingBlockEffect(settlementId, EBuildingScaleEffect.MigrateSpeedBonusFactor, -1);
				successRate *= buildingBonus;
				successRate += farmer.MigrateResourceSuccessRateBonus;
				bool flag3 = context.Random.CheckPercentProb(successRate);
				if (flag3)
				{
					ResourceTypeItem resourceTypeCfg = Config.ResourceType.Instance[workData.ResourceType];
					List<ValueTuple<short, short>> weightTable = context.AdvanceMonthRelatedData.WeightTable.Occupy();
					short[] possibleItems = resourceTypeCfg.PossibleBuildingCoreItem;
					bool flag4;
					if (farmer.HasChickenUpgradeEffect && context.Random.CheckPercentProb(farmer.UpgradeBuildingCoreRate))
					{
						short[] possibleUpgradedBuildingCoreItem = resourceTypeCfg.PossibleUpgradedBuildingCoreItem;
						flag4 = (possibleUpgradedBuildingCoreItem != null && possibleUpgradedBuildingCoreItem.Length > 0);
					}
					else
					{
						flag4 = false;
					}
					bool flag5 = flag4;
					if (flag5)
					{
						possibleItems = resourceTypeCfg.PossibleUpgradedBuildingCoreItem;
					}
					foreach (short coreItem in possibleItems)
					{
						weightTable.Add(new ValueTuple<short, short>(coreItem, 0));
					}
					foreach (BuildingBlockItem buildingBlock in ((IEnumerable<BuildingBlockItem>)BuildingBlock.Instance))
					{
						bool flag6 = buildingBlock.BuildingCoreItem < 0;
						if (!flag6)
						{
							int index = resourceTypeCfg.PossibleBuildingCoreItem.IndexOf(buildingBlock.BuildingCoreItem);
							bool flag7 = index < 0;
							if (!flag7)
							{
								sbyte[] collectResourcePercent = buildingBlock.CollectResourcePercent;
								bool flag8 = collectResourcePercent == null || collectResourcePercent.Length <= 0;
								if (!flag8)
								{
									short weight = weightTable[index].Item2 + (short)buildingBlock.CollectResourcePercent[(int)workData.ResourceType];
									bool flag9 = workData.ResourceType == 5;
									if (flag9)
									{
										weight += (short)buildingBlock.CollectResourcePercent[(int)(workData.ResourceType + 1)];
									}
									weightTable[index] = new ValueTuple<short, short>(buildingBlock.BuildingCoreItem, weight);
								}
							}
						}
					}
					short miscTemplateId = RandomUtils.GetRandomResult<short>(weightTable, context.Random);
					ItemKey itemKey = DomainManager.Item.CreateMisc(context, miscTemplateId);
					DomainManager.Taiwu.WarehouseAdd(context, itemKey, 1);
					context.AdvanceMonthRelatedData.WeightTable.Release(ref weightTable);
					int currDate = DomainManager.World.GetCurrDate();
					LifeRecordCollection lifeRecordCollection = DomainManager.LifeRecord.GetLifeRecordCollection();
					MonthlyNotificationCollection monthlyNotifications = DomainManager.World.GetMonthlyNotificationCollection();
					TaiwuVillageStoragesRecordCollection storageRecordCollection = DomainManager.Extra.GetTaiwuVillageStoragesRecordCollection();
					lifeRecordCollection.AddVillagerMigrateResources(workData.CharacterId, currDate, location, itemKey.ItemType, itemKey.TemplateId);
					monthlyNotifications.AddResourceMigration(workData.CharacterId, location, itemKey.ItemType, itemKey.TemplateId);
					storageRecordCollection.AddMigrateResources(currDate, TaiwuVillageStorageType.Warehouse, workData.CharacterId, itemKey.ItemType, itemKey.TemplateId);
					this.RemoveVillagerWork(context, workData.CharacterId, true);
					bool flag10 = block.RootBlockId >= 0 || block.GroupBlockList != null;
					if (flag10)
					{
						return;
					}
					block.Destroyed = true;
					block.DestroyItemsDirect(context.AdvanceMonthRelatedData.WorldItemsToBeRemoved);
					block.CurrResources.Initialize();
					DomainManager.Map.SetBlockData(context, block);
					DomainManager.Extra.AddMapBlockRecoveryLock(context, location, 120);
				}
				else
				{
					farmer.AccumulateMigrateFailure();
				}
				DomainManager.Extra.SetVillagerRole(context, farmer.Character.GetId());
			}
		}

		// Token: 0x06001289 RID: 4745 RVA: 0x0012511C File Offset: 0x0012331C
		public TaiwuDomain() : base(77)
		{
			this._taiwuCharId = 0;
			this._taiwuGenerationsCount = 0;
			this._cricketLuckPoint = 0;
			this._previousTaiwuIds = new List<int>();
			this._needToEscape = false;
			this._receivedItems = new List<ItemDisplayData>();
			this._receivedCharacters = new List<CharacterDisplayData>();
			this._warehouseItems = new Dictionary<ItemKey, int>(0);
			this._warehouseMaxLoad = 0;
			this._warehouseCurrLoad = 0;
			this._buildingSpaceLimit = 0;
			this._buildingSpaceCurr = 0;
			this._buildingSpaceExtraAdd = 0;
			this._prosperousConstruction = false;
			this._combatSkills = new Dictionary<short, TaiwuCombatSkill>(0);
			this._lifeSkills = new Dictionary<short, TaiwuLifeSkill>(0);
			this._combatSkillPlans = new CombatSkillPlan[9];
			this._currCombatSkillPlanId = 0;
			this._currLifeSkillAttainmentPanelPlanIndex = new sbyte[16];
			this._skillBreakPlateObsoleteDict = new Dictionary<short, SkillBreakPlateObsolete>(0);
			this._skillBreakBonusDict = new Dictionary<short, SkillBreakBonusCollection>(0);
			this._teachTaiwuLifeSkillDict = new Dictionary<int, GameData.Utilities.ShortList>(0);
			this._teachTaiwuCombatSkillDict = new Dictionary<int, GameData.Utilities.ShortList>(0);
			this._combatSkillAttainmentPanelPlans = new short[630];
			this._currCombatSkillAttainmentPanelPlanIds = new sbyte[14];
			this._moveTimeCostPercent = 0;
			this._weaponInnerRatios = new sbyte[6];
			this._weaponCurrInnerRatios = new sbyte[7];
			this._appointments = new Dictionary<int, short>(0);
			this._babyBonusMainAttributes = 0;
			this._babyBonusLifeSkillQualifications = 0;
			this._babyBonusCombatSkillQualifications = 0;
			this._equipmentsPlans = new EquipmentPlan[5];
			this._currEquipmentPlanId = 0;
			this._groupCharIds = default(CharacterSet);
			this._combatGroupCharIds = new int[3];
			this._taiwuGroupMaxCount = 0;
			this._legacyPointDict = new Dictionary<short, short>(0);
			this._legacyPoint = 0;
			this._availableLegacyList = new List<short>();
			this._legacyPassingState = 0;
			this._successorCandidates = new List<int>();
			this._stateNewCharacterLegacyGrowingGrades = new SByteList[15];
			this._notLearnCombatSkillReadingProgress = new Dictionary<short, TaiwuCombatSkill>(0);
			this._notLearnLifeSkillReadingProgress = new Dictionary<short, TaiwuLifeSkill>(0);
			this._readingBooks = new Dictionary<ItemKey, ReadingBookStrategies>(0);
			this._curReadingBook = default(ItemKey);
			this._referenceBooks = new ItemKey[3];
			this._referenceBookSlotUnlockStates = 0;
			this._readingEventTriggered = false;
			this._readInCombatCount = 0;
			this._healingOuterInjuryRestriction = false;
			this._healingInnerInjuryRestriction = false;
			this._neiliAllocationTypeRestriction = 0;
			this._visitedSettlements = new List<short>();
			this._taiwuVillageSettlementId = 0;
			this._villagerWork = new Dictionary<int, VillagerWorkData>(0);
			this._villagerWorkLocations = new HashSetAsDictionary<Location>();
			this._materialResourceMaxCount = 0;
			this._resourceChange = new int[8];
			this._workLocationMaxCount = 0;
			this._totalVillagerCount = 0;
			this._totalAdultVillagerCount = 0;
			this._availableVillagerCount = 0;
			this._isTaiwuDieOfCombatWithXiangshu = false;
			this._villagerLearnLifeSkillsFromSect = false;
			this._villagerLearnCombatSkillsFromSect = false;
			this._overweightSanctionPercent = new List<IntPair>();
			this._referenceSkillSlotUnlockStates = 0;
			this._taiwuGroupWorstInjuries = default(Injuries);
			this._totalResources = default(ResourceInts);
			this._taiwuSpecialGroup = new List<int>();
			this._taiwuGearMateGroup = new List<int>();
			this._canBreakOut = false;
			this._troughMaxLoad = 0;
			this._troughCurrLoad = 0;
			this._clothingDurability = new List<IntPair>();
			this.OnInitializedDomainData();
		}

		// Token: 0x0600128A RID: 4746 RVA: 0x00125918 File Offset: 0x00123B18
		public int GetTaiwuCharId()
		{
			return this._taiwuCharId;
		}

		// Token: 0x0600128B RID: 4747 RVA: 0x00125930 File Offset: 0x00123B30
		private unsafe void SetTaiwuCharId(int value, DataContext context)
		{
			this._taiwuCharId = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(0, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 0, 4);
			*(int*)pData = this._taiwuCharId;
			pData += 4;
		}

		// Token: 0x0600128C RID: 4748 RVA: 0x00125970 File Offset: 0x00123B70
		public int GetTaiwuGenerationsCount()
		{
			return this._taiwuGenerationsCount;
		}

		// Token: 0x0600128D RID: 4749 RVA: 0x00125988 File Offset: 0x00123B88
		public unsafe void SetTaiwuGenerationsCount(int value, DataContext context)
		{
			this._taiwuGenerationsCount = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(1, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 1, 4);
			*(int*)pData = this._taiwuGenerationsCount;
			pData += 4;
		}

		// Token: 0x0600128E RID: 4750 RVA: 0x001259C8 File Offset: 0x00123BC8
		public int GetCricketLuckPoint()
		{
			return this._cricketLuckPoint;
		}

		// Token: 0x0600128F RID: 4751 RVA: 0x001259E0 File Offset: 0x00123BE0
		public unsafe void SetCricketLuckPoint(int value, DataContext context)
		{
			this._cricketLuckPoint = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(2, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 2, 4);
			*(int*)pData = this._cricketLuckPoint;
			pData += 4;
		}

		// Token: 0x06001290 RID: 4752 RVA: 0x00125A20 File Offset: 0x00123C20
		public List<int> GetPreviousTaiwuIds()
		{
			return this._previousTaiwuIds;
		}

		// Token: 0x06001291 RID: 4753 RVA: 0x00125A38 File Offset: 0x00123C38
		public unsafe void SetPreviousTaiwuIds(List<int> value, DataContext context)
		{
			this._previousTaiwuIds = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(3, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int elementsCount = this._previousTaiwuIds.Count;
			int contentSize = 4 * elementsCount;
			int dataSize = 2 + contentSize;
			byte* pData = OperationAdder.DynamicSingleValue_Set(5, 3, dataSize);
			*(short*)pData = (short)((ushort)elementsCount);
			pData += 2;
			for (int i = 0; i < elementsCount; i++)
			{
				*(int*)(pData + (IntPtr)i * 4) = this._previousTaiwuIds[i];
			}
			pData += contentSize;
		}

		// Token: 0x06001292 RID: 4754 RVA: 0x00125AB4 File Offset: 0x00123CB4
		public bool GetNeedToEscape()
		{
			return this._needToEscape;
		}

		// Token: 0x06001293 RID: 4755 RVA: 0x00125ACC File Offset: 0x00123CCC
		public unsafe void SetNeedToEscape(bool value, DataContext context)
		{
			this._needToEscape = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(4, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 4, 1);
			*pData = (this._needToEscape ? 1 : 0);
			pData++;
		}

		// Token: 0x06001294 RID: 4756 RVA: 0x00125B0C File Offset: 0x00123D0C
		public List<ItemDisplayData> GetReceivedItems()
		{
			return this._receivedItems;
		}

		// Token: 0x06001295 RID: 4757 RVA: 0x00125B24 File Offset: 0x00123D24
		public void SetReceivedItems(List<ItemDisplayData> value, DataContext context)
		{
			this._receivedItems = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(5, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x06001296 RID: 4758 RVA: 0x00125B44 File Offset: 0x00123D44
		public List<CharacterDisplayData> GetReceivedCharacters()
		{
			return this._receivedCharacters;
		}

		// Token: 0x06001297 RID: 4759 RVA: 0x00125B5C File Offset: 0x00123D5C
		public void SetReceivedCharacters(List<CharacterDisplayData> value, DataContext context)
		{
			this._receivedCharacters = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(6, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x06001298 RID: 4760 RVA: 0x00125B7C File Offset: 0x00123D7C
		private int GetElement_WarehouseItems(ItemKey elementId)
		{
			return this._warehouseItems[elementId];
		}

		// Token: 0x06001299 RID: 4761 RVA: 0x00125B9C File Offset: 0x00123D9C
		private bool TryGetElement_WarehouseItems(ItemKey elementId, out int value)
		{
			return this._warehouseItems.TryGetValue(elementId, out value);
		}

		// Token: 0x0600129A RID: 4762 RVA: 0x00125BBC File Offset: 0x00123DBC
		private unsafe void AddElement_WarehouseItems(ItemKey elementId, int value, DataContext context)
		{
			this._warehouseItems.Add(elementId, value);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(7, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<ItemKey>(5, 7, elementId, 4);
			*(int*)pData = value;
			pData += 4;
		}

		// Token: 0x0600129B RID: 4763 RVA: 0x00125BFC File Offset: 0x00123DFC
		private unsafe void SetElement_WarehouseItems(ItemKey elementId, int value, DataContext context)
		{
			this._warehouseItems[elementId] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(7, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<ItemKey>(5, 7, elementId, 4);
			*(int*)pData = value;
			pData += 4;
		}

		// Token: 0x0600129C RID: 4764 RVA: 0x00125C3C File Offset: 0x00123E3C
		private void RemoveElement_WarehouseItems(ItemKey elementId, DataContext context)
		{
			this._warehouseItems.Remove(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(7, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<ItemKey>(5, 7, elementId);
		}

		// Token: 0x0600129D RID: 4765 RVA: 0x00125C68 File Offset: 0x00123E68
		private void ClearWarehouseItems(DataContext context)
		{
			this._warehouseItems.Clear();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(7, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 7);
		}

		// Token: 0x0600129E RID: 4766 RVA: 0x00125C94 File Offset: 0x00123E94
		public int GetWarehouseMaxLoad()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 8);
			int warehouseMaxLoad;
			if (flag)
			{
				warehouseMaxLoad = this._warehouseMaxLoad;
			}
			else
			{
				int value = this.CalcWarehouseMaxLoad();
				bool lockTaken = false;
				try
				{
					this._spinLockWarehouseMaxLoad.Enter(ref lockTaken);
					this._warehouseMaxLoad = value;
					BaseGameDataDomain.SetCached(this.DataStates, 8);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockWarehouseMaxLoad.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				warehouseMaxLoad = this._warehouseMaxLoad;
			}
			return warehouseMaxLoad;
		}

		// Token: 0x0600129F RID: 4767 RVA: 0x00125D28 File Offset: 0x00123F28
		public int GetWarehouseCurrLoad()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 9);
			int warehouseCurrLoad;
			if (flag)
			{
				warehouseCurrLoad = this._warehouseCurrLoad;
			}
			else
			{
				int value = this.CalcWarehouseCurrLoad();
				bool lockTaken = false;
				try
				{
					this._spinLockWarehouseCurrLoad.Enter(ref lockTaken);
					this._warehouseCurrLoad = value;
					BaseGameDataDomain.SetCached(this.DataStates, 9);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockWarehouseCurrLoad.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				warehouseCurrLoad = this._warehouseCurrLoad;
			}
			return warehouseCurrLoad;
		}

		// Token: 0x060012A0 RID: 4768 RVA: 0x00125DC0 File Offset: 0x00123FC0
		public int GetBuildingSpaceLimit()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 10);
			int buildingSpaceLimit;
			if (flag)
			{
				buildingSpaceLimit = this._buildingSpaceLimit;
			}
			else
			{
				int value = this.CalcBuildingSpaceLimit();
				bool lockTaken = false;
				try
				{
					this._spinLockBuildingSpaceLimit.Enter(ref lockTaken);
					this._buildingSpaceLimit = value;
					BaseGameDataDomain.SetCached(this.DataStates, 10);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockBuildingSpaceLimit.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				buildingSpaceLimit = this._buildingSpaceLimit;
			}
			return buildingSpaceLimit;
		}

		// Token: 0x060012A1 RID: 4769 RVA: 0x00125E58 File Offset: 0x00124058
		public int GetBuildingSpaceCurr()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 11);
			int buildingSpaceCurr;
			if (flag)
			{
				buildingSpaceCurr = this._buildingSpaceCurr;
			}
			else
			{
				int value = this.CalcBuildingSpaceCurr();
				bool lockTaken = false;
				try
				{
					this._spinLockBuildingSpaceCurr.Enter(ref lockTaken);
					this._buildingSpaceCurr = value;
					BaseGameDataDomain.SetCached(this.DataStates, 11);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockBuildingSpaceCurr.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				buildingSpaceCurr = this._buildingSpaceCurr;
			}
			return buildingSpaceCurr;
		}

		// Token: 0x060012A2 RID: 4770 RVA: 0x00125EF0 File Offset: 0x001240F0
		public int GetBuildingSpaceExtraAdd()
		{
			return this._buildingSpaceExtraAdd;
		}

		// Token: 0x060012A3 RID: 4771 RVA: 0x00125F08 File Offset: 0x00124108
		public unsafe void SetBuildingSpaceExtraAdd(int value, DataContext context)
		{
			this._buildingSpaceExtraAdd = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(12, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 12, 4);
			*(int*)pData = this._buildingSpaceExtraAdd;
			pData += 4;
		}

		// Token: 0x060012A4 RID: 4772 RVA: 0x00125F48 File Offset: 0x00124148
		public bool GetProsperousConstruction()
		{
			return this._prosperousConstruction;
		}

		// Token: 0x060012A5 RID: 4773 RVA: 0x00125F60 File Offset: 0x00124160
		public unsafe void SetProsperousConstruction(bool value, DataContext context)
		{
			this._prosperousConstruction = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(13, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 13, 1);
			*pData = (this._prosperousConstruction ? 1 : 0);
			pData++;
		}

		// Token: 0x060012A6 RID: 4774 RVA: 0x00125FA0 File Offset: 0x001241A0
		public TaiwuCombatSkill GetElement_CombatSkills(short elementId)
		{
			return this._combatSkills[elementId];
		}

		// Token: 0x060012A7 RID: 4775 RVA: 0x00125FC0 File Offset: 0x001241C0
		public bool TryGetElement_CombatSkills(short elementId, out TaiwuCombatSkill value)
		{
			return this._combatSkills.TryGetValue(elementId, out value);
		}

		// Token: 0x060012A8 RID: 4776 RVA: 0x00125FE0 File Offset: 0x001241E0
		private unsafe void AddElement_CombatSkills(short elementId, TaiwuCombatSkill value, DataContext context)
		{
			this._combatSkills.Add(elementId, value);
			this._modificationsCombatSkills.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(14, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<short>(5, 14, elementId, 20);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012A9 RID: 4777 RVA: 0x00126034 File Offset: 0x00124234
		private unsafe void SetElement_CombatSkills(short elementId, TaiwuCombatSkill value, DataContext context)
		{
			this._combatSkills[elementId] = value;
			this._modificationsCombatSkills.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(14, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<short>(5, 14, elementId, 20);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012AA RID: 4778 RVA: 0x00126087 File Offset: 0x00124287
		private void RemoveElement_CombatSkills(short elementId, DataContext context)
		{
			this._combatSkills.Remove(elementId);
			this._modificationsCombatSkills.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(14, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<short>(5, 14, elementId);
		}

		// Token: 0x060012AB RID: 4779 RVA: 0x001260C2 File Offset: 0x001242C2
		private void ClearCombatSkills(DataContext context)
		{
			this._combatSkills.Clear();
			this._modificationsCombatSkills.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(14, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 14);
		}

		// Token: 0x060012AC RID: 4780 RVA: 0x001260FC File Offset: 0x001242FC
		public TaiwuLifeSkill GetElement_LifeSkills(short elementId)
		{
			return this._lifeSkills[elementId];
		}

		// Token: 0x060012AD RID: 4781 RVA: 0x0012611C File Offset: 0x0012431C
		public bool TryGetElement_LifeSkills(short elementId, out TaiwuLifeSkill value)
		{
			return this._lifeSkills.TryGetValue(elementId, out value);
		}

		// Token: 0x060012AE RID: 4782 RVA: 0x0012613C File Offset: 0x0012433C
		private unsafe void AddElement_LifeSkills(short elementId, TaiwuLifeSkill value, DataContext context)
		{
			this._lifeSkills.Add(elementId, value);
			this._modificationsLifeSkills.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(15, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<short>(5, 15, elementId, 5);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012AF RID: 4783 RVA: 0x00126190 File Offset: 0x00124390
		private unsafe void SetElement_LifeSkills(short elementId, TaiwuLifeSkill value, DataContext context)
		{
			this._lifeSkills[elementId] = value;
			this._modificationsLifeSkills.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(15, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<short>(5, 15, elementId, 5);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012B0 RID: 4784 RVA: 0x001261E2 File Offset: 0x001243E2
		private void RemoveElement_LifeSkills(short elementId, DataContext context)
		{
			this._lifeSkills.Remove(elementId);
			this._modificationsLifeSkills.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(15, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<short>(5, 15, elementId);
		}

		// Token: 0x060012B1 RID: 4785 RVA: 0x0012621D File Offset: 0x0012441D
		private void ClearLifeSkills(DataContext context)
		{
			this._lifeSkills.Clear();
			this._modificationsLifeSkills.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(15, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 15);
		}

		// Token: 0x060012B2 RID: 4786 RVA: 0x00126258 File Offset: 0x00124458
		private CombatSkillPlan GetElement_CombatSkillPlans(int index)
		{
			return this._combatSkillPlans[index];
		}

		// Token: 0x060012B3 RID: 4787 RVA: 0x00126274 File Offset: 0x00124474
		private unsafe void SetElement_CombatSkillPlans(int index, CombatSkillPlan value, DataContext context)
		{
			this._combatSkillPlans[index] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(index, this._dataStatesCombatSkillPlans, TaiwuDomain.CacheInfluencesCombatSkillPlans, context);
			bool flag = value != null;
			if (flag)
			{
				int dataSize = value.GetSerializedSize();
				byte* pData = OperationAdder.DynamicElementList_Set(5, 16, index, dataSize);
				pData += value.Serialize(pData);
			}
			else
			{
				OperationAdder.DynamicElementList_Set(5, 16, index, 0);
			}
		}

		// Token: 0x060012B4 RID: 4788 RVA: 0x001262D4 File Offset: 0x001244D4
		public int GetCurrCombatSkillPlanId()
		{
			return this._currCombatSkillPlanId;
		}

		// Token: 0x060012B5 RID: 4789 RVA: 0x001262EC File Offset: 0x001244EC
		private unsafe void SetCurrCombatSkillPlanId(int value, DataContext context)
		{
			this._currCombatSkillPlanId = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(17, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 17, 4);
			*(int*)pData = this._currCombatSkillPlanId;
			pData += 4;
		}

		// Token: 0x060012B6 RID: 4790 RVA: 0x0012632C File Offset: 0x0012452C
		public sbyte GetElement_CurrLifeSkillAttainmentPanelPlanIndex(int index)
		{
			return this._currLifeSkillAttainmentPanelPlanIndex[index];
		}

		// Token: 0x060012B7 RID: 4791 RVA: 0x00126348 File Offset: 0x00124548
		public unsafe void SetElement_CurrLifeSkillAttainmentPanelPlanIndex(int index, sbyte value, DataContext context)
		{
			this._currLifeSkillAttainmentPanelPlanIndex[index] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(index, this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, TaiwuDomain.CacheInfluencesCurrLifeSkillAttainmentPanelPlanIndex, context);
			byte* pData = OperationAdder.FixedElementList_Set(5, 18, index, 1);
			*pData = (byte)value;
			pData++;
		}

		// Token: 0x060012B8 RID: 4792 RVA: 0x00126384 File Offset: 0x00124584
		public SkillBreakPlateObsolete GetElement_SkillBreakPlateObsoleteDict(short elementId)
		{
			return this._skillBreakPlateObsoleteDict[elementId];
		}

		// Token: 0x060012B9 RID: 4793 RVA: 0x001263A4 File Offset: 0x001245A4
		public bool TryGetElement_SkillBreakPlateObsoleteDict(short elementId, out SkillBreakPlateObsolete value)
		{
			return this._skillBreakPlateObsoleteDict.TryGetValue(elementId, out value);
		}

		// Token: 0x060012BA RID: 4794 RVA: 0x001263C4 File Offset: 0x001245C4
		private unsafe void AddElement_SkillBreakPlateObsoleteDict(short elementId, SkillBreakPlateObsolete value, DataContext context)
		{
			this._skillBreakPlateObsoleteDict.Add(elementId, value);
			this._modificationsSkillBreakPlateObsoleteDict.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(19, this.DataStates, TaiwuDomain.CacheInfluences, context);
			bool flag = value != null;
			if (flag)
			{
				int contentSize = value.GetSerializedSize();
				byte* pData = OperationAdder.DynamicSingleValueCollection_Add<short>(5, 19, elementId, contentSize);
				pData += value.Serialize(pData);
			}
			else
			{
				OperationAdder.DynamicSingleValueCollection_Add<short>(5, 19, elementId, 0);
			}
		}

		// Token: 0x060012BB RID: 4795 RVA: 0x00126434 File Offset: 0x00124634
		private unsafe void SetElement_SkillBreakPlateObsoleteDict(short elementId, SkillBreakPlateObsolete value, DataContext context)
		{
			this._skillBreakPlateObsoleteDict[elementId] = value;
			this._modificationsSkillBreakPlateObsoleteDict.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(19, this.DataStates, TaiwuDomain.CacheInfluences, context);
			bool flag = value != null;
			if (flag)
			{
				int contentSize = value.GetSerializedSize();
				byte* pData = OperationAdder.DynamicSingleValueCollection_Set<short>(5, 19, elementId, contentSize);
				pData += value.Serialize(pData);
			}
			else
			{
				OperationAdder.DynamicSingleValueCollection_Set<short>(5, 19, elementId, 0);
			}
		}

		// Token: 0x060012BC RID: 4796 RVA: 0x001264A4 File Offset: 0x001246A4
		private void RemoveElement_SkillBreakPlateObsoleteDict(short elementId, DataContext context)
		{
			this._skillBreakPlateObsoleteDict.Remove(elementId);
			this._modificationsSkillBreakPlateObsoleteDict.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(19, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Remove<short>(5, 19, elementId);
		}

		// Token: 0x060012BD RID: 4797 RVA: 0x001264DF File Offset: 0x001246DF
		private void ClearSkillBreakPlateObsoleteDict(DataContext context)
		{
			this._skillBreakPlateObsoleteDict.Clear();
			this._modificationsSkillBreakPlateObsoleteDict.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(19, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Clear(5, 19);
		}

		// Token: 0x060012BE RID: 4798 RVA: 0x00126518 File Offset: 0x00124718
		private SkillBreakBonusCollection GetElement_SkillBreakBonusDict(short elementId)
		{
			return this._skillBreakBonusDict[elementId];
		}

		// Token: 0x060012BF RID: 4799 RVA: 0x00126538 File Offset: 0x00124738
		private bool TryGetElement_SkillBreakBonusDict(short elementId, out SkillBreakBonusCollection value)
		{
			return this._skillBreakBonusDict.TryGetValue(elementId, out value);
		}

		// Token: 0x060012C0 RID: 4800 RVA: 0x00126558 File Offset: 0x00124758
		private unsafe void AddElement_SkillBreakBonusDict(short elementId, SkillBreakBonusCollection value, DataContext context)
		{
			this._skillBreakBonusDict.Add(elementId, value);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(20, this.DataStates, TaiwuDomain.CacheInfluences, context);
			bool flag = value != null;
			if (flag)
			{
				int contentSize = value.GetSerializedSize();
				byte* pData = OperationAdder.DynamicSingleValueCollection_Add<short>(5, 20, elementId, contentSize);
				pData += value.Serialize(pData);
			}
			else
			{
				OperationAdder.DynamicSingleValueCollection_Add<short>(5, 20, elementId, 0);
			}
		}

		// Token: 0x060012C1 RID: 4801 RVA: 0x001265BC File Offset: 0x001247BC
		private unsafe void SetElement_SkillBreakBonusDict(short elementId, SkillBreakBonusCollection value, DataContext context)
		{
			this._skillBreakBonusDict[elementId] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(20, this.DataStates, TaiwuDomain.CacheInfluences, context);
			bool flag = value != null;
			if (flag)
			{
				int contentSize = value.GetSerializedSize();
				byte* pData = OperationAdder.DynamicSingleValueCollection_Set<short>(5, 20, elementId, contentSize);
				pData += value.Serialize(pData);
			}
			else
			{
				OperationAdder.DynamicSingleValueCollection_Set<short>(5, 20, elementId, 0);
			}
		}

		// Token: 0x060012C2 RID: 4802 RVA: 0x0012661F File Offset: 0x0012481F
		private void RemoveElement_SkillBreakBonusDict(short elementId, DataContext context)
		{
			this._skillBreakBonusDict.Remove(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(20, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Remove<short>(5, 20, elementId);
		}

		// Token: 0x060012C3 RID: 4803 RVA: 0x0012664D File Offset: 0x0012484D
		private void ClearSkillBreakBonusDict(DataContext context)
		{
			this._skillBreakBonusDict.Clear();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(20, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Clear(5, 20);
		}

		// Token: 0x060012C4 RID: 4804 RVA: 0x0012667C File Offset: 0x0012487C
		public GameData.Utilities.ShortList GetElement_TeachTaiwuLifeSkillDict(int elementId)
		{
			return this._teachTaiwuLifeSkillDict[elementId];
		}

		// Token: 0x060012C5 RID: 4805 RVA: 0x0012669C File Offset: 0x0012489C
		public bool TryGetElement_TeachTaiwuLifeSkillDict(int elementId, out GameData.Utilities.ShortList value)
		{
			return this._teachTaiwuLifeSkillDict.TryGetValue(elementId, out value);
		}

		// Token: 0x060012C6 RID: 4806 RVA: 0x001266BC File Offset: 0x001248BC
		private unsafe void AddElement_TeachTaiwuLifeSkillDict(int elementId, GameData.Utilities.ShortList value, DataContext context)
		{
			this._teachTaiwuLifeSkillDict.Add(elementId, value);
			this._modificationsTeachTaiwuLifeSkillDict.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(21, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int dataSize = value.GetSerializedSize();
			byte* pData = OperationAdder.DynamicSingleValueCollection_Add<int>(5, 21, elementId, dataSize);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012C7 RID: 4807 RVA: 0x00126718 File Offset: 0x00124918
		private unsafe void SetElement_TeachTaiwuLifeSkillDict(int elementId, GameData.Utilities.ShortList value, DataContext context)
		{
			this._teachTaiwuLifeSkillDict[elementId] = value;
			this._modificationsTeachTaiwuLifeSkillDict.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(21, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int dataSize = value.GetSerializedSize();
			byte* pData = OperationAdder.DynamicSingleValueCollection_Set<int>(5, 21, elementId, dataSize);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012C8 RID: 4808 RVA: 0x00126773 File Offset: 0x00124973
		private void RemoveElement_TeachTaiwuLifeSkillDict(int elementId, DataContext context)
		{
			this._teachTaiwuLifeSkillDict.Remove(elementId);
			this._modificationsTeachTaiwuLifeSkillDict.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(21, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Remove<int>(5, 21, elementId);
		}

		// Token: 0x060012C9 RID: 4809 RVA: 0x001267AE File Offset: 0x001249AE
		private void ClearTeachTaiwuLifeSkillDict(DataContext context)
		{
			this._teachTaiwuLifeSkillDict.Clear();
			this._modificationsTeachTaiwuLifeSkillDict.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(21, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Clear(5, 21);
		}

		// Token: 0x060012CA RID: 4810 RVA: 0x001267E8 File Offset: 0x001249E8
		public GameData.Utilities.ShortList GetElement_TeachTaiwuCombatSkillDict(int elementId)
		{
			return this._teachTaiwuCombatSkillDict[elementId];
		}

		// Token: 0x060012CB RID: 4811 RVA: 0x00126808 File Offset: 0x00124A08
		public bool TryGetElement_TeachTaiwuCombatSkillDict(int elementId, out GameData.Utilities.ShortList value)
		{
			return this._teachTaiwuCombatSkillDict.TryGetValue(elementId, out value);
		}

		// Token: 0x060012CC RID: 4812 RVA: 0x00126828 File Offset: 0x00124A28
		private unsafe void AddElement_TeachTaiwuCombatSkillDict(int elementId, GameData.Utilities.ShortList value, DataContext context)
		{
			this._teachTaiwuCombatSkillDict.Add(elementId, value);
			this._modificationsTeachTaiwuCombatSkillDict.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(22, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int dataSize = value.GetSerializedSize();
			byte* pData = OperationAdder.DynamicSingleValueCollection_Add<int>(5, 22, elementId, dataSize);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012CD RID: 4813 RVA: 0x00126884 File Offset: 0x00124A84
		private unsafe void SetElement_TeachTaiwuCombatSkillDict(int elementId, GameData.Utilities.ShortList value, DataContext context)
		{
			this._teachTaiwuCombatSkillDict[elementId] = value;
			this._modificationsTeachTaiwuCombatSkillDict.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(22, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int dataSize = value.GetSerializedSize();
			byte* pData = OperationAdder.DynamicSingleValueCollection_Set<int>(5, 22, elementId, dataSize);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012CE RID: 4814 RVA: 0x001268DF File Offset: 0x00124ADF
		private void RemoveElement_TeachTaiwuCombatSkillDict(int elementId, DataContext context)
		{
			this._teachTaiwuCombatSkillDict.Remove(elementId);
			this._modificationsTeachTaiwuCombatSkillDict.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(22, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Remove<int>(5, 22, elementId);
		}

		// Token: 0x060012CF RID: 4815 RVA: 0x0012691A File Offset: 0x00124B1A
		private void ClearTeachTaiwuCombatSkillDict(DataContext context)
		{
			this._teachTaiwuCombatSkillDict.Clear();
			this._modificationsTeachTaiwuCombatSkillDict.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(22, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.DynamicSingleValueCollection_Clear(5, 22);
		}

		// Token: 0x060012D0 RID: 4816 RVA: 0x00126954 File Offset: 0x00124B54
		public short[] GetCombatSkillAttainmentPanelPlans()
		{
			return this._combatSkillAttainmentPanelPlans;
		}

		// Token: 0x060012D1 RID: 4817 RVA: 0x0012696C File Offset: 0x00124B6C
		private unsafe void SetCombatSkillAttainmentPanelPlans(short[] value, DataContext context)
		{
			this._combatSkillAttainmentPanelPlans = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(23, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 23, 1260);
			for (int i = 0; i < 630; i++)
			{
				*(short*)(pData + (IntPtr)i * 2) = this._combatSkillAttainmentPanelPlans[i];
			}
			pData += 1260;
		}

		// Token: 0x060012D2 RID: 4818 RVA: 0x001269D0 File Offset: 0x00124BD0
		public sbyte[] GetCurrCombatSkillAttainmentPanelPlanIds()
		{
			return this._currCombatSkillAttainmentPanelPlanIds;
		}

		// Token: 0x060012D3 RID: 4819 RVA: 0x001269E8 File Offset: 0x00124BE8
		private unsafe void SetCurrCombatSkillAttainmentPanelPlanIds(sbyte[] value, DataContext context)
		{
			this._currCombatSkillAttainmentPanelPlanIds = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(24, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 24, 14);
			for (int i = 0; i < 14; i++)
			{
				pData[i] = (byte)this._currCombatSkillAttainmentPanelPlanIds[i];
			}
			pData += 14;
		}

		// Token: 0x060012D4 RID: 4820 RVA: 0x00126A40 File Offset: 0x00124C40
		public int GetMoveTimeCostPercent()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 25);
			int moveTimeCostPercent;
			if (flag)
			{
				moveTimeCostPercent = this._moveTimeCostPercent;
			}
			else
			{
				int value = this.CalcMoveTimeCostPercent();
				bool lockTaken = false;
				try
				{
					this._spinLockMoveTimeCostPercent.Enter(ref lockTaken);
					this._moveTimeCostPercent = value;
					BaseGameDataDomain.SetCached(this.DataStates, 25);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockMoveTimeCostPercent.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				moveTimeCostPercent = this._moveTimeCostPercent;
			}
			return moveTimeCostPercent;
		}

		// Token: 0x060012D5 RID: 4821 RVA: 0x00126AD8 File Offset: 0x00124CD8
		public sbyte[] GetWeaponInnerRatios()
		{
			return this._weaponInnerRatios;
		}

		// Token: 0x060012D6 RID: 4822 RVA: 0x00126AF0 File Offset: 0x00124CF0
		public unsafe void SetWeaponInnerRatios(sbyte[] value, DataContext context)
		{
			this._weaponInnerRatios = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(26, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 26, 6);
			for (int i = 0; i < 6; i++)
			{
				pData[i] = (byte)this._weaponInnerRatios[i];
			}
			pData += 6;
		}

		// Token: 0x060012D7 RID: 4823 RVA: 0x00126B44 File Offset: 0x00124D44
		public sbyte[] GetWeaponCurrInnerRatios()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 27);
			sbyte[] weaponCurrInnerRatios;
			if (flag)
			{
				weaponCurrInnerRatios = this._weaponCurrInnerRatios;
			}
			else
			{
				sbyte[] value = new sbyte[7];
				this.CalcWeaponCurrInnerRatios(value);
				bool lockTaken = false;
				try
				{
					this._spinLockWeaponCurrInnerRatios.Enter(ref lockTaken);
					for (int i = 0; i < 7; i++)
					{
						this._weaponCurrInnerRatios[i] = value[i];
					}
					BaseGameDataDomain.SetCached(this.DataStates, 27);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockWeaponCurrInnerRatios.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				weaponCurrInnerRatios = this._weaponCurrInnerRatios;
			}
			return weaponCurrInnerRatios;
		}

		// Token: 0x060012D8 RID: 4824 RVA: 0x00126C00 File Offset: 0x00124E00
		public short GetElement_Appointments(int elementId)
		{
			return this._appointments[elementId];
		}

		// Token: 0x060012D9 RID: 4825 RVA: 0x00126C20 File Offset: 0x00124E20
		public bool TryGetElement_Appointments(int elementId, out short value)
		{
			return this._appointments.TryGetValue(elementId, out value);
		}

		// Token: 0x060012DA RID: 4826 RVA: 0x00126C40 File Offset: 0x00124E40
		private unsafe void AddElement_Appointments(int elementId, short value, DataContext context)
		{
			this._appointments.Add(elementId, value);
			this._modificationsAppointments.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(28, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<int>(5, 28, elementId, 2);
			*(short*)pData = value;
			pData += 2;
		}

		// Token: 0x060012DB RID: 4827 RVA: 0x00126C90 File Offset: 0x00124E90
		private unsafe void SetElement_Appointments(int elementId, short value, DataContext context)
		{
			this._appointments[elementId] = value;
			this._modificationsAppointments.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(28, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<int>(5, 28, elementId, 2);
			*(short*)pData = value;
			pData += 2;
		}

		// Token: 0x060012DC RID: 4828 RVA: 0x00126CDF File Offset: 0x00124EDF
		private void RemoveElement_Appointments(int elementId, DataContext context)
		{
			this._appointments.Remove(elementId);
			this._modificationsAppointments.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(28, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<int>(5, 28, elementId);
		}

		// Token: 0x060012DD RID: 4829 RVA: 0x00126D1A File Offset: 0x00124F1A
		private void ClearAppointments(DataContext context)
		{
			this._appointments.Clear();
			this._modificationsAppointments.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(28, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 28);
		}

		// Token: 0x060012DE RID: 4830 RVA: 0x00126D54 File Offset: 0x00124F54
		private short GetBabyBonusMainAttributes()
		{
			return this._babyBonusMainAttributes;
		}

		// Token: 0x060012DF RID: 4831 RVA: 0x00126D6C File Offset: 0x00124F6C
		private unsafe void SetBabyBonusMainAttributes(short value, DataContext context)
		{
			this._babyBonusMainAttributes = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(29, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 29, 2);
			*(short*)pData = this._babyBonusMainAttributes;
			pData += 2;
		}

		// Token: 0x060012E0 RID: 4832 RVA: 0x00126DAC File Offset: 0x00124FAC
		private short GetBabyBonusLifeSkillQualifications()
		{
			return this._babyBonusLifeSkillQualifications;
		}

		// Token: 0x060012E1 RID: 4833 RVA: 0x00126DC4 File Offset: 0x00124FC4
		private unsafe void SetBabyBonusLifeSkillQualifications(short value, DataContext context)
		{
			this._babyBonusLifeSkillQualifications = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(30, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 30, 2);
			*(short*)pData = this._babyBonusLifeSkillQualifications;
			pData += 2;
		}

		// Token: 0x060012E2 RID: 4834 RVA: 0x00126E04 File Offset: 0x00125004
		private short GetBabyBonusCombatSkillQualifications()
		{
			return this._babyBonusCombatSkillQualifications;
		}

		// Token: 0x060012E3 RID: 4835 RVA: 0x00126E1C File Offset: 0x0012501C
		private unsafe void SetBabyBonusCombatSkillQualifications(short value, DataContext context)
		{
			this._babyBonusCombatSkillQualifications = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(31, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 31, 2);
			*(short*)pData = this._babyBonusCombatSkillQualifications;
			pData += 2;
		}

		// Token: 0x060012E4 RID: 4836 RVA: 0x00126E5C File Offset: 0x0012505C
		private EquipmentPlan GetElement_EquipmentsPlans(int index)
		{
			return this._equipmentsPlans[index];
		}

		// Token: 0x060012E5 RID: 4837 RVA: 0x00126E78 File Offset: 0x00125078
		private unsafe void SetElement_EquipmentsPlans(int index, EquipmentPlan value, DataContext context)
		{
			this._equipmentsPlans[index] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(index, this._dataStatesEquipmentsPlans, TaiwuDomain.CacheInfluencesEquipmentsPlans, context);
			byte* pData = OperationAdder.FixedElementList_Set(5, 32, index, 99);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012E6 RID: 4838 RVA: 0x00126EB8 File Offset: 0x001250B8
		public int GetCurrEquipmentPlanId()
		{
			return this._currEquipmentPlanId;
		}

		// Token: 0x060012E7 RID: 4839 RVA: 0x00126ED0 File Offset: 0x001250D0
		private unsafe void SetCurrEquipmentPlanId(int value, DataContext context)
		{
			this._currEquipmentPlanId = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(33, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 33, 4);
			*(int*)pData = this._currEquipmentPlanId;
			pData += 4;
		}

		// Token: 0x060012E8 RID: 4840 RVA: 0x00126F10 File Offset: 0x00125110
		public CharacterSet GetGroupCharIds()
		{
			return this._groupCharIds;
		}

		// Token: 0x060012E9 RID: 4841 RVA: 0x00126F28 File Offset: 0x00125128
		private unsafe void SetGroupCharIds(CharacterSet value, DataContext context)
		{
			this._groupCharIds = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(34, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int dataSize = this._groupCharIds.GetSerializedSize();
			byte* pData = OperationAdder.DynamicSingleValue_Set(5, 34, dataSize);
			pData += this._groupCharIds.Serialize(pData);
		}

		// Token: 0x060012EA RID: 4842 RVA: 0x00126F78 File Offset: 0x00125178
		public int GetElement_CombatGroupCharIds(int index)
		{
			return this._combatGroupCharIds[index];
		}

		// Token: 0x060012EB RID: 4843 RVA: 0x00126F94 File Offset: 0x00125194
		public unsafe void SetElement_CombatGroupCharIds(int index, int value, DataContext context)
		{
			this._combatGroupCharIds[index] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(index, this._dataStatesCombatGroupCharIds, TaiwuDomain.CacheInfluencesCombatGroupCharIds, context);
			byte* pData = OperationAdder.FixedElementList_Set(5, 35, index, 4);
			*(int*)pData = value;
			pData += 4;
		}

		// Token: 0x060012EC RID: 4844 RVA: 0x00126FD0 File Offset: 0x001251D0
		public int GetTaiwuGroupMaxCount()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 36);
			int taiwuGroupMaxCount;
			if (flag)
			{
				taiwuGroupMaxCount = this._taiwuGroupMaxCount;
			}
			else
			{
				int value = this.CalcTaiwuGroupMaxCount();
				bool lockTaken = false;
				try
				{
					this._spinLockTaiwuGroupMaxCount.Enter(ref lockTaken);
					this._taiwuGroupMaxCount = value;
					BaseGameDataDomain.SetCached(this.DataStates, 36);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTaiwuGroupMaxCount.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				taiwuGroupMaxCount = this._taiwuGroupMaxCount;
			}
			return taiwuGroupMaxCount;
		}

		// Token: 0x060012ED RID: 4845 RVA: 0x00127068 File Offset: 0x00125268
		public short GetElement_LegacyPointDict(short elementId)
		{
			return this._legacyPointDict[elementId];
		}

		// Token: 0x060012EE RID: 4846 RVA: 0x00127088 File Offset: 0x00125288
		public bool TryGetElement_LegacyPointDict(short elementId, out short value)
		{
			return this._legacyPointDict.TryGetValue(elementId, out value);
		}

		// Token: 0x060012EF RID: 4847 RVA: 0x001270A8 File Offset: 0x001252A8
		private unsafe void AddElement_LegacyPointDict(short elementId, short value, DataContext context)
		{
			this._legacyPointDict.Add(elementId, value);
			this._modificationsLegacyPointDict.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(37, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<short>(5, 37, elementId, 2);
			*(short*)pData = value;
			pData += 2;
		}

		// Token: 0x060012F0 RID: 4848 RVA: 0x001270F8 File Offset: 0x001252F8
		private unsafe void SetElement_LegacyPointDict(short elementId, short value, DataContext context)
		{
			this._legacyPointDict[elementId] = value;
			this._modificationsLegacyPointDict.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(37, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<short>(5, 37, elementId, 2);
			*(short*)pData = value;
			pData += 2;
		}

		// Token: 0x060012F1 RID: 4849 RVA: 0x00127147 File Offset: 0x00125347
		private void RemoveElement_LegacyPointDict(short elementId, DataContext context)
		{
			this._legacyPointDict.Remove(elementId);
			this._modificationsLegacyPointDict.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(37, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<short>(5, 37, elementId);
		}

		// Token: 0x060012F2 RID: 4850 RVA: 0x00127182 File Offset: 0x00125382
		private void ClearLegacyPointDict(DataContext context)
		{
			this._legacyPointDict.Clear();
			this._modificationsLegacyPointDict.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(37, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 37);
		}

		// Token: 0x060012F3 RID: 4851 RVA: 0x001271BC File Offset: 0x001253BC
		public int GetLegacyPoint()
		{
			return this._legacyPoint;
		}

		// Token: 0x060012F4 RID: 4852 RVA: 0x001271D4 File Offset: 0x001253D4
		public unsafe void SetLegacyPoint(int value, DataContext context)
		{
			this._legacyPoint = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(38, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 38, 4);
			*(int*)pData = this._legacyPoint;
			pData += 4;
		}

		// Token: 0x060012F5 RID: 4853 RVA: 0x00127214 File Offset: 0x00125414
		public List<short> GetAvailableLegacyList()
		{
			return this._availableLegacyList;
		}

		// Token: 0x060012F6 RID: 4854 RVA: 0x0012722C File Offset: 0x0012542C
		public unsafe void SetAvailableLegacyList(List<short> value, DataContext context)
		{
			this._availableLegacyList = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(39, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int elementsCount = this._availableLegacyList.Count;
			int contentSize = 2 * elementsCount;
			int dataSize = 2 + contentSize;
			byte* pData = OperationAdder.DynamicSingleValue_Set(5, 39, dataSize);
			*(short*)pData = (short)((ushort)elementsCount);
			pData += 2;
			for (int i = 0; i < elementsCount; i++)
			{
				*(short*)(pData + (IntPtr)i * 2) = this._availableLegacyList[i];
			}
			pData += contentSize;
		}

		// Token: 0x060012F7 RID: 4855 RVA: 0x001272AC File Offset: 0x001254AC
		public sbyte GetLegacyPassingState()
		{
			return this._legacyPassingState;
		}

		// Token: 0x060012F8 RID: 4856 RVA: 0x001272C4 File Offset: 0x001254C4
		private void SetLegacyPassingState(sbyte value, DataContext context)
		{
			this._legacyPassingState = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(40, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x060012F9 RID: 4857 RVA: 0x001272E4 File Offset: 0x001254E4
		public List<int> GetSuccessorCandidates()
		{
			return this._successorCandidates;
		}

		// Token: 0x060012FA RID: 4858 RVA: 0x001272FC File Offset: 0x001254FC
		private void SetSuccessorCandidates(List<int> value, DataContext context)
		{
			this._successorCandidates = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(41, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x060012FB RID: 4859 RVA: 0x0012731C File Offset: 0x0012551C
		public SByteList GetElement_StateNewCharacterLegacyGrowingGrades(int index)
		{
			return this._stateNewCharacterLegacyGrowingGrades[index];
		}

		// Token: 0x060012FC RID: 4860 RVA: 0x0012733C File Offset: 0x0012553C
		public unsafe void SetElement_StateNewCharacterLegacyGrowingGrades(int index, SByteList value, DataContext context)
		{
			this._stateNewCharacterLegacyGrowingGrades[index] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(index, this._dataStatesStateNewCharacterLegacyGrowingGrades, TaiwuDomain.CacheInfluencesStateNewCharacterLegacyGrowingGrades, context);
			int dataSize = value.GetSerializedSize();
			byte* pData = OperationAdder.DynamicElementList_Set(5, 42, index, dataSize);
			pData += value.Serialize(pData);
		}

		// Token: 0x060012FD RID: 4861 RVA: 0x00127388 File Offset: 0x00125588
		public TaiwuCombatSkill GetElement_NotLearnCombatSkillReadingProgress(short elementId)
		{
			return this._notLearnCombatSkillReadingProgress[elementId];
		}

		// Token: 0x060012FE RID: 4862 RVA: 0x001273A8 File Offset: 0x001255A8
		public bool TryGetElement_NotLearnCombatSkillReadingProgress(short elementId, out TaiwuCombatSkill value)
		{
			return this._notLearnCombatSkillReadingProgress.TryGetValue(elementId, out value);
		}

		// Token: 0x060012FF RID: 4863 RVA: 0x001273C8 File Offset: 0x001255C8
		private unsafe void AddElement_NotLearnCombatSkillReadingProgress(short elementId, TaiwuCombatSkill value, DataContext context)
		{
			this._notLearnCombatSkillReadingProgress.Add(elementId, value);
			this._modificationsNotLearnCombatSkillReadingProgress.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(43, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<short>(5, 43, elementId, 20);
			pData += value.Serialize(pData);
		}

		// Token: 0x06001300 RID: 4864 RVA: 0x0012741C File Offset: 0x0012561C
		private unsafe void SetElement_NotLearnCombatSkillReadingProgress(short elementId, TaiwuCombatSkill value, DataContext context)
		{
			this._notLearnCombatSkillReadingProgress[elementId] = value;
			this._modificationsNotLearnCombatSkillReadingProgress.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(43, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<short>(5, 43, elementId, 20);
			pData += value.Serialize(pData);
		}

		// Token: 0x06001301 RID: 4865 RVA: 0x0012746F File Offset: 0x0012566F
		private void RemoveElement_NotLearnCombatSkillReadingProgress(short elementId, DataContext context)
		{
			this._notLearnCombatSkillReadingProgress.Remove(elementId);
			this._modificationsNotLearnCombatSkillReadingProgress.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(43, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<short>(5, 43, elementId);
		}

		// Token: 0x06001302 RID: 4866 RVA: 0x001274AA File Offset: 0x001256AA
		private void ClearNotLearnCombatSkillReadingProgress(DataContext context)
		{
			this._notLearnCombatSkillReadingProgress.Clear();
			this._modificationsNotLearnCombatSkillReadingProgress.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(43, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 43);
		}

		// Token: 0x06001303 RID: 4867 RVA: 0x001274E4 File Offset: 0x001256E4
		public TaiwuLifeSkill GetElement_NotLearnLifeSkillReadingProgress(short elementId)
		{
			return this._notLearnLifeSkillReadingProgress[elementId];
		}

		// Token: 0x06001304 RID: 4868 RVA: 0x00127504 File Offset: 0x00125704
		public bool TryGetElement_NotLearnLifeSkillReadingProgress(short elementId, out TaiwuLifeSkill value)
		{
			return this._notLearnLifeSkillReadingProgress.TryGetValue(elementId, out value);
		}

		// Token: 0x06001305 RID: 4869 RVA: 0x00127524 File Offset: 0x00125724
		private unsafe void AddElement_NotLearnLifeSkillReadingProgress(short elementId, TaiwuLifeSkill value, DataContext context)
		{
			this._notLearnLifeSkillReadingProgress.Add(elementId, value);
			this._modificationsNotLearnLifeSkillReadingProgress.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(44, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<short>(5, 44, elementId, 5);
			pData += value.Serialize(pData);
		}

		// Token: 0x06001306 RID: 4870 RVA: 0x00127578 File Offset: 0x00125778
		private unsafe void SetElement_NotLearnLifeSkillReadingProgress(short elementId, TaiwuLifeSkill value, DataContext context)
		{
			this._notLearnLifeSkillReadingProgress[elementId] = value;
			this._modificationsNotLearnLifeSkillReadingProgress.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(44, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<short>(5, 44, elementId, 5);
			pData += value.Serialize(pData);
		}

		// Token: 0x06001307 RID: 4871 RVA: 0x001275CA File Offset: 0x001257CA
		private void RemoveElement_NotLearnLifeSkillReadingProgress(short elementId, DataContext context)
		{
			this._notLearnLifeSkillReadingProgress.Remove(elementId);
			this._modificationsNotLearnLifeSkillReadingProgress.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(44, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<short>(5, 44, elementId);
		}

		// Token: 0x06001308 RID: 4872 RVA: 0x00127605 File Offset: 0x00125805
		private void ClearNotLearnLifeSkillReadingProgress(DataContext context)
		{
			this._notLearnLifeSkillReadingProgress.Clear();
			this._modificationsNotLearnLifeSkillReadingProgress.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(44, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 44);
		}

		// Token: 0x06001309 RID: 4873 RVA: 0x00127640 File Offset: 0x00125840
		private ReadingBookStrategies GetElement_ReadingBooks(ItemKey elementId)
		{
			return this._readingBooks[elementId];
		}

		// Token: 0x0600130A RID: 4874 RVA: 0x00127660 File Offset: 0x00125860
		private bool TryGetElement_ReadingBooks(ItemKey elementId, out ReadingBookStrategies value)
		{
			return this._readingBooks.TryGetValue(elementId, out value);
		}

		// Token: 0x0600130B RID: 4875 RVA: 0x00127680 File Offset: 0x00125880
		private unsafe void AddElement_ReadingBooks(ItemKey elementId, ref ReadingBookStrategies value, DataContext context)
		{
			this._readingBooks.Add(elementId, value);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(45, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<ItemKey>(5, 45, elementId, 36);
			pData += value.Serialize(pData);
		}

		// Token: 0x0600130C RID: 4876 RVA: 0x001276CC File Offset: 0x001258CC
		private unsafe void SetElement_ReadingBooks(ItemKey elementId, ref ReadingBookStrategies value, DataContext context)
		{
			this._readingBooks[elementId] = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(45, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<ItemKey>(5, 45, elementId, 36);
			pData += value.Serialize(pData);
		}

		// Token: 0x0600130D RID: 4877 RVA: 0x00127717 File Offset: 0x00125917
		private void RemoveElement_ReadingBooks(ItemKey elementId, DataContext context)
		{
			this._readingBooks.Remove(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(45, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<ItemKey>(5, 45, elementId);
		}

		// Token: 0x0600130E RID: 4878 RVA: 0x00127745 File Offset: 0x00125945
		private void ClearReadingBooks(DataContext context)
		{
			this._readingBooks.Clear();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(45, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 45);
		}

		// Token: 0x0600130F RID: 4879 RVA: 0x00127774 File Offset: 0x00125974
		public ItemKey GetCurReadingBook()
		{
			return this._curReadingBook;
		}

		// Token: 0x06001310 RID: 4880 RVA: 0x0012778C File Offset: 0x0012598C
		private unsafe void SetCurReadingBook(ItemKey value, DataContext context)
		{
			this._curReadingBook = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(46, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 46, 8);
			pData += this._curReadingBook.Serialize(pData);
		}

		// Token: 0x06001311 RID: 4881 RVA: 0x001277D0 File Offset: 0x001259D0
		public ItemKey[] GetReferenceBooks()
		{
			return this._referenceBooks;
		}

		// Token: 0x06001312 RID: 4882 RVA: 0x001277E8 File Offset: 0x001259E8
		private unsafe void SetReferenceBooks(ItemKey[] value, DataContext context)
		{
			this._referenceBooks = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(47, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 47, 24);
			for (int i = 0; i < 3; i++)
			{
				pData += this._referenceBooks[i].Serialize(pData);
			}
		}

		// Token: 0x06001313 RID: 4883 RVA: 0x00127844 File Offset: 0x00125A44
		public byte GetReferenceBookSlotUnlockStates()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 48);
			byte referenceBookSlotUnlockStates;
			if (flag)
			{
				referenceBookSlotUnlockStates = this._referenceBookSlotUnlockStates;
			}
			else
			{
				byte value = this.CalcReferenceBookSlotUnlockStates();
				bool lockTaken = false;
				try
				{
					this._spinLockReferenceBookSlotUnlockStates.Enter(ref lockTaken);
					this._referenceBookSlotUnlockStates = value;
					BaseGameDataDomain.SetCached(this.DataStates, 48);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockReferenceBookSlotUnlockStates.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				referenceBookSlotUnlockStates = this._referenceBookSlotUnlockStates;
			}
			return referenceBookSlotUnlockStates;
		}

		// Token: 0x06001314 RID: 4884 RVA: 0x001278DC File Offset: 0x00125ADC
		[Obsolete("DomainData _readingEventTriggered is no longer in use.")]
		public bool GetReadingEventTriggered()
		{
			return this._readingEventTriggered;
		}

		// Token: 0x06001315 RID: 4885 RVA: 0x001278F4 File Offset: 0x00125AF4
		[Obsolete("DomainData _readingEventTriggered is no longer in use.")]
		public unsafe void SetReadingEventTriggered(bool value, DataContext context)
		{
			this._readingEventTriggered = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(49, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 49, 1);
			*pData = (this._readingEventTriggered ? 1 : 0);
			pData++;
		}

		// Token: 0x06001316 RID: 4886 RVA: 0x00127934 File Offset: 0x00125B34
		public sbyte GetReadInCombatCount()
		{
			return this._readInCombatCount;
		}

		// Token: 0x06001317 RID: 4887 RVA: 0x0012794C File Offset: 0x00125B4C
		public unsafe void SetReadInCombatCount(sbyte value, DataContext context)
		{
			this._readInCombatCount = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(50, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 50, 1);
			*pData = (byte)this._readInCombatCount;
			pData++;
		}

		// Token: 0x06001318 RID: 4888 RVA: 0x0012798C File Offset: 0x00125B8C
		public bool GetHealingOuterInjuryRestriction()
		{
			return this._healingOuterInjuryRestriction;
		}

		// Token: 0x06001319 RID: 4889 RVA: 0x001279A4 File Offset: 0x00125BA4
		public void SetHealingOuterInjuryRestriction(bool value, DataContext context)
		{
			this._healingOuterInjuryRestriction = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(51, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600131A RID: 4890 RVA: 0x001279C4 File Offset: 0x00125BC4
		public bool GetHealingInnerInjuryRestriction()
		{
			return this._healingInnerInjuryRestriction;
		}

		// Token: 0x0600131B RID: 4891 RVA: 0x001279DC File Offset: 0x00125BDC
		public void SetHealingInnerInjuryRestriction(bool value, DataContext context)
		{
			this._healingInnerInjuryRestriction = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(52, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600131C RID: 4892 RVA: 0x001279FC File Offset: 0x00125BFC
		public byte GetNeiliAllocationTypeRestriction()
		{
			return this._neiliAllocationTypeRestriction;
		}

		// Token: 0x0600131D RID: 4893 RVA: 0x00127A14 File Offset: 0x00125C14
		private void SetNeiliAllocationTypeRestriction(byte value, DataContext context)
		{
			this._neiliAllocationTypeRestriction = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(53, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600131E RID: 4894 RVA: 0x00127A34 File Offset: 0x00125C34
		public List<short> GetVisitedSettlements()
		{
			return this._visitedSettlements;
		}

		// Token: 0x0600131F RID: 4895 RVA: 0x00127A4C File Offset: 0x00125C4C
		public unsafe void SetVisitedSettlements(List<short> value, DataContext context)
		{
			this._visitedSettlements = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(54, this.DataStates, TaiwuDomain.CacheInfluences, context);
			int elementsCount = this._visitedSettlements.Count;
			int contentSize = 2 * elementsCount;
			int dataSize = 2 + contentSize;
			byte* pData = OperationAdder.DynamicSingleValue_Set(5, 54, dataSize);
			*(short*)pData = (short)((ushort)elementsCount);
			pData += 2;
			for (int i = 0; i < elementsCount; i++)
			{
				*(short*)(pData + (IntPtr)i * 2) = this._visitedSettlements[i];
			}
			pData += contentSize;
		}

		// Token: 0x06001320 RID: 4896 RVA: 0x00127ACC File Offset: 0x00125CCC
		public short GetTaiwuVillageSettlementId()
		{
			return this._taiwuVillageSettlementId;
		}

		// Token: 0x06001321 RID: 4897 RVA: 0x00127AE4 File Offset: 0x00125CE4
		public unsafe void SetTaiwuVillageSettlementId(short value, DataContext context)
		{
			this._taiwuVillageSettlementId = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(55, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 55, 2);
			*(short*)pData = this._taiwuVillageSettlementId;
			pData += 2;
		}

		// Token: 0x06001322 RID: 4898 RVA: 0x00127B24 File Offset: 0x00125D24
		public VillagerWorkData GetElement_VillagerWork(int elementId)
		{
			return this._villagerWork[elementId];
		}

		// Token: 0x06001323 RID: 4899 RVA: 0x00127B44 File Offset: 0x00125D44
		public bool TryGetElement_VillagerWork(int elementId, out VillagerWorkData value)
		{
			return this._villagerWork.TryGetValue(elementId, out value);
		}

		// Token: 0x06001324 RID: 4900 RVA: 0x00127B64 File Offset: 0x00125D64
		private unsafe void AddElement_VillagerWork(int elementId, VillagerWorkData value, DataContext context)
		{
			this._villagerWork.Add(elementId, value);
			this._modificationsVillagerWork.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(56, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Add<int>(5, 56, elementId, 20);
			pData += value.Serialize(pData);
		}

		// Token: 0x06001325 RID: 4901 RVA: 0x00127BB8 File Offset: 0x00125DB8
		private unsafe void SetElement_VillagerWork(int elementId, VillagerWorkData value, DataContext context)
		{
			this._villagerWork[elementId] = value;
			this._modificationsVillagerWork.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(56, this.DataStates, TaiwuDomain.CacheInfluences, context);
			byte* pData = OperationAdder.FixedSingleValueCollection_Set<int>(5, 56, elementId, 20);
			pData += value.Serialize(pData);
		}

		// Token: 0x06001326 RID: 4902 RVA: 0x00127C0B File Offset: 0x00125E0B
		private void RemoveElement_VillagerWork(int elementId, DataContext context)
		{
			this._villagerWork.Remove(elementId);
			this._modificationsVillagerWork.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(56, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Remove<int>(5, 56, elementId);
		}

		// Token: 0x06001327 RID: 4903 RVA: 0x00127C46 File Offset: 0x00125E46
		private void ClearVillagerWork(DataContext context)
		{
			this._villagerWork.Clear();
			this._modificationsVillagerWork.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(56, this.DataStates, TaiwuDomain.CacheInfluences, context);
			OperationAdder.FixedSingleValueCollection_Clear(5, 56);
		}

		// Token: 0x06001328 RID: 4904 RVA: 0x00127C80 File Offset: 0x00125E80
		public VoidValue GetElement_VillagerWorkLocations(Location elementId)
		{
			return this._villagerWorkLocations[elementId];
		}

		// Token: 0x06001329 RID: 4905 RVA: 0x00127CA0 File Offset: 0x00125EA0
		public bool TryGetElement_VillagerWorkLocations(Location elementId, out VoidValue value)
		{
			return this._villagerWorkLocations.TryGetValue(elementId, out value);
		}

		// Token: 0x0600132A RID: 4906 RVA: 0x00127CBF File Offset: 0x00125EBF
		private void AddElement_VillagerWorkLocations(Location elementId, VoidValue value, DataContext context)
		{
			this._villagerWorkLocations.Add(elementId, value);
			this._modificationsVillagerWorkLocations.RecordAdding(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(57, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600132B RID: 4907 RVA: 0x00127CF1 File Offset: 0x00125EF1
		private void SetElement_VillagerWorkLocations(Location elementId, VoidValue value, DataContext context)
		{
			this._villagerWorkLocations[elementId] = value;
			this._modificationsVillagerWorkLocations.RecordSetting(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(57, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600132C RID: 4908 RVA: 0x00127D23 File Offset: 0x00125F23
		private void RemoveElement_VillagerWorkLocations(Location elementId, DataContext context)
		{
			this._villagerWorkLocations.Remove(elementId);
			this._modificationsVillagerWorkLocations.RecordRemoving(elementId);
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(57, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600132D RID: 4909 RVA: 0x00127D54 File Offset: 0x00125F54
		private void ClearVillagerWorkLocations(DataContext context)
		{
			this._villagerWorkLocations.Clear();
			this._modificationsVillagerWorkLocations.RecordClearing();
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(57, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x0600132E RID: 4910 RVA: 0x00127D84 File Offset: 0x00125F84
		public int GetMaterialResourceMaxCount()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 58);
			int materialResourceMaxCount;
			if (flag)
			{
				materialResourceMaxCount = this._materialResourceMaxCount;
			}
			else
			{
				int value = this.CalcMaterialResourceMaxCount();
				bool lockTaken = false;
				try
				{
					this._spinLockMaterialResourceMaxCount.Enter(ref lockTaken);
					this._materialResourceMaxCount = value;
					BaseGameDataDomain.SetCached(this.DataStates, 58);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockMaterialResourceMaxCount.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				materialResourceMaxCount = this._materialResourceMaxCount;
			}
			return materialResourceMaxCount;
		}

		// Token: 0x0600132F RID: 4911 RVA: 0x00127E1C File Offset: 0x0012601C
		public int[] GetResourceChange()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 59);
			int[] resourceChange;
			if (flag)
			{
				resourceChange = this._resourceChange;
			}
			else
			{
				int[] value = new int[8];
				this.CalcResourceChange(value);
				bool lockTaken = false;
				try
				{
					this._spinLockResourceChange.Enter(ref lockTaken);
					for (int i = 0; i < 8; i++)
					{
						this._resourceChange[i] = value[i];
					}
					BaseGameDataDomain.SetCached(this.DataStates, 59);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockResourceChange.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				resourceChange = this._resourceChange;
			}
			return resourceChange;
		}

		// Token: 0x06001330 RID: 4912 RVA: 0x00127ED8 File Offset: 0x001260D8
		public short GetWorkLocationMaxCount()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 60);
			short workLocationMaxCount;
			if (flag)
			{
				workLocationMaxCount = this._workLocationMaxCount;
			}
			else
			{
				short value = this.CalcWorkLocationMaxCount();
				bool lockTaken = false;
				try
				{
					this._spinLockWorkLocationMaxCount.Enter(ref lockTaken);
					this._workLocationMaxCount = value;
					BaseGameDataDomain.SetCached(this.DataStates, 60);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockWorkLocationMaxCount.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				workLocationMaxCount = this._workLocationMaxCount;
			}
			return workLocationMaxCount;
		}

		// Token: 0x06001331 RID: 4913 RVA: 0x00127F70 File Offset: 0x00126170
		public short GetTotalVillagerCount()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 61);
			short totalVillagerCount;
			if (flag)
			{
				totalVillagerCount = this._totalVillagerCount;
			}
			else
			{
				short value = this.CalcTotalVillagerCount();
				bool lockTaken = false;
				try
				{
					this._spinLockTotalVillagerCount.Enter(ref lockTaken);
					this._totalVillagerCount = value;
					BaseGameDataDomain.SetCached(this.DataStates, 61);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTotalVillagerCount.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				totalVillagerCount = this._totalVillagerCount;
			}
			return totalVillagerCount;
		}

		// Token: 0x06001332 RID: 4914 RVA: 0x00128008 File Offset: 0x00126208
		public short GetTotalAdultVillagerCount()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 62);
			short totalAdultVillagerCount;
			if (flag)
			{
				totalAdultVillagerCount = this._totalAdultVillagerCount;
			}
			else
			{
				short value = this.CalcTotalAdultVillagerCount();
				bool lockTaken = false;
				try
				{
					this._spinLockTotalAdultVillagerCount.Enter(ref lockTaken);
					this._totalAdultVillagerCount = value;
					BaseGameDataDomain.SetCached(this.DataStates, 62);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTotalAdultVillagerCount.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				totalAdultVillagerCount = this._totalAdultVillagerCount;
			}
			return totalAdultVillagerCount;
		}

		// Token: 0x06001333 RID: 4915 RVA: 0x001280A0 File Offset: 0x001262A0
		public short GetAvailableVillagerCount()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 63);
			short availableVillagerCount;
			if (flag)
			{
				availableVillagerCount = this._availableVillagerCount;
			}
			else
			{
				short value = this.CalcAvailableVillagerCount();
				bool lockTaken = false;
				try
				{
					this._spinLockAvailableVillagerCount.Enter(ref lockTaken);
					this._availableVillagerCount = value;
					BaseGameDataDomain.SetCached(this.DataStates, 63);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockAvailableVillagerCount.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				availableVillagerCount = this._availableVillagerCount;
			}
			return availableVillagerCount;
		}

		// Token: 0x06001334 RID: 4916 RVA: 0x00128138 File Offset: 0x00126338
		public bool GetIsTaiwuDieOfCombatWithXiangshu()
		{
			return this._isTaiwuDieOfCombatWithXiangshu;
		}

		// Token: 0x06001335 RID: 4917 RVA: 0x00128150 File Offset: 0x00126350
		public void SetIsTaiwuDieOfCombatWithXiangshu(bool value, DataContext context)
		{
			this._isTaiwuDieOfCombatWithXiangshu = value;
			BaseGameDataDomain.SetModifiedAndInvalidateInfluencedCache(64, this.DataStates, TaiwuDomain.CacheInfluences, context);
		}

		// Token: 0x06001336 RID: 4918 RVA: 0x00128170 File Offset: 0x00126370
		public bool GetVillagerLearnLifeSkillsFromSect()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 65);
			bool villagerLearnLifeSkillsFromSect;
			if (flag)
			{
				villagerLearnLifeSkillsFromSect = this._villagerLearnLifeSkillsFromSect;
			}
			else
			{
				bool value = this.CalcVillagerLearnLifeSkillsFromSect();
				bool lockTaken = false;
				try
				{
					this._spinLockVillagerLearnLifeSkillsFromSect.Enter(ref lockTaken);
					this._villagerLearnLifeSkillsFromSect = value;
					BaseGameDataDomain.SetCached(this.DataStates, 65);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockVillagerLearnLifeSkillsFromSect.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				villagerLearnLifeSkillsFromSect = this._villagerLearnLifeSkillsFromSect;
			}
			return villagerLearnLifeSkillsFromSect;
		}

		// Token: 0x06001337 RID: 4919 RVA: 0x00128208 File Offset: 0x00126408
		public bool GetVillagerLearnCombatSkillsFromSect()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 66);
			bool villagerLearnCombatSkillsFromSect;
			if (flag)
			{
				villagerLearnCombatSkillsFromSect = this._villagerLearnCombatSkillsFromSect;
			}
			else
			{
				bool value = this.CalcVillagerLearnCombatSkillsFromSect();
				bool lockTaken = false;
				try
				{
					this._spinLockVillagerLearnCombatSkillsFromSect.Enter(ref lockTaken);
					this._villagerLearnCombatSkillsFromSect = value;
					BaseGameDataDomain.SetCached(this.DataStates, 66);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockVillagerLearnCombatSkillsFromSect.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				villagerLearnCombatSkillsFromSect = this._villagerLearnCombatSkillsFromSect;
			}
			return villagerLearnCombatSkillsFromSect;
		}

		// Token: 0x06001338 RID: 4920 RVA: 0x001282A0 File Offset: 0x001264A0
		public List<IntPair> GetOverweightSanctionPercent()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 67);
			List<IntPair> overweightSanctionPercent;
			if (flag)
			{
				overweightSanctionPercent = this._overweightSanctionPercent;
			}
			else
			{
				List<IntPair> value = new List<IntPair>();
				this.CalcOverweightSanctionPercent(value);
				bool lockTaken = false;
				try
				{
					this._spinLockOverweightSanctionPercent.Enter(ref lockTaken);
					this._overweightSanctionPercent.Assign(value);
					BaseGameDataDomain.SetCached(this.DataStates, 67);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockOverweightSanctionPercent.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				overweightSanctionPercent = this._overweightSanctionPercent;
			}
			return overweightSanctionPercent;
		}

		// Token: 0x06001339 RID: 4921 RVA: 0x00128344 File Offset: 0x00126544
		public byte GetReferenceSkillSlotUnlockStates()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 68);
			byte referenceSkillSlotUnlockStates;
			if (flag)
			{
				referenceSkillSlotUnlockStates = this._referenceSkillSlotUnlockStates;
			}
			else
			{
				byte value = this.CalcReferenceSkillSlotUnlockStates();
				bool lockTaken = false;
				try
				{
					this._spinLockReferenceSkillSlotUnlockStates.Enter(ref lockTaken);
					this._referenceSkillSlotUnlockStates = value;
					BaseGameDataDomain.SetCached(this.DataStates, 68);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockReferenceSkillSlotUnlockStates.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				referenceSkillSlotUnlockStates = this._referenceSkillSlotUnlockStates;
			}
			return referenceSkillSlotUnlockStates;
		}

		// Token: 0x0600133A RID: 4922 RVA: 0x001283DC File Offset: 0x001265DC
		public Injuries GetTaiwuGroupWorstInjuries()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 69);
			Injuries taiwuGroupWorstInjuries;
			if (flag)
			{
				taiwuGroupWorstInjuries = this._taiwuGroupWorstInjuries;
			}
			else
			{
				Injuries value = this.CalcTaiwuGroupWorstInjuries();
				bool lockTaken = false;
				try
				{
					this._spinLockTaiwuGroupWorstInjuries.Enter(ref lockTaken);
					this._taiwuGroupWorstInjuries = value;
					BaseGameDataDomain.SetCached(this.DataStates, 69);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTaiwuGroupWorstInjuries.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				taiwuGroupWorstInjuries = this._taiwuGroupWorstInjuries;
			}
			return taiwuGroupWorstInjuries;
		}

		// Token: 0x0600133B RID: 4923 RVA: 0x00128474 File Offset: 0x00126674
		public ref ResourceInts GetTotalResources()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 70);
			ResourceInts result;
			if (flag)
			{
				result = ref this._totalResources;
			}
			else
			{
				ResourceInts value = this.CalcTotalResources();
				bool lockTaken = false;
				try
				{
					this._spinLockTotalResources.Enter(ref lockTaken);
					this._totalResources = value;
					BaseGameDataDomain.SetCached(this.DataStates, 70);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTotalResources.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				result = ref this._totalResources;
			}
			return ref result;
		}

		// Token: 0x0600133C RID: 4924 RVA: 0x0012850C File Offset: 0x0012670C
		public List<int> GetTaiwuSpecialGroup()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 71);
			List<int> taiwuSpecialGroup;
			if (flag)
			{
				taiwuSpecialGroup = this._taiwuSpecialGroup;
			}
			else
			{
				List<int> value = new List<int>();
				this.CalcTaiwuSpecialGroup(value);
				bool lockTaken = false;
				try
				{
					this._spinLockTaiwuSpecialGroup.Enter(ref lockTaken);
					this._taiwuSpecialGroup.Assign(value);
					BaseGameDataDomain.SetCached(this.DataStates, 71);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTaiwuSpecialGroup.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				taiwuSpecialGroup = this._taiwuSpecialGroup;
			}
			return taiwuSpecialGroup;
		}

		// Token: 0x0600133D RID: 4925 RVA: 0x001285B0 File Offset: 0x001267B0
		public List<int> GetTaiwuGearMateGroup()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 72);
			List<int> taiwuGearMateGroup;
			if (flag)
			{
				taiwuGearMateGroup = this._taiwuGearMateGroup;
			}
			else
			{
				List<int> value = new List<int>();
				this.CalcTaiwuGearMateGroup(value);
				bool lockTaken = false;
				try
				{
					this._spinLockTaiwuGearMateGroup.Enter(ref lockTaken);
					this._taiwuGearMateGroup.Assign(value);
					BaseGameDataDomain.SetCached(this.DataStates, 72);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTaiwuGearMateGroup.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				taiwuGearMateGroup = this._taiwuGearMateGroup;
			}
			return taiwuGearMateGroup;
		}

		// Token: 0x0600133E RID: 4926 RVA: 0x00128654 File Offset: 0x00126854
		public bool GetCanBreakOut()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 73);
			bool canBreakOut;
			if (flag)
			{
				canBreakOut = this._canBreakOut;
			}
			else
			{
				bool value = this.CalcCanBreakOut();
				bool lockTaken = false;
				try
				{
					this._spinLockCanBreakOut.Enter(ref lockTaken);
					this._canBreakOut = value;
					BaseGameDataDomain.SetCached(this.DataStates, 73);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockCanBreakOut.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				canBreakOut = this._canBreakOut;
			}
			return canBreakOut;
		}

		// Token: 0x0600133F RID: 4927 RVA: 0x001286EC File Offset: 0x001268EC
		public int GetTroughMaxLoad()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 74);
			int troughMaxLoad;
			if (flag)
			{
				troughMaxLoad = this._troughMaxLoad;
			}
			else
			{
				int value = this.CalcTroughMaxLoad();
				bool lockTaken = false;
				try
				{
					this._spinLockTroughMaxLoad.Enter(ref lockTaken);
					this._troughMaxLoad = value;
					BaseGameDataDomain.SetCached(this.DataStates, 74);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTroughMaxLoad.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				troughMaxLoad = this._troughMaxLoad;
			}
			return troughMaxLoad;
		}

		// Token: 0x06001340 RID: 4928 RVA: 0x00128784 File Offset: 0x00126984
		public int GetTroughCurrLoad()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 75);
			int troughCurrLoad;
			if (flag)
			{
				troughCurrLoad = this._troughCurrLoad;
			}
			else
			{
				int value = this.CalcTroughCurrLoad();
				bool lockTaken = false;
				try
				{
					this._spinLockTroughCurrLoad.Enter(ref lockTaken);
					this._troughCurrLoad = value;
					BaseGameDataDomain.SetCached(this.DataStates, 75);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockTroughCurrLoad.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				troughCurrLoad = this._troughCurrLoad;
			}
			return troughCurrLoad;
		}

		// Token: 0x06001341 RID: 4929 RVA: 0x0012881C File Offset: 0x00126A1C
		public List<IntPair> GetClothingDurability()
		{
			Thread.MemoryBarrier();
			bool flag = BaseGameDataDomain.IsCached(this.DataStates, 76);
			List<IntPair> clothingDurability;
			if (flag)
			{
				clothingDurability = this._clothingDurability;
			}
			else
			{
				List<IntPair> value = new List<IntPair>();
				this.CalcClothingDurability(value);
				bool lockTaken = false;
				try
				{
					this._spinLockClothingDurability.Enter(ref lockTaken);
					this._clothingDurability.Assign(value);
					BaseGameDataDomain.SetCached(this.DataStates, 76);
				}
				finally
				{
					bool flag2 = lockTaken;
					if (flag2)
					{
						this._spinLockClothingDurability.Exit(false);
					}
				}
				Thread.MemoryBarrier();
				clothingDurability = this._clothingDurability;
			}
			return clothingDurability;
		}

		// Token: 0x06001342 RID: 4930 RVA: 0x001288C0 File Offset: 0x00126AC0
		public override void OnInitializeGameDataModule()
		{
			this.InitializeOnInitializeGameDataModule();
		}

		// Token: 0x06001343 RID: 4931 RVA: 0x001288CC File Offset: 0x00126ACC
		public unsafe override void OnEnterNewWorld()
		{
			this.InitializeOnEnterNewWorld();
			this.InitializeInternalDataOfCollections();
			byte* pData = OperationAdder.FixedSingleValue_Set(5, 0, 4);
			*(int*)pData = this._taiwuCharId;
			pData += 4;
			byte* pData2 = OperationAdder.FixedSingleValue_Set(5, 1, 4);
			*(int*)pData2 = this._taiwuGenerationsCount;
			pData2 += 4;
			byte* pData3 = OperationAdder.FixedSingleValue_Set(5, 2, 4);
			*(int*)pData3 = this._cricketLuckPoint;
			pData3 += 4;
			int elementsCount = this._previousTaiwuIds.Count;
			int contentSize = 4 * elementsCount;
			int dataSize = 2 + contentSize;
			byte* pData4 = OperationAdder.DynamicSingleValue_Set(5, 3, dataSize);
			*(short*)pData4 = (short)((ushort)elementsCount);
			pData4 += 2;
			for (int i = 0; i < elementsCount; i++)
			{
				*(int*)(pData4 + (IntPtr)i * 4) = this._previousTaiwuIds[i];
			}
			pData4 += contentSize;
			byte* pData5 = OperationAdder.FixedSingleValue_Set(5, 4, 1);
			*pData5 = (this._needToEscape ? 1 : 0);
			pData5++;
			foreach (KeyValuePair<ItemKey, int> entry in this._warehouseItems)
			{
				ItemKey elementId = entry.Key;
				int value = entry.Value;
				byte* pData6 = OperationAdder.FixedSingleValueCollection_Add<ItemKey>(5, 7, elementId, 4);
				*(int*)pData6 = value;
				pData6 += 4;
			}
			byte* pData7 = OperationAdder.FixedSingleValue_Set(5, 12, 4);
			*(int*)pData7 = this._buildingSpaceExtraAdd;
			pData7 += 4;
			byte* pData8 = OperationAdder.FixedSingleValue_Set(5, 13, 1);
			*pData8 = (this._prosperousConstruction ? 1 : 0);
			pData8++;
			foreach (KeyValuePair<short, TaiwuCombatSkill> entry2 in this._combatSkills)
			{
				short elementId2 = entry2.Key;
				TaiwuCombatSkill value2 = entry2.Value;
				byte* pData9 = OperationAdder.FixedSingleValueCollection_Add<short>(5, 14, elementId2, 20);
				pData9 += value2.Serialize(pData9);
			}
			foreach (KeyValuePair<short, TaiwuLifeSkill> entry3 in this._lifeSkills)
			{
				short elementId3 = entry3.Key;
				TaiwuLifeSkill value3 = entry3.Value;
				byte* pData10 = OperationAdder.FixedSingleValueCollection_Add<short>(5, 15, elementId3, 5);
				pData10 += value3.Serialize(pData10);
			}
			int dataSize2 = 0;
			for (int j = 0; j < 9; j++)
			{
				CombatSkillPlan element = this._combatSkillPlans[j];
				bool flag = element != null;
				if (flag)
				{
					dataSize2 += 4 + element.GetSerializedSize();
				}
				else
				{
					dataSize2 += 4;
				}
			}
			byte* pData11 = OperationAdder.DynamicElementList_InsertRange(5, 16, 0, 9, dataSize2);
			for (int k = 0; k < 9; k++)
			{
				CombatSkillPlan element2 = this._combatSkillPlans[k];
				bool flag2 = element2 != null;
				if (flag2)
				{
					byte* pSubContentSize = pData11;
					pData11 += 4;
					int subContentSize = element2.Serialize(pData11);
					pData11 += subContentSize;
					*(int*)pSubContentSize = subContentSize;
				}
				else
				{
					*(int*)pData11 = 0;
					pData11 += 4;
				}
			}
			byte* pData12 = OperationAdder.FixedSingleValue_Set(5, 17, 4);
			*(int*)pData12 = this._currCombatSkillPlanId;
			pData12 += 4;
			byte* pData13 = OperationAdder.FixedElementList_InsertRange(5, 18, 0, 16, 16);
			for (int l = 0; l < 16; l++)
			{
				pData13[l] = (byte)this._currLifeSkillAttainmentPanelPlanIndex[l];
			}
			pData13 += 16;
			foreach (KeyValuePair<short, SkillBreakPlateObsolete> entry4 in this._skillBreakPlateObsoleteDict)
			{
				short elementId4 = entry4.Key;
				SkillBreakPlateObsolete value4 = entry4.Value;
				bool flag3 = value4 != null;
				if (flag3)
				{
					int contentSize2 = value4.GetSerializedSize();
					byte* pData14 = OperationAdder.DynamicSingleValueCollection_Add<short>(5, 19, elementId4, contentSize2);
					pData14 += value4.Serialize(pData14);
				}
				else
				{
					OperationAdder.DynamicSingleValueCollection_Add<short>(5, 19, elementId4, 0);
				}
			}
			foreach (KeyValuePair<short, SkillBreakBonusCollection> entry5 in this._skillBreakBonusDict)
			{
				short elementId5 = entry5.Key;
				SkillBreakBonusCollection value5 = entry5.Value;
				bool flag4 = value5 != null;
				if (flag4)
				{
					int contentSize3 = value5.GetSerializedSize();
					byte* pData15 = OperationAdder.DynamicSingleValueCollection_Add<short>(5, 20, elementId5, contentSize3);
					pData15 += value5.Serialize(pData15);
				}
				else
				{
					OperationAdder.DynamicSingleValueCollection_Add<short>(5, 20, elementId5, 0);
				}
			}
			foreach (KeyValuePair<int, GameData.Utilities.ShortList> entry6 in this._teachTaiwuLifeSkillDict)
			{
				int elementId6 = entry6.Key;
				GameData.Utilities.ShortList value6 = entry6.Value;
				int dataSize3 = value6.GetSerializedSize();
				byte* pData16 = OperationAdder.DynamicSingleValueCollection_Add<int>(5, 21, elementId6, dataSize3);
				pData16 += value6.Serialize(pData16);
			}
			foreach (KeyValuePair<int, GameData.Utilities.ShortList> entry7 in this._teachTaiwuCombatSkillDict)
			{
				int elementId7 = entry7.Key;
				GameData.Utilities.ShortList value7 = entry7.Value;
				int dataSize4 = value7.GetSerializedSize();
				byte* pData17 = OperationAdder.DynamicSingleValueCollection_Add<int>(5, 22, elementId7, dataSize4);
				pData17 += value7.Serialize(pData17);
			}
			byte* pData18 = OperationAdder.FixedSingleValue_Set(5, 23, 1260);
			for (int m = 0; m < 630; m++)
			{
				*(short*)(pData18 + (IntPtr)m * 2) = this._combatSkillAttainmentPanelPlans[m];
			}
			pData18 += 1260;
			byte* pData19 = OperationAdder.FixedSingleValue_Set(5, 24, 14);
			for (int n = 0; n < 14; n++)
			{
				pData19[n] = (byte)this._currCombatSkillAttainmentPanelPlanIds[n];
			}
			pData19 += 14;
			byte* pData20 = OperationAdder.FixedSingleValue_Set(5, 26, 6);
			for (int i2 = 0; i2 < 6; i2++)
			{
				pData20[i2] = (byte)this._weaponInnerRatios[i2];
			}
			pData20 += 6;
			foreach (KeyValuePair<int, short> entry8 in this._appointments)
			{
				int elementId8 = entry8.Key;
				short value8 = entry8.Value;
				byte* pData21 = OperationAdder.FixedSingleValueCollection_Add<int>(5, 28, elementId8, 2);
				*(short*)pData21 = value8;
				pData21 += 2;
			}
			byte* pData22 = OperationAdder.FixedSingleValue_Set(5, 29, 2);
			*(short*)pData22 = this._babyBonusMainAttributes;
			pData22 += 2;
			byte* pData23 = OperationAdder.FixedSingleValue_Set(5, 30, 2);
			*(short*)pData23 = this._babyBonusLifeSkillQualifications;
			pData23 += 2;
			byte* pData24 = OperationAdder.FixedSingleValue_Set(5, 31, 2);
			*(short*)pData24 = this._babyBonusCombatSkillQualifications;
			pData24 += 2;
			byte* pData25 = OperationAdder.FixedElementList_InsertRange(5, 32, 0, 5, 495);
			for (int i3 = 0; i3 < 5; i3++)
			{
				pData25 += this._equipmentsPlans[i3].Serialize(pData25);
			}
			byte* pData26 = OperationAdder.FixedSingleValue_Set(5, 33, 4);
			*(int*)pData26 = this._currEquipmentPlanId;
			pData26 += 4;
			int dataSize5 = this._groupCharIds.GetSerializedSize();
			byte* pData27 = OperationAdder.DynamicSingleValue_Set(5, 34, dataSize5);
			pData27 += this._groupCharIds.Serialize(pData27);
			byte* pData28 = OperationAdder.FixedElementList_InsertRange(5, 35, 0, 3, 12);
			for (int i4 = 0; i4 < 3; i4++)
			{
				*(int*)(pData28 + (IntPtr)i4 * 4) = this._combatGroupCharIds[i4];
			}
			pData28 += 12;
			foreach (KeyValuePair<short, short> entry9 in this._legacyPointDict)
			{
				short elementId9 = entry9.Key;
				short value9 = entry9.Value;
				byte* pData29 = OperationAdder.FixedSingleValueCollection_Add<short>(5, 37, elementId9, 2);
				*(short*)pData29 = value9;
				pData29 += 2;
			}
			byte* pData30 = OperationAdder.FixedSingleValue_Set(5, 38, 4);
			*(int*)pData30 = this._legacyPoint;
			pData30 += 4;
			int elementsCount2 = this._availableLegacyList.Count;
			int contentSize4 = 2 * elementsCount2;
			int dataSize6 = 2 + contentSize4;
			byte* pData31 = OperationAdder.DynamicSingleValue_Set(5, 39, dataSize6);
			*(short*)pData31 = (short)((ushort)elementsCount2);
			pData31 += 2;
			for (int i5 = 0; i5 < elementsCount2; i5++)
			{
				*(short*)(pData31 + (IntPtr)i5 * 2) = this._availableLegacyList[i5];
			}
			pData31 += contentSize4;
			int dataSize7 = 0;
			for (int i6 = 0; i6 < 15; i6++)
			{
				dataSize7 += 4 + this._stateNewCharacterLegacyGrowingGrades[i6].GetSerializedSize();
			}
			byte* pData32 = OperationAdder.DynamicElementList_InsertRange(5, 42, 0, 15, dataSize7);
			for (int i7 = 0; i7 < 15; i7++)
			{
				byte* pSubContentSize2 = pData32;
				pData32 += 4;
				int subContentSize2 = this._stateNewCharacterLegacyGrowingGrades[i7].Serialize(pData32);
				pData32 += subContentSize2;
				*(int*)pSubContentSize2 = subContentSize2;
			}
			foreach (KeyValuePair<short, TaiwuCombatSkill> entry10 in this._notLearnCombatSkillReadingProgress)
			{
				short elementId10 = entry10.Key;
				TaiwuCombatSkill value10 = entry10.Value;
				byte* pData33 = OperationAdder.FixedSingleValueCollection_Add<short>(5, 43, elementId10, 20);
				pData33 += value10.Serialize(pData33);
			}
			foreach (KeyValuePair<short, TaiwuLifeSkill> entry11 in this._notLearnLifeSkillReadingProgress)
			{
				short elementId11 = entry11.Key;
				TaiwuLifeSkill value11 = entry11.Value;
				byte* pData34 = OperationAdder.FixedSingleValueCollection_Add<short>(5, 44, elementId11, 5);
				pData34 += value11.Serialize(pData34);
			}
			foreach (KeyValuePair<ItemKey, ReadingBookStrategies> entry12 in this._readingBooks)
			{
				ItemKey elementId12 = entry12.Key;
				ReadingBookStrategies value12 = entry12.Value;
				byte* pData35 = OperationAdder.FixedSingleValueCollection_Add<ItemKey>(5, 45, elementId12, 36);
				pData35 += value12.Serialize(pData35);
			}
			byte* pData36 = OperationAdder.FixedSingleValue_Set(5, 46, 8);
			pData36 += this._curReadingBook.Serialize(pData36);
			byte* pData37 = OperationAdder.FixedSingleValue_Set(5, 47, 24);
			for (int i8 = 0; i8 < 3; i8++)
			{
				pData37 += this._referenceBooks[i8].Serialize(pData37);
			}
			byte* pData38 = OperationAdder.FixedSingleValue_Set(5, 49, 1);
			*pData38 = (this._readingEventTriggered ? 1 : 0);
			pData38++;
			byte* pData39 = OperationAdder.FixedSingleValue_Set(5, 50, 1);
			*pData39 = (byte)this._readInCombatCount;
			pData39++;
			int elementsCount3 = this._visitedSettlements.Count;
			int contentSize5 = 2 * elementsCount3;
			int dataSize8 = 2 + contentSize5;
			byte* pData40 = OperationAdder.DynamicSingleValue_Set(5, 54, dataSize8);
			*(short*)pData40 = (short)((ushort)elementsCount3);
			pData40 += 2;
			for (int i9 = 0; i9 < elementsCount3; i9++)
			{
				*(short*)(pData40 + (IntPtr)i9 * 2) = this._visitedSettlements[i9];
			}
			pData40 += contentSize5;
			byte* pData41 = OperationAdder.FixedSingleValue_Set(5, 55, 2);
			*(short*)pData41 = this._taiwuVillageSettlementId;
			pData41 += 2;
			foreach (KeyValuePair<int, VillagerWorkData> entry13 in this._villagerWork)
			{
				int elementId13 = entry13.Key;
				VillagerWorkData value13 = entry13.Value;
				byte* pData42 = OperationAdder.FixedSingleValueCollection_Add<int>(5, 56, elementId13, 20);
				pData42 += value13.Serialize(pData42);
			}
		}

		// Token: 0x06001344 RID: 4932 RVA: 0x001294E0 File Offset: 0x001276E0
		public override void OnLoadWorld()
		{
			this._pendingLoadingOperationIds = new Queue<uint>();
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 0));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 1));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 2));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValue_Get(5, 3));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 4));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 7));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 12));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 13));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 14));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 15));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicElementList_GetAll(5, 16));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 17));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedElementList_GetAll(5, 18));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValueCollection_GetAll(5, 19));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValueCollection_GetAll(5, 20));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValueCollection_GetAll(5, 21));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValueCollection_GetAll(5, 22));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 23));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 24));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 26));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 28));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 29));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 30));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 31));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedElementList_GetAll(5, 32));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 33));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValue_Get(5, 34));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedElementList_GetAll(5, 35));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 37));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 38));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValue_Get(5, 39));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicElementList_GetAll(5, 42));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 43));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 44));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 45));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 46));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 47));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 49));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 50));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.DynamicSingleValue_Get(5, 54));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValue_Get(5, 55));
			this._pendingLoadingOperationIds.Enqueue(OperationAdder.FixedSingleValueCollection_GetAll(5, 56));
		}

		// Token: 0x06001345 RID: 4933 RVA: 0x0012983C File Offset: 0x00127A3C
		public unsafe override int GetData(ushort dataId, ulong subId0, uint subId1, RawDataPool dataPool, bool resetModified)
		{
			int result;
			switch (dataId)
			{
			case 0:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 0);
				}
				result = Serializer.Serialize(this._taiwuCharId, dataPool);
				break;
			case 1:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 1);
				}
				result = Serializer.Serialize(this._taiwuGenerationsCount, dataPool);
				break;
			case 2:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 2);
				}
				result = Serializer.Serialize(this._cricketLuckPoint, dataPool);
				break;
			case 3:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 3);
				}
				result = Serializer.Serialize(this._previousTaiwuIds, dataPool);
				break;
			case 4:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 4);
				}
				result = Serializer.Serialize(this._needToEscape, dataPool);
				break;
			case 5:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 5);
				}
				result = Serializer.Serialize(this._receivedItems, dataPool);
				break;
			case 6:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 6);
				}
				result = Serializer.Serialize(this._receivedCharacters, dataPool);
				break;
			case 7:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 8:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 8);
				}
				result = Serializer.Serialize(this.GetWarehouseMaxLoad(), dataPool);
				break;
			case 9:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 9);
				}
				result = Serializer.Serialize(this.GetWarehouseCurrLoad(), dataPool);
				break;
			case 10:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 10);
				}
				result = Serializer.Serialize(this.GetBuildingSpaceLimit(), dataPool);
				break;
			case 11:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 11);
				}
				result = Serializer.Serialize(this.GetBuildingSpaceCurr(), dataPool);
				break;
			case 12:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 12);
				}
				result = Serializer.Serialize(this._buildingSpaceExtraAdd, dataPool);
				break;
			case 13:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 13);
				}
				result = Serializer.Serialize(this._prosperousConstruction, dataPool);
				break;
			case 14:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 14);
					this._modificationsCombatSkills.Reset();
				}
				result = Serializer.SerializeModifications<short>(this._combatSkills, dataPool);
				break;
			case 15:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 15);
					this._modificationsLifeSkills.Reset();
				}
				result = Serializer.SerializeModifications<short>(this._lifeSkills, dataPool);
				break;
			case 16:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 17:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 17);
				}
				result = Serializer.Serialize(this._currCombatSkillPlanId, dataPool);
				break;
			case 18:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, (int)subId0);
				}
				result = Serializer.Serialize(this._currLifeSkillAttainmentPanelPlanIndex[(int)subId0], dataPool);
				break;
			case 19:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 19);
					this._modificationsSkillBreakPlateObsoleteDict.Reset();
				}
				result = Serializer.SerializeModifications<short>(this._skillBreakPlateObsoleteDict, dataPool);
				break;
			case 20:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 21:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 21);
					this._modificationsTeachTaiwuLifeSkillDict.Reset();
				}
				result = Serializer.SerializeModifications<int>(this._teachTaiwuLifeSkillDict, dataPool);
				break;
			case 22:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 22);
					this._modificationsTeachTaiwuCombatSkillDict.Reset();
				}
				result = Serializer.SerializeModifications<int>(this._teachTaiwuCombatSkillDict, dataPool);
				break;
			case 23:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 23);
				}
				result = Serializer.Serialize(this._combatSkillAttainmentPanelPlans, dataPool);
				break;
			case 24:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 24);
				}
				result = Serializer.Serialize(this._currCombatSkillAttainmentPanelPlanIds, dataPool);
				break;
			case 25:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 25);
				}
				result = Serializer.Serialize(this.GetMoveTimeCostPercent(), dataPool);
				break;
			case 26:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 26);
				}
				result = Serializer.Serialize(this._weaponInnerRatios, dataPool);
				break;
			case 27:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 27);
				}
				result = Serializer.Serialize(this.GetWeaponCurrInnerRatios(), dataPool);
				break;
			case 28:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 28);
					this._modificationsAppointments.Reset();
				}
				result = Serializer.SerializeModifications<int>(this._appointments, dataPool);
				break;
			case 29:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 30:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 31:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 32:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 33:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 33);
				}
				result = Serializer.Serialize(this._currEquipmentPlanId, dataPool);
				break;
			case 34:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 34);
				}
				result = Serializer.Serialize(this._groupCharIds, dataPool);
				break;
			case 35:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this._dataStatesCombatGroupCharIds, (int)subId0);
				}
				result = Serializer.Serialize(this._combatGroupCharIds[(int)subId0], dataPool);
				break;
			case 36:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 36);
				}
				result = Serializer.Serialize(this.GetTaiwuGroupMaxCount(), dataPool);
				break;
			case 37:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 37);
					this._modificationsLegacyPointDict.Reset();
				}
				result = Serializer.SerializeModifications<short>(this._legacyPointDict, dataPool);
				break;
			case 38:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 38);
				}
				result = Serializer.Serialize(this._legacyPoint, dataPool);
				break;
			case 39:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 39);
				}
				result = Serializer.Serialize(this._availableLegacyList, dataPool);
				break;
			case 40:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 40);
				}
				result = Serializer.Serialize(this._legacyPassingState, dataPool);
				break;
			case 41:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 41);
				}
				result = Serializer.Serialize(this._successorCandidates, dataPool);
				break;
			case 42:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this._dataStatesStateNewCharacterLegacyGrowingGrades, (int)subId0);
				}
				result = Serializer.Serialize(this._stateNewCharacterLegacyGrowingGrades[(int)subId0], dataPool);
				break;
			case 43:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 43);
					this._modificationsNotLearnCombatSkillReadingProgress.Reset();
				}
				result = Serializer.SerializeModifications<short>(this._notLearnCombatSkillReadingProgress, dataPool);
				break;
			case 44:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 44);
					this._modificationsNotLearnLifeSkillReadingProgress.Reset();
				}
				result = Serializer.SerializeModifications<short>(this._notLearnLifeSkillReadingProgress, dataPool);
				break;
			case 45:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(34, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to get value of dataId: ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 46:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 46);
				}
				result = Serializer.Serialize(this._curReadingBook, dataPool);
				break;
			case 47:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 47);
				}
				result = Serializer.Serialize(this._referenceBooks, dataPool);
				break;
			case 48:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 48);
				}
				result = Serializer.Serialize(this.GetReferenceBookSlotUnlockStates(), dataPool);
				break;
			case 49:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 49);
				}
				result = Serializer.Serialize(this._readingEventTriggered, dataPool);
				break;
			case 50:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 50);
				}
				result = Serializer.Serialize(this._readInCombatCount, dataPool);
				break;
			case 51:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 51);
				}
				result = Serializer.Serialize(this._healingOuterInjuryRestriction, dataPool);
				break;
			case 52:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 52);
				}
				result = Serializer.Serialize(this._healingInnerInjuryRestriction, dataPool);
				break;
			case 53:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 53);
				}
				result = Serializer.Serialize(this._neiliAllocationTypeRestriction, dataPool);
				break;
			case 54:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 54);
				}
				result = Serializer.Serialize(this._visitedSettlements, dataPool);
				break;
			case 55:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 55);
				}
				result = Serializer.Serialize(this._taiwuVillageSettlementId, dataPool);
				break;
			case 56:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 56);
					this._modificationsVillagerWork.Reset();
				}
				result = Serializer.SerializeModifications<int>(this._villagerWork, dataPool);
				break;
			case 57:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 57);
					this._modificationsVillagerWorkLocations.Reset();
				}
				result = Serializer.SerializeModifications<Location>(this._villagerWorkLocations, dataPool);
				break;
			case 58:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 58);
				}
				result = Serializer.Serialize(this.GetMaterialResourceMaxCount(), dataPool);
				break;
			case 59:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 59);
				}
				result = Serializer.Serialize(this.GetResourceChange(), dataPool);
				break;
			case 60:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 60);
				}
				result = Serializer.Serialize(this.GetWorkLocationMaxCount(), dataPool);
				break;
			case 61:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 61);
				}
				result = Serializer.Serialize(this.GetTotalVillagerCount(), dataPool);
				break;
			case 62:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 62);
				}
				result = Serializer.Serialize(this.GetTotalAdultVillagerCount(), dataPool);
				break;
			case 63:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 63);
				}
				result = Serializer.Serialize(this.GetAvailableVillagerCount(), dataPool);
				break;
			case 64:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 64);
				}
				result = Serializer.Serialize(this._isTaiwuDieOfCombatWithXiangshu, dataPool);
				break;
			case 65:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 65);
				}
				result = Serializer.Serialize(this.GetVillagerLearnLifeSkillsFromSect(), dataPool);
				break;
			case 66:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 66);
				}
				result = Serializer.Serialize(this.GetVillagerLearnCombatSkillsFromSect(), dataPool);
				break;
			case 67:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 67);
				}
				result = Serializer.Serialize(this.GetOverweightSanctionPercent(), dataPool);
				break;
			case 68:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 68);
				}
				result = Serializer.Serialize(this.GetReferenceSkillSlotUnlockStates(), dataPool);
				break;
			case 69:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 69);
				}
				result = Serializer.Serialize(this.GetTaiwuGroupWorstInjuries(), dataPool);
				break;
			case 70:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 70);
				}
				result = Serializer.Serialize(*this.GetTotalResources(), dataPool);
				break;
			case 71:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 71);
				}
				result = Serializer.Serialize(this.GetTaiwuSpecialGroup(), dataPool);
				break;
			case 72:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 72);
				}
				result = Serializer.Serialize(this.GetTaiwuGearMateGroup(), dataPool);
				break;
			case 73:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 73);
				}
				result = Serializer.Serialize(this.GetCanBreakOut(), dataPool);
				break;
			case 74:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 74);
				}
				result = Serializer.Serialize(this.GetTroughMaxLoad(), dataPool);
				break;
			case 75:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 75);
				}
				result = Serializer.Serialize(this.GetTroughCurrLoad(), dataPool);
				break;
			case 76:
				if (resetModified)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 76);
				}
				result = Serializer.Serialize(this.GetClothingDurability(), dataPool);
				break;
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
			return result;
		}

		// Token: 0x06001346 RID: 4934 RVA: 0x0012A6CC File Offset: 0x001288CC
		public override void SetData(ushort dataId, ulong subId0, uint subId1, int valueOffset, RawDataPool dataPool, DataContext context)
		{
			switch (dataId)
			{
			case 0:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 1:
				Serializer.Deserialize(dataPool, valueOffset, ref this._taiwuGenerationsCount);
				this.SetTaiwuGenerationsCount(this._taiwuGenerationsCount, context);
				break;
			case 2:
				Serializer.Deserialize(dataPool, valueOffset, ref this._cricketLuckPoint);
				this.SetCricketLuckPoint(this._cricketLuckPoint, context);
				break;
			case 3:
				Serializer.Deserialize(dataPool, valueOffset, ref this._previousTaiwuIds);
				this.SetPreviousTaiwuIds(this._previousTaiwuIds, context);
				break;
			case 4:
				Serializer.Deserialize(dataPool, valueOffset, ref this._needToEscape);
				this.SetNeedToEscape(this._needToEscape, context);
				break;
			case 5:
				Serializer.Deserialize(dataPool, valueOffset, ref this._receivedItems);
				this.SetReceivedItems(this._receivedItems, context);
				break;
			case 6:
				Serializer.Deserialize(dataPool, valueOffset, ref this._receivedCharacters);
				this.SetReceivedCharacters(this._receivedCharacters, context);
				break;
			case 7:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 8:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 9:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 10:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 11:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 12:
				Serializer.Deserialize(dataPool, valueOffset, ref this._buildingSpaceExtraAdd);
				this.SetBuildingSpaceExtraAdd(this._buildingSpaceExtraAdd, context);
				break;
			case 13:
				Serializer.Deserialize(dataPool, valueOffset, ref this._prosperousConstruction);
				this.SetProsperousConstruction(this._prosperousConstruction, context);
				break;
			case 14:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 15:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 16:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 17:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 18:
			{
				sbyte value = 0;
				Serializer.Deserialize(dataPool, valueOffset, ref value);
				this._currLifeSkillAttainmentPanelPlanIndex[(int)subId0] = value;
				this.SetElement_CurrLifeSkillAttainmentPanelPlanIndex((int)subId0, value, context);
				break;
			}
			case 19:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 20:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 21:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 22:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 23:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 24:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 25:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 26:
				Serializer.Deserialize(dataPool, valueOffset, ref this._weaponInnerRatios);
				this.SetWeaponInnerRatios(this._weaponInnerRatios, context);
				break;
			case 27:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 28:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 29:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 30:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 31:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 32:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 33:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 34:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 35:
			{
				int value2 = 0;
				Serializer.Deserialize(dataPool, valueOffset, ref value2);
				this._combatGroupCharIds[(int)subId0] = value2;
				this.SetElement_CombatGroupCharIds((int)subId0, value2, context);
				break;
			}
			case 36:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 37:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 38:
				Serializer.Deserialize(dataPool, valueOffset, ref this._legacyPoint);
				this.SetLegacyPoint(this._legacyPoint, context);
				break;
			case 39:
				Serializer.Deserialize(dataPool, valueOffset, ref this._availableLegacyList);
				this.SetAvailableLegacyList(this._availableLegacyList, context);
				break;
			case 40:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 41:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 42:
			{
				SByteList value3 = default(SByteList);
				Serializer.Deserialize(dataPool, valueOffset, ref value3);
				this._stateNewCharacterLegacyGrowingGrades[(int)subId0] = value3;
				this.SetElement_StateNewCharacterLegacyGrowingGrades((int)subId0, value3, context);
				break;
			}
			case 43:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 44:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 45:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 46:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 47:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 48:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 49:
				Serializer.Deserialize(dataPool, valueOffset, ref this._readingEventTriggered);
				this.SetReadingEventTriggered(this._readingEventTriggered, context);
				break;
			case 50:
				Serializer.Deserialize(dataPool, valueOffset, ref this._readInCombatCount);
				this.SetReadInCombatCount(this._readInCombatCount, context);
				break;
			case 51:
				Serializer.Deserialize(dataPool, valueOffset, ref this._healingOuterInjuryRestriction);
				this.SetHealingOuterInjuryRestriction(this._healingOuterInjuryRestriction, context);
				break;
			case 52:
				Serializer.Deserialize(dataPool, valueOffset, ref this._healingInnerInjuryRestriction);
				this.SetHealingInnerInjuryRestriction(this._healingInnerInjuryRestriction, context);
				break;
			case 53:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 54:
				Serializer.Deserialize(dataPool, valueOffset, ref this._visitedSettlements);
				this.SetVisitedSettlements(this._visitedSettlements, context);
				break;
			case 55:
				Serializer.Deserialize(dataPool, valueOffset, ref this._taiwuVillageSettlementId);
				this.SetTaiwuVillageSettlementId(this._taiwuVillageSettlementId, context);
				break;
			case 56:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 57:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 58:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 59:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 60:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 61:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 62:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 63:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 64:
				Serializer.Deserialize(dataPool, valueOffset, ref this._isTaiwuDieOfCombatWithXiangshu);
				this.SetIsTaiwuDieOfCombatWithXiangshu(this._isTaiwuDieOfCombatWithXiangshu, context);
				break;
			case 65:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 66:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 67:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 68:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 69:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 70:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 71:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 72:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 73:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 74:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 75:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 76:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(33, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to set value of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
		}

		// Token: 0x06001347 RID: 4935 RVA: 0x0012B54C File Offset: 0x0012974C
		public override int CallMethod(Operation operation, RawDataPool argDataPool, RawDataPool returnDataPool, DataContext context)
		{
			int argsOffset = operation.ArgsOffset;
			int result;
			switch (operation.MethodId)
			{
			case 0:
			{
				int argsCount = operation.ArgsCount;
				int num = argsCount;
				if (num != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<SettlementDisplayData> returnValue = this.GetAllVisitedSettlements();
				result = Serializer.Serialize(returnValue, returnDataPool);
				break;
			}
			case 1:
			{
				int argsCount2 = operation.ArgsCount;
				int num2 = argsCount2;
				if (num2 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId);
				short areaId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId);
				short blockId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId);
				sbyte resourceType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref resourceType);
				bool returnValue2 = this.SetVillagerCollectResourceWork(context, charId, areaId, blockId, resourceType);
				result = Serializer.Serialize(returnValue2, returnDataPool);
				break;
			}
			case 2:
			{
				int argsCount3 = operation.ArgsCount;
				int num3 = argsCount3;
				if (num3 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId2);
				short areaId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId2);
				short blockId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId2);
				bool returnValue3 = this.SetVillagerCollectTributeWork(context, charId2, areaId2, blockId2);
				result = Serializer.Serialize(returnValue3, returnDataPool);
				break;
			}
			case 3:
			{
				int argsCount4 = operation.ArgsCount;
				int num4 = argsCount4;
				if (num4 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId3);
				short areaId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId3);
				short blockId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId3);
				int graveId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref graveId);
				bool returnValue4 = this.SetVillagerKeepGraveWork(context, charId3, areaId3, blockId3, graveId);
				result = Serializer.Serialize(returnValue4, returnDataPool);
				break;
			}
			case 4:
			{
				int argsCount5 = operation.ArgsCount;
				int num5 = argsCount5;
				if (num5 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId4);
				short areaId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId4);
				short blockId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId4);
				bool returnValue5 = this.SetVillagerIdleWork(context, charId4, areaId4, blockId4);
				result = Serializer.Serialize(returnValue5, returnDataPool);
				break;
			}
			case 5:
			{
				int argsCount6 = operation.ArgsCount;
				int num6 = argsCount6;
				if (num6 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short areaId5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId5);
				short blockId5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId5);
				sbyte workType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref workType);
				bool returnValue6 = this.StopVillagerWork(context, areaId5, blockId5, workType);
				result = Serializer.Serialize(returnValue6, returnDataPool);
				break;
			}
			case 6:
			{
				int argsCount7 = operation.ArgsCount;
				int num7 = argsCount7;
				if (num7 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short areaId6 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId6);
				short blockId6 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId6);
				bool returnValue7 = this.StopVillagerCollectResourceWork(context, areaId6, blockId6);
				result = Serializer.Serialize(returnValue7, returnDataPool);
				break;
			}
			case 7:
			{
				int argsCount8 = operation.ArgsCount;
				int num8 = argsCount8;
				if (num8 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<Location> locationList = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref locationList);
				List<VillagerWorkData> returnValue8 = this.GetCollectResourceWorkDataList(locationList);
				result = Serializer.Serialize(returnValue8, returnDataPool);
				break;
			}
			case 8:
			{
				int argsCount9 = operation.ArgsCount;
				int num9 = argsCount9;
				if (num9 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId5);
				this.ExpelVillager(context, charId5);
				result = -1;
				break;
			}
			case 9:
			{
				int argsCount10 = operation.ArgsCount;
				int num10 = argsCount10;
				if (num10 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<int> charIds = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charIds);
				List<VillagerStatusDisplayData> returnValue9 = this.GetVillagerStatusDisplayDataList(charIds);
				result = Serializer.Serialize(returnValue9, returnDataPool);
				break;
			}
			case 10:
			{
				int argsCount11 = operation.ArgsCount;
				int num11 = argsCount11;
				if (num11 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<VillagerStatusDisplayData> returnValue10 = this.GetAllVillagersStatus();
				result = Serializer.Serialize(returnValue10, returnDataPool);
				break;
			}
			case 11:
			{
				int argsCount12 = operation.ArgsCount;
				int num12 = argsCount12;
				if (num12 != 0)
				{
					if (num12 != 1)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					bool actuallyNotOccupiedOnly = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref actuallyNotOccupiedOnly);
					List<int> returnValue11 = this.GetAllVillagersAvailableForWork(actuallyNotOccupiedOnly);
					result = Serializer.Serialize(returnValue11, returnDataPool);
				}
				else
				{
					List<int> returnValue12 = this.GetAllVillagersAvailableForWork(false);
					result = Serializer.Serialize(returnValue12, returnDataPool);
				}
				break;
			}
			case 12:
			{
				int argsCount13 = operation.ArgsCount;
				int num13 = argsCount13;
				if (num13 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int[] returnValue13 = this.CalcResourceChangeByVillageWork(context);
				result = Serializer.Serialize(returnValue13, returnDataPool);
				break;
			}
			case 13:
			{
				int argsCount14 = operation.ArgsCount;
				int num14 = argsCount14;
				if (num14 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int[] returnValue14 = this.CalcResourceChangeByBuildingEarn(context);
				result = Serializer.Serialize(returnValue14, returnDataPool);
				break;
			}
			case 14:
			{
				int argsCount15 = operation.ArgsCount;
				int num15 = argsCount15;
				if (num15 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int[] returnValue15 = this.CalcResourceChangeByBuildingMaintain(context);
				result = Serializer.Serialize(returnValue15, returnDataPool);
				break;
			}
			case 15:
			{
				int argsCount16 = operation.ArgsCount;
				int num16 = argsCount16;
				if (num16 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemDisplayData> returnValue16 = this.GetAllWarehouseItems(context);
				result = Serializer.Serialize(returnValue16, returnDataPool);
				break;
			}
			case 16:
			{
				int argsCount17 = operation.ArgsCount;
				int num17 = argsCount17;
				if (num17 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short itemSubType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemSubType);
				List<ItemDisplayData> returnValue17 = this.GetWarehouseItemsBySubType(context, itemSubType);
				result = Serializer.Serialize(returnValue17, returnDataPool);
				break;
			}
			case 17:
			{
				int argsCount18 = operation.ArgsCount;
				int num18 = argsCount18;
				if (num18 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int planId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref planId);
				this.SwitchEquipmentPlan(context, planId);
				result = -1;
				break;
			}
			case 18:
			{
				int argsCount19 = operation.ArgsCount;
				int num19 = argsCount19;
				if (num19 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte type = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref type);
				int count = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref count);
				this.GmCmd_AddResource(context, type, count);
				result = -1;
				break;
			}
			case 19:
			{
				int argsCount20 = operation.ArgsCount;
				int num20 = argsCount20;
				if (num20 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short template = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref template);
				int percent = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref percent);
				this.GmCmd_AddLegacyPoint(context, template, percent);
				result = -1;
				break;
			}
			case 20:
			{
				int argsCount21 = operation.ArgsCount;
				int num21 = argsCount21;
				if (num21 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int count2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref count2);
				this.GmCmd_AddExp(context, count2);
				result = -1;
				break;
			}
			case 21:
			{
				int argsCount22 = operation.ArgsCount;
				int num22 = argsCount22;
				if (num22 != 2)
				{
					if (num22 != 3)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					short skillTemplateId = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillTemplateId);
					ushort selectedPages = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref selectedPages);
					bool bonusOn = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bonusOn);
					this.GmCmd_SetTaiwuCombatSkillActiveState(context, skillTemplateId, selectedPages, bonusOn);
					result = -1;
				}
				else
				{
					short skillTemplateId2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillTemplateId2);
					ushort selectedPages2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref selectedPages2);
					this.GmCmd_SetTaiwuCombatSkillActiveState(context, skillTemplateId2, selectedPages2, false);
					result = -1;
				}
				break;
			}
			case 22:
			{
				int argsCount23 = operation.ArgsCount;
				int num23 = argsCount23;
				if (num23 != 1)
				{
					if (num23 != 2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					int charId6 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId6);
					bool showNotification = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref showNotification);
					this.JoinGroup(context, charId6, showNotification);
					result = -1;
				}
				else
				{
					int charId7 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId7);
					this.JoinGroup(context, charId7, true);
					result = -1;
				}
				break;
			}
			case 23:
				switch (operation.ArgsCount)
				{
				case 1:
				{
					int charId8 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId8);
					this.LeaveGroup(context, charId8, true, true, true);
					result = -1;
					break;
				}
				case 2:
				{
					int charId9 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId9);
					bool bringWards = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bringWards);
					this.LeaveGroup(context, charId9, bringWards, true, true);
					result = -1;
					break;
				}
				case 3:
				{
					int charId10 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId10);
					bool bringWards2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bringWards2);
					bool showNotification2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref showNotification2);
					this.LeaveGroup(context, charId10, bringWards2, showNotification2, true);
					result = -1;
					break;
				}
				case 4:
				{
					int charId11 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId11);
					bool bringWards3 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bringWards3);
					bool showNotification3 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref showNotification3);
					bool moveToRandomAdjacentBlock = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref moveToRandomAdjacentBlock);
					this.LeaveGroup(context, charId11, bringWards3, showNotification3, moveToRandomAdjacentBlock);
					result = -1;
					break;
				}
				default:
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				}
				break;
			case 24:
			{
				int argsCount24 = operation.ArgsCount;
				int num24 = argsCount24;
				if (num24 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.CompletePassingLegacy(context);
				result = -1;
				break;
			}
			case 25:
			{
				int argsCount25 = operation.ArgsCount;
				int num25 = argsCount25;
				if (num25 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short templateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref templateId);
				this.SelectLegacy(context, templateId);
				result = -1;
				break;
			}
			case 26:
			{
				int argsCount26 = operation.ArgsCount;
				int num26 = argsCount26;
				if (num26 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<int> returnValue18 = this.FindSuccessorCandidates(context);
				result = Serializer.Serialize(returnValue18, returnDataPool);
				break;
			}
			case 27:
			{
				int argsCount27 = operation.ArgsCount;
				int num27 = argsCount27;
				if (num27 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int newTaiwuId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref newTaiwuId);
				this.ConfirmChosenSuccessor(context, newTaiwuId);
				result = -1;
				break;
			}
			case 28:
			{
				int argsCount28 = operation.ArgsCount;
				int num28 = argsCount28;
				if (num28 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte index = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index);
				ItemKey bookItemKey = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bookItemKey);
				this.SetReferenceBook(context, index, bookItemKey);
				result = -1;
				break;
			}
			case 29:
			{
				int argsCount29 = operation.ArgsCount;
				int num29 = argsCount29;
				if (num29 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemKey bookItemKey2 = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bookItemKey2);
				this.SetReadingBook(context, bookItemKey2);
				result = -1;
				break;
			}
			case 30:
			{
				int argsCount30 = operation.ArgsCount;
				int num30 = argsCount30;
				if (num30 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ReadingBookStrategies returnValue19 = this.GetCurReadingStrategies();
				result = Serializer.Serialize(returnValue19, returnDataPool);
				break;
			}
			case 31:
			{
				int argsCount31 = operation.ArgsCount;
				int num31 = argsCount31;
				if (num31 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte pageIndex = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref pageIndex);
				int strategyIndex = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref strategyIndex);
				sbyte strategyId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref strategyId);
				this.SetReadingStrategy(context, pageIndex, strategyIndex, strategyId);
				result = -1;
				break;
			}
			case 32:
			{
				int argsCount32 = operation.ArgsCount;
				int num32 = argsCount32;
				if (num32 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte pageIndex2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref pageIndex2);
				this.ClearPageStrategy(context, pageIndex2);
				result = -1;
				break;
			}
			case 33:
			{
				int argsCount33 = operation.ArgsCount;
				int num33 = argsCount33;
				if (num33 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte pageIndex3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref pageIndex3);
				List<byte> returnValue20 = this.GetRandomSelectableStrategies(context, pageIndex3);
				result = Serializer.Serialize(returnValue20, returnDataPool);
				break;
			}
			case 34:
			{
				int argsCount34 = operation.ArgsCount;
				int num34 = argsCount34;
				if (num34 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.CheckNotInInventoryBooks(context);
				result = -1;
				break;
			}
			case 35:
			{
				int argsCount35 = operation.ArgsCount;
				int num35 = argsCount35;
				if (num35 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int bookItemId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bookItemId);
				sbyte returnValue21 = this.GetTotalReadingProgress(bookItemId);
				result = Serializer.Serialize(returnValue21, returnDataPool);
				break;
			}
			case 36:
			{
				int argsCount36 = operation.ArgsCount;
				int num36 = argsCount36;
				if (num36 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short returnValue22 = this.GetCurrReadingEventBonusRate();
				result = Serializer.Serialize(returnValue22, returnDataPool);
				break;
			}
			case 37:
			{
				int argsCount37 = operation.ArgsCount;
				int num37 = argsCount37;
				if (num37 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short returnValue23 = this.GetCurrReadingEfficiency(context);
				result = Serializer.Serialize(returnValue23, returnDataPool);
				break;
			}
			case 38:
			{
				int argsCount38 = operation.ArgsCount;
				int num38 = argsCount38;
				if (num38 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemKey itemKey = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey);
				int amount = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount);
				this.WarehouseAdd(context, itemKey, amount);
				result = -1;
				break;
			}
			case 39:
			{
				int argsCount39 = operation.ArgsCount;
				int num39 = argsCount39;
				if (num39 != 2)
				{
					if (num39 != 3)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					ItemKey itemKey2 = default(ItemKey);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey2);
					int amount2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount2);
					bool deleteItem = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref deleteItem);
					this.WarehouseRemove(context, itemKey2, amount2, deleteItem);
					result = -1;
				}
				else
				{
					ItemKey itemKey3 = default(ItemKey);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey3);
					int amount3 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount3);
					this.WarehouseRemove(context, itemKey3, amount3, false);
					result = -1;
				}
				break;
			}
			case 40:
			{
				int argsCount40 = operation.ArgsCount;
				int num40 = argsCount40;
				if (num40 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemKey itemKey4 = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey4);
				int amount4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount4);
				this.PutItemIntoWarehouse(context, itemKey4, amount4);
				result = -1;
				break;
			}
			case 41:
			{
				int argsCount41 = operation.ArgsCount;
				int num41 = argsCount41;
				if (num41 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemKey itemKey5 = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey5);
				int amount5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount5);
				this.TakeOutItemFromWarehouse(context, itemKey5, amount5);
				result = -1;
				break;
			}
			case 42:
			{
				int argsCount42 = operation.ArgsCount;
				int num42 = argsCount42;
				if (num42 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool returnValue24 = this.CanTransferItemToWarehouse(context);
				result = Serializer.Serialize(returnValue24, returnDataPool);
				break;
			}
			case 43:
			{
				int argsCount43 = operation.ArgsCount;
				int num43 = argsCount43;
				if (num43 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				BuildingBlockKey blockKey = default(BuildingBlockKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockKey);
				int returnValue25 = this.CalcBuildingResourceOutput(blockKey);
				result = Serializer.Serialize(returnValue25, returnDataPool);
				break;
			}
			case 44:
			{
				int argsCount44 = operation.ArgsCount;
				int num44 = argsCount44;
				if (num44 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isToWarehouse = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isToWarehouse);
				List<ItemKey> keyList = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList);
				bool returnValue26 = this.TransferAllItems(context, isToWarehouse, keyList);
				result = Serializer.Serialize(returnValue26, returnDataPool);
				break;
			}
			case 45:
			{
				int argsCount45 = operation.ArgsCount;
				int num45 = argsCount45;
				if (num45 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte combatSkillType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref combatSkillType);
				sbyte planId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref planId2);
				this.SelectCombatSkillAttainmentPanelPlan(context, combatSkillType, planId2);
				result = -1;
				break;
			}
			case 46:
			{
				int argsCount46 = operation.ArgsCount;
				int num46 = argsCount46;
				if (num46 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] returnValue27 = this.GetGenericGridAllocation();
				result = Serializer.Serialize(returnValue27, returnDataPool);
				break;
			}
			case 47:
			{
				int argsCount47 = operation.ArgsCount;
				int num47 = argsCount47;
				if (num47 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte equipType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref equipType);
				this.AllocateGenericGrid(context, equipType);
				result = -1;
				break;
			}
			case 48:
			{
				int argsCount48 = operation.ArgsCount;
				int num48 = argsCount48;
				if (num48 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte equipType2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref equipType2);
				this.DeallocateGenericGrid(context, equipType2);
				result = -1;
				break;
			}
			case 49:
			{
				int argsCount49 = operation.ArgsCount;
				int num49 = argsCount49;
				if (num49 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index2);
				this.UpdateCombatSkillPlan(context, index2);
				result = -1;
				break;
			}
			case 50:
			{
				int argsCount50 = operation.ArgsCount;
				int num50 = argsCount50;
				if (num50 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillTemplateId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillTemplateId3);
				SkillBreakPlate returnValue28 = this.GetBreakPlateData(skillTemplateId3);
				result = Serializer.Serialize(returnValue28, returnDataPool);
				break;
			}
			case 51:
			{
				int argsCount51 = operation.ArgsCount;
				int num51 = argsCount51;
				if (num51 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId);
				ushort selectedPages3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref selectedPages3);
				SkillBreakPlate returnValue29 = this.EnterSkillBreakPlate(context, skillId, selectedPages3);
				result = Serializer.Serialize(returnValue29, returnDataPool);
				break;
			}
			case 52:
			{
				int argsCount52 = operation.ArgsCount;
				int num52 = argsCount52;
				if (num52 != 1)
				{
					if (num52 != 2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					short skillId2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId2);
					bool fromGmCmd = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref fromGmCmd);
					this.ClearBreakPlate(context, skillId2, fromGmCmd);
					result = -1;
				}
				else
				{
					short skillId3 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId3);
					this.ClearBreakPlate(context, skillId3, false);
					result = -1;
				}
				break;
			}
			case 53:
			{
				int argsCount53 = operation.ArgsCount;
				int num53 = argsCount53;
				if (num53 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId4);
				SkillBreakPlateIndex index3 = default(SkillBreakPlateIndex);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index3);
				SkillBreakPlate returnValue30 = this.SelectSkillBreakGrid(context, skillId4, index3);
				result = Serializer.Serialize(returnValue30, returnDataPool);
				break;
			}
			case 54:
			{
				int argsCount54 = operation.ArgsCount;
				int num54 = argsCount54;
				if (num54 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.EscapeToAdjacentBlock(context);
				result = -1;
				break;
			}
			case 55:
			{
				int argsCount55 = operation.ArgsCount;
				int num55 = argsCount55;
				if (num55 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short itemSubType2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemSubType2);
				List<ItemDisplayData> returnValue31 = this.GetCanOperateItemDisplayDataInVillage(context, itemSubType2);
				result = Serializer.Serialize(returnValue31, returnDataPool);
				break;
			}
			case 56:
			{
				int argsCount56 = operation.ArgsCount;
				int num56 = argsCount56;
				if (num56 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemKey> keyList2 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList2);
				this.PutItemListIntoWarehouse(context, keyList2);
				result = -1;
				break;
			}
			case 57:
			{
				int argsCount57 = operation.ArgsCount;
				int num57 = argsCount57;
				if (num57 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemKey> keyList3 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList3);
				this.WarehouseAddList(context, keyList3);
				result = -1;
				break;
			}
			case 58:
			{
				int argsCount58 = operation.ArgsCount;
				int num58 = argsCount58;
				if (num58 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemKey> keyList4 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList4);
				this.TakeOutItemListFromWarehouse(context, keyList4);
				result = -1;
				break;
			}
			case 59:
			{
				int argsCount59 = operation.ArgsCount;
				int num59 = argsCount59;
				if (num59 != 1)
				{
					if (num59 != 2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					List<ItemKey> keyList5 = null;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList5);
					bool deleteItem2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref deleteItem2);
					this.WarehouseRemoveList(context, keyList5, deleteItem2);
					result = -1;
				}
				else
				{
					List<ItemKey> keyList6 = null;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList6);
					this.WarehouseRemoveList(context, keyList6, false);
					result = -1;
				}
				break;
			}
			case 60:
			{
				int argsCount60 = operation.ArgsCount;
				int num60 = argsCount60;
				if (num60 != 1)
				{
					if (num60 != 2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					ItemKey itemKey6 = default(ItemKey);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey6);
					int count3 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref count3);
					this.WarehouseDiscardItem(context, itemKey6, count3);
					result = -1;
				}
				else
				{
					ItemKey itemKey7 = default(ItemKey);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey7);
					this.WarehouseDiscardItem(context, itemKey7, 1);
					result = -1;
				}
				break;
			}
			case 61:
			{
				int argsCount61 = operation.ArgsCount;
				int num61 = argsCount61;
				if (num61 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemKey> keyList7 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList7);
				this.WarehouseDiscardItemList(context, keyList7);
				result = -1;
				break;
			}
			case 62:
			{
				int argsCount62 = operation.ArgsCount;
				int num62 = argsCount62;
				if (num62 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemDisplayData> returnValue32 = this.GetTaiwuAllItems(context);
				result = Serializer.Serialize(returnValue32, returnDataPool);
				break;
			}
			case 63:
			{
				int argsCount63 = operation.ArgsCount;
				int num63 = argsCount63;
				if (num63 != 4)
				{
					if (num63 != 5)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					sbyte from = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref from);
					sbyte to = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref to);
					ItemKey itemKey8 = default(ItemKey);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey8);
					int amount6 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount6);
					bool offLine = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref offLine);
					bool returnValue33 = this.TransferItem(context, from, to, itemKey8, amount6, offLine);
					result = Serializer.Serialize(returnValue33, returnDataPool);
				}
				else
				{
					sbyte from2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref from2);
					sbyte to2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref to2);
					ItemKey itemKey9 = default(ItemKey);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey9);
					int amount7 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount7);
					bool returnValue34 = this.TransferItem(context, from2, to2, itemKey9, amount7, false);
					result = Serializer.Serialize(returnValue34, returnDataPool);
				}
				break;
			}
			case 64:
			{
				int argsCount64 = operation.ArgsCount;
				int num64 = argsCount64;
				if (num64 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemDisplayData> returnValue35 = this.GetAllTroughItems(context);
				result = Serializer.Serialize(returnValue35, returnDataPool);
				break;
			}
			case 65:
			{
				int argsCount65 = operation.ArgsCount;
				int num65 = argsCount65;
				if (num65 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte from3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref from3);
				sbyte to3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref to3);
				List<ItemKey> keyList8 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref keyList8);
				bool returnValue36 = this.TransferItemList(context, from3, to3, keyList8);
				result = Serializer.Serialize(returnValue36, returnDataPool);
				break;
			}
			case 66:
			{
				int argsCount66 = operation.ArgsCount;
				int num66 = argsCount66;
				if (num66 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemDisplayData> returnValue37 = this.GetAllTreasuryItems(context);
				result = Serializer.Serialize(returnValue37, returnDataPool);
				break;
			}
			case 67:
			{
				int argsCount67 = operation.ArgsCount;
				int num67 = argsCount67;
				if (num67 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<int> bookItemIdList = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref bookItemIdList);
				List<sbyte> returnValue38 = this.GetTotalReadingProgressList(bookItemIdList);
				result = Serializer.Serialize(returnValue38, returnDataPool);
				break;
			}
			case 68:
			{
				int argsCount68 = operation.ArgsCount;
				int num68 = argsCount68;
				if (num68 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int[] returnValue39 = this.CalcResourceChangeByAutoExpand(context);
				result = Serializer.Serialize(returnValue39, returnDataPool);
				break;
			}
			case 69:
			{
				int argsCount69 = operation.ArgsCount;
				int num69 = argsCount69;
				if (num69 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int returnValue40 = this.CalcAutoExpandNotSatisfyIndex(context);
				result = Serializer.Serialize(returnValue40, returnDataPool);
				break;
			}
			case 70:
			{
				int argsCount70 = operation.ArgsCount;
				int num70 = argsCount70;
				if (num70 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Location location = default(Location);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref location);
				ValueTuple<int, int> returnValue41 = this.GetRelationCharacterCountOnBlock(location);
				result = Serializer.Serialize(returnValue41, returnDataPool);
				break;
			}
			case 71:
			{
				int argsCount71 = operation.ArgsCount;
				int num71 = argsCount71;
				if (num71 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int adversaryCharacterId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref adversaryCharacterId);
				bool isTaiwuWin = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwuWin);
				CombatResultDisplayData returnValue42 = this.ApplyLifeSkillCombatResult(context, adversaryCharacterId, isTaiwuWin);
				result = Serializer.Serialize(returnValue42, returnDataPool);
				break;
			}
			case 72:
			{
				int argsCount72 = operation.ArgsCount;
				int num72 = argsCount72;
				if (num72 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId);
				ItemDisplayData returnValue43 = this.PickLifeSkillCombatCharacterUseItem(context, characterId);
				result = Serializer.Serialize(returnValue43, returnDataPool);
				break;
			}
			case 73:
			{
				int argsCount73 = operation.ArgsCount;
				int num73 = argsCount73;
				if (num73 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId2);
				SecretInformationDisplayPackage returnValue44 = this.PickLifeSkillCombatCharacterUseSecretInformation(context, characterId2);
				result = Serializer.Serialize(returnValue44, returnDataPool);
				break;
			}
			case 74:
			{
				int argsCount74 = operation.ArgsCount;
				int num74 = argsCount74;
				if (num74 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Location location2 = default(Location);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref location2);
				int returnValue45 = this.GetConsumedCountOnBlock(location2);
				result = Serializer.Serialize(returnValue45, returnDataPool);
				break;
			}
			case 75:
			{
				int argsCount75 = operation.ArgsCount;
				int num75 = argsCount75;
				if (num75 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemKey refBookKey = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref refBookKey);
				int returnValue46 = this.GetRefBonusSpeed(refBookKey);
				result = Serializer.Serialize(returnValue46, returnDataPool);
				break;
			}
			case 76:
			{
				int argsCount76 = operation.ArgsCount;
				int num76 = argsCount76;
				if (num76 != 1)
				{
					if (num76 != 2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					short buildingTemplateId = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref buildingTemplateId);
					bool checkUsable = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref checkUsable);
					bool returnValue47 = this.FindTaiwuBuilding(buildingTemplateId, checkUsable);
					result = Serializer.Serialize(returnValue47, returnDataPool);
				}
				else
				{
					short buildingTemplateId2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref buildingTemplateId2);
					bool returnValue48 = this.FindTaiwuBuilding(buildingTemplateId2, true);
					result = Serializer.Serialize(returnValue48, returnDataPool);
				}
				break;
			}
			case 77:
			{
				int argsCount77 = operation.ArgsCount;
				int num77 = argsCount77;
				if (num77 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte resourceType2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref resourceType2);
				int count4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref count4);
				List<ItemDisplayData> returnValue49 = this.ChoosyGetMaterial(context, resourceType2, count4);
				result = Serializer.Serialize(returnValue49, returnDataPool);
				break;
			}
			case 78:
			{
				int argsCount78 = operation.ArgsCount;
				int num78 = argsCount78;
				if (num78 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short itemSubType3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemSubType3);
				List<ItemDisplayData> returnValue50 = this.GetCannotOperateItemDisplayDataInInventory(context, itemSubType3);
				result = Serializer.Serialize(returnValue50, returnDataPool);
				break;
			}
			case 79:
			{
				int argsCount79 = operation.ArgsCount;
				int num79 = argsCount79;
				if (num79 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<CharacterDisplayData> returnValue51 = this.GetInventoryOverloadedGroupCharNames();
				result = Serializer.Serialize(returnValue51, returnDataPool);
				break;
			}
			case 80:
			{
				int argsCount80 = operation.ArgsCount;
				int num80 = argsCount80;
				if (num80 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool value = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref value);
				this.SetAutoAllocateNeiliToMax(value);
				result = -1;
				break;
			}
			case 81:
			{
				int argsCount81 = operation.ArgsCount;
				int num81 = argsCount81;
				if (num81 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] inputData = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref inputData);
				List<sbyte> returnValue52 = this.LifeSkillCombatCurrentPlayerGetNotUsableEffectCardTemplateIds(context, inputData);
				result = Serializer.Serialize(returnValue52, returnDataPool);
				break;
			}
			case 82:
			{
				int argsCount82 = operation.ArgsCount;
				int num82 = argsCount82;
				if (num82 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte lifeSkillType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref lifeSkillType);
				int charA = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charA);
				int charB = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charB);
				sbyte firstTurnPlayerId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref firstTurnPlayerId);
				byte[] returnValue53 = this.LifeSkillCombatStart(context, lifeSkillType, charA, charB, firstTurnPlayerId);
				result = Serializer.Serialize(returnValue53, returnDataPool);
				break;
			}
			case 83:
			{
				int argsCount83 = operation.ArgsCount;
				int num83 = argsCount83;
				if (num83 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				CombatResultDisplayData returnValue54 = this.LifeSkillCombatTerminate(context);
				result = Serializer.Serialize(returnValue54, returnDataPool);
				break;
			}
			case 84:
			{
				int argsCount84 = operation.ArgsCount;
				int num84 = argsCount84;
				if (num84 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] data = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref data);
				byte[] returnValue55 = this.LifeSkillCombatCurrentPlayerCommitOperation(context, data);
				result = Serializer.Serialize(returnValue55, returnDataPool);
				break;
			}
			case 85:
			{
				int argsCount85 = operation.ArgsCount;
				int num85 = argsCount85;
				if (num85 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] inputData2 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref inputData2);
				byte[] returnValue56 = this.LifeSkillCombatCurrentPlayerGetUsableOperationList(context, inputData2);
				result = Serializer.Serialize(returnValue56, returnDataPool);
				break;
			}
			case 86:
			{
				int argsCount86 = operation.ArgsCount;
				int num86 = argsCount86;
				if (num86 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] returnValue57 = this.LifeSkillCombatCurrentPlayerSimulateCancelOperation(context);
				result = Serializer.Serialize(returnValue57, returnDataPool);
				break;
			}
			case 87:
			{
				int argsCount87 = operation.ArgsCount;
				int num87 = argsCount87;
				if (num87 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] inputData3 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref inputData3);
				byte[] returnValue58 = this.LifeSkillCombatCurrentPlayerGetSecondPhaseUsableOperationList(context, inputData3);
				result = Serializer.Serialize(returnValue58, returnDataPool);
				break;
			}
			case 88:
			{
				int argsCount88 = operation.ArgsCount;
				int num88 = argsCount88;
				if (num88 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte effectCardTemplateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref effectCardTemplateId);
				byte[] returnValue59 = this.LifeSkillCombatCurrentPlayerCalcUsableFirstPhaseEffectCardInfo(context, effectCardTemplateId);
				result = Serializer.Serialize(returnValue59, returnDataPool);
				break;
			}
			case 89:
			{
				int argsCount89 = operation.ArgsCount;
				int num89 = argsCount89;
				if (num89 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] data2 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref data2);
				byte[] returnValue60 = this.LifeSkillCombatCurrentPlayerSimulateCommitOperation(context, data2);
				result = Serializer.Serialize(returnValue60, returnDataPool);
				break;
			}
			case 90:
			{
				int argsCount90 = operation.ArgsCount;
				int num90 = argsCount90;
				if (num90 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] operationListData = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref operationListData);
				byte[] returnValue61 = this.LifeSkillCombatCurrentPlayerAiPickOperation(context, operationListData);
				result = Serializer.Serialize(returnValue61, returnDataPool);
				break;
			}
			case 91:
			{
				int argsCount91 = operation.ArgsCount;
				int num91 = argsCount91;
				if (num91 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] data3 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref data3);
				byte[] returnValue62 = this.LifeSkillCombatCurrentPlayerCommitOperationPreview(context, data3);
				result = Serializer.Serialize(returnValue62, returnDataPool);
				break;
			}
			case 92:
			{
				int argsCount92 = operation.ArgsCount;
				int num92 = argsCount92;
				if (num92 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				byte[] returnValue63 = this.LifeSkillCombatCurrentPlayerAcceptForceSilent(context);
				result = Serializer.Serialize(returnValue63, returnDataPool);
				break;
			}
			case 93:
			{
				int argsCount93 = operation.ArgsCount;
				int num93 = argsCount93;
				if (num93 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillTemplateId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillTemplateId4);
				bool returnValue64 = this.MasteredSkillWillChangePlan(skillTemplateId4);
				result = Serializer.Serialize(returnValue64, returnDataPool);
				break;
			}
			case 94:
				switch (operation.ArgsCount)
				{
				case 0:
				{
					List<int> returnValue65 = this.GetVillagersForWork(false, false);
					result = Serializer.Serialize(returnValue65, returnDataPool);
					break;
				}
				case 1:
				{
					bool includeUnlockedWorkingVillagers = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref includeUnlockedWorkingVillagers);
					List<int> returnValue66 = this.GetVillagersForWork(includeUnlockedWorkingVillagers, false);
					result = Serializer.Serialize(returnValue66, returnDataPool);
					break;
				}
				case 2:
				{
					bool includeUnlockedWorkingVillagers2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref includeUnlockedWorkingVillagers2);
					bool farmerFirst = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref farmerFirst);
					List<int> returnValue67 = this.GetVillagersForWork(includeUnlockedWorkingVillagers2, farmerFirst);
					result = Serializer.Serialize(returnValue67, returnDataPool);
					break;
				}
				default:
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				}
				break;
			case 95:
			{
				int argsCount94 = operation.ArgsCount;
				int num94 = argsCount94;
				if (num94 != 0)
				{
					if (num94 != 1)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					bool includeTaiwu = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref includeTaiwu);
					List<NameRelatedData> returnValue68 = this.GetSeverelyInjuredGroupCharNames(includeTaiwu);
					result = Serializer.Serialize(returnValue68, returnDataPool);
				}
				else
				{
					List<NameRelatedData> returnValue69 = this.GetSeverelyInjuredGroupCharNames(false);
					result = Serializer.Serialize(returnValue69, returnDataPool);
				}
				break;
			}
			case 96:
			{
				int argsCount95 = operation.ArgsCount;
				int num95 = argsCount95;
				if (num95 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte itemType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemType);
				short itemTemplateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemTemplateId);
				int returnValue70 = this.GetItemCount(itemType, itemTemplateId);
				result = Serializer.Serialize(returnValue70, returnDataPool);
				break;
			}
			case 97:
			{
				int argsCount96 = operation.ArgsCount;
				int num96 = argsCount96;
				if (num96 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				MapBlockData returnValue71 = this.GetTaiwuVillagerMapBlockData();
				result = Serializer.Serialize(returnValue71, returnDataPool);
				break;
			}
			case 98:
			{
				int argsCount97 = operation.ArgsCount;
				int num97 = argsCount97;
				if (num97 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short areaId7 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId7);
				short blockId7 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId7);
				sbyte workType2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref workType2);
				bool removeUnlockedState = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref removeUnlockedState);
				bool returnValue72 = this.StopVillagerWorkOptional(context, areaId7, blockId7, workType2, removeUnlockedState);
				result = Serializer.Serialize(returnValue72, returnDataPool);
				break;
			}
			case 99:
			{
				int argsCount98 = operation.ArgsCount;
				int num98 = argsCount98;
				if (num98 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short legacyType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref legacyType);
				int returnValue73 = this.GetLegacyMaxPointByType(legacyType);
				result = Serializer.Serialize(returnValue73, returnDataPool);
				break;
			}
			case 100:
			{
				int argsCount99 = operation.ArgsCount;
				int num99 = argsCount99;
				if (num99 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool returnValue74 = this.GetCurrReadingBanByWug();
				result = Serializer.Serialize(returnValue74, returnDataPool);
				break;
			}
			case 101:
			{
				int argsCount100 = operation.ArgsCount;
				int num100 = argsCount100;
				if (num100 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Location location3 = default(Location);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref location3);
				int returnValue75 = this.GetPastLifeRelationCharacterCountOnBlock(location3);
				result = Serializer.Serialize(returnValue75, returnDataPool);
				break;
			}
			case 102:
			{
				int argsCount101 = operation.ArgsCount;
				int num101 = argsCount101;
				if (num101 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.GmCmd_MarkAllCarrierFullTamePoint(context);
				result = -1;
				break;
			}
			case 103:
			{
				int argsCount102 = operation.ArgsCount;
				int num102 = argsCount102;
				if (num102 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Location location4 = default(Location);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref location4);
				int returnValue76 = this.GetSelectMapBlockHasMerchantId(context, location4);
				result = Serializer.Serialize(returnValue76, returnDataPool);
				break;
			}
			case 104:
			{
				int argsCount103 = operation.ArgsCount;
				int num103 = argsCount103;
				if (num103 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte playerId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref playerId);
				bool active = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref active);
				this.GmCmd_LifeSkillCombatAiSetAlwaysUseForceAdversary(context, playerId, active);
				result = -1;
				break;
			}
			case 105:
			{
				int argsCount104 = operation.ArgsCount;
				int num104 = argsCount104;
				if (num104 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.ActiveReadOnce(context);
				result = -1;
				break;
			}
			case 106:
			{
				int argsCount105 = operation.ArgsCount;
				int num105 = argsCount105;
				if (num105 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.ActiveNeigongLoopingOnce(context);
				result = -1;
				break;
			}
			case 107:
			{
				int argsCount106 = operation.ArgsCount;
				int num106 = argsCount106;
				if (num106 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.AppendCombatSkillPlan(context);
				result = -1;
				break;
			}
			case 108:
			{
				int argsCount107 = operation.ArgsCount;
				int num107 = argsCount107;
				if (num107 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.CopyCombatSkillPlan(context);
				result = -1;
				break;
			}
			case 109:
			{
				int argsCount108 = operation.ArgsCount;
				int num108 = argsCount108;
				if (num108 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.ClearCombatSkillPlan(context);
				result = -1;
				break;
			}
			case 110:
			{
				int argsCount109 = operation.ArgsCount;
				int num109 = argsCount109;
				if (num109 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.DeleteCombatSkillPlan(context);
				result = -1;
				break;
			}
			case 111:
			{
				int argsCount110 = operation.ArgsCount;
				int num110 = argsCount110;
				if (num110 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short legacyType2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref legacyType2);
				List<IntList> returnValue77 = this.GetLegacyMaxPointAndTimesListByType(legacyType2);
				result = Serializer.Serialize(returnValue77, returnDataPool);
				break;
			}
			case 112:
			{
				int argsCount111 = operation.ArgsCount;
				int num111 = argsCount111;
				if (num111 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index4);
				sbyte templateId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref templateId2);
				this.SetQiArtStrategy(context, index4, templateId2);
				result = -1;
				break;
			}
			case 113:
			{
				int argsCount112 = operation.ArgsCount;
				int num112 = argsCount112;
				if (num112 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<sbyte> returnValue78 = this.GetCurrentBookAvailableReadingStrategies(context);
				result = Serializer.Serialize(returnValue78, returnDataPool);
				break;
			}
			case 114:
			{
				int argsCount113 = operation.ArgsCount;
				int num113 = argsCount113;
				if (num113 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				SByteList returnValue79 = this.GetLoopingNeigongQiArtStrategies(context);
				result = Serializer.Serialize(returnValue79, returnDataPool);
				break;
			}
			case 115:
			{
				int argsCount114 = operation.ArgsCount;
				int num114 = argsCount114;
				if (num114 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index5);
				short combatSkillTemplateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref combatSkillTemplateId);
				this.SetReferenceCombatSkillAt(context, index5, combatSkillTemplateId);
				result = -1;
				break;
			}
			case 116:
			{
				int argsCount115 = operation.ArgsCount;
				int num115 = argsCount115;
				if (num115 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<QiArtStrategyDisplayData> returnValue80 = this.GetLoopingNeigongQiArtStrategyDisplayDatas(context);
				result = Serializer.Serialize(returnValue80, returnDataPool);
				break;
			}
			case 117:
			{
				int argsCount116 = operation.ArgsCount;
				int num116 = argsCount116;
				if (num116 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				SByteList returnValue81 = this.GetLoopingNeigongAvailableQiArtStrategies(context);
				result = Serializer.Serialize(returnValue81, returnDataPool);
				break;
			}
			case 118:
			{
				int argsCount117 = operation.ArgsCount;
				int num117 = argsCount117;
				if (num117 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.ClearCurrentLoopingNeigongEvent(context);
				result = -1;
				break;
			}
			case 119:
			{
				int argsCount118 = operation.ArgsCount;
				int num118 = argsCount118;
				if (num118 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short combatSkillTemplateId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref combatSkillTemplateId2);
				this.SetTaiwuLoopingNeigong(context, combatSkillTemplateId2);
				result = -1;
				break;
			}
			case 120:
			{
				int argsCount119 = operation.ArgsCount;
				int num119 = argsCount119;
				if (num119 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short featureId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref featureId);
				this.DeleteTaiwuFeature(context, featureId);
				result = -1;
				break;
			}
			case 121:
			{
				int argsCount120 = operation.ArgsCount;
				int num120 = argsCount120;
				if (num120 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.GmCmd_TaiwuActiveLoopingApply(context);
				result = -1;
				break;
			}
			case 122:
			{
				int argsCount121 = operation.ArgsCount;
				int num121 = argsCount121;
				if (num121 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool returnValue82 = this.GetIsFollowingNpcListMax();
				result = Serializer.Serialize(returnValue82, returnDataPool);
				break;
			}
			case 123:
			{
				int argsCount122 = operation.ArgsCount;
				int num122 = argsCount122;
				if (num122 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int returnValue83 = this.GetFollowingNpcListMaxCount();
				result = Serializer.Serialize(returnValue83, returnDataPool);
				break;
			}
			case 124:
			{
				int argsCount123 = operation.ArgsCount;
				int num123 = argsCount123;
				if (num123 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int count5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref count5);
				this.GmCmd_FollowRandomNpc(context, count5);
				result = -1;
				break;
			}
			case 125:
			{
				int argsCount124 = operation.ArgsCount;
				int num124 = argsCount124;
				if (num124 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int npcId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref npcId);
				this.TaiwuFollowNpc(context, npcId);
				result = -1;
				break;
			}
			case 126:
			{
				int argsCount125 = operation.ArgsCount;
				int num125 = argsCount125;
				if (num125 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId3);
				this.TaiwuUnfollowNpc(context, characterId3);
				result = -1;
				break;
			}
			case 127:
			{
				int argsCount126 = operation.ArgsCount;
				int num126 = argsCount126;
				if (num126 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId4);
				string nickName = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref nickName);
				int returnValue84 = this.SetFollowingNpcNickName(context, characterId4, nickName);
				result = Serializer.Serialize(returnValue84, returnDataPool);
				break;
			}
			case 128:
			{
				int argsCount127 = operation.ArgsCount;
				int num127 = argsCount127;
				if (num127 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId5);
				string returnValue85 = this.GetFollowingNpcNickName(characterId5);
				result = Serializer.Serialize(returnValue85, returnDataPool);
				break;
			}
			case 129:
			{
				int argsCount128 = operation.ArgsCount;
				int num128 = argsCount128;
				if (num128 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId6 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId6);
				int returnValue86 = this.GetFollowingNpcNickNameId(characterId6);
				result = Serializer.Serialize(returnValue86, returnDataPool);
				break;
			}
			case 130:
			{
				int argsCount129 = operation.ArgsCount;
				int num129 = argsCount129;
				if (num129 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<int> characterIdList = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterIdList);
				List<VillagerRoleCharacterDisplayData> returnValue87 = this.GetVillagerRoleCharacterDisplayDataList(characterIdList);
				result = Serializer.Serialize(returnValue87, returnDataPool);
				break;
			}
			case 131:
			{
				int argsCount130 = operation.ArgsCount;
				int num130 = argsCount130;
				if (num130 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId7 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId7);
				VillagerRoleCharacterDisplayData returnValue88 = this.GetVillagerRoleCharacterDisplayData(characterId7);
				result = Serializer.Serialize(returnValue88, returnDataPool);
				break;
			}
			case 132:
			{
				int argsCount131 = operation.ArgsCount;
				int num131 = argsCount131;
				if (num131 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<int> characterIdList2 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterIdList2);
				short roleTemplateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref roleTemplateId);
				bool returnValue89 = this.BatchSetVillagerRole(context, characterIdList2, roleTemplateId);
				result = Serializer.Serialize(returnValue89, returnDataPool);
				break;
			}
			case 133:
			{
				int argsCount132 = operation.ArgsCount;
				int num132 = argsCount132;
				if (num132 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId8 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId8);
				short arrangementTemplateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref arrangementTemplateId);
				Location location5 = default(Location);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref location5);
				bool returnValue90 = this.DispatchVillagerArrangement(context, characterId8, arrangementTemplateId, location5);
				result = Serializer.Serialize(returnValue90, returnDataPool);
				break;
			}
			case 134:
			{
				int argsCount133 = operation.ArgsCount;
				int num133 = argsCount133;
				if (num133 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId9 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId9);
				bool returnValue91 = this.RecallVillager(context, characterId9);
				result = Serializer.Serialize(returnValue91, returnDataPool);
				break;
			}
			case 135:
			{
				int argsCount134 = operation.ArgsCount;
				int num134 = argsCount134;
				if (num134 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId10 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId10);
				TemplateKey targetItem = default(TemplateKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref targetItem);
				bool returnValue92 = this.AssignTargetItem(context, characterId10, targetItem);
				result = Serializer.Serialize(returnValue92, returnDataPool);
				break;
			}
			case 136:
			{
				int argsCount135 = operation.ArgsCount;
				int num135 = argsCount135;
				if (num135 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short roleTemplateId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref roleTemplateId2);
				VillagerRoleManageDisplayData returnValue93 = this.GetVillagerRoleDisplayData(roleTemplateId2);
				result = Serializer.Serialize(returnValue93, returnDataPool);
				break;
			}
			case 137:
			{
				int argsCount136 = operation.ArgsCount;
				int num136 = argsCount136;
				if (num136 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId11 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId11);
				bool isIncrease = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isIncrease);
				bool returnValue94 = this.AssignArrangementIncreaseOrDecrease(context, characterId11, isIncrease);
				result = Serializer.Serialize(returnValue94, returnDataPool);
				break;
			}
			case 138:
			{
				int argsCount137 = operation.ArgsCount;
				int num137 = argsCount137;
				if (num137 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<VillagerRoleManageDisplayData> returnValue95 = this.GetAllVillagerRoleDisplayData();
				result = Serializer.Serialize(returnValue95, returnDataPool);
				break;
			}
			case 139:
			{
				int argsCount138 = operation.ArgsCount;
				int num138 = argsCount138;
				if (num138 != 1)
				{
					if (num138 != 2)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					ItemSourceType itemSourceType = ItemSourceType.Equipment;
					argsOffset += Serializer.DeserializeDefault<ItemSourceType>(argDataPool, argsOffset, ref itemSourceType);
					bool includeResources = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref includeResources);
					ValueTuple<ItemSourceType, List<ItemDisplayData>> returnValue96 = this.GetAllItems(itemSourceType, includeResources);
					result = Serializer.Serialize(returnValue96, returnDataPool);
				}
				else
				{
					ItemSourceType itemSourceType2 = ItemSourceType.Equipment;
					argsOffset += Serializer.DeserializeDefault<ItemSourceType>(argDataPool, argsOffset, ref itemSourceType2);
					ValueTuple<ItemSourceType, List<ItemDisplayData>> returnValue97 = this.GetAllItems(itemSourceType2, false);
					result = Serializer.Serialize(returnValue97, returnDataPool);
				}
				break;
			}
			case 140:
			{
				int argsCount139 = operation.ArgsCount;
				int num139 = argsCount139;
				if (num139 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemSourceType srcType = ItemSourceType.Equipment;
				argsOffset += Serializer.DeserializeDefault<ItemSourceType>(argDataPool, argsOffset, ref srcType);
				ItemSourceType destType = ItemSourceType.Equipment;
				argsOffset += Serializer.DeserializeDefault<ItemSourceType>(argDataPool, argsOffset, ref destType);
				sbyte resourceType3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref resourceType3);
				int amount8 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref amount8);
				bool returnValue98 = this.TransferResource(context, srcType, destType, resourceType3, amount8);
				result = Serializer.Serialize(returnValue98, returnDataPool);
				break;
			}
			case 141:
			{
				int argsCount140 = operation.ArgsCount;
				int num140 = argsCount140;
				if (num140 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short roleTemplateId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref roleTemplateId3);
				VillagerRoleTipsDisplayData returnValue99 = this.GetVillagerRoleTipsDisplayData(context, roleTemplateId3);
				result = Serializer.Serialize(returnValue99, returnDataPool);
				break;
			}
			case 142:
			{
				int argsCount141 = operation.ArgsCount;
				int num141 = argsCount141;
				if (num141 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId12 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId12);
				short roleTemplateId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref roleTemplateId4);
				bool returnValue100 = this.SetVillagerRole(context, charId12, roleTemplateId4);
				result = Serializer.Serialize(returnValue100, returnDataPool);
				break;
			}
			case 143:
			{
				int argsCount142 = operation.ArgsCount;
				int num142 = argsCount142;
				if (num142 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId13 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId13);
				short areaId8 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId8);
				short blockId8 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId8);
				sbyte resourceType4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref resourceType4);
				bool returnValue101 = this.SetVillagerMigrateWork(context, charId13, areaId8, blockId8, resourceType4);
				result = Serializer.Serialize(returnValue101, returnDataPool);
				break;
			}
			case 144:
			{
				int argsCount143 = operation.ArgsCount;
				int num143 = argsCount143;
				if (num143 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short roleTemplateId5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref roleTemplateId5);
				string returnValue102 = this.GetVillagerRoleNpcNickName(roleTemplateId5);
				result = Serializer.Serialize(returnValue102, returnDataPool);
				break;
			}
			case 145:
			{
				int argsCount144 = operation.ArgsCount;
				int num144 = argsCount144;
				if (num144 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short roleTemplateId6 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref roleTemplateId6);
				string nickName2 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref nickName2);
				int returnValue103 = this.SetVillagerRoleNickName(context, roleTemplateId6, nickName2);
				result = Serializer.Serialize(returnValue103, returnDataPool);
				break;
			}
			case 146:
			{
				int argsCount145 = operation.ArgsCount;
				int num145 = argsCount145;
				if (num145 != 0)
				{
					if (num145 != 1)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					bool removeTaiwuGroup = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref removeTaiwuGroup);
					List<int> returnValue104 = this.GetVillagersAvailableForVillagerRole(removeTaiwuGroup);
					result = Serializer.Serialize(returnValue104, returnDataPool);
				}
				else
				{
					List<int> returnValue105 = this.GetVillagersAvailableForVillagerRole(true);
					result = Serializer.Serialize(returnValue105, returnDataPool);
				}
				break;
			}
			case 147:
			{
				int argsCount146 = operation.ArgsCount;
				int num146 = argsCount146;
				if (num146 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemSourceType itemSourceType3 = ItemSourceType.Equipment;
				argsOffset += Serializer.DeserializeDefault<ItemSourceType>(argDataPool, argsOffset, ref itemSourceType3);
				ValueTuple<ItemSourceType, ResourceInts> returnValue106 = this.GetAllResources(itemSourceType3);
				result = Serializer.Serialize(returnValue106, returnDataPool);
				break;
			}
			case 148:
			{
				int argsCount147 = operation.ArgsCount;
				int num147 = argsCount147;
				if (num147 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<DispatchSwordTombDisplayData> returnValue107 = this.GetAllSwordTombDisplayDataForDispatch();
				result = Serializer.Serialize(returnValue107, returnDataPool);
				break;
			}
			case 149:
			{
				int argsCount148 = operation.ArgsCount;
				int num148 = argsCount148;
				if (num148 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId12 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId12);
				VillagerRoleCharacterSlimDisplayData returnValue108 = this.GetVillagerRoleCharacterSlimDisplayData(characterId12);
				result = Serializer.Serialize(returnValue108, returnDataPool);
				break;
			}
			case 150:
			{
				int argsCount149 = operation.ArgsCount;
				int num149 = argsCount149;
				if (num149 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemDisplayData> returnValue109 = this.GetAllWarehouseItemsExcludeValueZero(context);
				result = Serializer.Serialize(returnValue109, returnDataPool);
				break;
			}
			case 151:
			{
				int argsCount150 = operation.ArgsCount;
				int num150 = argsCount150;
				if (num150 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short templateId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref templateId3);
				this.GmCmd_FillLegacyPoint(context, templateId3);
				result = -1;
				break;
			}
			case 152:
			{
				int argsCount151 = operation.ArgsCount;
				int num151 = argsCount151;
				if (num151 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				TaiwuVillageStorageType storageType = TaiwuVillageStorageType.Treasury;
				argsOffset += Serializer.DeserializeDefault<TaiwuVillageStorageType>(argDataPool, argsOffset, ref storageType);
				VillagerRoleActionSetting setting = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref setting);
				this.SetVillagerRoleActionSetting(context, storageType, setting);
				result = -1;
				break;
			}
			case 153:
			{
				int argsCount152 = operation.ArgsCount;
				int num152 = argsCount152;
				if (num152 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				TaiwuVillageStorageType storageType2 = TaiwuVillageStorageType.Treasury;
				argsOffset += Serializer.DeserializeDefault<TaiwuVillageStorageType>(argDataPool, argsOffset, ref storageType2);
				VillagerRoleActionSetting returnValue110 = this.GetVillagerRoleActionSetting(context, storageType2);
				result = Serializer.Serialize(returnValue110, returnDataPool);
				break;
			}
			case 154:
			{
				int argsCount153 = operation.ArgsCount;
				int num153 = argsCount153;
				if (num153 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Dictionary<sbyte, VillagerRoleActionSetting> returnValue111 = this.GetAllVillagerRoleActionSetting(context);
				result = Serializer.SerializeDefault<Dictionary<sbyte, VillagerRoleActionSetting>>(returnValue111, returnDataPool);
				break;
			}
			case 155:
			{
				int argsCount154 = operation.ArgsCount;
				int num154 = argsCount154;
				if (num154 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short villagerRoleTemplateId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref villagerRoleTemplateId);
				sbyte fixedActionType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref fixedActionType);
				List<sbyte> returnValue112 = this.GetVillagerRoleExecuteFixedActionFailReasons(context, villagerRoleTemplateId, fixedActionType);
				result = Serializer.Serialize(returnValue112, returnDataPool);
				break;
			}
			case 156:
			{
				int argsCount155 = operation.ArgsCount;
				int num155 = argsCount155;
				if (num155 != 2)
				{
					if (num155 != 3)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					int characterId13 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId13);
					sbyte merchantType = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref merchantType);
					bool immediate = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref immediate);
					this.SetMerchantType(context, characterId13, merchantType, immediate);
					result = -1;
				}
				else
				{
					int characterId14 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId14);
					sbyte merchantType2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref merchantType2);
					this.SetMerchantType(context, characterId14, merchantType2, false);
					result = -1;
				}
				break;
			}
			case 157:
			{
				int argsCount156 = operation.ArgsCount;
				int num156 = argsCount156;
				if (num156 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId15 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId15);
				sbyte returnValue113 = this.GetMerchantType(characterId15);
				result = Serializer.Serialize(returnValue113, returnDataPool);
				break;
			}
			case 158:
			{
				int argsCount157 = operation.ArgsCount;
				int num157 = argsCount157;
				if (num157 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int professionId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref professionId);
				ProfessionTipDisplayData returnValue114 = this.GetProfessionTipDisplayData(professionId);
				result = Serializer.Serialize(returnValue114, returnDataPool);
				break;
			}
			case 159:
			{
				int argsCount158 = operation.ArgsCount;
				int num158 = argsCount158;
				if (num158 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isInBattle = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isInBattle);
				int remainingSpeedPercent = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref remainingSpeedPercent);
				int returnValue115 = this.GetExpByRereading(isInBattle, remainingSpeedPercent);
				result = Serializer.Serialize(returnValue115, returnDataPool);
				break;
			}
			case 160:
			{
				int argsCount159 = operation.ArgsCount;
				int num159 = argsCount159;
				if (num159 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.EnterMerchant();
				result = -1;
				break;
			}
			case 161:
			{
				int argsCount160 = operation.ArgsCount;
				int num160 = argsCount160;
				if (num160 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int[] returnValue116 = this.GetReadingResult();
				result = Serializer.Serialize(returnValue116, returnDataPool);
				break;
			}
			case 162:
			{
				int argsCount161 = operation.ArgsCount;
				int num161 = argsCount161;
				if (num161 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId14 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId14);
				VillagerTreasuryNeed returnValue117 = this.GetVillagerTreasuryNeed(charId14);
				result = Serializer.Serialize(returnValue117, returnDataPool);
				break;
			}
			case 163:
			{
				int argsCount162 = operation.ArgsCount;
				int num162 = argsCount162;
				if (num162 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				Dictionary<int, sbyte> returnValue118 = this.GetVillagerClassesDict();
				result = Serializer.SerializeDefault<Dictionary<int, sbyte>>(returnValue118, returnDataPool);
				break;
			}
			case 164:
			{
				int argsCount163 = operation.ArgsCount;
				int num163 = argsCount163;
				if (num163 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<int>[] returnValue119 = this.GetVillagerListClassArray();
				result = Serializer.SerializeDefault<List<int>[]>(returnValue119, returnDataPool);
				break;
			}
			case 165:
			{
				int argsCount164 = operation.ArgsCount;
				int num164 = argsCount164;
				if (num164 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ItemKey itemKey10 = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey10);
				Dictionary<int, sbyte> returnValue120 = this.GetTreasuryItemNeededCharDict(itemKey10);
				result = Serializer.SerializeDefault<Dictionary<int, sbyte>>(returnValue120, returnDataPool);
				break;
			}
			case 166:
			{
				int argsCount165 = operation.ArgsCount;
				int num165 = argsCount165;
				if (num165 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<ItemKey> returnValue121 = this.GetTreasuryNeededItemList();
				result = Serializer.Serialize(returnValue121, returnDataPool);
				break;
			}
			case 167:
			{
				int argsCount166 = operation.ArgsCount;
				int num166 = argsCount166;
				if (num166 != 0)
				{
					if (num166 != 1)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					bool includeTaiwu2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref includeTaiwu2);
					List<NameRelatedData> returnValue122 = this.GetDyingGroupCharNames(includeTaiwu2);
					result = Serializer.Serialize(returnValue122, returnDataPool);
				}
				else
				{
					List<NameRelatedData> returnValue123 = this.GetDyingGroupCharNames(false);
					result = Serializer.Serialize(returnValue123, returnDataPool);
				}
				break;
			}
			case 168:
			{
				int argsCount167 = operation.ArgsCount;
				int num167 = argsCount167;
				if (num167 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId5);
				int returnValue124 = this.GetBreakBaseCostExp(skillId5);
				result = Serializer.Serialize(returnValue124, returnDataPool);
				break;
			}
			case 169:
			{
				int argsCount168 = operation.ArgsCount;
				int num168 = argsCount168;
				if (num168 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId6 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId6);
				SkillBreakPlateIndex index6 = default(SkillBreakPlateIndex);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index6);
				int charId15 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId15);
				ushort relationType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref relationType);
				SkillBreakPlate returnValue125 = this.SetBonusRelation(context, skillId6, index6, charId15, relationType);
				result = Serializer.Serialize(returnValue125, returnDataPool);
				break;
			}
			case 170:
			{
				int argsCount169 = operation.ArgsCount;
				int num169 = argsCount169;
				if (num169 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId7 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId7);
				SkillBreakPlateIndex index7 = default(SkillBreakPlateIndex);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index7);
				int expLevel = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref expLevel);
				SkillBreakPlate returnValue126 = this.SetBonusExp(context, skillId7, index7, expLevel);
				result = Serializer.Serialize(returnValue126, returnDataPool);
				break;
			}
			case 171:
			{
				int argsCount170 = operation.ArgsCount;
				int num170 = argsCount170;
				if (num170 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId8 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId8);
				SkillBreakPlateIndex index8 = default(SkillBreakPlateIndex);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index8);
				ItemKey itemKey11 = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemKey11);
				sbyte itemSourceType4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref itemSourceType4);
				SkillBreakPlate returnValue127 = this.SetBonusItem(context, skillId8, index8, itemKey11, itemSourceType4);
				result = Serializer.Serialize(returnValue127, returnDataPool);
				break;
			}
			case 172:
			{
				int argsCount171 = operation.ArgsCount;
				int num171 = argsCount171;
				if (num171 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId9 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId9);
				byte pageId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref pageId);
				sbyte direction = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref direction);
				bool returnValue128 = this.SetActivePage(context, skillId9, pageId, direction);
				result = Serializer.Serialize(returnValue128, returnDataPool);
				break;
			}
			case 173:
			{
				int argsCount172 = operation.ArgsCount;
				int num172 = argsCount172;
				if (num172 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId10 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId10);
				List<SkillBreakPlateBonus> returnValue129 = this.GetAvailableRelationBonuses(skillId10);
				result = Serializer.Serialize(returnValue129, returnDataPool);
				break;
			}
			case 174:
			{
				int argsCount173 = operation.ArgsCount;
				int num173 = argsCount173;
				if (num173 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId16 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId16);
				sbyte returnValue130 = this.GetVillagerCollectStorageType(context, charId16);
				result = Serializer.Serialize(returnValue130, returnDataPool);
				break;
			}
			case 175:
			{
				int argsCount174 = operation.ArgsCount;
				int num174 = argsCount174;
				if (num174 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId17 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId17);
				sbyte villagerRoleStorageType = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref villagerRoleStorageType);
				bool returnValue131 = this.SetVillagerCollectStorageType(context, charId17, villagerRoleStorageType);
				result = Serializer.Serialize(returnValue131, returnDataPool);
				break;
			}
			case 176:
			{
				int argsCount175 = operation.ArgsCount;
				int num175 = argsCount175;
				if (num175 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId11 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId11);
				SkillBreakPlateIndex index9 = default(SkillBreakPlateIndex);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index9);
				SkillBreakPlate returnValue132 = this.ClearBonus(context, skillId11, index9);
				result = Serializer.Serialize(returnValue132, returnDataPool);
				break;
			}
			case 177:
			{
				int argsCount176 = operation.ArgsCount;
				int num176 = argsCount176;
				if (num176 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short featureId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref featureId2);
				this.TaiwuAddFeature(context, featureId2);
				result = -1;
				break;
			}
			case 178:
			{
				int argsCount177 = operation.ArgsCount;
				int num177 = argsCount177;
				if (num177 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte groupId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref groupId);
				int count6 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref count6);
				List<short> returnValue133 = this.GetRandomLegaciesInGroup(context, groupId, count6);
				result = Serializer.Serialize(returnValue133, returnDataPool);
				break;
			}
			case 179:
			{
				int argsCount178 = operation.ArgsCount;
				int num178 = argsCount178;
				if (num178 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int returnValue134 = this.GetGroupBabyCount();
				result = Serializer.Serialize(returnValue134, returnDataPool);
				break;
			}
			case 180:
			{
				int argsCount179 = operation.ArgsCount;
				int num179 = argsCount179;
				if (num179 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int returnValue135 = TaiwuDomain.GetStrategyRoomLevel();
				result = Serializer.Serialize(returnValue135, returnDataPool);
				break;
			}
			case 181:
			{
				int argsCount180 = operation.ArgsCount;
				int num180 = argsCount180;
				if (num180 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short skillId12 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref skillId12);
				SkillBreakPlateIndex index10 = default(SkillBreakPlateIndex);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index10);
				int charId18 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId18);
				SkillBreakPlate returnValue136 = this.SetBonusFriend(context, skillId12, index10, charId18);
				result = Serializer.Serialize(returnValue136, returnDataPool);
				break;
			}
			case 182:
			{
				int argsCount181 = operation.ArgsCount;
				int num181 = argsCount181;
				if (num181 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short start = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref start);
				short end = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref end);
				this.GmCmd_ShowUnlockedDebateStrategy(start, end);
				result = -1;
				break;
			}
			case 183:
			{
				int argsCount182 = operation.ArgsCount;
				int num182 = argsCount182;
				if (num182 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwu = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu);
				int delta = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref delta);
				this.GmCmd_ChangeGamePoint(isTaiwu, delta);
				result = -1;
				break;
			}
			case 184:
			{
				int argsCount183 = operation.ArgsCount;
				int num183 = argsCount183;
				if (num183 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool value2 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref value2);
				this.GmCmd_SetForceAiBribery(value2);
				result = -1;
				break;
			}
			case 185:
			{
				int argsCount184 = operation.ArgsCount;
				int num184 = argsCount184;
				if (num184 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwuWin2 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwuWin2);
				bool isSurrender = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isSurrender);
				DebateResult returnValue137 = this.DebateGameOver(context, isTaiwuWin2, isSurrender);
				result = Serializer.Serialize(returnValue137, returnDataPool);
				break;
			}
			case 186:
			{
				int argsCount185 = operation.ArgsCount;
				int num185 = argsCount185;
				if (num185 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isAi = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isAi);
				DebateGame returnValue138 = this.DebateGameSetTaiwuAi(context, isAi);
				result = Serializer.Serialize(returnValue138, returnDataPool);
				break;
			}
			case 187:
			{
				int argsCount186 = operation.ArgsCount;
				int num186 = argsCount186;
				if (num186 != 3)
				{
					if (num186 != 4)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					IntPair coordinate = default(IntPair);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref coordinate);
					bool isTaiwu2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu2);
					sbyte grade = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref grade);
					bool countAsMakeMove = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref countAsMakeMove);
					DebateGame returnValue139 = this.DebateGameMakeMove(context, coordinate, isTaiwu2, grade, countAsMakeMove);
					result = Serializer.Serialize(returnValue139, returnDataPool);
				}
				else
				{
					IntPair coordinate2 = default(IntPair);
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref coordinate2);
					bool isTaiwu3 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu3);
					sbyte grade2 = 0;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref grade2);
					DebateGame returnValue140 = this.DebateGameMakeMove(context, coordinate2, isTaiwu3, grade2, true);
					result = Serializer.Serialize(returnValue140, returnDataPool);
				}
				break;
			}
			case 188:
			{
				int argsCount187 = operation.ArgsCount;
				int num187 = argsCount187;
				if (num187 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				DebateGame returnValue141 = this.DebateGameNextState(context);
				result = Serializer.Serialize(returnValue141, returnDataPool);
				break;
			}
			case 189:
			{
				int argsCount188 = operation.ArgsCount;
				int num188 = argsCount188;
				if (num188 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte lifeSkillType2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref lifeSkillType2);
				int npcId2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref npcId2);
				bool isTaiwu4 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu4);
				List<int> spectatorIds = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref spectatorIds);
				List<int> returnValue142 = this.DebateGamePickSpectators(context, lifeSkillType2, npcId2, isTaiwu4, spectatorIds);
				result = Serializer.Serialize(returnValue142, returnDataPool);
				break;
			}
			case 190:
			{
				int argsCount189 = operation.ArgsCount;
				int num189 = argsCount189;
				if (num189 != 4)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				sbyte type2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref type2);
				bool isTaiwuFirst = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwuFirst);
				int npcId3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref npcId3);
				List<int> spectatorIds2 = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref spectatorIds2);
				DebateGame returnValue143 = this.DebateGameInitialize(context, type2, isTaiwuFirst, npcId3, spectatorIds2);
				result = Serializer.Serialize(returnValue143, returnDataPool);
				break;
			}
			case 191:
			{
				int argsCount190 = operation.ArgsCount;
				int num190 = argsCount190;
				if (num190 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId19 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId19);
				OperationForceAdversary returnValue144 = this.GetAiBriberyDataOnPrepareLifeSkillCombat(context, charId19);
				result = Serializer.Serialize(returnValue144, returnDataPool);
				break;
			}
			case 192:
			{
				int argsCount191 = operation.ArgsCount;
				int num191 = argsCount191;
				if (num191 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index11 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index11);
				bool isCastedByTaiwu = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isCastedByTaiwu);
				List<StrategyTarget> strategyTargets = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref strategyTargets);
				DebateGame returnValue145 = this.DebateGameCastStrategy(context, index11, isCastedByTaiwu, strategyTargets);
				result = Serializer.Serialize(returnValue145, returnDataPool);
				break;
			}
			case 193:
			{
				int argsCount192 = operation.ArgsCount;
				int num192 = argsCount192;
				if (num192 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int id = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref id);
				this.GmCmd_GetDebateStrategyCard(id);
				result = -1;
				break;
			}
			case 194:
			{
				int argsCount193 = operation.ArgsCount;
				int num193 = argsCount193;
				if (num193 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwu5 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu5);
				int delta2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref delta2);
				this.GmCmd_ChangeStrategyPoint(isTaiwu5, delta2);
				result = -1;
				break;
			}
			case 195:
			{
				int argsCount194 = operation.ArgsCount;
				int num194 = argsCount194;
				if (num194 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwu6 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu6);
				int delta3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref delta3);
				this.GmCmd_ChangeBases(isTaiwu6, delta3);
				result = -1;
				break;
			}
			case 196:
			{
				int argsCount195 = operation.ArgsCount;
				int num195 = argsCount195;
				if (num195 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<short> returnValue146 = this.GetNewUnlockedDebateStrategyList();
				result = Serializer.Serialize(returnValue146, returnDataPool);
				break;
			}
			case 197:
			{
				int argsCount196 = operation.ArgsCount;
				int num196 = argsCount196;
				if (num196 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwu7 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu7);
				int delta4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref delta4);
				this.GmCmd_ChangePressure(isTaiwu7, delta4);
				result = -1;
				break;
			}
			case 198:
			{
				int argsCount197 = operation.ArgsCount;
				int num197 = argsCount197;
				if (num197 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<sbyte> types = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref types);
				this.DebateGameSetTaiwuSelectedCardTypes(context, types);
				result = -1;
				break;
			}
			case 199:
			{
				int argsCount198 = operation.ArgsCount;
				int num198 = argsCount198;
				if (num198 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<sbyte> returnValue147 = this.DebateGameGetTaiwuSelectedCardTypes();
				result = Serializer.Serialize(returnValue147, returnDataPool);
				break;
			}
			case 200:
			{
				int argsCount199 = operation.ArgsCount;
				int num199 = argsCount199;
				if (num199 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int id2 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref id2);
				this.GmCmd_AddAiOwnedCard(id2);
				result = -1;
				break;
			}
			case 201:
			{
				int argsCount200 = operation.ArgsCount;
				int num200 = argsCount200;
				if (num200 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				this.GmCmd_EmptyAiOwnedCard();
				result = -1;
				break;
			}
			case 202:
			{
				int argsCount201 = operation.ArgsCount;
				int num201 = argsCount201;
				if (num201 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool returnValue148 = this.DebateGameTryForceWin(context);
				result = Serializer.Serialize(returnValue148, returnDataPool);
				break;
			}
			case 203:
			{
				int argsCount202 = operation.ArgsCount;
				int num202 = argsCount202;
				if (num202 != 5)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int charId20 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref charId20);
				short areaId9 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref areaId9);
				short blockId9 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref blockId9);
				sbyte resourceType5 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref resourceType5);
				short index12 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index12);
				bool returnValue149 = this.SetVillagerDevelopWork(context, charId20, areaId9, blockId9, resourceType5, index12);
				result = Serializer.Serialize(returnValue149, returnDataPool);
				break;
			}
			case 204:
			{
				int argsCount203 = operation.ArgsCount;
				int num203 = argsCount203;
				if (num203 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<VillagerRoleCharacterDisplayData> returnValue150 = this.GetVillagerRoleCharacterDisplayDataOnPanel(context);
				result = Serializer.Serialize(returnValue150, returnDataPool);
				break;
			}
			case 205:
			{
				int argsCount204 = operation.ArgsCount;
				int num204 = argsCount204;
				if (num204 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int npcId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref npcId4);
				int returnValue151 = this.GetIsTaiwuFirstByLuck(context, npcId4);
				result = Serializer.Serialize(returnValue151, returnDataPool);
				break;
			}
			case 206:
			{
				int argsCount205 = operation.ArgsCount;
				int num205 = argsCount205;
				if (num205 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				short templateId4 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref templateId4);
				int spectatorId = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref spectatorId);
				this.GmCmd_AddNodeEffect(context, templateId4, spectatorId);
				result = -1;
				break;
			}
			case 207:
			{
				int argsCount206 = operation.ArgsCount;
				int num206 = argsCount206;
				if (num206 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int characterId16 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref characterId16);
				ValueTuple<int, int, int> returnValue152 = this.GetVillagerFarmerMigrateResourceSuccessRateBonus(characterId16);
				result = Serializer.Serialize(returnValue152, returnDataPool);
				break;
			}
			case 208:
			{
				int argsCount207 = operation.ArgsCount;
				int num207 = argsCount207;
				if (num207 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int returnValue153 = this.GetVillagerRoleHeadTotalAuthorityCost();
				result = Serializer.Serialize(returnValue153, returnDataPool);
				break;
			}
			case 209:
			{
				int argsCount208 = operation.ArgsCount;
				int num208 = argsCount208;
				if (num208 != 0)
				{
					if (num208 != 1)
					{
						DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
						defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
						defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
						throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
					}
					bool actuallyNotOccupiedOnly2 = false;
					argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref actuallyNotOccupiedOnly2);
					List<int> returnValue154 = this.GetAllChildAvailableForWork(actuallyNotOccupiedOnly2);
					result = Serializer.Serialize(returnValue154, returnDataPool);
				}
				else
				{
					List<int> returnValue155 = this.GetAllChildAvailableForWork(false);
					result = Serializer.Serialize(returnValue155, returnDataPool);
				}
				break;
			}
			case 210:
			{
				int argsCount209 = operation.ArgsCount;
				int num209 = argsCount209;
				if (num209 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				ValueTuple<int, int, int, int> returnValue156 = this.GetTaiwuVillageSpaceLimitInfo();
				result = Serializer.Serialize(returnValue156, returnDataPool);
				break;
			}
			case 211:
			{
				int argsCount210 = operation.ArgsCount;
				int num210 = argsCount210;
				if (num210 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				List<CharacterDisplayData> returnValue157 = this.GetGroupNeiliConflictingCharDataList();
				result = Serializer.Serialize(returnValue157, returnDataPool);
				break;
			}
			case 212:
			{
				int argsCount211 = operation.ArgsCount;
				int num211 = argsCount211;
				if (num211 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwu8 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu8);
				DebateGame returnValue158 = this.DebateGameResetCards(isTaiwu8);
				result = Serializer.Serialize(returnValue158, returnDataPool);
				break;
			}
			case 213:
			{
				int argsCount212 = operation.ArgsCount;
				int num212 = argsCount212;
				if (num212 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				bool isTaiwu9 = false;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref isTaiwu9);
				List<int> removingCards = null;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref removingCards);
				DebateGame returnValue159 = this.DebateGameRemoveCards(isTaiwu9, removingCards);
				result = Serializer.Serialize(returnValue159, returnDataPool);
				break;
			}
			case 214:
			{
				int argsCount213 = operation.ArgsCount;
				int num213 = argsCount213;
				if (num213 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int value3 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref value3);
				this.SetLastCricketPlan(context, value3);
				result = -1;
				break;
			}
			case 215:
			{
				int argsCount214 = operation.ArgsCount;
				int num214 = argsCount214;
				if (num214 != 2)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index13 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index13);
				CricketCombatConfig config = default(CricketCombatConfig);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref config);
				List<ItemKey> returnValue160 = this.RequestValidCricketPlan(index13, config);
				result = Serializer.Serialize(returnValue160, returnDataPool);
				break;
			}
			case 216:
			{
				int argsCount215 = operation.ArgsCount;
				int num215 = argsCount215;
				if (num215 != 3)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index14 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index14);
				ItemKey cricket = default(ItemKey);
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref cricket);
				int cricketIndex = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref cricketIndex);
				this.SetCricketPlan(context, index14, cricket, cricketIndex);
				result = -1;
				break;
			}
			case 217:
			{
				int argsCount216 = operation.ArgsCount;
				int num216 = argsCount216;
				if (num216 != 1)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int index15 = 0;
				argsOffset += Serializer.Deserialize(argDataPool, argsOffset, ref index15);
				this.ClearCricketPlan(context, index15);
				result = -1;
				break;
			}
			case 218:
			{
				int argsCount217 = operation.ArgsCount;
				int num217 = argsCount217;
				if (num217 != 0)
				{
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(35, 1);
					defaultInterpolatedStringHandler.AppendLiteral("Unsupported argsCount of methodId: ");
					defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
					throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
				}
				int returnValue161 = this.GetLastCricketPlan();
				result = Serializer.Serialize(returnValue161, returnDataPool);
				break;
			}
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(21, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported methodId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.MethodId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
			return result;
		}

		// Token: 0x06001348 RID: 4936 RVA: 0x001336F4 File Offset: 0x001318F4
		public override void OnMonitorData(ushort dataId, ulong subId0, uint subId1, bool monitoring)
		{
			switch (dataId)
			{
			case 0:
				break;
			case 1:
				break;
			case 2:
				break;
			case 3:
				break;
			case 4:
				break;
			case 5:
				break;
			case 6:
				break;
			case 7:
				break;
			case 8:
				break;
			case 9:
				break;
			case 10:
				break;
			case 11:
				break;
			case 12:
				break;
			case 13:
				break;
			case 14:
				this._modificationsCombatSkills.ChangeRecording(monitoring);
				break;
			case 15:
				this._modificationsLifeSkills.ChangeRecording(monitoring);
				break;
			case 16:
				break;
			case 17:
				break;
			case 18:
				break;
			case 19:
				this._modificationsSkillBreakPlateObsoleteDict.ChangeRecording(monitoring);
				break;
			case 20:
				break;
			case 21:
				this._modificationsTeachTaiwuLifeSkillDict.ChangeRecording(monitoring);
				break;
			case 22:
				this._modificationsTeachTaiwuCombatSkillDict.ChangeRecording(monitoring);
				break;
			case 23:
				break;
			case 24:
				break;
			case 25:
				break;
			case 26:
				break;
			case 27:
				break;
			case 28:
				this._modificationsAppointments.ChangeRecording(monitoring);
				break;
			case 29:
				break;
			case 30:
				break;
			case 31:
				break;
			case 32:
				break;
			case 33:
				break;
			case 34:
				break;
			case 35:
				break;
			case 36:
				break;
			case 37:
				this._modificationsLegacyPointDict.ChangeRecording(monitoring);
				break;
			case 38:
				break;
			case 39:
				break;
			case 40:
				break;
			case 41:
				break;
			case 42:
				break;
			case 43:
				this._modificationsNotLearnCombatSkillReadingProgress.ChangeRecording(monitoring);
				break;
			case 44:
				this._modificationsNotLearnLifeSkillReadingProgress.ChangeRecording(monitoring);
				break;
			case 45:
				break;
			case 46:
				break;
			case 47:
				break;
			case 48:
				break;
			case 49:
				break;
			case 50:
				break;
			case 51:
				break;
			case 52:
				break;
			case 53:
				break;
			case 54:
				break;
			case 55:
				break;
			case 56:
				this._modificationsVillagerWork.ChangeRecording(monitoring);
				break;
			case 57:
				this._modificationsVillagerWorkLocations.ChangeRecording(monitoring);
				break;
			case 58:
				break;
			case 59:
				break;
			case 60:
				break;
			case 61:
				break;
			case 62:
				break;
			case 63:
				break;
			case 64:
				break;
			case 65:
				break;
			case 66:
				break;
			case 67:
				break;
			case 68:
				break;
			case 69:
				break;
			case 70:
				break;
			case 71:
				break;
			case 72:
				break;
			case 73:
				break;
			case 74:
				break;
			case 75:
				break;
			case 76:
				break;
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
		}

		// Token: 0x06001349 RID: 4937 RVA: 0x00133A3C File Offset: 0x00131C3C
		public unsafe override int CheckModified(ushort dataId, ulong subId0, uint subId1, RawDataPool dataPool)
		{
			int result;
			switch (dataId)
			{
			case 0:
			{
				bool flag = !BaseGameDataDomain.IsModified(this.DataStates, 0);
				if (flag)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 0);
					result = Serializer.Serialize(this._taiwuCharId, dataPool);
				}
				break;
			}
			case 1:
			{
				bool flag2 = !BaseGameDataDomain.IsModified(this.DataStates, 1);
				if (flag2)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 1);
					result = Serializer.Serialize(this._taiwuGenerationsCount, dataPool);
				}
				break;
			}
			case 2:
			{
				bool flag3 = !BaseGameDataDomain.IsModified(this.DataStates, 2);
				if (flag3)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 2);
					result = Serializer.Serialize(this._cricketLuckPoint, dataPool);
				}
				break;
			}
			case 3:
			{
				bool flag4 = !BaseGameDataDomain.IsModified(this.DataStates, 3);
				if (flag4)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 3);
					result = Serializer.Serialize(this._previousTaiwuIds, dataPool);
				}
				break;
			}
			case 4:
			{
				bool flag5 = !BaseGameDataDomain.IsModified(this.DataStates, 4);
				if (flag5)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 4);
					result = Serializer.Serialize(this._needToEscape, dataPool);
				}
				break;
			}
			case 5:
			{
				bool flag6 = !BaseGameDataDomain.IsModified(this.DataStates, 5);
				if (flag6)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 5);
					result = Serializer.Serialize(this._receivedItems, dataPool);
				}
				break;
			}
			case 6:
			{
				bool flag7 = !BaseGameDataDomain.IsModified(this.DataStates, 6);
				if (flag7)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 6);
					result = Serializer.Serialize(this._receivedCharacters, dataPool);
				}
				break;
			}
			case 7:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 8:
			{
				bool flag8 = !BaseGameDataDomain.IsModified(this.DataStates, 8);
				if (flag8)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 8);
					result = Serializer.Serialize(this.GetWarehouseMaxLoad(), dataPool);
				}
				break;
			}
			case 9:
			{
				bool flag9 = !BaseGameDataDomain.IsModified(this.DataStates, 9);
				if (flag9)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 9);
					result = Serializer.Serialize(this.GetWarehouseCurrLoad(), dataPool);
				}
				break;
			}
			case 10:
			{
				bool flag10 = !BaseGameDataDomain.IsModified(this.DataStates, 10);
				if (flag10)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 10);
					result = Serializer.Serialize(this.GetBuildingSpaceLimit(), dataPool);
				}
				break;
			}
			case 11:
			{
				bool flag11 = !BaseGameDataDomain.IsModified(this.DataStates, 11);
				if (flag11)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 11);
					result = Serializer.Serialize(this.GetBuildingSpaceCurr(), dataPool);
				}
				break;
			}
			case 12:
			{
				bool flag12 = !BaseGameDataDomain.IsModified(this.DataStates, 12);
				if (flag12)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 12);
					result = Serializer.Serialize(this._buildingSpaceExtraAdd, dataPool);
				}
				break;
			}
			case 13:
			{
				bool flag13 = !BaseGameDataDomain.IsModified(this.DataStates, 13);
				if (flag13)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 13);
					result = Serializer.Serialize(this._prosperousConstruction, dataPool);
				}
				break;
			}
			case 14:
			{
				bool flag14 = !BaseGameDataDomain.IsModified(this.DataStates, 14);
				if (flag14)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 14);
					int offset = Serializer.SerializeModifications<short>(this._combatSkills, dataPool, this._modificationsCombatSkills);
					this._modificationsCombatSkills.Reset();
					result = offset;
				}
				break;
			}
			case 15:
			{
				bool flag15 = !BaseGameDataDomain.IsModified(this.DataStates, 15);
				if (flag15)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 15);
					int offset2 = Serializer.SerializeModifications<short>(this._lifeSkills, dataPool, this._modificationsLifeSkills);
					this._modificationsLifeSkills.Reset();
					result = offset2;
				}
				break;
			}
			case 16:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 17:
			{
				bool flag16 = !BaseGameDataDomain.IsModified(this.DataStates, 17);
				if (flag16)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 17);
					result = Serializer.Serialize(this._currCombatSkillPlanId, dataPool);
				}
				break;
			}
			case 18:
			{
				bool flag17 = !BaseGameDataDomain.IsModified(this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, (int)subId0);
				if (flag17)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, (int)subId0);
					result = Serializer.Serialize(this._currLifeSkillAttainmentPanelPlanIndex[(int)subId0], dataPool);
				}
				break;
			}
			case 19:
			{
				bool flag18 = !BaseGameDataDomain.IsModified(this.DataStates, 19);
				if (flag18)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 19);
					int offset3 = Serializer.SerializeModifications<short>(this._skillBreakPlateObsoleteDict, dataPool, this._modificationsSkillBreakPlateObsoleteDict);
					this._modificationsSkillBreakPlateObsoleteDict.Reset();
					result = offset3;
				}
				break;
			}
			case 20:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 21:
			{
				bool flag19 = !BaseGameDataDomain.IsModified(this.DataStates, 21);
				if (flag19)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 21);
					int offset4 = Serializer.SerializeModifications<int>(this._teachTaiwuLifeSkillDict, dataPool, this._modificationsTeachTaiwuLifeSkillDict);
					this._modificationsTeachTaiwuLifeSkillDict.Reset();
					result = offset4;
				}
				break;
			}
			case 22:
			{
				bool flag20 = !BaseGameDataDomain.IsModified(this.DataStates, 22);
				if (flag20)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 22);
					int offset5 = Serializer.SerializeModifications<int>(this._teachTaiwuCombatSkillDict, dataPool, this._modificationsTeachTaiwuCombatSkillDict);
					this._modificationsTeachTaiwuCombatSkillDict.Reset();
					result = offset5;
				}
				break;
			}
			case 23:
			{
				bool flag21 = !BaseGameDataDomain.IsModified(this.DataStates, 23);
				if (flag21)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 23);
					result = Serializer.Serialize(this._combatSkillAttainmentPanelPlans, dataPool);
				}
				break;
			}
			case 24:
			{
				bool flag22 = !BaseGameDataDomain.IsModified(this.DataStates, 24);
				if (flag22)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 24);
					result = Serializer.Serialize(this._currCombatSkillAttainmentPanelPlanIds, dataPool);
				}
				break;
			}
			case 25:
			{
				bool flag23 = !BaseGameDataDomain.IsModified(this.DataStates, 25);
				if (flag23)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 25);
					result = Serializer.Serialize(this.GetMoveTimeCostPercent(), dataPool);
				}
				break;
			}
			case 26:
			{
				bool flag24 = !BaseGameDataDomain.IsModified(this.DataStates, 26);
				if (flag24)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 26);
					result = Serializer.Serialize(this._weaponInnerRatios, dataPool);
				}
				break;
			}
			case 27:
			{
				bool flag25 = !BaseGameDataDomain.IsModified(this.DataStates, 27);
				if (flag25)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 27);
					result = Serializer.Serialize(this.GetWeaponCurrInnerRatios(), dataPool);
				}
				break;
			}
			case 28:
			{
				bool flag26 = !BaseGameDataDomain.IsModified(this.DataStates, 28);
				if (flag26)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 28);
					int offset6 = Serializer.SerializeModifications<int>(this._appointments, dataPool, this._modificationsAppointments);
					this._modificationsAppointments.Reset();
					result = offset6;
				}
				break;
			}
			case 29:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 30:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 31:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 32:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 33:
			{
				bool flag27 = !BaseGameDataDomain.IsModified(this.DataStates, 33);
				if (flag27)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 33);
					result = Serializer.Serialize(this._currEquipmentPlanId, dataPool);
				}
				break;
			}
			case 34:
			{
				bool flag28 = !BaseGameDataDomain.IsModified(this.DataStates, 34);
				if (flag28)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 34);
					result = Serializer.Serialize(this._groupCharIds, dataPool);
				}
				break;
			}
			case 35:
			{
				bool flag29 = !BaseGameDataDomain.IsModified(this._dataStatesCombatGroupCharIds, (int)subId0);
				if (flag29)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this._dataStatesCombatGroupCharIds, (int)subId0);
					result = Serializer.Serialize(this._combatGroupCharIds[(int)subId0], dataPool);
				}
				break;
			}
			case 36:
			{
				bool flag30 = !BaseGameDataDomain.IsModified(this.DataStates, 36);
				if (flag30)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 36);
					result = Serializer.Serialize(this.GetTaiwuGroupMaxCount(), dataPool);
				}
				break;
			}
			case 37:
			{
				bool flag31 = !BaseGameDataDomain.IsModified(this.DataStates, 37);
				if (flag31)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 37);
					int offset7 = Serializer.SerializeModifications<short>(this._legacyPointDict, dataPool, this._modificationsLegacyPointDict);
					this._modificationsLegacyPointDict.Reset();
					result = offset7;
				}
				break;
			}
			case 38:
			{
				bool flag32 = !BaseGameDataDomain.IsModified(this.DataStates, 38);
				if (flag32)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 38);
					result = Serializer.Serialize(this._legacyPoint, dataPool);
				}
				break;
			}
			case 39:
			{
				bool flag33 = !BaseGameDataDomain.IsModified(this.DataStates, 39);
				if (flag33)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 39);
					result = Serializer.Serialize(this._availableLegacyList, dataPool);
				}
				break;
			}
			case 40:
			{
				bool flag34 = !BaseGameDataDomain.IsModified(this.DataStates, 40);
				if (flag34)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 40);
					result = Serializer.Serialize(this._legacyPassingState, dataPool);
				}
				break;
			}
			case 41:
			{
				bool flag35 = !BaseGameDataDomain.IsModified(this.DataStates, 41);
				if (flag35)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 41);
					result = Serializer.Serialize(this._successorCandidates, dataPool);
				}
				break;
			}
			case 42:
			{
				bool flag36 = !BaseGameDataDomain.IsModified(this._dataStatesStateNewCharacterLegacyGrowingGrades, (int)subId0);
				if (flag36)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this._dataStatesStateNewCharacterLegacyGrowingGrades, (int)subId0);
					result = Serializer.Serialize(this._stateNewCharacterLegacyGrowingGrades[(int)subId0], dataPool);
				}
				break;
			}
			case 43:
			{
				bool flag37 = !BaseGameDataDomain.IsModified(this.DataStates, 43);
				if (flag37)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 43);
					int offset8 = Serializer.SerializeModifications<short>(this._notLearnCombatSkillReadingProgress, dataPool, this._modificationsNotLearnCombatSkillReadingProgress);
					this._modificationsNotLearnCombatSkillReadingProgress.Reset();
					result = offset8;
				}
				break;
			}
			case 44:
			{
				bool flag38 = !BaseGameDataDomain.IsModified(this.DataStates, 44);
				if (flag38)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 44);
					int offset9 = Serializer.SerializeModifications<short>(this._notLearnLifeSkillReadingProgress, dataPool, this._modificationsNotLearnLifeSkillReadingProgress);
					this._modificationsNotLearnLifeSkillReadingProgress.Reset();
					result = offset9;
				}
				break;
			}
			case 45:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(42, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to check modification of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 46:
			{
				bool flag39 = !BaseGameDataDomain.IsModified(this.DataStates, 46);
				if (flag39)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 46);
					result = Serializer.Serialize(this._curReadingBook, dataPool);
				}
				break;
			}
			case 47:
			{
				bool flag40 = !BaseGameDataDomain.IsModified(this.DataStates, 47);
				if (flag40)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 47);
					result = Serializer.Serialize(this._referenceBooks, dataPool);
				}
				break;
			}
			case 48:
			{
				bool flag41 = !BaseGameDataDomain.IsModified(this.DataStates, 48);
				if (flag41)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 48);
					result = Serializer.Serialize(this.GetReferenceBookSlotUnlockStates(), dataPool);
				}
				break;
			}
			case 49:
			{
				bool flag42 = !BaseGameDataDomain.IsModified(this.DataStates, 49);
				if (flag42)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 49);
					result = Serializer.Serialize(this._readingEventTriggered, dataPool);
				}
				break;
			}
			case 50:
			{
				bool flag43 = !BaseGameDataDomain.IsModified(this.DataStates, 50);
				if (flag43)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 50);
					result = Serializer.Serialize(this._readInCombatCount, dataPool);
				}
				break;
			}
			case 51:
			{
				bool flag44 = !BaseGameDataDomain.IsModified(this.DataStates, 51);
				if (flag44)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 51);
					result = Serializer.Serialize(this._healingOuterInjuryRestriction, dataPool);
				}
				break;
			}
			case 52:
			{
				bool flag45 = !BaseGameDataDomain.IsModified(this.DataStates, 52);
				if (flag45)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 52);
					result = Serializer.Serialize(this._healingInnerInjuryRestriction, dataPool);
				}
				break;
			}
			case 53:
			{
				bool flag46 = !BaseGameDataDomain.IsModified(this.DataStates, 53);
				if (flag46)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 53);
					result = Serializer.Serialize(this._neiliAllocationTypeRestriction, dataPool);
				}
				break;
			}
			case 54:
			{
				bool flag47 = !BaseGameDataDomain.IsModified(this.DataStates, 54);
				if (flag47)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 54);
					result = Serializer.Serialize(this._visitedSettlements, dataPool);
				}
				break;
			}
			case 55:
			{
				bool flag48 = !BaseGameDataDomain.IsModified(this.DataStates, 55);
				if (flag48)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 55);
					result = Serializer.Serialize(this._taiwuVillageSettlementId, dataPool);
				}
				break;
			}
			case 56:
			{
				bool flag49 = !BaseGameDataDomain.IsModified(this.DataStates, 56);
				if (flag49)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 56);
					int offset10 = Serializer.SerializeModifications<int>(this._villagerWork, dataPool, this._modificationsVillagerWork);
					this._modificationsVillagerWork.Reset();
					result = offset10;
				}
				break;
			}
			case 57:
			{
				bool flag50 = !BaseGameDataDomain.IsModified(this.DataStates, 57);
				if (flag50)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 57);
					int offset11 = Serializer.SerializeModifications<Location>(this._villagerWorkLocations, dataPool, this._modificationsVillagerWorkLocations);
					this._modificationsVillagerWorkLocations.Reset();
					result = offset11;
				}
				break;
			}
			case 58:
			{
				bool flag51 = !BaseGameDataDomain.IsModified(this.DataStates, 58);
				if (flag51)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 58);
					result = Serializer.Serialize(this.GetMaterialResourceMaxCount(), dataPool);
				}
				break;
			}
			case 59:
			{
				bool flag52 = !BaseGameDataDomain.IsModified(this.DataStates, 59);
				if (flag52)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 59);
					result = Serializer.Serialize(this.GetResourceChange(), dataPool);
				}
				break;
			}
			case 60:
			{
				bool flag53 = !BaseGameDataDomain.IsModified(this.DataStates, 60);
				if (flag53)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 60);
					result = Serializer.Serialize(this.GetWorkLocationMaxCount(), dataPool);
				}
				break;
			}
			case 61:
			{
				bool flag54 = !BaseGameDataDomain.IsModified(this.DataStates, 61);
				if (flag54)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 61);
					result = Serializer.Serialize(this.GetTotalVillagerCount(), dataPool);
				}
				break;
			}
			case 62:
			{
				bool flag55 = !BaseGameDataDomain.IsModified(this.DataStates, 62);
				if (flag55)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 62);
					result = Serializer.Serialize(this.GetTotalAdultVillagerCount(), dataPool);
				}
				break;
			}
			case 63:
			{
				bool flag56 = !BaseGameDataDomain.IsModified(this.DataStates, 63);
				if (flag56)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 63);
					result = Serializer.Serialize(this.GetAvailableVillagerCount(), dataPool);
				}
				break;
			}
			case 64:
			{
				bool flag57 = !BaseGameDataDomain.IsModified(this.DataStates, 64);
				if (flag57)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 64);
					result = Serializer.Serialize(this._isTaiwuDieOfCombatWithXiangshu, dataPool);
				}
				break;
			}
			case 65:
			{
				bool flag58 = !BaseGameDataDomain.IsModified(this.DataStates, 65);
				if (flag58)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 65);
					result = Serializer.Serialize(this.GetVillagerLearnLifeSkillsFromSect(), dataPool);
				}
				break;
			}
			case 66:
			{
				bool flag59 = !BaseGameDataDomain.IsModified(this.DataStates, 66);
				if (flag59)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 66);
					result = Serializer.Serialize(this.GetVillagerLearnCombatSkillsFromSect(), dataPool);
				}
				break;
			}
			case 67:
			{
				bool flag60 = !BaseGameDataDomain.IsModified(this.DataStates, 67);
				if (flag60)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 67);
					result = Serializer.Serialize(this.GetOverweightSanctionPercent(), dataPool);
				}
				break;
			}
			case 68:
			{
				bool flag61 = !BaseGameDataDomain.IsModified(this.DataStates, 68);
				if (flag61)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 68);
					result = Serializer.Serialize(this.GetReferenceSkillSlotUnlockStates(), dataPool);
				}
				break;
			}
			case 69:
			{
				bool flag62 = !BaseGameDataDomain.IsModified(this.DataStates, 69);
				if (flag62)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 69);
					result = Serializer.Serialize(this.GetTaiwuGroupWorstInjuries(), dataPool);
				}
				break;
			}
			case 70:
			{
				bool flag63 = !BaseGameDataDomain.IsModified(this.DataStates, 70);
				if (flag63)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 70);
					result = Serializer.Serialize(*this.GetTotalResources(), dataPool);
				}
				break;
			}
			case 71:
			{
				bool flag64 = !BaseGameDataDomain.IsModified(this.DataStates, 71);
				if (flag64)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 71);
					result = Serializer.Serialize(this.GetTaiwuSpecialGroup(), dataPool);
				}
				break;
			}
			case 72:
			{
				bool flag65 = !BaseGameDataDomain.IsModified(this.DataStates, 72);
				if (flag65)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 72);
					result = Serializer.Serialize(this.GetTaiwuGearMateGroup(), dataPool);
				}
				break;
			}
			case 73:
			{
				bool flag66 = !BaseGameDataDomain.IsModified(this.DataStates, 73);
				if (flag66)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 73);
					result = Serializer.Serialize(this.GetCanBreakOut(), dataPool);
				}
				break;
			}
			case 74:
			{
				bool flag67 = !BaseGameDataDomain.IsModified(this.DataStates, 74);
				if (flag67)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 74);
					result = Serializer.Serialize(this.GetTroughMaxLoad(), dataPool);
				}
				break;
			}
			case 75:
			{
				bool flag68 = !BaseGameDataDomain.IsModified(this.DataStates, 75);
				if (flag68)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 75);
					result = Serializer.Serialize(this.GetTroughCurrLoad(), dataPool);
				}
				break;
			}
			case 76:
			{
				bool flag69 = !BaseGameDataDomain.IsModified(this.DataStates, 76);
				if (flag69)
				{
					result = -1;
				}
				else
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 76);
					result = Serializer.Serialize(this.GetClothingDurability(), dataPool);
				}
				break;
			}
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
			return result;
		}

		// Token: 0x0600134A RID: 4938 RVA: 0x00134F08 File Offset: 0x00133108
		public override void ResetModifiedWrapper(ushort dataId, ulong subId0, uint subId1)
		{
			switch (dataId)
			{
			case 0:
			{
				bool flag = !BaseGameDataDomain.IsModified(this.DataStates, 0);
				if (!flag)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 0);
				}
				break;
			}
			case 1:
			{
				bool flag2 = !BaseGameDataDomain.IsModified(this.DataStates, 1);
				if (!flag2)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 1);
				}
				break;
			}
			case 2:
			{
				bool flag3 = !BaseGameDataDomain.IsModified(this.DataStates, 2);
				if (!flag3)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 2);
				}
				break;
			}
			case 3:
			{
				bool flag4 = !BaseGameDataDomain.IsModified(this.DataStates, 3);
				if (!flag4)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 3);
				}
				break;
			}
			case 4:
			{
				bool flag5 = !BaseGameDataDomain.IsModified(this.DataStates, 4);
				if (!flag5)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 4);
				}
				break;
			}
			case 5:
			{
				bool flag6 = !BaseGameDataDomain.IsModified(this.DataStates, 5);
				if (!flag6)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 5);
				}
				break;
			}
			case 6:
			{
				bool flag7 = !BaseGameDataDomain.IsModified(this.DataStates, 6);
				if (!flag7)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 6);
				}
				break;
			}
			case 7:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 8:
			{
				bool flag8 = !BaseGameDataDomain.IsModified(this.DataStates, 8);
				if (!flag8)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 8);
				}
				break;
			}
			case 9:
			{
				bool flag9 = !BaseGameDataDomain.IsModified(this.DataStates, 9);
				if (!flag9)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 9);
				}
				break;
			}
			case 10:
			{
				bool flag10 = !BaseGameDataDomain.IsModified(this.DataStates, 10);
				if (!flag10)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 10);
				}
				break;
			}
			case 11:
			{
				bool flag11 = !BaseGameDataDomain.IsModified(this.DataStates, 11);
				if (!flag11)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 11);
				}
				break;
			}
			case 12:
			{
				bool flag12 = !BaseGameDataDomain.IsModified(this.DataStates, 12);
				if (!flag12)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 12);
				}
				break;
			}
			case 13:
			{
				bool flag13 = !BaseGameDataDomain.IsModified(this.DataStates, 13);
				if (!flag13)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 13);
				}
				break;
			}
			case 14:
			{
				bool flag14 = !BaseGameDataDomain.IsModified(this.DataStates, 14);
				if (!flag14)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 14);
					this._modificationsCombatSkills.Reset();
				}
				break;
			}
			case 15:
			{
				bool flag15 = !BaseGameDataDomain.IsModified(this.DataStates, 15);
				if (!flag15)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 15);
					this._modificationsLifeSkills.Reset();
				}
				break;
			}
			case 16:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 17:
			{
				bool flag16 = !BaseGameDataDomain.IsModified(this.DataStates, 17);
				if (!flag16)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 17);
				}
				break;
			}
			case 18:
			{
				bool flag17 = !BaseGameDataDomain.IsModified(this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, (int)subId0);
				if (!flag17)
				{
					BaseGameDataDomain.ResetModified(this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, (int)subId0);
				}
				break;
			}
			case 19:
			{
				bool flag18 = !BaseGameDataDomain.IsModified(this.DataStates, 19);
				if (!flag18)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 19);
					this._modificationsSkillBreakPlateObsoleteDict.Reset();
				}
				break;
			}
			case 20:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 21:
			{
				bool flag19 = !BaseGameDataDomain.IsModified(this.DataStates, 21);
				if (!flag19)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 21);
					this._modificationsTeachTaiwuLifeSkillDict.Reset();
				}
				break;
			}
			case 22:
			{
				bool flag20 = !BaseGameDataDomain.IsModified(this.DataStates, 22);
				if (!flag20)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 22);
					this._modificationsTeachTaiwuCombatSkillDict.Reset();
				}
				break;
			}
			case 23:
			{
				bool flag21 = !BaseGameDataDomain.IsModified(this.DataStates, 23);
				if (!flag21)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 23);
				}
				break;
			}
			case 24:
			{
				bool flag22 = !BaseGameDataDomain.IsModified(this.DataStates, 24);
				if (!flag22)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 24);
				}
				break;
			}
			case 25:
			{
				bool flag23 = !BaseGameDataDomain.IsModified(this.DataStates, 25);
				if (!flag23)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 25);
				}
				break;
			}
			case 26:
			{
				bool flag24 = !BaseGameDataDomain.IsModified(this.DataStates, 26);
				if (!flag24)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 26);
				}
				break;
			}
			case 27:
			{
				bool flag25 = !BaseGameDataDomain.IsModified(this.DataStates, 27);
				if (!flag25)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 27);
				}
				break;
			}
			case 28:
			{
				bool flag26 = !BaseGameDataDomain.IsModified(this.DataStates, 28);
				if (!flag26)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 28);
					this._modificationsAppointments.Reset();
				}
				break;
			}
			case 29:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 30:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 31:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 32:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 33:
			{
				bool flag27 = !BaseGameDataDomain.IsModified(this.DataStates, 33);
				if (!flag27)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 33);
				}
				break;
			}
			case 34:
			{
				bool flag28 = !BaseGameDataDomain.IsModified(this.DataStates, 34);
				if (!flag28)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 34);
				}
				break;
			}
			case 35:
			{
				bool flag29 = !BaseGameDataDomain.IsModified(this._dataStatesCombatGroupCharIds, (int)subId0);
				if (!flag29)
				{
					BaseGameDataDomain.ResetModified(this._dataStatesCombatGroupCharIds, (int)subId0);
				}
				break;
			}
			case 36:
			{
				bool flag30 = !BaseGameDataDomain.IsModified(this.DataStates, 36);
				if (!flag30)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 36);
				}
				break;
			}
			case 37:
			{
				bool flag31 = !BaseGameDataDomain.IsModified(this.DataStates, 37);
				if (!flag31)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 37);
					this._modificationsLegacyPointDict.Reset();
				}
				break;
			}
			case 38:
			{
				bool flag32 = !BaseGameDataDomain.IsModified(this.DataStates, 38);
				if (!flag32)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 38);
				}
				break;
			}
			case 39:
			{
				bool flag33 = !BaseGameDataDomain.IsModified(this.DataStates, 39);
				if (!flag33)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 39);
				}
				break;
			}
			case 40:
			{
				bool flag34 = !BaseGameDataDomain.IsModified(this.DataStates, 40);
				if (!flag34)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 40);
				}
				break;
			}
			case 41:
			{
				bool flag35 = !BaseGameDataDomain.IsModified(this.DataStates, 41);
				if (!flag35)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 41);
				}
				break;
			}
			case 42:
			{
				bool flag36 = !BaseGameDataDomain.IsModified(this._dataStatesStateNewCharacterLegacyGrowingGrades, (int)subId0);
				if (!flag36)
				{
					BaseGameDataDomain.ResetModified(this._dataStatesStateNewCharacterLegacyGrowingGrades, (int)subId0);
				}
				break;
			}
			case 43:
			{
				bool flag37 = !BaseGameDataDomain.IsModified(this.DataStates, 43);
				if (!flag37)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 43);
					this._modificationsNotLearnCombatSkillReadingProgress.Reset();
				}
				break;
			}
			case 44:
			{
				bool flag38 = !BaseGameDataDomain.IsModified(this.DataStates, 44);
				if (!flag38)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 44);
					this._modificationsNotLearnLifeSkillReadingProgress.Reset();
				}
				break;
			}
			case 45:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to reset modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 46:
			{
				bool flag39 = !BaseGameDataDomain.IsModified(this.DataStates, 46);
				if (!flag39)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 46);
				}
				break;
			}
			case 47:
			{
				bool flag40 = !BaseGameDataDomain.IsModified(this.DataStates, 47);
				if (!flag40)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 47);
				}
				break;
			}
			case 48:
			{
				bool flag41 = !BaseGameDataDomain.IsModified(this.DataStates, 48);
				if (!flag41)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 48);
				}
				break;
			}
			case 49:
			{
				bool flag42 = !BaseGameDataDomain.IsModified(this.DataStates, 49);
				if (!flag42)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 49);
				}
				break;
			}
			case 50:
			{
				bool flag43 = !BaseGameDataDomain.IsModified(this.DataStates, 50);
				if (!flag43)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 50);
				}
				break;
			}
			case 51:
			{
				bool flag44 = !BaseGameDataDomain.IsModified(this.DataStates, 51);
				if (!flag44)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 51);
				}
				break;
			}
			case 52:
			{
				bool flag45 = !BaseGameDataDomain.IsModified(this.DataStates, 52);
				if (!flag45)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 52);
				}
				break;
			}
			case 53:
			{
				bool flag46 = !BaseGameDataDomain.IsModified(this.DataStates, 53);
				if (!flag46)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 53);
				}
				break;
			}
			case 54:
			{
				bool flag47 = !BaseGameDataDomain.IsModified(this.DataStates, 54);
				if (!flag47)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 54);
				}
				break;
			}
			case 55:
			{
				bool flag48 = !BaseGameDataDomain.IsModified(this.DataStates, 55);
				if (!flag48)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 55);
				}
				break;
			}
			case 56:
			{
				bool flag49 = !BaseGameDataDomain.IsModified(this.DataStates, 56);
				if (!flag49)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 56);
					this._modificationsVillagerWork.Reset();
				}
				break;
			}
			case 57:
			{
				bool flag50 = !BaseGameDataDomain.IsModified(this.DataStates, 57);
				if (!flag50)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 57);
					this._modificationsVillagerWorkLocations.Reset();
				}
				break;
			}
			case 58:
			{
				bool flag51 = !BaseGameDataDomain.IsModified(this.DataStates, 58);
				if (!flag51)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 58);
				}
				break;
			}
			case 59:
			{
				bool flag52 = !BaseGameDataDomain.IsModified(this.DataStates, 59);
				if (!flag52)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 59);
				}
				break;
			}
			case 60:
			{
				bool flag53 = !BaseGameDataDomain.IsModified(this.DataStates, 60);
				if (!flag53)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 60);
				}
				break;
			}
			case 61:
			{
				bool flag54 = !BaseGameDataDomain.IsModified(this.DataStates, 61);
				if (!flag54)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 61);
				}
				break;
			}
			case 62:
			{
				bool flag55 = !BaseGameDataDomain.IsModified(this.DataStates, 62);
				if (!flag55)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 62);
				}
				break;
			}
			case 63:
			{
				bool flag56 = !BaseGameDataDomain.IsModified(this.DataStates, 63);
				if (!flag56)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 63);
				}
				break;
			}
			case 64:
			{
				bool flag57 = !BaseGameDataDomain.IsModified(this.DataStates, 64);
				if (!flag57)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 64);
				}
				break;
			}
			case 65:
			{
				bool flag58 = !BaseGameDataDomain.IsModified(this.DataStates, 65);
				if (!flag58)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 65);
				}
				break;
			}
			case 66:
			{
				bool flag59 = !BaseGameDataDomain.IsModified(this.DataStates, 66);
				if (!flag59)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 66);
				}
				break;
			}
			case 67:
			{
				bool flag60 = !BaseGameDataDomain.IsModified(this.DataStates, 67);
				if (!flag60)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 67);
				}
				break;
			}
			case 68:
			{
				bool flag61 = !BaseGameDataDomain.IsModified(this.DataStates, 68);
				if (!flag61)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 68);
				}
				break;
			}
			case 69:
			{
				bool flag62 = !BaseGameDataDomain.IsModified(this.DataStates, 69);
				if (!flag62)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 69);
				}
				break;
			}
			case 70:
			{
				bool flag63 = !BaseGameDataDomain.IsModified(this.DataStates, 70);
				if (!flag63)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 70);
				}
				break;
			}
			case 71:
			{
				bool flag64 = !BaseGameDataDomain.IsModified(this.DataStates, 71);
				if (!flag64)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 71);
				}
				break;
			}
			case 72:
			{
				bool flag65 = !BaseGameDataDomain.IsModified(this.DataStates, 72);
				if (!flag65)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 72);
				}
				break;
			}
			case 73:
			{
				bool flag66 = !BaseGameDataDomain.IsModified(this.DataStates, 73);
				if (!flag66)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 73);
				}
				break;
			}
			case 74:
			{
				bool flag67 = !BaseGameDataDomain.IsModified(this.DataStates, 74);
				if (!flag67)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 74);
				}
				break;
			}
			case 75:
			{
				bool flag68 = !BaseGameDataDomain.IsModified(this.DataStates, 75);
				if (!flag68)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 75);
				}
				break;
			}
			case 76:
			{
				bool flag69 = !BaseGameDataDomain.IsModified(this.DataStates, 76);
				if (!flag69)
				{
					BaseGameDataDomain.ResetModified(this.DataStates, 76);
				}
				break;
			}
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
		}

		// Token: 0x0600134B RID: 4939 RVA: 0x00135EFC File Offset: 0x001340FC
		public override bool IsModifiedWrapper(ushort dataId, ulong subId0, uint subId1)
		{
			bool result;
			switch (dataId)
			{
			case 0:
				result = BaseGameDataDomain.IsModified(this.DataStates, 0);
				break;
			case 1:
				result = BaseGameDataDomain.IsModified(this.DataStates, 1);
				break;
			case 2:
				result = BaseGameDataDomain.IsModified(this.DataStates, 2);
				break;
			case 3:
				result = BaseGameDataDomain.IsModified(this.DataStates, 3);
				break;
			case 4:
				result = BaseGameDataDomain.IsModified(this.DataStates, 4);
				break;
			case 5:
				result = BaseGameDataDomain.IsModified(this.DataStates, 5);
				break;
			case 6:
				result = BaseGameDataDomain.IsModified(this.DataStates, 6);
				break;
			case 7:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 8:
				result = BaseGameDataDomain.IsModified(this.DataStates, 8);
				break;
			case 9:
				result = BaseGameDataDomain.IsModified(this.DataStates, 9);
				break;
			case 10:
				result = BaseGameDataDomain.IsModified(this.DataStates, 10);
				break;
			case 11:
				result = BaseGameDataDomain.IsModified(this.DataStates, 11);
				break;
			case 12:
				result = BaseGameDataDomain.IsModified(this.DataStates, 12);
				break;
			case 13:
				result = BaseGameDataDomain.IsModified(this.DataStates, 13);
				break;
			case 14:
				result = BaseGameDataDomain.IsModified(this.DataStates, 14);
				break;
			case 15:
				result = BaseGameDataDomain.IsModified(this.DataStates, 15);
				break;
			case 16:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 17:
				result = BaseGameDataDomain.IsModified(this.DataStates, 17);
				break;
			case 18:
				result = BaseGameDataDomain.IsModified(this._dataStatesCurrLifeSkillAttainmentPanelPlanIndex, (int)subId0);
				break;
			case 19:
				result = BaseGameDataDomain.IsModified(this.DataStates, 19);
				break;
			case 20:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 21:
				result = BaseGameDataDomain.IsModified(this.DataStates, 21);
				break;
			case 22:
				result = BaseGameDataDomain.IsModified(this.DataStates, 22);
				break;
			case 23:
				result = BaseGameDataDomain.IsModified(this.DataStates, 23);
				break;
			case 24:
				result = BaseGameDataDomain.IsModified(this.DataStates, 24);
				break;
			case 25:
				result = BaseGameDataDomain.IsModified(this.DataStates, 25);
				break;
			case 26:
				result = BaseGameDataDomain.IsModified(this.DataStates, 26);
				break;
			case 27:
				result = BaseGameDataDomain.IsModified(this.DataStates, 27);
				break;
			case 28:
				result = BaseGameDataDomain.IsModified(this.DataStates, 28);
				break;
			case 29:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 30:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 31:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 32:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 33:
				result = BaseGameDataDomain.IsModified(this.DataStates, 33);
				break;
			case 34:
				result = BaseGameDataDomain.IsModified(this.DataStates, 34);
				break;
			case 35:
				result = BaseGameDataDomain.IsModified(this._dataStatesCombatGroupCharIds, (int)subId0);
				break;
			case 36:
				result = BaseGameDataDomain.IsModified(this.DataStates, 36);
				break;
			case 37:
				result = BaseGameDataDomain.IsModified(this.DataStates, 37);
				break;
			case 38:
				result = BaseGameDataDomain.IsModified(this.DataStates, 38);
				break;
			case 39:
				result = BaseGameDataDomain.IsModified(this.DataStates, 39);
				break;
			case 40:
				result = BaseGameDataDomain.IsModified(this.DataStates, 40);
				break;
			case 41:
				result = BaseGameDataDomain.IsModified(this.DataStates, 41);
				break;
			case 42:
				result = BaseGameDataDomain.IsModified(this._dataStatesStateNewCharacterLegacyGrowingGrades, (int)subId0);
				break;
			case 43:
				result = BaseGameDataDomain.IsModified(this.DataStates, 43);
				break;
			case 44:
				result = BaseGameDataDomain.IsModified(this.DataStates, 44);
				break;
			case 45:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(49, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Not allow to verify modification state of dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			case 46:
				result = BaseGameDataDomain.IsModified(this.DataStates, 46);
				break;
			case 47:
				result = BaseGameDataDomain.IsModified(this.DataStates, 47);
				break;
			case 48:
				result = BaseGameDataDomain.IsModified(this.DataStates, 48);
				break;
			case 49:
				result = BaseGameDataDomain.IsModified(this.DataStates, 49);
				break;
			case 50:
				result = BaseGameDataDomain.IsModified(this.DataStates, 50);
				break;
			case 51:
				result = BaseGameDataDomain.IsModified(this.DataStates, 51);
				break;
			case 52:
				result = BaseGameDataDomain.IsModified(this.DataStates, 52);
				break;
			case 53:
				result = BaseGameDataDomain.IsModified(this.DataStates, 53);
				break;
			case 54:
				result = BaseGameDataDomain.IsModified(this.DataStates, 54);
				break;
			case 55:
				result = BaseGameDataDomain.IsModified(this.DataStates, 55);
				break;
			case 56:
				result = BaseGameDataDomain.IsModified(this.DataStates, 56);
				break;
			case 57:
				result = BaseGameDataDomain.IsModified(this.DataStates, 57);
				break;
			case 58:
				result = BaseGameDataDomain.IsModified(this.DataStates, 58);
				break;
			case 59:
				result = BaseGameDataDomain.IsModified(this.DataStates, 59);
				break;
			case 60:
				result = BaseGameDataDomain.IsModified(this.DataStates, 60);
				break;
			case 61:
				result = BaseGameDataDomain.IsModified(this.DataStates, 61);
				break;
			case 62:
				result = BaseGameDataDomain.IsModified(this.DataStates, 62);
				break;
			case 63:
				result = BaseGameDataDomain.IsModified(this.DataStates, 63);
				break;
			case 64:
				result = BaseGameDataDomain.IsModified(this.DataStates, 64);
				break;
			case 65:
				result = BaseGameDataDomain.IsModified(this.DataStates, 65);
				break;
			case 66:
				result = BaseGameDataDomain.IsModified(this.DataStates, 66);
				break;
			case 67:
				result = BaseGameDataDomain.IsModified(this.DataStates, 67);
				break;
			case 68:
				result = BaseGameDataDomain.IsModified(this.DataStates, 68);
				break;
			case 69:
				result = BaseGameDataDomain.IsModified(this.DataStates, 69);
				break;
			case 70:
				result = BaseGameDataDomain.IsModified(this.DataStates, 70);
				break;
			case 71:
				result = BaseGameDataDomain.IsModified(this.DataStates, 71);
				break;
			case 72:
				result = BaseGameDataDomain.IsModified(this.DataStates, 72);
				break;
			case 73:
				result = BaseGameDataDomain.IsModified(this.DataStates, 73);
				break;
			case 74:
				result = BaseGameDataDomain.IsModified(this.DataStates, 74);
				break;
			case 75:
				result = BaseGameDataDomain.IsModified(this.DataStates, 75);
				break;
			case 76:
				result = BaseGameDataDomain.IsModified(this.DataStates, 76);
				break;
			default:
			{
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(dataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			}
			return result;
		}

		// Token: 0x0600134C RID: 4940 RVA: 0x001366E8 File Offset: 0x001348E8
		public override void InvalidateCache(BaseGameDataObject sourceObject, DataInfluence influence, DataContext context, bool unconditionallyInfluenceAll)
		{
			DefaultInterpolatedStringHandler defaultInterpolatedStringHandler;
			switch (influence.TargetIndicator.DataId)
			{
			case 0:
				break;
			case 1:
				break;
			case 2:
				break;
			case 3:
				break;
			case 4:
				break;
			case 5:
				break;
			case 6:
				break;
			case 7:
				break;
			case 8:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(8, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 9:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(9, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 10:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(10, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 11:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(11, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 12:
				break;
			case 13:
				break;
			case 14:
				break;
			case 15:
				break;
			case 16:
				break;
			case 17:
				break;
			case 18:
				break;
			case 19:
				break;
			case 20:
				break;
			case 21:
				break;
			case 22:
				break;
			case 23:
				break;
			case 24:
				break;
			case 25:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(25, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 26:
				break;
			case 27:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(27, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 28:
				break;
			case 29:
				break;
			case 30:
				break;
			case 31:
				break;
			case 32:
				break;
			case 33:
				break;
			case 34:
				break;
			case 35:
				break;
			case 36:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(36, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 37:
				break;
			case 38:
				break;
			case 39:
				break;
			case 40:
				break;
			case 41:
				break;
			case 42:
				break;
			case 43:
				break;
			case 44:
				break;
			case 45:
				break;
			case 46:
				break;
			case 47:
				break;
			case 48:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(48, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 49:
				break;
			case 50:
				break;
			case 51:
				break;
			case 52:
				break;
			case 53:
				break;
			case 54:
				break;
			case 55:
				break;
			case 56:
				break;
			case 57:
				break;
			case 58:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(58, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 59:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(59, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 60:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(60, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 61:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(61, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 62:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(62, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 63:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(63, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 64:
				break;
			case 65:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(65, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 66:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(66, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 67:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(67, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 68:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(68, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 69:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(69, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 70:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(70, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 71:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(71, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 72:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(72, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 73:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(73, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 74:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(74, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 75:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(75, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			case 76:
				BaseGameDataDomain.InvalidateSelfAndInfluencedCache(76, this.DataStates, TaiwuDomain.CacheInfluences, context);
				return;
			default:
				defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(influence.TargetIndicator.DataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(48, 1);
			defaultInterpolatedStringHandler.AppendLiteral("Cannot invalidate cache state of non-cache data ");
			defaultInterpolatedStringHandler.AppendFormatted<ushort>(influence.TargetIndicator.DataId);
			throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
		}

		// Token: 0x0600134D RID: 4941 RVA: 0x00136C54 File Offset: 0x00134E54
		public unsafe override void ProcessArchiveResponse(OperationWrapper operation, byte* pResult)
		{
			DefaultInterpolatedStringHandler defaultInterpolatedStringHandler;
			switch (operation.DataId)
			{
			case 0:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._taiwuCharId);
				break;
			case 1:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._taiwuGenerationsCount);
				break;
			case 2:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._cricketLuckPoint);
				break;
			case 3:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_List<int>(operation, pResult, this._previousTaiwuIds);
				break;
			case 4:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<bool>(operation, pResult, ref this._needToEscape);
				break;
			case 5:
				goto IL_5E1;
			case 6:
				goto IL_5E1;
			case 7:
				ResponseProcessor.ProcessSingleValueCollection_BasicType_Fixed_Value<ItemKey, int>(operation, pResult, this._warehouseItems);
				break;
			case 8:
				goto IL_5E1;
			case 9:
				goto IL_5E1;
			case 10:
				goto IL_5E1;
			case 11:
				goto IL_5E1;
			case 12:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._buildingSpaceExtraAdd);
				break;
			case 13:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<bool>(operation, pResult, ref this._prosperousConstruction);
				break;
			case 14:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Fixed_Ref<short, TaiwuCombatSkill>(operation, pResult, this._combatSkills, 20);
				break;
			case 15:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Fixed_Ref<short, TaiwuLifeSkill>(operation, pResult, this._lifeSkills, 5);
				break;
			case 16:
				ResponseProcessor.ProcessElementList_CustomType_Dynamic_Ref<CombatSkillPlan>(operation, pResult, this._combatSkillPlans, 9);
				break;
			case 17:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._currCombatSkillPlanId);
				break;
			case 18:
				ResponseProcessor.ProcessElementList_BasicType_Fixed_Value<sbyte>(operation, pResult, this._currLifeSkillAttainmentPanelPlanIndex, 16, 1);
				break;
			case 19:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Dynamic_Ref<short, SkillBreakPlateObsolete>(operation, pResult, this._skillBreakPlateObsoleteDict);
				break;
			case 20:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Dynamic_Ref<short, SkillBreakBonusCollection>(operation, pResult, this._skillBreakBonusDict);
				break;
			case 21:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Dynamic_Value<int, GameData.Utilities.ShortList>(operation, pResult, this._teachTaiwuLifeSkillDict);
				break;
			case 22:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Dynamic_Value<int, GameData.Utilities.ShortList>(operation, pResult, this._teachTaiwuCombatSkillDict);
				break;
			case 23:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Array<short>(operation, pResult, this._combatSkillAttainmentPanelPlans, 630);
				break;
			case 24:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Array<sbyte>(operation, pResult, this._currCombatSkillAttainmentPanelPlanIds, 14);
				break;
			case 25:
				goto IL_5E1;
			case 26:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Array<sbyte>(operation, pResult, this._weaponInnerRatios, 6);
				break;
			case 27:
				goto IL_5E1;
			case 28:
				ResponseProcessor.ProcessSingleValueCollection_BasicType_Fixed_Value<int, short>(operation, pResult, this._appointments);
				break;
			case 29:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<short>(operation, pResult, ref this._babyBonusMainAttributes);
				break;
			case 30:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<short>(operation, pResult, ref this._babyBonusLifeSkillQualifications);
				break;
			case 31:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<short>(operation, pResult, ref this._babyBonusCombatSkillQualifications);
				break;
			case 32:
				ResponseProcessor.ProcessElementList_CustomType_Fixed_Ref<EquipmentPlan>(operation, pResult, this._equipmentsPlans, 5, 99);
				break;
			case 33:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._currEquipmentPlanId);
				break;
			case 34:
				ResponseProcessor.ProcessSingleValue_CustomType_Dynamic_Value_Single<CharacterSet>(operation, pResult, ref this._groupCharIds);
				break;
			case 35:
				ResponseProcessor.ProcessElementList_BasicType_Fixed_Value<int>(operation, pResult, this._combatGroupCharIds, 3, 4);
				break;
			case 36:
				goto IL_5E1;
			case 37:
				ResponseProcessor.ProcessSingleValueCollection_BasicType_Fixed_Value<short, short>(operation, pResult, this._legacyPointDict);
				break;
			case 38:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<int>(operation, pResult, ref this._legacyPoint);
				break;
			case 39:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_List<short>(operation, pResult, this._availableLegacyList);
				break;
			case 40:
				goto IL_5E1;
			case 41:
				goto IL_5E1;
			case 42:
				ResponseProcessor.ProcessElementList_CustomType_Dynamic_Value<SByteList>(operation, pResult, this._stateNewCharacterLegacyGrowingGrades, 15);
				break;
			case 43:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Fixed_Ref<short, TaiwuCombatSkill>(operation, pResult, this._notLearnCombatSkillReadingProgress, 20);
				break;
			case 44:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Fixed_Ref<short, TaiwuLifeSkill>(operation, pResult, this._notLearnLifeSkillReadingProgress, 5);
				break;
			case 45:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Fixed_Value<ItemKey, ReadingBookStrategies>(operation, pResult, this._readingBooks, 36);
				break;
			case 46:
				ResponseProcessor.ProcessSingleValue_CustomType_Fixed_Value_Single<ItemKey>(operation, pResult, ref this._curReadingBook);
				break;
			case 47:
				ResponseProcessor.ProcessSingleValue_CustomType_Fixed_Value_Array<ItemKey>(operation, pResult, this._referenceBooks, 3, 8);
				break;
			case 48:
				goto IL_5E1;
			case 49:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<bool>(operation, pResult, ref this._readingEventTriggered);
				break;
			case 50:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<sbyte>(operation, pResult, ref this._readInCombatCount);
				break;
			case 51:
				goto IL_5E1;
			case 52:
				goto IL_5E1;
			case 53:
				goto IL_5E1;
			case 54:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_List<short>(operation, pResult, this._visitedSettlements);
				break;
			case 55:
				ResponseProcessor.ProcessSingleValue_BasicType_Fixed_Value_Single<short>(operation, pResult, ref this._taiwuVillageSettlementId);
				break;
			case 56:
				ResponseProcessor.ProcessSingleValueCollection_CustomType_Fixed_Ref<int, VillagerWorkData>(operation, pResult, this._villagerWork, 20);
				break;
			case 57:
				goto IL_5E1;
			case 58:
				goto IL_5E1;
			case 59:
				goto IL_5E1;
			case 60:
				goto IL_5E1;
			case 61:
				goto IL_5E1;
			case 62:
				goto IL_5E1;
			case 63:
				goto IL_5E1;
			case 64:
				goto IL_5E1;
			case 65:
				goto IL_5E1;
			case 66:
				goto IL_5E1;
			case 67:
				goto IL_5E1;
			case 68:
				goto IL_5E1;
			case 69:
				goto IL_5E1;
			case 70:
				goto IL_5E1;
			case 71:
				goto IL_5E1;
			case 72:
				goto IL_5E1;
			case 73:
				goto IL_5E1;
			case 74:
				goto IL_5E1;
			case 75:
				goto IL_5E1;
			case 76:
				goto IL_5E1;
			default:
				defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(19, 1);
				defaultInterpolatedStringHandler.AppendLiteral("Unsupported dataId ");
				defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.DataId);
				throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
			}
			bool flag = this._pendingLoadingOperationIds != null;
			if (flag)
			{
				uint currPendingOperationId = this._pendingLoadingOperationIds.Peek();
				bool flag2 = currPendingOperationId == operation.Id;
				if (flag2)
				{
					this._pendingLoadingOperationIds.Dequeue();
					bool flag3 = this._pendingLoadingOperationIds.Count <= 0;
					if (flag3)
					{
						this._pendingLoadingOperationIds = null;
						this.InitializeInternalDataOfCollections();
						this.OnLoadedArchiveData();
						DomainManager.Global.CompleteLoading(5);
					}
				}
			}
			return;
			IL_5E1:
			defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(52, 1);
			defaultInterpolatedStringHandler.AppendLiteral("Cannot process archive response of non-archive data ");
			defaultInterpolatedStringHandler.AppendFormatted<ushort>(operation.DataId);
			throw new Exception(defaultInterpolatedStringHandler.ToStringAndClear());
		}

		// Token: 0x0600134E RID: 4942 RVA: 0x00137276 File Offset: 0x00135476
		private void InitializeInternalDataOfCollections()
		{
		}

		// Token: 0x0600134F RID: 4943 RVA: 0x00137279 File Offset: 0x00135479
		private void RunTestings(DataContext context)
		{
			this.Test_QuickFillCombatSkillAttainmentPanel(context);
			this.Test_SaveCombatSkillAttainmentPanelPlan(context);
		}

		// Token: 0x06001350 RID: 4944 RVA: 0x0013728C File Offset: 0x0013548C
		private unsafe void Test_FindSectLeaderLocation()
		{
			Location location = this._taiwuChar.GetLocation();
			Span<MapBlockData> areaBlocks = DomainManager.Map.GetAreaBlocks(location.AreaId);
			for (int i = 0; i < 10; i++)
			{
				TaiwuDomain.Logger.Info("-----------");
				Stopwatch stopwatch = Stopwatch.StartNew();
				GameData.Domains.Character.Character foundChar = null;
				Span<MapBlockData> span = areaBlocks;
				for (int j = 0; j < span.Length; j++)
				{
					MapBlockData block = *span[j];
					if (foundChar == null)
					{
						foundChar = EventHelper.FindLeaderOfTargetOrganizationAtLocation(block.GetLocation(), 3, true);
					}
				}
				stopwatch.Stop();
				Logger logger = TaiwuDomain.Logger;
				DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(22, 3);
				defaultInterpolatedStringHandler.AppendLiteral("Found ");
				defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(foundChar);
				defaultInterpolatedStringHandler.AppendLiteral(" in ");
				defaultInterpolatedStringHandler.AppendFormatted<long>(stopwatch.ElapsedTicks);
				defaultInterpolatedStringHandler.AppendLiteral(" ticks with ");
				defaultInterpolatedStringHandler.AppendFormatted("FindLeaderOfTargetOrganizationAtLocation");
				logger.Info(defaultInterpolatedStringHandler.ToStringAndClear());
				Stopwatch stopwatch2 = Stopwatch.StartNew();
				GameData.Domains.Character.Character foundChar2 = null;
				Span<MapBlockData> span2 = areaBlocks;
				for (int k = 0; k < span2.Length; k++)
				{
					MapBlockData block2 = *span2[k];
					if (foundChar2 == null)
					{
						foundChar2 = EventHelper.TryGetSectLeaderAtLocation(block2.GetLocation(), 3, true);
					}
				}
				stopwatch2.Stop();
				Logger logger2 = TaiwuDomain.Logger;
				defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(22, 3);
				defaultInterpolatedStringHandler.AppendLiteral("Found ");
				defaultInterpolatedStringHandler.AppendFormatted<GameData.Domains.Character.Character>(foundChar2);
				defaultInterpolatedStringHandler.AppendLiteral(" in ");
				defaultInterpolatedStringHandler.AppendFormatted<long>(stopwatch2.ElapsedTicks);
				defaultInterpolatedStringHandler.AppendLiteral(" ticks with ");
				defaultInterpolatedStringHandler.AppendFormatted("TryGetSectLeaderAtLocation");
				logger2.Info(defaultInterpolatedStringHandler.ToStringAndClear());
				TaiwuDomain.Logger.Info("-----------");
			}
		}

		// Token: 0x06001351 RID: 4945 RVA: 0x00137464 File Offset: 0x00135664
		private void Test_QuickFillCombatSkillAttainmentPanel(DataContext context)
		{
			short[] panels = this._taiwuChar.GetCombatSkillAttainmentPanels();
			for (sbyte skillType2 = 0; skillType2 < 14; skillType2 += 2)
			{
				this.QuickFillCombatSkillAttainmentPanel(context, skillType2);
			}
			sbyte skillType;
			for (skillType = 0; skillType < 14; skillType += 2)
			{
				Dictionary<short, GameData.Domains.CombatSkill.CombatSkill> learnedCombatSkills = DomainManager.CombatSkill.GetCharCombatSkills(this._taiwuCharId);
				List<KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill>> viableSkills = (from pair in learnedCombatSkills
				where Config.CombatSkill.Instance[pair.Key].Type == skillType && !pair.Value.GetRevoked() && CombatSkillStateHelper.IsBrokenOut(pair.Value.GetActivationState())
				select pair).ToList<KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill>>();
				sbyte grade2;
				sbyte grade;
				for (grade = 0; grade < 9; grade = grade2 + 1)
				{
					short skillId = CombatSkillAttainmentPanelsHelper.Get(panels, skillType, grade);
					bool flag = skillId < 0;
					if (flag)
					{
						Tester.Assert(!viableSkills.Exists((KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill> pair) => Config.CombatSkill.Instance[pair.Key].Grade == grade), "");
					}
					else
					{
						Tester.Assert(Config.CombatSkill.Instance[skillId].Grade == grade, "");
						Tester.Assert(Config.CombatSkill.Instance[skillId].Type == skillType, "");
						Tester.Assert(this._skillBreakPlateObsoleteDict[skillId].Finished, "");
					}
					grade2 = grade;
				}
			}
		}

		// Token: 0x06001352 RID: 4946 RVA: 0x001375E8 File Offset: 0x001357E8
		private void Test_SaveCombatSkillAttainmentPanelPlan(DataContext context)
		{
			short[] panels = this._taiwuChar.GetCombatSkillAttainmentPanels();
			for (sbyte skillType2 = 0; skillType2 < 14; skillType2 += 2)
			{
				this.SaveCombatSkillAttainmentPanelPlan(context, skillType2, skillType2 % 4 + 1);
			}
			sbyte skillType;
			sbyte b;
			for (skillType = 0; skillType < 14; skillType = b + 1)
			{
				Dictionary<short, GameData.Domains.CombatSkill.CombatSkill> learnedCombatSkills = DomainManager.CombatSkill.GetCharCombatSkills(this._taiwuCharId);
				List<KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill>> viableSkills = (from pair in learnedCombatSkills
				where Config.CombatSkill.Instance[pair.Key].Type == skillType && !pair.Value.GetRevoked() && CombatSkillStateHelper.IsBrokenOut(pair.Value.GetActivationState())
				select pair).ToList<KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill>>();
				for (sbyte planId = 0; planId < 5; planId += 1)
				{
					this.SelectCombatSkillAttainmentPanelPlan(context, skillType, planId);
					TaiwuDomain.Logger.Info("CombatSkillAttainmentPanelPlan ========================================");
					Logger logger = TaiwuDomain.Logger;
					DefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(20, 2);
					defaultInterpolatedStringHandler.AppendLiteral("skill type ");
					defaultInterpolatedStringHandler.AppendFormatted<sbyte>(skillType);
					defaultInterpolatedStringHandler.AppendLiteral("\t planId ");
					defaultInterpolatedStringHandler.AppendFormatted<sbyte>(planId);
					logger.Info(defaultInterpolatedStringHandler.ToStringAndClear());
					sbyte grade;
					for (grade = 0; grade < 9; grade = b + 1)
					{
						short skillId = CombatSkillAttainmentPanelsHelper.Get(panels, skillType, grade);
						bool flag = skillId < 0;
						if (flag)
						{
							Tester.Assert(!viableSkills.Exists((KeyValuePair<short, GameData.Domains.CombatSkill.CombatSkill> pair) => Config.CombatSkill.Instance[pair.Key].Grade == grade), "");
							Logger logger2 = TaiwuDomain.Logger;
							defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(51, 2);
							defaultInterpolatedStringHandler.AppendLiteral("Can't find viable CombatSkill with type ");
							defaultInterpolatedStringHandler.AppendFormatted<sbyte>(skillType);
							defaultInterpolatedStringHandler.AppendLiteral(" and grade ");
							defaultInterpolatedStringHandler.AppendFormatted<sbyte>(grade);
							logger2.Warn(defaultInterpolatedStringHandler.ToStringAndClear());
						}
						else
						{
							Logger logger3 = TaiwuDomain.Logger;
							defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(51, 2);
							defaultInterpolatedStringHandler.AppendLiteral("Can't find viable CombatSkill with type ");
							defaultInterpolatedStringHandler.AppendFormatted<sbyte>(skillType);
							defaultInterpolatedStringHandler.AppendLiteral(" and grade ");
							defaultInterpolatedStringHandler.AppendFormatted<sbyte>(grade);
							logger3.Info(defaultInterpolatedStringHandler.ToStringAndClear());
							Tester.Assert(Config.CombatSkill.Instance[skillId].Grade == grade, "");
							Tester.Assert(Config.CombatSkill.Instance[skillId].Type == skillType, "");
							Tester.Assert(this._skillBreakPlateObsoleteDict[skillId].Finished, "");
						}
						b = grade;
					}
				}
				b = skillType;
			}
		}

		// Token: 0x06001353 RID: 4947 RVA: 0x001378B0 File Offset: 0x00135AB0
		// Note: this type is marked as 'beforefieldinit'.
		static TaiwuDomain()
		{
			ItemSourceType[] array = new ItemSourceType[5];
			RuntimeHelpers.InitializeArray(array, fieldof(<PrivateImplementationDetails>.FCE96C000F313F0BDFB17F43C2C4266E96B5CAEA0C615320804F8F566E035B78).FieldHandle);
			TaiwuDomain.TaiwuVillageStorages = array;
			TaiwuDomain.UseDrawConditionCanObtainNeiliIdList = new sbyte[]
			{
				0,
				3,
				6,
				9,
				12,
				15
			};
			TaiwuDomain.UseDrawConditionNeiliAllocationLessThanIdList = new sbyte[]
			{
				2,
				5,
				8,
				11,
				14,
				17
			};
			TaiwuDomain.VillagerRoleNeedLifeSkillBooks = new Dictionary<short, HashSet<sbyte>>
			{
				{
					-1,
					null
				},
				{
					0,
					new HashSet<sbyte>
					{
						14,
						13
					}
				},
				{
					1,
					new HashSet<sbyte>
					{
						7,
						6,
						11,
						14
					}
				},
				{
					2,
					new HashSet<sbyte>
					{
						8,
						9,
						12
					}
				},
				{
					3,
					new HashSet<sbyte>
					{
						5,
						15
					}
				},
				{
					4,
					new HashSet<sbyte>
					{
						0,
						1,
						2,
						3,
						4,
						5
					}
				},
				{
					5,
					new HashSet<sbyte>
					{
						1,
						3,
						2,
						4
					}
				},
				{
					6,
					null
				}
			};
			TaiwuDomain.CacheInfluences = new DataInfluence[77][];
			TaiwuDomain.CacheInfluencesCombatSkillPlans = new DataInfluence[9][];
			TaiwuDomain.CacheInfluencesCurrLifeSkillAttainmentPanelPlanIndex = new DataInfluence[16][];
			TaiwuDomain.CacheInfluencesEquipmentsPlans = new DataInfluence[5][];
			TaiwuDomain.CacheInfluencesCombatGroupCharIds = new DataInfluence[3][];
			TaiwuDomain.CacheInfluencesStateNewCharacterLegacyGrowingGrades = new DataInfluence[15][];
		}

		// Token: 0x06001354 RID: 4948 RVA: 0x00137A68 File Offset: 0x00135C68
		[CompilerGenerated]
		private void <FixItemsPoisonEffects>g__Fix|36_0(ItemKey itemKey, ItemSourceType sourceType, int index = -1, int planIndex = -1, ref TaiwuDomain.<>c__DisplayClass36_0 A_5)
		{
			bool flag = !itemKey.IsValid();
			if (!flag)
			{
				bool flag2 = ModificationStateHelper.IsActive(itemKey.ModificationState, 1);
				if (flag2)
				{
					bool need = false;
					bool flag3 = DomainManager.Item.HasOldPoisonEffects(itemKey);
					if (flag3)
					{
						bool flag4 = !DomainManager.Item.GetOldPoisonEffects(itemKey).HasPoison;
						if (flag4)
						{
							need = true;
						}
					}
					else
					{
						bool flag5 = !DomainManager.Item.PoisonEffects.ContainsKey(itemKey.Id);
						if (flag5)
						{
							need = true;
						}
					}
					bool flag6 = need;
					if (flag6)
					{
						ItemKey newItemKey = itemKey;
						bool flag7 = DomainManager.Item.ItemExists(itemKey);
						if (flag7)
						{
							DomainManager.Item.RemoveOldPoisonEffect(A_5.context, itemKey);
						}
						bool flag8 = sourceType == ItemSourceType.Equipment;
						if (flag8)
						{
							bool flag9 = index > -1;
							if (flag9)
							{
								ItemKey[] equipment = this._taiwuChar.GetEquipment();
								equipment[index] = newItemKey;
								this._taiwuChar.SetEquipment(equipment, A_5.context);
							}
						}
						else
						{
							bool flag10 = sourceType == ItemSourceType.EquipmentPlan && index > -1 && planIndex > -1;
							if (flag10)
							{
								bool flag11 = this._taiwuChar.GetInventory().Items.ContainsKey(itemKey);
								if (flag11)
								{
									this.RemoveItem(A_5.context, itemKey, 1, ItemSourceType.Inventory, false, false);
								}
								bool flag12 = newItemKey.Equals(itemKey);
								if (flag12)
								{
									newItemKey = DomainManager.Item.CreateItem(A_5.context, itemKey.ItemType, itemKey.TemplateId);
									this.AddItem(A_5.context, newItemKey, 1, ItemSourceType.Inventory, false);
								}
								this.SetEquipmentPlan(A_5.context, newItemKey, planIndex, index);
							}
							else
							{
								this.RemoveItem(A_5.context, itemKey, 1, sourceType, false, false);
								this.AddItem(A_5.context, newItemKey, 1, sourceType, false);
							}
						}
					}
				}
			}
		}

		// Token: 0x06001355 RID: 4949 RVA: 0x00137C3C File Offset: 0x00135E3C
		[CompilerGenerated]
		private void <FixSkillBookReadingProgress>g__FixLifeSkillBookReadingProgress|41_0(GameData.Domains.Character.LifeSkillItem lifeSkillItem, TaiwuLifeSkill taiwuLifeSkill, ref TaiwuDomain.<>c__DisplayClass41_0 A_3)
		{
			short skillTemplateId = lifeSkillItem.SkillTemplateId;
			bool isChange = false;
			for (byte pageId = 0; pageId < 5; pageId += 1)
			{
				sbyte readingProgress = taiwuLifeSkill.GetBookPageReadingProgress(pageId);
				bool flag = readingProgress < 100;
				if (flag)
				{
					bool flag2 = lifeSkillItem.IsPageRead(pageId);
					if (flag2)
					{
						taiwuLifeSkill.SetBookPageReadingProgress(pageId, 100);
						isChange = true;
					}
				}
			}
			bool flag3 = isChange;
			if (flag3)
			{
				DomainManager.Taiwu.SetTaiwuLifeSkill(A_3.context, skillTemplateId, taiwuLifeSkill);
				TaiwuDomain.Logger.Warn("Fixing taiwu Wrong SkillBookReadingProgress, SkillName: " + LifeSkill.Instance[skillTemplateId].Name);
			}
		}

		// Token: 0x06001356 RID: 4950 RVA: 0x00137CDC File Offset: 0x00135EDC
		[CompilerGenerated]
		private void <FixSkillBookReadingProgress>g__FixCombatSkillBookReadingProgress|41_1(short skillTemplateId, TaiwuCombatSkill taiwuCombatSkill, ref TaiwuDomain.<>c__DisplayClass41_0 A_3)
		{
			GameData.Domains.CombatSkill.CombatSkill skillItem;
			bool flag = !DomainManager.CombatSkill.TryGetElement_CombatSkills(new CombatSkillKey(this._taiwuCharId, skillTemplateId), out skillItem);
			if (!flag)
			{
				bool isChange = false;
				for (byte combatSkillBookInternalIndex = 0; combatSkillBookInternalIndex < 15; combatSkillBookInternalIndex += 1)
				{
					sbyte readingProgress = taiwuCombatSkill.GetBookPageReadingProgress(combatSkillBookInternalIndex);
					bool flag2 = readingProgress < 100;
					if (flag2)
					{
						bool flag3 = CombatSkillStateHelper.IsPageRead(skillItem.GetReadingState(), combatSkillBookInternalIndex);
						if (flag3)
						{
							taiwuCombatSkill.SetBookPageReadingProgress(combatSkillBookInternalIndex, 100);
							isChange = true;
						}
					}
				}
				bool flag4 = isChange;
				if (flag4)
				{
					this.SetTaiwuCombatSkill(A_3.context, skillTemplateId, taiwuCombatSkill);
					TaiwuDomain.Logger.Warn("Fixing taiwu Wrong SkillBookReadingProgress, SkillName: " + Config.CombatSkill.Instance[skillTemplateId].Name);
				}
			}
		}

		// Token: 0x06001357 RID: 4951 RVA: 0x00137D9C File Offset: 0x00135F9C
		[CompilerGenerated]
		internal static void <FixSkillBookReadingState>g__FixLifeSkillBookReadingState|43_0(GameData.Domains.Character.LifeSkillItem lifeSkillItem, TaiwuLifeSkill taiwuLifeSkill, int i, List<TaiwuDomain.LifeSkillStateModify> lifeSkillStateModifies)
		{
			for (byte pageId = 0; pageId < 5; pageId += 1)
			{
				sbyte readingProgress = taiwuLifeSkill.GetBookPageReadingProgress(pageId);
				bool flag = readingProgress == 100;
				if (flag)
				{
					bool flag2 = !lifeSkillItem.IsPageRead(pageId);
					if (flag2)
					{
						lifeSkillStateModifies.Add(new TaiwuDomain.LifeSkillStateModify
						{
							Index = i,
							ReadPageIndex = (int)pageId
						});
					}
				}
			}
		}

		// Token: 0x06001359 RID: 4953 RVA: 0x00137E14 File Offset: 0x00136014
		[CompilerGenerated]
		internal unsafe static bool <LoseOverloadResources>g__LoseResource|126_0(sbyte resourceType, ref ResourceInts resources, ref int toLoseAmount, TaiwuVillageStorageType storageType = TaiwuVillageStorageType.Count, ref TaiwuDomain.<>c__DisplayClass126_0 A_4)
		{
			bool flag = toLoseAmount <= 0;
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				int loseAmount = Math.Min(*resources[(int)resourceType], toLoseAmount);
				bool flag2 = loseAmount > 0;
				if (flag2)
				{
					*resources[(int)resourceType] -= loseAmount;
					toLoseAmount -= loseAmount;
					bool flag3 = storageType != TaiwuVillageStorageType.Count;
					if (flag3)
					{
						A_4.taiwuVillageStoragesRecordCollection.AddLoseOverloadResources(A_4.currDate, storageType, resourceType, loseAmount);
					}
				}
				result = true;
			}
			return result;
		}

		// Token: 0x0600135A RID: 4954 RVA: 0x00137E88 File Offset: 0x00136088
		[CompilerGenerated]
		private bool <UnpackCrossArchiveGameData_LifeSkills>g__CombineDreamBackTaiwuLifeSkill|288_0(short skillId, TaiwuLifeSkill dreamBackLifeSkill, ref TaiwuDomain.<>c__DisplayClass288_0 A_3)
		{
			TaiwuLifeSkill lifeSkill;
			bool flag = this._lifeSkills.TryGetValue(skillId, out lifeSkill);
			bool result;
			if (flag)
			{
				TaiwuDomain.<UnpackCrossArchiveGameData_LifeSkills>g__CombineTaiwuLifeSkillData|288_1(lifeSkill, dreamBackLifeSkill);
				this.SetElement_LifeSkills(skillId, lifeSkill, A_3.context);
				result = true;
			}
			else
			{
				TaiwuLifeSkill notLearnedLifeSkill;
				bool flag2 = this._notLearnLifeSkillReadingProgress.TryGetValue(skillId, out notLearnedLifeSkill);
				if (flag2)
				{
					TaiwuDomain.<UnpackCrossArchiveGameData_LifeSkills>g__CombineTaiwuLifeSkillData|288_1(notLearnedLifeSkill, dreamBackLifeSkill);
					this.RemoveElement_NotLearnCombatSkillReadingProgress(skillId, A_3.context);
					this.AddElement_LifeSkills(skillId, notLearnedLifeSkill, A_3.context);
					result = true;
				}
				else
				{
					result = false;
				}
			}
			return result;
		}

		// Token: 0x0600135B RID: 4955 RVA: 0x00137F08 File Offset: 0x00136108
		[CompilerGenerated]
		internal static void <UnpackCrossArchiveGameData_LifeSkills>g__CombineTaiwuLifeSkillData|288_1(TaiwuLifeSkill taiwuLifeSkill, TaiwuLifeSkill dreamBackLifeSkill)
		{
			sbyte[] readingProgress = taiwuLifeSkill.GetAllBookPageReadingProgress();
			sbyte[] dreamBackReadingProgress = dreamBackLifeSkill.GetAllBookPageReadingProgress();
			byte index = 0;
			while ((int)index < readingProgress.Length)
			{
				sbyte progress = Math.Max(readingProgress[(int)index], dreamBackReadingProgress[(int)index]);
				taiwuLifeSkill.SetBookPageReadingProgress(index, progress);
				index += 1;
			}
		}

		// Token: 0x0600135C RID: 4956 RVA: 0x00137F50 File Offset: 0x00136150
		[CompilerGenerated]
		private bool <UnpackCrossArchiveGameData_CombatSkills>g__CombineDreamBackTaiwuCombatSkill|289_0(short skillId, TaiwuCombatSkill dreamBackCombatSkill, ref TaiwuDomain.<>c__DisplayClass289_0 A_3)
		{
			TaiwuCombatSkill combatSkill;
			bool flag = this._combatSkills.TryGetValue(skillId, out combatSkill);
			bool result;
			if (flag)
			{
				TaiwuDomain.<UnpackCrossArchiveGameData_CombatSkills>g__CombineTaiwuCombatSkillData|289_1(combatSkill, dreamBackCombatSkill);
				this.SetElement_CombatSkills(skillId, combatSkill, A_3.context);
				result = true;
			}
			else
			{
				TaiwuCombatSkill notLearnedCombatSkill;
				bool flag2 = this._notLearnCombatSkillReadingProgress.TryGetValue(skillId, out notLearnedCombatSkill);
				if (flag2)
				{
					TaiwuDomain.<UnpackCrossArchiveGameData_CombatSkills>g__CombineTaiwuCombatSkillData|289_1(notLearnedCombatSkill, dreamBackCombatSkill);
					this.RemoveElement_NotLearnCombatSkillReadingProgress(skillId, A_3.context);
					this.AddElement_CombatSkills(skillId, notLearnedCombatSkill, A_3.context);
					result = true;
				}
				else
				{
					result = false;
				}
			}
			return result;
		}

		// Token: 0x0600135D RID: 4957 RVA: 0x00137FD0 File Offset: 0x001361D0
		[CompilerGenerated]
		internal static void <UnpackCrossArchiveGameData_CombatSkills>g__CombineTaiwuCombatSkillData|289_1(TaiwuCombatSkill taiwuCombatSkill, TaiwuCombatSkill dreamBackCombatSkill)
		{
			taiwuCombatSkill.FullPowerCastTimes = Math.Max(taiwuCombatSkill.FullPowerCastTimes, dreamBackCombatSkill.FullPowerCastTimes);
			taiwuCombatSkill.LastClearBreakPlateTime = Math.Max(taiwuCombatSkill.LastClearBreakPlateTime, dreamBackCombatSkill.LastClearBreakPlateTime);
			sbyte[] readingProgress = taiwuCombatSkill.GetAllBookPageReadingProgress();
			sbyte[] dreamBackReadingProgress = dreamBackCombatSkill.GetAllBookPageReadingProgress();
			byte internalIndex = 0;
			while ((int)internalIndex < readingProgress.Length)
			{
				sbyte progress = Math.Max(readingProgress[(int)internalIndex], dreamBackReadingProgress[(int)internalIndex]);
				taiwuCombatSkill.SetBookPageReadingProgress(internalIndex, progress);
				internalIndex += 1;
			}
		}

		// Token: 0x0600135E RID: 4958 RVA: 0x00138048 File Offset: 0x00136248
		[CompilerGenerated]
		internal static bool <ReCalcAllEquipment>g__UpdateEquipmentsInDictionary|468_0(Dictionary<ItemKey, int> items, ref TaiwuDomain.<>c__DisplayClass468_0 A_1)
		{
			bool elementModified = false;
			foreach (KeyValuePair<ItemKey, int> keyValuePair in items)
			{
				ItemKey itemKey2;
				int num;
				keyValuePair.Deconstruct(out itemKey2, out num);
				ItemKey itemKey = itemKey2;
				bool flag = TaiwuDomain.<ReCalcAllEquipment>g__UpdateEquipment|468_1(itemKey, ref A_1);
				if (flag)
				{
					elementModified = true;
				}
			}
			return elementModified;
		}

		// Token: 0x0600135F RID: 4959 RVA: 0x001380C0 File Offset: 0x001362C0
		[CompilerGenerated]
		internal static bool <ReCalcAllEquipment>g__UpdateEquipment|468_1(ItemKey itemKey, ref TaiwuDomain.<>c__DisplayClass468_0 A_1)
		{
			bool flag = ItemTemplateHelper.IsRefinable(itemKey.ItemType, itemKey.TemplateId) && ModificationStateHelper.IsActive(itemKey.ModificationState, 2);
			bool result;
			if (flag)
			{
				EquipmentBase baseEquipment = DomainManager.Item.GetBaseEquipment(itemKey);
				baseEquipment.SetModificationState(baseEquipment.GetModificationState(), A_1.context);
				result = true;
			}
			else
			{
				result = false;
			}
			return result;
		}

		// Token: 0x06001360 RID: 4960 RVA: 0x00138120 File Offset: 0x00136320
		[CompilerGenerated]
		internal static void <GmCmd_MarkAllCarrierFullTamePoint>g__TryAddCarrierId|493_0(ItemKey itemKey, ref TaiwuDomain.<>c__DisplayClass493_0 A_1)
		{
			bool flag = !itemKey.IsValid();
			if (!flag)
			{
				bool flag2 = itemKey.ItemType != 4;
				if (!flag2)
				{
					bool flag3 = !DomainManager.Extra.IsCarrierTamable(itemKey.TemplateId);
					if (!flag3)
					{
						bool flag4 = DomainManager.Extra.IsCarrierFullTamePoint(itemKey);
						if (!flag4)
						{
							A_1.carrierIds.Add(itemKey.Id);
						}
					}
				}
			}
		}

		// Token: 0x06001361 RID: 4961 RVA: 0x0013818C File Offset: 0x0013638C
		[CompilerGenerated]
		private ValueTuple<sbyte, int> <GetProfessionTipDisplayData>g__GetWorkingSkillTypeAndBonus|592_0(ref TaiwuDomain.<>c__DisplayClass592_0 A_1)
		{
			ProfessionItem config = Profession.Instance[A_1.professionId];
			GameData.Domains.Character.Character taiwu = DomainManager.Taiwu.GetTaiwu();
			int factor = 100;
			sbyte workingSkillType = -1;
			bool flag = config.BonusLifeSkills != null;
			if (flag)
			{
				short bestAttainment = 0;
				foreach (sbyte lifeSkillType in config.BonusLifeSkills)
				{
					short attainment = taiwu.GetLifeSkillAttainment(lifeSkillType);
					bool flag2 = attainment > bestAttainment;
					if (flag2)
					{
						bestAttainment = attainment;
						workingSkillType = lifeSkillType;
					}
				}
				factor += (int)(bestAttainment / 3);
			}
			bool flag3 = config.BonusCombatSkills != null;
			if (flag3)
			{
				short bestAttainment2 = 0;
				foreach (sbyte combatSkillType in config.BonusCombatSkills)
				{
					short attainment2 = taiwu.GetCombatSkillAttainment(combatSkillType);
					bool flag4 = attainment2 > bestAttainment2;
					if (flag4)
					{
						bestAttainment2 = attainment2;
						workingSkillType = combatSkillType;
					}
				}
				factor += (int)(bestAttainment2 / 3);
			}
			return new ValueTuple<sbyte, int>(workingSkillType, factor);
		}

		// Token: 0x06001362 RID: 4962 RVA: 0x001382C4 File Offset: 0x001364C4
		[CompilerGenerated]
		private bool <GetProfessionTipDisplayData>g__IsWearingBonusClothing|592_1(ref TaiwuDomain.<>c__DisplayClass592_0 A_1)
		{
			ItemKey clothingKey = this._taiwuChar.GetEquipment()[4];
			bool flag = !clothingKey.IsValid() || DomainManager.Item.GetBaseItem(clothingKey).IsDurabilityRunningOut();
			bool result;
			if (flag)
			{
				result = false;
			}
			else
			{
				ProfessionItem professionConfig = Profession.Instance[A_1.professionId];
				result = (professionConfig.BonusClothing == clothingKey.TemplateId);
			}
			return result;
		}

		// Token: 0x04000240 RID: 576
		private static readonly Logger Logger = LogManager.GetCurrentClassLogger();

		// Token: 0x04000241 RID: 577
		[DomainData(DomainDataType.SingleValue, true, false, true, false)]
		private int _taiwuCharId;

		// Token: 0x04000242 RID: 578
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private int _taiwuGenerationsCount;

		// Token: 0x04000243 RID: 579
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private int _cricketLuckPoint;

		// Token: 0x04000244 RID: 580
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private List<int> _previousTaiwuIds;

		// Token: 0x04000245 RID: 581
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private bool _needToEscape;

		// Token: 0x04000246 RID: 582
		[DomainData(DomainDataType.SingleValue, false, false, true, true)]
		private List<ItemDisplayData> _receivedItems;

		// Token: 0x04000247 RID: 583
		[DomainData(DomainDataType.SingleValue, false, false, true, true)]
		private List<CharacterDisplayData> _receivedCharacters;

		// Token: 0x04000248 RID: 584
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private bool _villagerLearnCombatSkillsFromSect;

		// Token: 0x04000249 RID: 585
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private bool _villagerLearnLifeSkillsFromSect;

		// Token: 0x0400024A RID: 586
		private List<int> _prevMonthResourceCollection;

		// Token: 0x0400024B RID: 587
		[DomainData(DomainDataType.SingleValueCollection, true, false, false, false)]
		private readonly Dictionary<ItemKey, int> _warehouseItems;

		// Token: 0x0400024C RID: 588
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _warehouseMaxLoad;

		// Token: 0x0400024D RID: 589
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _warehouseCurrLoad;

		// Token: 0x0400024E RID: 590
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _troughCurrLoad;

		// Token: 0x0400024F RID: 591
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _troughMaxLoad;

		// Token: 0x04000250 RID: 592
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _buildingSpaceLimit;

		// Token: 0x04000251 RID: 593
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _buildingSpaceCurr;

		// Token: 0x04000252 RID: 594
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private int _buildingSpaceExtraAdd;

		// Token: 0x04000253 RID: 595
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private bool _prosperousConstruction;

		// Token: 0x04000254 RID: 596
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private ResourceInts _totalResources;

		// Token: 0x04000255 RID: 597
		private static readonly ItemSourceType[] TaiwuVillageStorages;

		// Token: 0x04000256 RID: 598
		public const sbyte TeachTaiwuMaxLifeSkill = 3;

		// Token: 0x04000257 RID: 599
		public const sbyte TeachTaiwuMaxCombatSkill = 3;

		// Token: 0x04000258 RID: 600
		public const sbyte ThinkPageVisibleRange = 3;

		// Token: 0x04000259 RID: 601
		public const int SkillAttainmentPanelPlanCount = 5;

		// Token: 0x0400025A RID: 602
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, false)]
		private readonly Dictionary<short, TaiwuCombatSkill> _combatSkills;

		// Token: 0x0400025B RID: 603
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, false)]
		private readonly Dictionary<short, TaiwuLifeSkill> _lifeSkills;

		// Token: 0x0400025C RID: 604
		[DomainData(DomainDataType.ElementList, true, false, false, false, ArrayElementsCount = 9)]
		private readonly CombatSkillPlan[] _combatSkillPlans;

		// Token: 0x0400025D RID: 605
		[DomainData(DomainDataType.SingleValue, true, false, true, false)]
		private int _currCombatSkillPlanId;

		// Token: 0x0400025E RID: 606
		[DomainData(DomainDataType.ElementList, true, false, true, true, ArrayElementsCount = 16)]
		private readonly sbyte[] _currLifeSkillAttainmentPanelPlanIndex;

		// Token: 0x0400025F RID: 607
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, true)]
		private readonly Dictionary<short, SkillBreakPlateObsolete> _skillBreakPlateObsoleteDict;

		// Token: 0x04000260 RID: 608
		[DomainData(DomainDataType.SingleValueCollection, true, false, false, false)]
		private readonly Dictionary<short, SkillBreakBonusCollection> _skillBreakBonusDict;

		// Token: 0x04000261 RID: 609
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, false)]
		private readonly Dictionary<int, GameData.Utilities.ShortList> _teachTaiwuLifeSkillDict;

		// Token: 0x04000262 RID: 610
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, false)]
		private readonly Dictionary<int, GameData.Utilities.ShortList> _teachTaiwuCombatSkillDict;

		// Token: 0x04000263 RID: 611
		[DomainData(DomainDataType.SingleValue, true, false, true, false, ArrayElementsCount = 630)]
		private short[] _combatSkillAttainmentPanelPlans;

		// Token: 0x04000264 RID: 612
		[DomainData(DomainDataType.SingleValue, true, false, true, false, ArrayElementsCount = 14)]
		private sbyte[] _currCombatSkillAttainmentPanelPlanIds;

		// Token: 0x04000265 RID: 613
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private bool _canBreakOut;

		// Token: 0x04000266 RID: 614
		private GameData.Domains.Character.Character _taiwuChar;

		// Token: 0x04000267 RID: 615
		private CivilianSettlement _taiwuVillage;

		// Token: 0x04000268 RID: 616
		private bool _canTaiwuBeSneakyHarmfulActionTarget;

		// Token: 0x04000269 RID: 617
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _moveTimeCostPercent;

		// Token: 0x0400026A RID: 618
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private List<IntPair> _overweightSanctionPercent;

		// Token: 0x0400026B RID: 619
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private List<IntPair> _clothingDurability;

		// Token: 0x0400026C RID: 620
		[DomainData(DomainDataType.SingleValue, true, false, true, true, ArrayElementsCount = 6)]
		private sbyte[] _weaponInnerRatios;

		// Token: 0x0400026D RID: 621
		[DomainData(DomainDataType.SingleValue, false, true, true, true, ArrayElementsCount = 7)]
		private sbyte[] _weaponCurrInnerRatios;

		// Token: 0x0400026E RID: 622
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, true)]
		private readonly Dictionary<int, short> _appointments;

		// Token: 0x0400026F RID: 623
		[DomainData(DomainDataType.SingleValue, true, false, false, false)]
		private short _babyBonusMainAttributes;

		// Token: 0x04000270 RID: 624
		[DomainData(DomainDataType.SingleValue, true, false, false, false)]
		private short _babyBonusLifeSkillQualifications;

		// Token: 0x04000271 RID: 625
		[DomainData(DomainDataType.SingleValue, true, false, false, false)]
		private short _babyBonusCombatSkillQualifications;

		// Token: 0x04000272 RID: 626
		public bool JieqingPunishmentAssassinAlreadyAdd;

		// Token: 0x04000273 RID: 627
		public bool JieqingHuntTaiwu;

		// Token: 0x04000275 RID: 629
		private HashSet<int> _debateVisitedPawns = new HashSet<int>();

		// Token: 0x04000276 RID: 630
		private HashSet<int> _debateNpcSpectators = new HashSet<int>();

		// Token: 0x04000277 RID: 631
		private Dictionary<int, int> _debateSpectatorCooldownMap = new Dictionary<int, int>();

		// Token: 0x04000278 RID: 632
		private int _debateCardUsedCount;

		// Token: 0x04000279 RID: 633
		[TupleElementNames(new string[]
		{
			"taiwu",
			"npc"
		})]
		private ValueTuple<int, int> _debateBeatPawnCount;

		// Token: 0x0400027A RID: 634
		[TupleElementNames(new string[]
		{
			"taiwu",
			"npc"
		})]
		private ValueTuple<int, int> _debateRevealedPawnCount;

		// Token: 0x0400027B RID: 635
		private int _pawnId;

		// Token: 0x0400027C RID: 636
		private int _nodeEffectId;

		// Token: 0x0400027D RID: 637
		private int _activatedStrategyId;

		// Token: 0x0400027E RID: 638
		private int _debateNpcId = -1;

		// Token: 0x0400027F RID: 639
		private sbyte _debateLifeSkillType = -1;

		// Token: 0x04000280 RID: 640
		private DebateAi _debateAiTaiwu;

		// Token: 0x04000281 RID: 641
		private DebateAi _debateAiNpc;

		// Token: 0x04000282 RID: 642
		private GameData.Domains.Character.Character _debateNpc;

		// Token: 0x04000283 RID: 643
		private bool _forceAiBribery = false;

		// Token: 0x04000284 RID: 644
		private Dictionary<int, Action<DebateStrategyActionParams>> _debateStrategyActions;

		// Token: 0x04000285 RID: 645
		private readonly List<Action> _oneTimeStrategyActionList = new List<Action>();

		// Token: 0x04000286 RID: 646
		private const int EquipmentPlansCount = 5;

		// Token: 0x04000287 RID: 647
		[DomainData(DomainDataType.ElementList, true, false, false, false, ArrayElementsCount = 5)]
		private readonly EquipmentPlan[] _equipmentsPlans;

		// Token: 0x04000288 RID: 648
		[DomainData(DomainDataType.SingleValue, true, false, true, false)]
		private int _currEquipmentPlanId;

		// Token: 0x04000289 RID: 649
		public const sbyte TaiwuGroupBaseMaxCount = 10;

		// Token: 0x0400028A RID: 650
		[DomainData(DomainDataType.SingleValue, true, false, true, false)]
		private CharacterSet _groupCharIds;

		// Token: 0x0400028B RID: 651
		[DomainData(DomainDataType.ElementList, true, false, true, true, ArrayElementsCount = 3)]
		private readonly int[] _combatGroupCharIds;

		// Token: 0x0400028C RID: 652
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _taiwuGroupMaxCount;

		// Token: 0x0400028D RID: 653
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private Injuries _taiwuGroupWorstInjuries;

		// Token: 0x0400028E RID: 654
		[DomainData(DomainDataType.SingleValue, false, true, true, false)]
		private List<int> _taiwuSpecialGroup;

		// Token: 0x0400028F RID: 655
		[DomainData(DomainDataType.SingleValue, false, true, true, false)]
		private List<int> _taiwuGearMateGroup;

		// Token: 0x04000290 RID: 656
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, true)]
		private Dictionary<short, short> _legacyPointDict;

		// Token: 0x04000291 RID: 657
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private int _legacyPoint;

		// Token: 0x04000292 RID: 658
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private List<short> _availableLegacyList;

		// Token: 0x04000293 RID: 659
		[DomainData(DomainDataType.SingleValue, false, false, true, false)]
		private sbyte _legacyPassingState;

		// Token: 0x04000294 RID: 660
		[DomainData(DomainDataType.SingleValue, false, false, true, false)]
		private List<int> _successorCandidates;

		// Token: 0x04000295 RID: 661
		[DomainData(DomainDataType.ElementList, true, false, true, true, ArrayElementsCount = 15)]
		private readonly SByteList[] _stateNewCharacterLegacyGrowingGrades;

		// Token: 0x04000296 RID: 662
		private bool _isTaiwuDying;

		// Token: 0x04000297 RID: 663
		[DomainData(DomainDataType.SingleValue, false, false, true, true)]
		private bool _isTaiwuDieOfCombatWithXiangshu;

		// Token: 0x04000298 RID: 664
		private readonly List<short> _selectedLegacies = new List<short>();

		// Token: 0x04000299 RID: 665
		private static List<ValueTuple<short, short>>[][] _categorizedNormalLegacyConfigs;

		// Token: 0x0400029A RID: 666
		private Match _lifeSkillCombat;

		// Token: 0x0400029B RID: 667
		private ItemKey _lockedItemKey = ItemKey.Invalid;

		// Token: 0x0400029C RID: 668
		private readonly Dictionary<OperationPrepareForceAdversary.ForceAdversaryOperation, bool> _nextLifeSkillCombatForceOperationForbid = new Dictionary<OperationPrepareForceAdversary.ForceAdversaryOperation, bool>();

		// Token: 0x0400029D RID: 669
		public const int MaxReferenceSkillCount = 3;

		// Token: 0x0400029E RID: 670
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private byte _referenceSkillSlotUnlockStates;

		// Token: 0x0400029F RID: 671
		private static bool _autoAllocateNeiliToMax;

		// Token: 0x040002A0 RID: 672
		private int _currentLoopingEventCostedConcentration = 0;

		// Token: 0x040002A1 RID: 673
		private static readonly sbyte[] UseDrawConditionCanObtainNeiliIdList;

		// Token: 0x040002A2 RID: 674
		private static readonly sbyte[] UseDrawConditionNeiliAllocationLessThanIdList;

		// Token: 0x040002A3 RID: 675
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, false)]
		private readonly Dictionary<short, TaiwuCombatSkill> _notLearnCombatSkillReadingProgress;

		// Token: 0x040002A4 RID: 676
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, false)]
		private readonly Dictionary<short, TaiwuLifeSkill> _notLearnLifeSkillReadingProgress;

		// Token: 0x040002A5 RID: 677
		[DomainData(DomainDataType.SingleValueCollection, true, false, false, false)]
		private readonly Dictionary<ItemKey, ReadingBookStrategies> _readingBooks;

		// Token: 0x040002A6 RID: 678
		[DomainData(DomainDataType.SingleValue, true, false, true, false)]
		private ItemKey _curReadingBook;

		// Token: 0x040002A7 RID: 679
		[DomainData(DomainDataType.SingleValue, true, false, true, false, ArrayElementsCount = 3)]
		private ItemKey[] _referenceBooks;

		// Token: 0x040002A8 RID: 680
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private byte _referenceBookSlotUnlockStates;

		// Token: 0x040002A9 RID: 681
		[Obsolete("Use _readingEventBookIdList Instead")]
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private bool _readingEventTriggered;

		// Token: 0x040002AA RID: 682
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private sbyte _readInCombatCount;

		// Token: 0x040002AB RID: 683
		private int _currentReadingEventCostedIntelligence;

		// Token: 0x040002AC RID: 684
		private readonly List<short> _unlockedDebateStrategyList = new List<short>();

		// Token: 0x040002AD RID: 685
		[DomainData(DomainDataType.SingleValue, false, false, true, true)]
		private bool _healingOuterInjuryRestriction;

		// Token: 0x040002AE RID: 686
		[DomainData(DomainDataType.SingleValue, false, false, true, true)]
		private bool _healingInnerInjuryRestriction;

		// Token: 0x040002AF RID: 687
		[DomainData(DomainDataType.SingleValue, false, false, true, false)]
		private byte _neiliAllocationTypeRestriction;

		// Token: 0x040002B0 RID: 688
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private List<short> _visitedSettlements;

		// Token: 0x040002B1 RID: 689
		private const short WarehouseBaseMaxLoad = 5000;

		// Token: 0x040002B2 RID: 690
		private const short ProsperousConstructionSpace = 20;

		// Token: 0x040002B3 RID: 691
		public const sbyte ResourceRecoverSpeedMultiplierWithWorker = 3;

		// Token: 0x040002B4 RID: 692
		[DomainData(DomainDataType.SingleValue, true, false, true, true)]
		private short _taiwuVillageSettlementId;

		// Token: 0x040002B5 RID: 693
		[DomainData(DomainDataType.SingleValueCollection, true, false, true, true)]
		private readonly Dictionary<int, VillagerWorkData> _villagerWork;

		// Token: 0x040002B6 RID: 694
		[DomainData(DomainDataType.SingleValueCollection, false, false, true, false)]
		private readonly HashSetAsDictionary<Location> _villagerWorkLocations;

		// Token: 0x040002B7 RID: 695
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private int _materialResourceMaxCount;

		// Token: 0x040002B8 RID: 696
		[DomainData(DomainDataType.SingleValue, false, true, true, true, ArrayElementsCount = 8)]
		private int[] _resourceChange;

		// Token: 0x040002B9 RID: 697
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private short _workLocationMaxCount;

		// Token: 0x040002BA RID: 698
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private short _totalVillagerCount;

		// Token: 0x040002BB RID: 699
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private short _totalAdultVillagerCount;

		// Token: 0x040002BC RID: 700
		[DomainData(DomainDataType.SingleValue, false, true, true, true)]
		private short _availableVillagerCount;

		// Token: 0x040002BD RID: 701
		private readonly List<int> _moveToWorkLocationCharList = new List<int>();

		// Token: 0x040002BE RID: 702
		public readonly Dictionary<sbyte, List<Location>> ResourceRecoverSpeedUpDict = new Dictionary<sbyte, List<Location>>();

		// Token: 0x040002BF RID: 703
		private bool _needCommitTaiwuSettlementTreasury;

		// Token: 0x040002C0 RID: 704
		private readonly bool[] _preAdvanceVillagerRoleFarmerFixedActionSuccessArray = new bool[1];

		// Token: 0x040002C1 RID: 705
		private readonly bool[] _preAdvanceVillagerRoleCraftsmanFixedActionSuccessArray = new bool[4];

		// Token: 0x040002C2 RID: 706
		private readonly bool[] _preAdvanceVillagerRoleDoctorFixedActionSuccessArray = new bool[3];

		// Token: 0x040002C3 RID: 707
		private readonly bool[] _periAdvanceVillagerRoleFarmerFixedActionSuccessArray = new bool[1];

		// Token: 0x040002C4 RID: 708
		private readonly bool[] _periAdvanceVillagerRoleCraftsmanFixedActionSuccessArray = new bool[4];

		// Token: 0x040002C5 RID: 709
		private readonly bool[] _periAdvanceVillagerRoleDoctorFixedActionSuccessArray = new bool[3];

		// Token: 0x040002C6 RID: 710
		private readonly float _gainItemActionRate = 0.5f;

		// Token: 0x040002C7 RID: 711
		private readonly Dictionary<short, HashSet<sbyte>> _villagerRoleNeedMaterials = new Dictionary<short, HashSet<sbyte>>
		{
			{
				-1,
				null
			},
			{
				0,
				new HashSet<sbyte>
				{
					0
				}
			},
			{
				1,
				new HashSet<sbyte>
				{
					1,
					3,
					2,
					4
				}
			},
			{
				2,
				new HashSet<sbyte>
				{
					5
				}
			},
			{
				3,
				new HashSet<sbyte>
				{
					3,
					4,
					0
				}
			},
			{
				4,
				new HashSet<sbyte>
				{
					3,
					4
				}
			},
			{
				5,
				new HashSet<sbyte>
				{
					1,
					3,
					2,
					4
				}
			},
			{
				6,
				null
			}
		};

		// Token: 0x040002C8 RID: 712
		public static readonly Dictionary<short, HashSet<sbyte>> VillagerRoleNeedLifeSkillBooks;

		// Token: 0x040002C9 RID: 713
		private readonly List<int>[] _villagerListClassArray = new List<int>[9];

		// Token: 0x040002CA RID: 714
		private readonly Dictionary<int, sbyte> _villagerClassDict = new Dictionary<int, sbyte>(9);

		// Token: 0x040002CB RID: 715
		private readonly Dictionary<int, List<GameData.Domains.Character.Ai.PersonalNeed>> _timeMeetTreasuryNeedDict = new Dictionary<int, List<GameData.Domains.Character.Ai.PersonalNeed>>(128);

		// Token: 0x040002CC RID: 716
		private readonly Dictionary<ItemKey, int> _villagerItems = new Dictionary<ItemKey, int>(512);

		// Token: 0x040002CD RID: 717
		private readonly HashSet<sbyte> _villagerGainedItemTypeSet = new HashSet<sbyte>();

		// Token: 0x040002CE RID: 718
		[TupleElementNames(new string[]
		{
			"itemKey",
			"score"
		})]
		private readonly Dictionary<short, List<ValueTuple<ItemKey, int>>> _villagerSelectableItemKeys = new Dictionary<short, List<ValueTuple<ItemKey, int>>>(512);

		// Token: 0x040002CF RID: 719
		[TupleElementNames(new string[]
		{
			"weapon",
			"score"
		})]
		private readonly List<ValueTuple<ItemKey, int>> _availableWeapons = new List<ValueTuple<ItemKey, int>>(128);

		// Token: 0x040002D0 RID: 720
		[TupleElementNames(new string[]
		{
			"itemTemplateId",
			"count"
		})]
		private readonly List<ValueTuple<short, short>> _suitableWeapons = new List<ValueTuple<short, short>>(128);

		// Token: 0x040002D1 RID: 721
		private readonly HashSet<short> _fixedBestWeapons = new HashSet<short>(128);

		// Token: 0x040002D2 RID: 722
		private readonly Dictionary<ItemKey, Dictionary<int, sbyte>> _treasuryNeededItemDict = new Dictionary<ItemKey, Dictionary<int, sbyte>>(128);

		// Token: 0x040002D3 RID: 723
		[TupleElementNames(new string[]
		{
			"item",
			"amount"
		})]
		private readonly List<ValueTuple<GameData.Domains.Item.Medicine, int>>[] _categorizedMedicines = new List<ValueTuple<GameData.Domains.Item.Medicine, int>>[]
		{
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Medicine, int>>(64)
		};

		// Token: 0x040002D4 RID: 724
		[TupleElementNames(new string[]
		{
			"item",
			"amount"
		})]
		private readonly List<ValueTuple<GameData.Domains.Item.Misc, int>> _itemsForNeili = new List<ValueTuple<GameData.Domains.Item.Misc, int>>(64);

		// Token: 0x040002D5 RID: 725
		[TupleElementNames(new string[]
		{
			"item",
			"amount"
		})]
		private readonly List<ValueTuple<GameData.Domains.Item.Food, int>>[] _foodsForMainAttributes = new List<ValueTuple<GameData.Domains.Item.Food, int>>[]
		{
			new List<ValueTuple<GameData.Domains.Item.Food, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Food, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Food, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Food, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Food, int>>(64),
			new List<ValueTuple<GameData.Domains.Item.Food, int>>(64)
		};

		// Token: 0x040002D6 RID: 726
		[TupleElementNames(new string[]
		{
			"item",
			"amount"
		})]
		private readonly List<ValueTuple<GameData.Domains.Item.TeaWine, int>> _teaWinesForHappiness = new List<ValueTuple<GameData.Domains.Item.TeaWine, int>>(64);

		// Token: 0x040002D7 RID: 727
		private readonly ISet<int> _villagerFeatureHolderSet = new HashSet<int>();

		// Token: 0x040002D8 RID: 728
		private static short[] _gradeVillagerRoles;

		// Token: 0x040002D9 RID: 729
		private static readonly DataInfluence[][] CacheInfluences;

		// Token: 0x040002DA RID: 730
		private SpinLock _spinLockWarehouseMaxLoad = new SpinLock(false);

		// Token: 0x040002DB RID: 731
		private SpinLock _spinLockWarehouseCurrLoad = new SpinLock(false);

		// Token: 0x040002DC RID: 732
		private SpinLock _spinLockBuildingSpaceLimit = new SpinLock(false);

		// Token: 0x040002DD RID: 733
		private SpinLock _spinLockBuildingSpaceCurr = new SpinLock(false);

		// Token: 0x040002DE RID: 734
		private SingleValueCollectionModificationCollection<short> _modificationsCombatSkills = SingleValueCollectionModificationCollection<short>.Create();

		// Token: 0x040002DF RID: 735
		private SingleValueCollectionModificationCollection<short> _modificationsLifeSkills = SingleValueCollectionModificationCollection<short>.Create();

		// Token: 0x040002E0 RID: 736
		private static readonly DataInfluence[][] CacheInfluencesCombatSkillPlans;

		// Token: 0x040002E1 RID: 737
		private readonly byte[] _dataStatesCombatSkillPlans = new byte[3];

		// Token: 0x040002E2 RID: 738
		private static readonly DataInfluence[][] CacheInfluencesCurrLifeSkillAttainmentPanelPlanIndex;

		// Token: 0x040002E3 RID: 739
		private readonly byte[] _dataStatesCurrLifeSkillAttainmentPanelPlanIndex = new byte[4];

		// Token: 0x040002E4 RID: 740
		private SingleValueCollectionModificationCollection<short> _modificationsSkillBreakPlateObsoleteDict = SingleValueCollectionModificationCollection<short>.Create();

		// Token: 0x040002E5 RID: 741
		private SingleValueCollectionModificationCollection<int> _modificationsTeachTaiwuLifeSkillDict = SingleValueCollectionModificationCollection<int>.Create();

		// Token: 0x040002E6 RID: 742
		private SingleValueCollectionModificationCollection<int> _modificationsTeachTaiwuCombatSkillDict = SingleValueCollectionModificationCollection<int>.Create();

		// Token: 0x040002E7 RID: 743
		private SpinLock _spinLockMoveTimeCostPercent = new SpinLock(false);

		// Token: 0x040002E8 RID: 744
		private SpinLock _spinLockWeaponCurrInnerRatios = new SpinLock(false);

		// Token: 0x040002E9 RID: 745
		private SingleValueCollectionModificationCollection<int> _modificationsAppointments = SingleValueCollectionModificationCollection<int>.Create();

		// Token: 0x040002EA RID: 746
		private static readonly DataInfluence[][] CacheInfluencesEquipmentsPlans;

		// Token: 0x040002EB RID: 747
		private readonly byte[] _dataStatesEquipmentsPlans = new byte[2];

		// Token: 0x040002EC RID: 748
		private static readonly DataInfluence[][] CacheInfluencesCombatGroupCharIds;

		// Token: 0x040002ED RID: 749
		private readonly byte[] _dataStatesCombatGroupCharIds = new byte[1];

		// Token: 0x040002EE RID: 750
		private SpinLock _spinLockTaiwuGroupMaxCount = new SpinLock(false);

		// Token: 0x040002EF RID: 751
		private SingleValueCollectionModificationCollection<short> _modificationsLegacyPointDict = SingleValueCollectionModificationCollection<short>.Create();

		// Token: 0x040002F0 RID: 752
		private static readonly DataInfluence[][] CacheInfluencesStateNewCharacterLegacyGrowingGrades;

		// Token: 0x040002F1 RID: 753
		private readonly byte[] _dataStatesStateNewCharacterLegacyGrowingGrades = new byte[4];

		// Token: 0x040002F2 RID: 754
		private SingleValueCollectionModificationCollection<short> _modificationsNotLearnCombatSkillReadingProgress = SingleValueCollectionModificationCollection<short>.Create();

		// Token: 0x040002F3 RID: 755
		private SingleValueCollectionModificationCollection<short> _modificationsNotLearnLifeSkillReadingProgress = SingleValueCollectionModificationCollection<short>.Create();

		// Token: 0x040002F4 RID: 756
		private SpinLock _spinLockReferenceBookSlotUnlockStates = new SpinLock(false);

		// Token: 0x040002F5 RID: 757
		private SingleValueCollectionModificationCollection<int> _modificationsVillagerWork = SingleValueCollectionModificationCollection<int>.Create();

		// Token: 0x040002F6 RID: 758
		private SingleValueCollectionModificationCollection<Location> _modificationsVillagerWorkLocations = SingleValueCollectionModificationCollection<Location>.Create();

		// Token: 0x040002F7 RID: 759
		private SpinLock _spinLockMaterialResourceMaxCount = new SpinLock(false);

		// Token: 0x040002F8 RID: 760
		private SpinLock _spinLockResourceChange = new SpinLock(false);

		// Token: 0x040002F9 RID: 761
		private SpinLock _spinLockWorkLocationMaxCount = new SpinLock(false);

		// Token: 0x040002FA RID: 762
		private SpinLock _spinLockTotalVillagerCount = new SpinLock(false);

		// Token: 0x040002FB RID: 763
		private SpinLock _spinLockTotalAdultVillagerCount = new SpinLock(false);

		// Token: 0x040002FC RID: 764
		private SpinLock _spinLockAvailableVillagerCount = new SpinLock(false);

		// Token: 0x040002FD RID: 765
		private SpinLock _spinLockVillagerLearnLifeSkillsFromSect = new SpinLock(false);

		// Token: 0x040002FE RID: 766
		private SpinLock _spinLockVillagerLearnCombatSkillsFromSect = new SpinLock(false);

		// Token: 0x040002FF RID: 767
		private SpinLock _spinLockOverweightSanctionPercent = new SpinLock(false);

		// Token: 0x04000300 RID: 768
		private SpinLock _spinLockReferenceSkillSlotUnlockStates = new SpinLock(false);

		// Token: 0x04000301 RID: 769
		private SpinLock _spinLockTaiwuGroupWorstInjuries = new SpinLock(false);

		// Token: 0x04000302 RID: 770
		private SpinLock _spinLockTotalResources = new SpinLock(false);

		// Token: 0x04000303 RID: 771
		private SpinLock _spinLockTaiwuSpecialGroup = new SpinLock(false);

		// Token: 0x04000304 RID: 772
		private SpinLock _spinLockTaiwuGearMateGroup = new SpinLock(false);

		// Token: 0x04000305 RID: 773
		private SpinLock _spinLockCanBreakOut = new SpinLock(false);

		// Token: 0x04000306 RID: 774
		private SpinLock _spinLockTroughMaxLoad = new SpinLock(false);

		// Token: 0x04000307 RID: 775
		private SpinLock _spinLockTroughCurrLoad = new SpinLock(false);

		// Token: 0x04000308 RID: 776
		private SpinLock _spinLockClothingDurability = new SpinLock(false);

		// Token: 0x04000309 RID: 777
		private Queue<uint> _pendingLoadingOperationIds;

		// Token: 0x02000925 RID: 2341
		private struct LifeSkillStateModify
		{
			// Token: 0x040026B7 RID: 9911
			public int Index;

			// Token: 0x040026B8 RID: 9912
			public int ReadPageIndex;
		}
	}
}
